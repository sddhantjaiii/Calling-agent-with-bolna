# Call Campaign System - Architecture Diagram

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                   USER INTERFACE                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  Contacts   â”‚    â”‚  Campaigns   â”‚    â”‚  Campaign      â”‚    â”‚   Settings      â”‚ â”‚
â”‚  â”‚    Page     â”‚    â”‚  Dashboard   â”‚    â”‚    Detail      â”‚    â”‚     Page        â”‚ â”‚
â”‚  â”‚             â”‚    â”‚              â”‚    â”‚                â”‚    â”‚                 â”‚ â”‚
â”‚  â”‚ [âœ“] Contact â”‚    â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚    â”‚ Stats & Charts â”‚    â”‚ Concurrency     â”‚ â”‚
â”‚  â”‚ [âœ“] Contact â”‚â”€â”€â”€â–¶â”‚ â”‚ Campaign â”‚ â”‚â—€â”€â”€â”€â”‚ Queue Status   â”‚    â”‚ Limit: 2        â”‚ â”‚
â”‚  â”‚ [âœ“] Contact â”‚    â”‚ â”‚  Cards   â”‚ â”‚    â”‚ Call History   â”‚    â”‚ Active: 1       â”‚ â”‚
â”‚  â”‚             â”‚    â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚    â”‚ Edit/Pause     â”‚    â”‚ Available: 1    â”‚ â”‚
â”‚  â”‚ [Bulk Call] â”‚    â”‚ [+ New]      â”‚    â”‚                â”‚    â”‚                 â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚         â”‚                  â”‚                                                        â”‚
â”‚         â”‚                  â”‚                                                        â”‚
â”‚         â–¼                  â–¼                                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚  â”‚   BulkCallModal                  â”‚      â”‚  CSVUploadForm            â”‚          â”‚
â”‚  â”‚                                  â”‚      â”‚                           â”‚          â”‚
â”‚  â”‚  Agent: [Dropdown]               â”‚      â”‚  [ðŸ“„ Drop CSV or Browse]  â”‚          â”‚
â”‚  â”‚  Next Action: [Textarea]         â”‚      â”‚                           â”‚          â”‚
â”‚  â”‚  Time: 09:00 AM - 06:00 PM      â”‚      â”‚  Download Templates:      â”‚          â”‚
â”‚  â”‚  Start: [Date Picker]            â”‚      â”‚  â€¢ Basic Template         â”‚          â”‚
â”‚  â”‚                                  â”‚      â”‚  â€¢ Advanced Template      â”‚          â”‚
â”‚  â”‚  [Create Campaign]               â”‚      â”‚                           â”‚          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â”‚                                                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                        â”‚
                                        â”‚ HTTP Requests (REST API)
                                        â”‚
                                        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                   API LAYER                                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                      â”‚
â”‚  POST   /api/campaigns/bulk-call     Create campaign from selected contacts        â”‚
â”‚  POST   /api/campaigns/upload-csv    Create campaign from CSV upload               â”‚
â”‚  GET    /api/campaigns               List all campaigns (filtered)                 â”‚
â”‚  GET    /api/campaigns/:id           Get campaign details                          â”‚
â”‚  PATCH  /api/campaigns/:id           Update campaign                               â”‚
â”‚  POST   /api/campaigns/:id/pause     Pause campaign                                â”‚
â”‚  POST   /api/campaigns/:id/resume    Resume campaign                               â”‚
â”‚  POST   /api/campaigns/:id/cancel    Cancel campaign                               â”‚
â”‚  DELETE /api/campaigns/:id           Delete campaign                               â”‚
â”‚  GET    /api/campaigns/:id/analytics Get campaign analytics                        â”‚
â”‚  GET    /api/queue                   Get user's queue status                       â”‚
â”‚  GET    /api/settings/concurrency    Get concurrency limits                        â”‚
â”‚                                                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                        â”‚
                                        â”‚
                                        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                SERVICE LAYER                                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚
â”‚  â”‚  CallCampaignService     â”‚       â”‚  CallQueueService       â”‚                   â”‚
â”‚  â”‚                          â”‚       â”‚                         â”‚                   â”‚
â”‚  â”‚  â€¢ createCampaign()      â”‚â—€â”€â”€â”€â”€â”€â–¶â”‚  â€¢ addToQueue()         â”‚                   â”‚
â”‚  â”‚  â€¢ updateCampaign()      â”‚       â”‚  â€¢ getNextQueuedCall()  â”‚                   â”‚
â”‚  â”‚  â€¢ pauseCampaign()       â”‚       â”‚  â€¢ calculatePriority()  â”‚                   â”‚
â”‚  â”‚  â€¢ resumeCampaign()      â”‚       â”‚  â€¢ distributeInWindow() â”‚                   â”‚
â”‚  â”‚  â€¢ getCampaigns()        â”‚       â”‚  â€¢ getQueueStats()      â”‚                   â”‚
â”‚  â”‚  â€¢ getCampaignAnalytics()â”‚       â”‚                         â”‚                   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚
â”‚               â”‚                                   â”‚                                 â”‚
â”‚               â”‚                                   â”‚                                 â”‚
â”‚               â–¼                                   â–¼                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚
â”‚  â”‚         QueueProcessorService (Background Job)              â”‚                  â”‚
â”‚  â”‚                                                             â”‚                  â”‚
â”‚  â”‚  Every 10 seconds:                                         â”‚                  â”‚
â”‚  â”‚  1. Check system concurrency (10 max)                     â”‚                  â”‚
â”‚  â”‚  2. Check user concurrency (2 max per user)               â”‚                  â”‚
â”‚  â”‚  3. Apply round-robin allocation                          â”‚                  â”‚
â”‚  â”‚  4. Get next queued calls (priority + FIFO)               â”‚                  â”‚
â”‚  â”‚  5. Validate time window (09:00 - 18:00)                  â”‚                  â”‚
â”‚  â”‚  6. Initiate calls via Bolna API â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚                  â”‚
â”‚  â”‚  7. Update queue status                               â”‚   â”‚                  â”‚
â”‚  â”‚                                                        â”‚   â”‚                  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚â”€â”€â”€â”˜                  â”‚
â”‚                                                           â”‚                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚  â”‚  CSVUploadService      â”‚      â”‚  WebhookService       â”‚              â”‚        â”‚
â”‚  â”‚                        â”‚      â”‚                       â–¼              â”‚        â”‚
â”‚  â”‚  â€¢ parseCSV()          â”‚      â”‚  On webhook receive:                â”‚        â”‚
â”‚  â”‚  â€¢ validateData()      â”‚      â”‚  â€¢ Update call status               â”‚        â”‚
â”‚  â”‚  â€¢ createContacts()    â”‚      â”‚  â€¢ Update queue status              â”‚        â”‚
â”‚  â”‚  â€¢ createCampaign()    â”‚      â”‚  â€¢ Free queue slot                  â”‚        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚  â€¢ Trigger processQueue()           â”‚        â”‚
â”‚                                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â”‚                                                                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                        â”‚
                                        â”‚
                                        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                DATABASE LAYER                                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”‚
â”‚  â”‚     users       â”‚   â”‚  call_campaigns â”‚   â”‚   call_queue    â”‚                 â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                 â”‚
â”‚  â”‚ id              â”‚   â”‚ id              â”‚   â”‚ id              â”‚                 â”‚
â”‚  â”‚ email           â”‚   â”‚ user_id      â”€â”€â”€â”¼â”€â”€â–¶â”‚ user_id         â”‚                 â”‚
â”‚  â”‚ name            â”‚   â”‚ name            â”‚   â”‚ campaign_id  â”€â”€â”€â”¼â”€â”€â”              â”‚
â”‚  â”‚ concurrent_     â”‚   â”‚ agent_id        â”‚   â”‚ agent_id        â”‚  â”‚              â”‚
â”‚  â”‚   calls_limit   â”‚   â”‚ next_action     â”‚   â”‚ contact_id      â”‚  â”‚              â”‚
â”‚  â”‚ system_         â”‚   â”‚ first_call_time â”‚   â”‚ phone_number    â”‚  â”‚              â”‚
â”‚  â”‚   concurrent_   â”‚   â”‚ last_call_time  â”‚   â”‚ contact_name    â”‚  â”‚              â”‚
â”‚  â”‚   calls_limit   â”‚   â”‚ status          â”‚   â”‚ user_data       â”‚  â”‚              â”‚
â”‚  â”‚ ...             â”‚   â”‚ total_contacts  â”‚   â”‚ status          â”‚  â”‚              â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚ completed_calls â”‚   â”‚ priority        â”‚  â”‚              â”‚
â”‚           â”‚            â”‚ start_date      â”‚   â”‚ position        â”‚  â”‚              â”‚
â”‚           â”‚            â”‚ ...             â”‚   â”‚ scheduled_for   â”‚  â”‚              â”‚
â”‚           â”‚            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚ call_id         â”‚  â”‚              â”‚
â”‚           â”‚                     â–²            â”‚ ...             â”‚  â”‚              â”‚
â”‚           â”‚                     â”‚            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚              â”‚
â”‚           â”‚                     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
â”‚           â”‚                                                                        â”‚
â”‚           â–¼                                                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”‚
â”‚  â”‚    agents       â”‚   â”‚    contacts     â”‚   â”‚     calls       â”‚                 â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                 â”‚
â”‚  â”‚ id              â”‚   â”‚ id              â”‚   â”‚ id              â”‚                 â”‚
â”‚  â”‚ user_id         â”‚   â”‚ user_id         â”‚   â”‚ user_id         â”‚                 â”‚
â”‚  â”‚ name            â”‚   â”‚ name            â”‚   â”‚ agent_id        â”‚                 â”‚
â”‚  â”‚ bolna_agent_id  â”‚   â”‚ phone_number    â”‚   â”‚ contact_id      â”‚                 â”‚
â”‚  â”‚ ...             â”‚   â”‚ email           â”‚   â”‚ phone_number    â”‚                 â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚ company         â”‚   â”‚ status          â”‚                 â”‚
â”‚                        â”‚ not_connected   â”‚   â”‚ duration        â”‚                 â”‚
â”‚                        â”‚ ...             â”‚   â”‚ recording_url   â”‚                 â”‚
â”‚                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚ ...             â”‚                 â”‚
â”‚                                              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â”‚
â”‚                                                                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                        â”‚
                                        â”‚
                                        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                            EXTERNAL SERVICES                                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                           Bolna.ai API                                       â”‚  â”‚
â”‚  â”‚                                                                              â”‚  â”‚
â”‚  â”‚  POST /call                                                                  â”‚  â”‚
â”‚  â”‚  {                                                                           â”‚  â”‚
â”‚  â”‚    "agent_id": "3b2998b1-3100-469a-aa0b-534f6d1cb4c3",                      â”‚  â”‚
â”‚  â”‚    "recipient_phone_number": "+918979556941",                               â”‚  â”‚
â”‚  â”‚    "user_data": {                                                           â”‚  â”‚
â”‚  â”‚      "summary": "name: John, email: john@..., company: ABC Corp, ...",     â”‚  â”‚
â”‚  â”‚      "next_action": "Schedule product demo"                                 â”‚  â”‚
â”‚  â”‚    }                                                                         â”‚  â”‚
â”‚  â”‚  }                                                                           â”‚  â”‚
â”‚  â”‚                                                                              â”‚  â”‚
â”‚  â”‚  Webhooks Sent:                                                             â”‚  â”‚
â”‚  â”‚  1. initiated        â†’ Call started                                         â”‚  â”‚
â”‚  â”‚  2. ringing          â†’ Phone ringing                                        â”‚  â”‚
â”‚  â”‚  3. in-progress      â†’ Call answered                                        â”‚  â”‚
â”‚  â”‚  4. call-disconnectedâ†’ Call ended (transcript available)                    â”‚  â”‚
â”‚  â”‚  5. completed        â†’ Processing complete (recording available)            â”‚  â”‚
â”‚  â”‚  Also: busy, no-answer, failed                                              â”‚  â”‚
â”‚  â”‚                                                                              â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Data Flow Examples

### **Example 1: Create Campaign from Contacts**

```
User Action:
  1. Selects 10 contacts on /contacts page
  2. Clicks "Bulk Call"
  3. Fills modal:
     - Agent: Sales Bot
     - Next Action: "Schedule demo"
     - Time: 09:00 - 18:00
     - Start: Tomorrow
  4. Clicks "Create Campaign"

Backend Flow:
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚ POST /api/campaigns/bulk-call                            â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚ CallCampaignService.createCampaign()                     â”‚
  â”‚   - Create campaign record                               â”‚
  â”‚   - Status: active (starts tomorrow)                     â”‚
  â”‚   - Total contacts: 10                                   â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚ CallQueueService.addToQueue()  (for each contact)       â”‚
  â”‚                                                          â”‚
  â”‚   For Contact #1:                                        â”‚
  â”‚   - Calculate priority: 100 (has name)                   â”‚
  â”‚   - Calculate scheduled_for: tomorrow 09:00 AM           â”‚
  â”‚   - Build user_data:                                     â”‚
  â”‚     {                                                    â”‚
  â”‚       summary: "name: John, email: ..., company: ...",   â”‚
  â”‚       next_action: "Schedule demo"                       â”‚
  â”‚     }                                                    â”‚
  â”‚   - Position: 1                                          â”‚
  â”‚                                                          â”‚
  â”‚   For Contact #2:                                        â”‚
  â”‚   - Priority: 100                                        â”‚
  â”‚   - Scheduled_for: tomorrow 09:54 AM (54 min after #1)  â”‚
  â”‚   - Position: 2                                          â”‚
  â”‚                                                          â”‚
  â”‚   ... repeat for all 10 contacts                         â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚ Database: Insert into call_queue (10 rows)              â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚ Response: { campaign_id, status: "success" }             â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚ Frontend: Navigate to /campaigns/:id                     â”‚
  â”‚ Shows: Campaign created, 10 calls queued for tomorrow    â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### **Example 2: Queue Processing (Background)**

```
Tomorrow 09:00 AM arrives:

QueueProcessor runs (every 10 seconds):

  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚ Check System Concurrency                                 â”‚
  â”‚   - System limit: 10                                     â”‚
  â”‚   - Active calls: 0                                      â”‚
  â”‚   - Available: 10 slots                                  â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚ Get Users with Queued Calls                              â”‚
  â”‚   - User A: 10 queued, limit: 2, active: 0               â”‚
  â”‚   - User B: 5 queued, limit: 2, active: 0                â”‚
  â”‚   - User C: 3 queued, limit: 2, active: 0                â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚ Round-Robin Allocation (System has 10 slots)             â”‚
  â”‚                                                          â”‚
  â”‚   Round 1: Give each user 1 slot                         â”‚
  â”‚   - User A: 1 slot allocated                             â”‚
  â”‚   - User B: 1 slot allocated                             â”‚
  â”‚   - User C: 1 slot allocated                             â”‚
  â”‚   Remaining: 7 slots                                     â”‚
  â”‚                                                          â”‚
  â”‚   Round 2: Give each user 1 more                         â”‚
  â”‚   - User A: 1 slot (now has 2, at limit)                 â”‚
  â”‚   - User B: 1 slot (now has 2, at limit)                 â”‚
  â”‚   - User C: 1 slot (now has 2, at limit)                 â”‚
  â”‚   Remaining: 4 slots                                     â”‚
  â”‚                                                          â”‚
  â”‚   Round 3: All users at their limit, stop                â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚ Process User A's 2 Allocated Slots                       â”‚
  â”‚                                                          â”‚
  â”‚   Slot 1:                                                â”‚
  â”‚   - Get next queued (priority DESC, position ASC)        â”‚
  â”‚   - Queue ID: abc-123 (Contact #1, priority 100)         â”‚
  â”‚   - Check scheduled_for: 09:00 AM âœ… (now)               â”‚
  â”‚   - Check time window: 09:00-18:00 âœ… (within)           â”‚
  â”‚   - Initiate call via Bolna API â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
  â”‚   - Update queue status: processing                â”‚     â”‚
  â”‚   - Create call record                             â”‚     â”‚
  â”‚                                                    â”‚     â”‚
  â”‚   Slot 2:                                          â”‚     â”‚
  â”‚   - Get next queued                                â”‚     â”‚
  â”‚   - Queue ID: abc-124 (Contact #2, priority 100)   â”‚     â”‚
  â”‚   - Check scheduled_for: 09:54 AM âŒ (not yet)     â”‚     â”‚
  â”‚   - Skip, try next                                 â”‚     â”‚
  â”‚   - Queue ID: abc-125 (Contact #3, priority 90)    â”‚     â”‚
  â”‚   - Check scheduled_for: 09:30 AM âœ… (overdue)     â”‚     â”‚
  â”‚   - Initiate call â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¤
  â”‚                                                    â”‚     â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
               â”‚                                             â”‚
               â”‚  Repeat for User B and User C...            â”‚
               â”‚                                             â”‚
               â–¼                                             â”‚
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”
  â”‚ Bolna.ai receives 6 call requests                           â”‚
  â”‚   - User A: Contact #1, Contact #3                          â”‚
  â”‚   - User B: Contact #1, Contact #2                          â”‚
  â”‚   - User C: Contact #1, Contact #2                          â”‚
  â”‚                                                             â”‚
  â”‚ Bolna starts dialing...                                     â”‚
  â”‚                                                             â”‚
  â”‚ Webhooks will be sent:                                      â”‚
  â”‚   â†’ initiated (immediately)                                 â”‚
  â”‚   â†’ ringing (5 seconds)                                     â”‚
  â”‚   â†’ in-progress (10 seconds)                                â”‚
  â”‚   â†’ call-disconnected (after conversation)                  â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### **Example 3: Call Completion & Slot Release**

```
5 minutes later, User A's Contact #1 call completes:

  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚ Bolna sends webhook:                                     â”‚
  â”‚   POST /api/webhooks/bolna                               â”‚
  â”‚   { status: "call-disconnected", ... }                   â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚ WebhookService.processWebhook()                          â”‚
  â”‚   - Find call record by execution_id                     â”‚
  â”‚   - Update call status: completed                        â”‚
  â”‚   - Find queue item by call_id                           â”‚
  â”‚   - Update queue status: completed                       â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚ QueueProcessorService.freeQueueSlot()                    â”‚
  â”‚   - User A now has 1 active call (was 2)                 â”‚
  â”‚   - User A has 1 available slot                          â”‚
  â”‚   - System has 1 available slot (was 6 active, now 5)    â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚ QueueProcessorService.processQueue() (triggered)         â”‚
  â”‚                                                          â”‚
  â”‚   System has 1 available slot:                           â”‚
  â”‚   - Round-robin: User A was last, try User B             â”‚
  â”‚   - User B at limit (2/2), skip                          â”‚
  â”‚   - Try User C                                           â”‚
  â”‚   - User C at limit (2/2), skip                          â”‚
  â”‚   - Back to User A                                       â”‚
  â”‚   - User A has 1 available slot! Allocate               â”‚
  â”‚                                                          â”‚
  â”‚   Get User A's next queued call:                         â”‚
  â”‚   - Queue ID: abc-124 (Contact #2)                       â”‚
  â”‚   - Scheduled_for: 09:54 AM                              â”‚
  â”‚   - Current time: 09:05 AM                               â”‚
  â”‚   - Not yet time, skip                                   â”‚
  â”‚                                                          â”‚
  â”‚   Try next:                                              â”‚
  â”‚   - Queue ID: abc-126 (Contact #4)                       â”‚
  â”‚   - Scheduled_for: 09:10 AM âœ…                           â”‚
  â”‚   - Initiate call â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
  â”‚                                                   â”‚      â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”˜
                                                      â”‚
                                                      â–¼
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚ Bolna.ai receives call request for Contact #4           â”‚
  â”‚ Process continues...                                     â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Key Algorithms

### **1. Priority Calculation**
```
priority = 0

if (contact.name exists): priority += 100
if (contact.email exists): priority += 10
if (contact.company exists): priority += 10
if (previous_successful_calls > 0): priority += (count * 5) max 20
if (contact.not_connected > 0): priority -= (count * 10)

return max(priority, 0)
```

### **2. Time Window Distribution**
```
total_minutes = (last_call_time - first_call_time)
interval = total_minutes / contact_count

for each contact (i):
  offset = i * interval
  scheduled_time = first_call_time + offset
```

### **3. Round-Robin Allocation**
```
available_system_slots = system_limit - active_system_calls
users_with_queue = get_users_with_queued_calls()
users_with_queue.sort_by(last_allocation_time ASC)

for each user in users_with_queue:
  if (available_system_slots <= 0): break
  
  user_available = user.limit - user.active_calls
  if (user_available > 0):
    allocate_1_slot_to(user)
    available_system_slots -= 1
    update_last_allocation_time(user)
```

---

**Ready to implement?** Start with the database migration! ðŸš€
