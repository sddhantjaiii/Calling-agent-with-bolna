/*! For license information please see plivobrowsersdk.min.js.LICENSE.txt */
var Plivo=function(n){var e={};function t(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}};return n[r].call(i.exports,i,i.exports,t),i.l=!0,i.exports}return t.m=n,t.c=e,t.d=function(n,e,r){t.o(n,e)||Object.defineProperty(n,e,{enumerable:!0,get:r})},t.r=function(n){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(n,"__esModule",{value:!0})},t.t=function(n,e){if(1&e&&(n=t(n)),8&e)return n;if(4&e&&"object"===typeof n&&n&&n.__esModule)return n;var r=Object.create(null);if(t.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:n}),2&e&&"string"!=typeof n)for(var i in n)t.d(r,i,function(e){return n[e]}.bind(null,i));return r},t.n=function(n){var e=n&&n.__esModule?function(){return n.default}:function(){return n};return t.d(e,"a",e),e},t.o=function(n,e){return Object.prototype.hasOwnProperty.call(n,e)},t.p="",t(t.s=25)}([function(n,e,t){"use strict";var r=this&&this.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(e,"__esModule",{value:!0}),e.Logger=void 0;const i=t(1),a=r(t(31)),s=t(9),o=[],c="undefined"!==typeof chrome&&chrome.storage?chrome.storage.local:window.localStorage,l=["INFO","DEBUG","WARN","ERROR","ALL","OFF"],u=["ERROR","WARN","INFO","DEBUG","ALL"];e.Logger=new class{constructor(n={}){this.info=(...n)=>this.logging("INFO",n),this.debug=(...n)=>this.logging("DEBUG",n),this.warn=(...n)=>this.logging("WARN",n),this.error=(...n)=>this.logging("ERROR",n),this.setLevel=n=>this._setLevel(n),this.level=()=>this.logMethod,this.consolelogs=()=>o,this.enableSipLogs=n=>this._enableSipLogs(n),this._setLevel=n=>{const e=n.toUpperCase();return-1!==l.indexOf(e)?(this.logMethod=e,-1===["DEBUG","ALL"].indexOf(e)&&(c.debug=""),`logLevel is now : ${this.logMethod}`):`only : ${l.toString()} are allowed in run time!`},this._enableSipLogs=n=>{-1!==["ALL","ALL-PLAIN"].indexOf(n)?(c.debug="JsSIP:*",window._PlivoUseColorLog=!0,"ALL-PLAIN"===n&&(window._PlivoUseColorLog=!1)):c.debug=""},this._appendToQueue=(n,e,t)=>{let r=!1;e.includes(i.LOGCAT.INIT)&&(r=!0),e.includes(i.LOGCAT.CALL)&&(r=!0),e.includes(i.LOGCAT.LOGIN)&&(r=!0),e.includes(i.LOGCAT.LOGOUT)&&(r=!0),e.includes(i.LOGCAT.CRASH)&&(r=!0),e.includes(i.LOGCAT.CALL_QUALITY)&&(r=!0),e.includes(i.LOGCAT.NETWORK_CHANGE)&&(r=!0),e.includes(i.LOGCAT.NIMBUS)&&(r=!0),e.includes(i.LOGCAT.WS)&&(r=!0),r&&a.default.getInstance().setData(n,e,t)},this.logging=(n,e)=>{var t,r;const a=n.toUpperCase(),s=e[0]||" ",c=e[1]||" ";if(-1!==l.indexOf(this.logMethod)||this.logMethod===a){const n=this.options.enableDate||!1,e=this.options.loggingName||"",l=new Date;let d="";n&&(d=`[${l.toISOString().substring(0,10)} ${l.toISOString().split("T")[1].split(".")[0]}.${l.getUTCMilliseconds()}]`);let h="";if(h=this.loggerUtil?`${d} ${e} : ${null===(t=this.loggerUtil)||void 0===t?void 0:t.getUserName()} ${null===(r=this.loggerUtil)||void 0===r?void 0:r.getSipCallID()} [${a}] `:`${d} ${e} :[${a}] `,o.length>=i.CONSOLE_LOGS_BUFFER_SIZE&&o.shift(),o.push(`${h+s+c} \n`),this._appendToQueue(h,s,c),u.indexOf(a)>u.indexOf(this.logMethod))return;switch(a){case"OFF":break;case"INFO":console.info(h,s,c);break;case"DEBUG":console.debug(h,s,c);break;case"WARN":console.warn(h,s,c);break;case"ERROR":console.error(h,s,c);break;default:console.log(h,s,c)}}},this._getLogsBatchData=(n,e)=>{let t=0;const r=[];let i=[];return n.forEach((n=>{t+=n.length,t>e&&(i.push("...continue"),r.push(i),i=[],t=0),i.push(n)})),0!==i.length&&(r.length>0&&i.push("...continue"),r.push(i)),r},this._sendBatchedLogsToServer=(n,e,t,r,o="",c="")=>new Promise(((l,u)=>{const d=s.getSDKVersion(),h=s.getOS(),p={username:n.userName,logs:t[r],sdk_v:d.version,sdk_name:"BrowserSDK",user_agent:h,call_uuid:""};o&&""!==o&&(p.call_uuid=o),c&&""!==c&&(p.username=c),n.isAccessToken&&(p.jwt=n.accessToken);const f={method:"POST",headers:e,body:JSON.stringify(p),redirect:"follow"},g=n.isAccessToken?i.LOG_COLLECTION_JWT:i.LOG_COLLECTION;navigator.onLine?fetch(g.trimEnd(),f).then((s=>{s.ok?(r+=1,t.length>r?this._sendBatchedLogsToServer(n,e,t,r,p.call_uuid,p.username):a.default.getInstance().clear(),l("success")):(this.info(`${i.LOGCAT.NIMBUS} | Error while uploading logs to nimbus`),u(new Error("failure"))),s.text()})).then((n=>console.log(n))).catch((n=>{console.log("error",n),u(n)})):(this.info(`${i.LOGCAT.NIMBUS} | No internet while pushing logs to nimbus`),l("no internet while sending nimbus logs"))})),this.send=n=>{const e=new Headers;e.append("Content-Type","application/json");const t=a.default.getInstance().getData();if(!t)return void console.log("No data to send");if(!n.userName)return;const r=JSON.parse(t).split("\n"),i=this._getLogsBatchData(r,2e4);this._sendBatchedLogsToServer(n,e,i,0)},this.options=n,this.logMethod=this.options.logMethod||"INFO"}setLoggerUtil(n){this.loggerUtil=n}}({enableDate:!0,loggingName:"PlivoSDK",logMethod:"DEBUG"})},function(n,e,t){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.AUDIO_DEVICE_SECURITY_ERROR=e.AUDIO_DEVICE_ABORT_ERROR_CODE=e.SILENT_TONE_ELEMENT_ID=e.CONNECT_TONE_ELEMENT_ID=e.RINGTONE_ELEMENT_ID=e.RINGBACK_ELEMENT_ID=e.REMOTE_VIEW_ID=e.SELF_VIEW_ID=e.SILENT_TONE_URL=e.CONNECT_TONE_URL=e.RINGBACK_URL=e.RINGTONE_URL=e.LOGCAT=e.DEFAULT_COMMENTS=e.DEBUG_MODES=e.REGION=e.MAX_REGISTRATION_REFRESH_TIMER=e.MIN_REGISTRATION_REFRESH_TIMER=e.MIN_AVERAGE_BITRATE=e.MAX_AVERAGE_BITRATE=e.CONSOLE_LOGS_BUFFER_SIZE=e.DTMF_OPTIONS=e.DEFAULT_CODECS=e.LOCAL_ERROR_CODES=e.SIP_ERROR_CODE=e.DTMF_TONE_PLAY_RETRY_ATTEMPTS=e.SOCKET_SEND_STATS_RETRY_ATTEMPTS=e.SOCKET_SEND_STATS_RETRY_SECONDS_COUNT=e.GOOG_STUN_SERVER=e.FALLBACK_STUN_SERVER=e.STUN_SERVERS=e.NETWORK_CHANGE_INTERVAL=e.ICE_RECONNECT_COUNT=e.ICE_RECONNECT_INTERVAL=e.ICE_GATHERING_TIMEOUT=e.DEFAULT_MDNS_CANDIDATE=e.WS_RECOVERY_MIN_INTERVAL=e.WS_RECOVERY_MAX_INTERVAL=e.SESSION_TIMERS_EXPIRES=e.REGISTER_EXPIRES_SECONDS=e.NUMBER_OF_SIMULTANEOUS_INCOMING_CALLS_ALLOWED=e.DEFAULT_DTMFOPTIONS=e.AUDIO_CONSTRAINTS=e.REMOTEONLY=e.LOCALONLY=e.ENABLE_QUALITY_TRACKING_ALLOWED_VALUES=e.DEFAULT_ENABLE_QUALITY_TRACKING=e.DEFAULT_LOG_LEVEL=e.WS_SERVERS=e.DOMAIN=void 0,e.WS_RECONNECT_RETRY_INTERVAL=e.WS_RECONNECT_RETRY_COUNT=e.IP_ADDRESS_FETCH_RETRY_COUNT=e.MESSAGE_CHECK_TIMEOUT_ON_CALL_STATE=e.MESSAGE_CHECK_TIMEOUT_IDLE_STATE=e.NETWORK_CHANGE_INTERVAL_ON_CALL_STATE=e.NETWORK_CHANGE_INTERVAL_IDLE_STATE=e.STATS_ANALYSIS_WAIT_TIME=e.STATSSOCKET_RECONNECT_SEC=e.GETSTATS_HEARTBEATINTERVAL=e.AUDIO_INTERVAL=e.GETSTATS_INTERVAL=e.STATS_VERSION=e.STATS_SOURCE=e.LOG_COLLECTION_JWT=e.LOG_COLLECTION=e.S3BUCKET_API_URL_JWT=e.STATS_API_URL_ACCESS_TOKEN=e.SDKVERSION_API_URL=e.STATS_API_URL=e.STATSSOCKET_URL=e.S3BUCKET_API_URL=e.DTMF_TONE_FLAG=void 0,e.DOMAIN="phone.plivo.com",e.WS_SERVERS=["wss://client.plivo.com/signalling","wss://client-fb.plivo.com/signalling"],e.DEFAULT_LOG_LEVEL="INFO",e.DEFAULT_ENABLE_QUALITY_TRACKING="ALL",e.ENABLE_QUALITY_TRACKING_ALLOWED_VALUES=["ALL","NONE","REMOTEONLY","LOCALONLY"],e.LOCALONLY="LOCALONLY",e.REMOTEONLY="REMOTEONLY",e.AUDIO_CONSTRAINTS={optional:[{googAutoGainControl:!0}]},e.DEFAULT_DTMFOPTIONS={sendDtmfType:["INBAND","OUTBAND"]},e.NUMBER_OF_SIMULTANEOUS_INCOMING_CALLS_ALLOWED=50,e.REGISTER_EXPIRES_SECONDS=120,e.SESSION_TIMERS_EXPIRES=300,e.WS_RECOVERY_MAX_INTERVAL=20,e.WS_RECOVERY_MIN_INTERVAL=2,e.DEFAULT_MDNS_CANDIDATE="192.168.0.1",e.ICE_GATHERING_TIMEOUT=2e3,e.ICE_RECONNECT_INTERVAL=2e3,e.ICE_RECONNECT_COUNT=5,e.NETWORK_CHANGE_INTERVAL=1e4,e.STUN_SERVERS=["stun:stun.plivo.com:3478"],e.FALLBACK_STUN_SERVER="stun:stun-fb.plivo.com:3478",e.GOOG_STUN_SERVER="stun:stun.l.google.com:19302",e.SOCKET_SEND_STATS_RETRY_SECONDS_COUNT=1,e.SOCKET_SEND_STATS_RETRY_ATTEMPTS=5,e.DTMF_TONE_PLAY_RETRY_ATTEMPTS=4,e.SIP_ERROR_CODE={486:"User was busy",408:"No response from user",480:"No response from user",603:"Call rejected by user",484:"Invalid destination format",503:"Network issue while connecting the call",501:"Incompatible client configuration",487:"Call cancelled by caller",400:"Bad request - Parameters not valid",401:"Call authorization failed",403:"Call authorization failed",404:"Call authorization failed",405:"Call authorization failed",483:"Too many hops detected for call connection",500:"Internal Server Error",502:"There is an issue with the Carrier Gateway"},e.LOCAL_ERROR_CODES={"No Answer":3e3,Canceled:1e3,Rejected:3020,Terminated:11001,Ignored:11002,"call answer fail":11003,"Network switch while ringing":11004},e.DEFAULT_CODECS=["OPUS","PCMU"],e.DTMF_OPTIONS=["INBAND","OUTBAND"],e.CONSOLE_LOGS_BUFFER_SIZE=900,e.MAX_AVERAGE_BITRATE=48e3,e.MIN_AVERAGE_BITRATE=8e3,e.MIN_REGISTRATION_REFRESH_TIMER=60,e.MAX_REGISTRATION_REFRESH_TIMER=86400,e.REGION=["usa_west","usa_east","australia","europe","asia","south_america","south_asia"],e.DEBUG_MODES=["INFO","DEBUG","WARN","ERROR","ALL","ALL-PLAIN","OFF"],e.DEFAULT_COMMENTS={AUDIO_LAG:"audio_lag",BROKEN_AUDIO:"broken_audio",CALL_DROPPED:"call_dropped",CALLERID_ISSUES:"callerid_issue",DIGITS_NOT_CAPTURED:"digits_not_captured",ECHO:"echo",HIGH_CONNECT_TIME:"high_connect_time",LOW_AUDIO_LEVEL:"low_audio_level",ONE_WAY_AUDIO:"one_way_audio",OTHERS:"others",ROBOTIC_AUDIO:"robotic_audio"},e.LOGCAT={INIT:"INIT",LOGIN:"LOGIN",CALL:"CALLING",LOGOUT:"LOGOUT",CRASH:"CRASH",CALL_QUALITY:"CALL_QUALITY_FEEDBACK",NETWORK_CHANGE:"NETWORK_CHANGE",NIMBUS:"NIMBUS",WS:"WS"},e.RINGTONE_URL="https://cdn.plivo.com/sdk/browser/audio/us-ring.mp3",e.RINGBACK_URL="https://cdn.plivo.com/sdk/browser/audio/us-ring.mp3?v=ringback",e.CONNECT_TONE_URL="https://cdn.plivo.com/sdk/browser/audio/connect-tone.mp3",e.SILENT_TONE_URL="https://cdn.plivo.com/sdk/browser/audio/silent-audio.mp3",e.SELF_VIEW_ID="plivo_webrtc_selfview",e.REMOTE_VIEW_ID="plivo_webrtc_remoteview",e.RINGBACK_ELEMENT_ID="plivo_ringbacktone",e.RINGTONE_ELEMENT_ID="plivo_ringtone",e.CONNECT_TONE_ELEMENT_ID="plivo_connect_tone",e.SILENT_TONE_ELEMENT_ID="plivo_silent_tone",e.AUDIO_DEVICE_ABORT_ERROR_CODE=20,e.AUDIO_DEVICE_SECURITY_ERROR="SecurityError",e.DTMF_TONE_FLAG={0:!0,1:!0,2:!0,3:!0,4:!0,5:!0,6:!0,7:!0,8:!0,9:!0,"#":!0,"*":!0},e.S3BUCKET_API_URL="https://stats.plivo.com/v1/browser/bucketurl/",e.STATSSOCKET_URL="wss://insights.plivo.com/ws",e.STATS_API_URL="https://stats.plivo.com/v1/browser/validate/",e.SDKVERSION_API_URL="https://stats.plivo.com/v1/browser/websdkversion/",e.STATS_API_URL_ACCESS_TOKEN="https://stats.plivo.com/v1/browser/validate/jwt/",e.S3BUCKET_API_URL_JWT="https://stats.plivo.com/v1/browser/bucketurl/jwt/",e.LOG_COLLECTION="https://nimbus.plivo.com/collect/logs/",e.LOG_COLLECTION_JWT="https://nimbus.plivo.com/collect/logs/jwt/",e.STATS_SOURCE="BrowserSDK",e.STATS_VERSION="v1",e.GETSTATS_INTERVAL=5e3,e.AUDIO_INTERVAL=1e3,e.GETSTATS_HEARTBEATINTERVAL=1e5,e.STATSSOCKET_RECONNECT_SEC=1e4,e.STATS_ANALYSIS_WAIT_TIME=5e3,e.NETWORK_CHANGE_INTERVAL_IDLE_STATE=5e3,e.NETWORK_CHANGE_INTERVAL_ON_CALL_STATE=4e3,e.MESSAGE_CHECK_TIMEOUT_IDLE_STATE=2e3,e.MESSAGE_CHECK_TIMEOUT_ON_CALL_STATE=2e3,e.IP_ADDRESS_FETCH_RETRY_COUNT=10,e.WS_RECONNECT_RETRY_COUNT=2,e.WS_RECONNECT_RETRY_INTERVAL=15e3},function(n,e,t){"use strict";var r=this&&this.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(e,"__esModule",{value:!0});const i=r(t(51));e.default=()=>{const n={version:i.default.browserDetails.version,browser:i.default.browserDetails.browser};return window.opr&&opr.addons||window.opera||navigator.userAgent.indexOf("OPR/")>=0?(n.browser="opera",n):"undefined"!==typeof InstallTrigger?(n.browser="firefox",n):/constructor/i.test(window.HTMLElement)||"[object SafariRemoteNotification]"===(!window.safari||"undefined"!==typeof safari&&safari.pushNotification).toString()?(n.browser="safari",n):window.StyleMedia||window.chrome&&(window.chrome.webstore||window.chrome.runtime)&&-1!==navigator.userAgent.indexOf("Edg")?(n.browser="edge",n):window.chrome&&(window.chrome.webstore||window.chrome.runtime)?(n.browser="chrome",n):n}},function(n,e,t){"use strict";var r=this&&this.__createBinding||(Object.create?function(n,e,t,r){void 0===r&&(r=t),Object.defineProperty(n,r,{enumerable:!0,get:function(){return e[t]}})}:function(n,e,t,r){void 0===r&&(r=t),n[r]=e[t]}),i=this&&this.__setModuleDefault||(Object.create?function(n,e){Object.defineProperty(n,"default",{enumerable:!0,value:e})}:function(n,e){n.default=e}),a=this&&this.__importStar||function(n){if(n&&n.__esModule)return n;var e={};if(null!=n)for(var t in n)"default"!==t&&Object.prototype.hasOwnProperty.call(n,t)&&r(e,n,t);return i(e,n),e},s=this&&this.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(e,"__esModule",{value:!0}),e.onToggleMute=e.onSDPfailure=e.onMediaFailure=e.onIceFailure=e.signallingEvent=e.sendFeedbackEvent=e.sendCallRingingEvent=e.sendCallSummaryEvent=e.sendCallAnsweredEvent=e.AppError=e.sendEvents=e.addCallInfo=void 0;const o=s(t(10)),c=a(t(9)),l=t(0),u=a(t(1)),d=s(t(2)),h={log:l.Logger};e.addCallInfo=function(n,e,t,r){const i=e;return i.callstats_key=t,i.callUUID=n.sipCallID,i.corelationId=n.sipCallID,i.xcallUUID=n.callUUID,i.timeStamp=Date.now(),i.userName=r,i.domain=u.DOMAIN,i.source=u.STATS_SOURCE,i.version=u.STATS_VERSION,i};e.sendEvents=function(n,t){const r=this;if(r.statsSocket&&r.callstatskey&&t&&t.sipCallID){const i=e.addCallInfo(t,n,r.callstatskey,r.userName);r.statsSocket.send(i,r),!0===r.isUnregisterPending&&(r.isUnregisterPending=!1,r.phone&&r.phone.stop(),r.deferFeedback=!0,r.statsSocket.disconnect(),r.statsSocket=null),"CALL_SUMMARY"===n.msg&&r.isAccessToken&&!r.isLoggedIn&&(r.emit("onLogout","ACCESS_TOKEN_EXPIRED"),r.logout())}else h.log.debug(`${u.LOGCAT.CALL} | Cannot send event `,n.msg," mandatory parameters (statsSocket, sipCallID, callstatskey) not defined ")};e.AppError=function(n,e){const t=this;if(t.userName&&t.callStats){const r=(t._currentSession?t._currentSession.callUUID:null)||t.userName;"[object Object]"===Object.prototype.toString.call(n)&&(n=JSON.stringify(n)),e&&h.log.debug(`Call summary ${r}\n`,n),t.callStats.reportError(null,r,t.callStats.webRTCFunctions.applicationLog,n)}return!0};e.sendCallAnsweredEvent=function(n,t){var r;const i=this;if(!i.callstatskey)return;const a=c.getClientVersion(),s=c.getSDKVersion(),l=c.getOS(),u={msg:"CALL_ANSWERED",info:"Outgoing call answered",clientName:d.default().browser,userAgent:navigator.userAgent,clientVersionMajor:a.major||a[0]||"0",clientVersionMinor:a.minor||a[1]||"0",clientVersionPatch:a.patch||a[2]||"0",sdkName:o.default.name,sdkVersionMajor:s.major,sdkVersionMinor:s.minor,sdkVersionPatch:s.patch,devicePlatform:navigator.platform,deviceOs:l,noiseReduction:{enabled:null!==(r=i.enableNoiseReduction)&&void 0!==r&&r,noiseSuprressionStarted:i.noiseSuppresion.started},setupOptions:i.options};n&&(u.audioDeviceInfo=n),t&&(u.info="Incoming call answered"),e.sendEvents.call(i,u,i._currentSession)};e.sendCallSummaryEvent=function(n,t,r,i){var a;const s=this;if(!s.callstatskey)return;const l=c.getClientVersion(),u=c.getSDKVersion(),h=c.getOS(),p={msg:"CALL_SUMMARY",signalling:t,mediaConnection:r,clientName:d.default().browser,userAgent:navigator.userAgent,clientVersionMajor:l.major||l[0]||"0",clientVersionMinor:l.minor||l[1]||"0",clientVersionPatch:l.patch||l[2]||"0",sdkName:o.default.name,sdkVersionMajor:u.major,sdkVersionMinor:u.minor,sdkVersionPatch:u.patch,devicePlatform:navigator.platform,deviceOs:h,setupOptions:s.options,isAudioDeviceMismatch:i.isAudioDeviceMismatch,noiseReduction:{enabled:null!==(a=s.enableNoiseReduction)&&void 0!==a&&a,noiseSuprressionStarted:s.noiseSuppresion.started},isAudioDeviceToggled:s.deviceToggledInCurrentSession,isNetworkChanged:s.networkChangeInCurrentSession,jsFramework:s.jsFramework};n&&(p.audioDeviceInfo=n),e.sendEvents.call(s,p,i)};e.sendCallRingingEvent=function(n,t,r,i){var a;const s=this;if(!s.callstatskey)return;const l=c.getClientVersion(),u=c.getSDKVersion(),h=c.getOS(),p={msg:"CALL_RINGING",signalling:t,mediaConnection:r,clientName:d.default().browser,userAgent:navigator.userAgent,clientVersionMajor:l.major||l[0]||"0",clientVersionMinor:l.minor||l[1]||"0",clientVersionPatch:l.patch||l[2]||"0",sdkName:o.default.name,sdkVersionMajor:u.major,sdkVersionMinor:u.minor,sdkVersionPatch:u.patch,devicePlatform:navigator.platform,deviceOs:h,setupOptions:s.options,isAudioDeviceMismatch:i.isAudioDeviceMismatch,noiseReduction:{enabled:null!==(a=s.enableNoiseReduction)&&void 0!==a&&a,noiseSuprressionStarted:s.noiseSuppresion.started},isAudioDeviceToggled:s.deviceToggledInCurrentSession,isNetworkChanged:s.networkChangeInCurrentSession,jsFramework:s.jsFramework};n&&(p.audioDeviceInfo=n),e.sendEvents.call(s,p,i)};e.sendFeedbackEvent=function(n,t){const r=this;if(n.callUUID&&r.callstatskey){const i={msg:"FEEDBACK",info:t};i.sdkVersion=o.default.version,e.sendEvents.call(r,i,n)}};e.signallingEvent=function(n){return u.SIP_ERROR_CODE[n]};e.onIceFailure=function(n,t){const r=this;if(n.callUUID&&r.callstatskey){const i={msg:"ICE_FAILURE",error:t.message};e.sendEvents.call(r,i,n)}};e.onMediaFailure=function(n,t){const r=this;if(n.callUUID&&r.callstatskey){const i={msg:"MEDIA_FAILURE",error:t.message};e.sendEvents.call(r,i,n)}};e.onSDPfailure=function(n,t){const r=this;if(n.callUUID&&r.callstatskey){const i={msg:"SDP_FAILURE",error:t.message};e.sendEvents.call(r,i,n)}};e.onToggleMute=function(n,t){const r=this;if(r.callstatskey){const i={msg:"TOGGLE_MUTE",action:t};e.sendEvents.call(r,i,n)}}},function(n,e,t){"use strict";var r=this&&this.__createBinding||(Object.create?function(n,e,t,r){void 0===r&&(r=t),Object.defineProperty(n,r,{enumerable:!0,get:function(){return e[t]}})}:function(n,e,t,r){void 0===r&&(r=t),n[r]=e[t]}),i=this&&this.__setModuleDefault||(Object.create?function(n,e){Object.defineProperty(n,"default",{enumerable:!0,value:e})}:function(n,e){n.default=e}),a=this&&this.__importStar||function(n){if(n&&n.__esModule)return n;var e={};if(null!=n)for(var t in n)"default"!==t&&Object.prototype.hasOwnProperty.call(n,t)&&r(e,n,t);return i(e,n),e};Object.defineProperty(e,"__esModule",{value:!0}),e.processStreams=e.emitMetrics=void 0;const s=t(0),o=a(t(1)),c={log:s.Logger};e.emitMetrics=function(n,e,t,r,i,a,s){const c=this;if(this.options.enableQualityTracking===o.DEFAULT_ENABLE_QUALITY_TRACKING&&this.options.enableTracking||this.options.enableQualityTracking===o.LOCALONLY){const o={group:n,level:e,type:t,value:r,active:i,desc:a||"",stream:s};c.emit("mediaMetrics",o)}};const l=function(n,t,r,i){const a=this,s=a.storage?a.storage[n]:[];if(2===s.length){s.push(Number(t));const l={};let u=null;s.forEach((n=>{l[n]=l[n]+1||1}));Object.keys(l).forEach((n=>{l[n]>=2&&(u=Number(n))})),"number"===typeof u&&a.storage?(a.storage.warning[n]=!0,u>1?c.log.debug(`Same audio level detected for ${n} : `,JSON.stringify(s)):c.log.debug(`${o.LOGCAT.CALL} | Audio mute detected for ${n} : `,JSON.stringify(s)),i&&"local_audio"===n||e.emitMetrics.call(a,"audio","warning","no_audio_received",u,!0,n,r)):a.storage&&a.storage.warning[n]&&(a.storage.warning[n]=!1,e.emitMetrics.call(a,"audio","warning","no_audio_received",0,!1,n,r))}else s.push(Number(t));3===s.length&&s.splice(0,2)},u=function(n,t){const r=Number(t),i=this,a=i.storage?i.storage[n]:[];if(2===a.length){a.push(r);const t=a.filter((n=>n>400));if(t.length>=2){const r=(t.reduce(((n,e)=>n+e))/t.length).toFixed(2);i.storage&&(i.storage.warning[n]=!0),c.log.debug(`${o.LOGCAT.CALL} | ${n} : getting high rtt  : `,JSON.stringify(t)),e.emitMetrics.call(i,"network","warning","high_rtt",r,!0,"high latency","None")}else i.storage&&i.storage.warning[n]&&(i.storage.warning[n]=!1,e.emitMetrics.call(i,"network","warning","high_rtt",0,!1,"high latency","None"))}else a.push(r);3===a.length&&a.splice(0,2)},d=function(n,t,r){const i=Number(t),a=this,s=a.storage?a.storage[n]:[];if(2===s.length){s.push(i);const t=s.filter((n=>n>30));if(t.length>=2){const i=t.reduce(((n,e)=>n+e))/t.length;a.storage&&(a.storage.warning[n]=!0),c.log.debug(`${o.LOGCAT.CALL} | ${n} : getting high jitter rate : `,JSON.stringify(t)),e.emitMetrics.call(a,"network","warning","high_jitter",i,!0,n,r)}else a.storage&&a.storage.warning[n]&&(a.storage.warning[n]=!1,e.emitMetrics.call(a,"network","warning","high_jitter",0,!1,n,r))}else s.push(i);3===s.length&&s.splice(0,2)},h=function(n,t){const r=this,i=r.storage?r.storage[n]:[];if(2===i.length){i.push(t);const a=i.filter((n=>n<3.5));a.length>=2?(r.storage&&(r.storage.warning[n]=!0),c.log.debug(`${o.LOGCAT.CALL} | ${n} : getting low mos : `,JSON.stringify(i)),e.emitMetrics.call(r,"network","warning","low_mos",a[0],!0,n,"None")):r.storage&&r.storage.warning[n]&&(r.storage.warning[n]=!1,e.emitMetrics.call(r,"network","warning","low_mos",0,!1,n,"None"))}else i.push(t);3===i.length&&i.splice(0,2)},p=function(n,t,r){const i=Number(t),a=this,s=a.storage?a.storage[n]:[];if(2===s.length){s.push(i);const t=s.filter((n=>a.storage&&"opus"===a.storage.audioCodec?n>=.1:n>=.02));if(t.length>=2){let i=t.reduce(((n,e)=>n+e))/t.length;i=parseFloat(i.toFixed(3)),a.storage&&(a.storage.warning[n]=!0),c.log.debug(`${o.LOGCAT.CALL} |\n        ${n} : packet loss value is high :`,JSON.stringify(t)),e.emitMetrics.call(a,"network","warning","high_packetloss",i,!0,n,r)}else a.storage&&a.storage.warning[n]&&(a.storage.warning[n]=!1,e.emitMetrics.call(a,"network","warning","high_packetloss",0,!1,n,r))}else s.push(i);3===s.length&&s.splice(0,2)};e.processStreams=function(n,e){const t=this;t.storage&&t.storage.startAnalysis&&(n.local&&(u.call(t,"rtt",n.local.rtt),d.call(t,"jitterLocalMeasures",n.local.jitter,"local"),h.call(t,"mosRemoteMeasures",n.local.mos),p.call(t,"packetLossLocalMeasures",n.local.fractionLoss,"local"),l.call(t,"local_audio",n.local.audioLevel,"local",e)),n.remote&&(d.call(t,"jitterRemoteMeasures",n.remote.jitter,"remote"),p.call(t,"packetLossRemoteMeasures",n.remote.fractionLoss,"remote"),l.call(t,"remote_audio",n.remote.audioLevel,"remote",e)))}},function(n,e,t){"use strict";var r={generateIdentifier:function(){return Math.random().toString(36).substr(2,10)}};r.localCName=r.generateIdentifier(),r.splitLines=function(n){return n.trim().split("\n").map((function(n){return n.trim()}))},r.splitSections=function(n){return n.split("\nm=").map((function(n,e){return(e>0?"m="+n:n).trim()+"\r\n"}))},r.getDescription=function(n){var e=r.splitSections(n);return e&&e[0]},r.getMediaSections=function(n){var e=r.splitSections(n);return e.shift(),e},r.matchPrefix=function(n,e){return r.splitLines(n).filter((function(n){return 0===n.indexOf(e)}))},r.parseCandidate=function(n){for(var e,t={foundation:(e=0===n.indexOf("a=candidate:")?n.substring(12).split(" "):n.substring(10).split(" "))[0],component:parseInt(e[1],10),protocol:e[2].toLowerCase(),priority:parseInt(e[3],10),ip:e[4],address:e[4],port:parseInt(e[5],10),type:e[7]},r=8;r<e.length;r+=2)switch(e[r]){case"raddr":t.relatedAddress=e[r+1];break;case"rport":t.relatedPort=parseInt(e[r+1],10);break;case"tcptype":t.tcpType=e[r+1];break;case"ufrag":t.ufrag=e[r+1],t.usernameFragment=e[r+1];break;default:t[e[r]]=e[r+1]}return t},r.writeCandidate=function(n){var e=[];e.push(n.foundation),e.push(n.component),e.push(n.protocol.toUpperCase()),e.push(n.priority),e.push(n.address||n.ip),e.push(n.port);var t=n.type;return e.push("typ"),e.push(t),"host"!==t&&n.relatedAddress&&n.relatedPort&&(e.push("raddr"),e.push(n.relatedAddress),e.push("rport"),e.push(n.relatedPort)),n.tcpType&&"tcp"===n.protocol.toLowerCase()&&(e.push("tcptype"),e.push(n.tcpType)),(n.usernameFragment||n.ufrag)&&(e.push("ufrag"),e.push(n.usernameFragment||n.ufrag)),"candidate:"+e.join(" ")},r.parseIceOptions=function(n){return n.substr(14).split(" ")},r.parseRtpMap=function(n){var e=n.substr(9).split(" "),t={payloadType:parseInt(e.shift(),10)};return e=e[0].split("/"),t.name=e[0],t.clockRate=parseInt(e[1],10),t.channels=3===e.length?parseInt(e[2],10):1,t.numChannels=t.channels,t},r.writeRtpMap=function(n){var e=n.payloadType;void 0!==n.preferredPayloadType&&(e=n.preferredPayloadType);var t=n.channels||n.numChannels||1;return"a=rtpmap:"+e+" "+n.name+"/"+n.clockRate+(1!==t?"/"+t:"")+"\r\n"},r.parseExtmap=function(n){var e=n.substr(9).split(" ");return{id:parseInt(e[0],10),direction:e[0].indexOf("/")>0?e[0].split("/")[1]:"sendrecv",uri:e[1]}},r.writeExtmap=function(n){return"a=extmap:"+(n.id||n.preferredId)+(n.direction&&"sendrecv"!==n.direction?"/"+n.direction:"")+" "+n.uri+"\r\n"},r.parseFmtp=function(n){for(var e,t={},r=n.substr(n.indexOf(" ")+1).split(";"),i=0;i<r.length;i++)t[(e=r[i].trim().split("="))[0].trim()]=e[1];return t},r.writeFmtp=function(n){var e="",t=n.payloadType;if(void 0!==n.preferredPayloadType&&(t=n.preferredPayloadType),n.parameters&&Object.keys(n.parameters).length){var r=[];Object.keys(n.parameters).forEach((function(e){n.parameters[e]?r.push(e+"="+n.parameters[e]):r.push(e)})),e+="a=fmtp:"+t+" "+r.join(";")+"\r\n"}return e},r.parseRtcpFb=function(n){var e=n.substr(n.indexOf(" ")+1).split(" ");return{type:e.shift(),parameter:e.join(" ")}},r.writeRtcpFb=function(n){var e="",t=n.payloadType;return void 0!==n.preferredPayloadType&&(t=n.preferredPayloadType),n.rtcpFeedback&&n.rtcpFeedback.length&&n.rtcpFeedback.forEach((function(n){e+="a=rtcp-fb:"+t+" "+n.type+(n.parameter&&n.parameter.length?" "+n.parameter:"")+"\r\n"})),e},r.parseSsrcMedia=function(n){var e=n.indexOf(" "),t={ssrc:parseInt(n.substr(7,e-7),10)},r=n.indexOf(":",e);return r>-1?(t.attribute=n.substr(e+1,r-e-1),t.value=n.substr(r+1)):t.attribute=n.substr(e+1),t},r.parseSsrcGroup=function(n){var e=n.substr(13).split(" ");return{semantics:e.shift(),ssrcs:e.map((function(n){return parseInt(n,10)}))}},r.getMid=function(n){var e=r.matchPrefix(n,"a=mid:")[0];if(e)return e.substr(6)},r.parseFingerprint=function(n){var e=n.substr(14).split(" ");return{algorithm:e[0].toLowerCase(),value:e[1]}},r.getDtlsParameters=function(n,e){return{role:"auto",fingerprints:r.matchPrefix(n+e,"a=fingerprint:").map(r.parseFingerprint)}},r.writeDtlsParameters=function(n,e){var t="a=setup:"+e+"\r\n";return n.fingerprints.forEach((function(n){t+="a=fingerprint:"+n.algorithm+" "+n.value+"\r\n"})),t},r.parseCryptoLine=function(n){var e=n.substr(9).split(" ");return{tag:parseInt(e[0],10),cryptoSuite:e[1],keyParams:e[2],sessionParams:e.slice(3)}},r.writeCryptoLine=function(n){return"a=crypto:"+n.tag+" "+n.cryptoSuite+" "+("object"===typeof n.keyParams?r.writeCryptoKeyParams(n.keyParams):n.keyParams)+(n.sessionParams?" "+n.sessionParams.join(" "):"")+"\r\n"},r.parseCryptoKeyParams=function(n){if(0!==n.indexOf("inline:"))return null;var e=n.substr(7).split("|");return{keyMethod:"inline",keySalt:e[0],lifeTime:e[1],mkiValue:e[2]?e[2].split(":")[0]:void 0,mkiLength:e[2]?e[2].split(":")[1]:void 0}},r.writeCryptoKeyParams=function(n){return n.keyMethod+":"+n.keySalt+(n.lifeTime?"|"+n.lifeTime:"")+(n.mkiValue&&n.mkiLength?"|"+n.mkiValue+":"+n.mkiLength:"")},r.getCryptoParameters=function(n,e){return r.matchPrefix(n+e,"a=crypto:").map(r.parseCryptoLine)},r.getIceParameters=function(n,e){var t=r.matchPrefix(n+e,"a=ice-ufrag:")[0],i=r.matchPrefix(n+e,"a=ice-pwd:")[0];return t&&i?{usernameFragment:t.substr(12),password:i.substr(10)}:null},r.writeIceParameters=function(n){return"a=ice-ufrag:"+n.usernameFragment+"\r\na=ice-pwd:"+n.password+"\r\n"},r.parseRtpParameters=function(n){for(var e={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},t=r.splitLines(n)[0].split(" "),i=3;i<t.length;i++){var a=t[i],s=r.matchPrefix(n,"a=rtpmap:"+a+" ")[0];if(s){var o=r.parseRtpMap(s),c=r.matchPrefix(n,"a=fmtp:"+a+" ");switch(o.parameters=c.length?r.parseFmtp(c[0]):{},o.rtcpFeedback=r.matchPrefix(n,"a=rtcp-fb:"+a+" ").map(r.parseRtcpFb),e.codecs.push(o),o.name.toUpperCase()){case"RED":case"ULPFEC":e.fecMechanisms.push(o.name.toUpperCase())}}}return r.matchPrefix(n,"a=extmap:").forEach((function(n){e.headerExtensions.push(r.parseExtmap(n))})),e},r.writeRtpDescription=function(n,e){var t="";t+="m="+n+" ",t+=e.codecs.length>0?"9":"0",t+=" UDP/TLS/RTP/SAVPF ",t+=e.codecs.map((function(n){return void 0!==n.preferredPayloadType?n.preferredPayloadType:n.payloadType})).join(" ")+"\r\n",t+="c=IN IP4 0.0.0.0\r\n",t+="a=rtcp:9 IN IP4 0.0.0.0\r\n",e.codecs.forEach((function(n){t+=r.writeRtpMap(n),t+=r.writeFmtp(n),t+=r.writeRtcpFb(n)}));var i=0;return e.codecs.forEach((function(n){n.maxptime>i&&(i=n.maxptime)})),i>0&&(t+="a=maxptime:"+i+"\r\n"),t+="a=rtcp-mux\r\n",e.headerExtensions&&e.headerExtensions.forEach((function(n){t+=r.writeExtmap(n)})),t},r.parseRtpEncodingParameters=function(n){var e,t=[],i=r.parseRtpParameters(n),a=-1!==i.fecMechanisms.indexOf("RED"),s=-1!==i.fecMechanisms.indexOf("ULPFEC"),o=r.matchPrefix(n,"a=ssrc:").map((function(n){return r.parseSsrcMedia(n)})).filter((function(n){return"cname"===n.attribute})),c=o.length>0&&o[0].ssrc,l=r.matchPrefix(n,"a=ssrc-group:FID").map((function(n){return n.substr(17).split(" ").map((function(n){return parseInt(n,10)}))}));l.length>0&&l[0].length>1&&l[0][0]===c&&(e=l[0][1]),i.codecs.forEach((function(n){if("RTX"===n.name.toUpperCase()&&n.parameters.apt){var r={ssrc:c,codecPayloadType:parseInt(n.parameters.apt,10)};c&&e&&(r.rtx={ssrc:e}),t.push(r),a&&((r=JSON.parse(JSON.stringify(r))).fec={ssrc:c,mechanism:s?"red+ulpfec":"red"},t.push(r))}})),0===t.length&&c&&t.push({ssrc:c});var u=r.matchPrefix(n,"b=");return u.length&&(u=0===u[0].indexOf("b=TIAS:")?parseInt(u[0].substr(7),10):0===u[0].indexOf("b=AS:")?1e3*parseInt(u[0].substr(5),10)*.95-16e3:void 0,t.forEach((function(n){n.maxBitrate=u}))),t},r.parseRtcpParameters=function(n){var e={},t=r.matchPrefix(n,"a=ssrc:").map((function(n){return r.parseSsrcMedia(n)})).filter((function(n){return"cname"===n.attribute}))[0];t&&(e.cname=t.value,e.ssrc=t.ssrc);var i=r.matchPrefix(n,"a=rtcp-rsize");e.reducedSize=i.length>0,e.compound=0===i.length;var a=r.matchPrefix(n,"a=rtcp-mux");return e.mux=a.length>0,e},r.parseMsid=function(n){var e,t=r.matchPrefix(n,"a=msid:");if(1===t.length)return{stream:(e=t[0].substr(7).split(" "))[0],track:e[1]};var i=r.matchPrefix(n,"a=ssrc:").map((function(n){return r.parseSsrcMedia(n)})).filter((function(n){return"msid"===n.attribute}));return i.length>0?{stream:(e=i[0].value.split(" "))[0],track:e[1]}:void 0},r.parseSctpDescription=function(n){var e,t=r.parseMLine(n),i=r.matchPrefix(n,"a=max-message-size:");i.length>0&&(e=parseInt(i[0].substr(19),10)),isNaN(e)&&(e=65536);var a=r.matchPrefix(n,"a=sctp-port:");if(a.length>0)return{port:parseInt(a[0].substr(12),10),protocol:t.fmt,maxMessageSize:e};if(r.matchPrefix(n,"a=sctpmap:").length>0){var s=r.matchPrefix(n,"a=sctpmap:")[0].substr(10).split(" ");return{port:parseInt(s[0],10),protocol:s[1],maxMessageSize:e}}},r.writeSctpDescription=function(n,e){var t=[];return t="DTLS/SCTP"!==n.protocol?["m="+n.kind+" 9 "+n.protocol+" "+e.protocol+"\r\n","c=IN IP4 0.0.0.0\r\n","a=sctp-port:"+e.port+"\r\n"]:["m="+n.kind+" 9 "+n.protocol+" "+e.port+"\r\n","c=IN IP4 0.0.0.0\r\n","a=sctpmap:"+e.port+" "+e.protocol+" 65535\r\n"],void 0!==e.maxMessageSize&&t.push("a=max-message-size:"+e.maxMessageSize+"\r\n"),t.join("")},r.generateSessionId=function(){return Math.random().toString().substr(2,21)},r.writeSessionBoilerplate=function(n,e,t){var i=void 0!==e?e:2;return"v=0\r\no="+(t||"thisisadapterortc")+" "+(n||r.generateSessionId())+" "+i+" IN IP4 127.0.0.1\r\ns=-\r\nt=0 0\r\n"},r.writeMediaSection=function(n,e,t,i){var a=r.writeRtpDescription(n.kind,e);if(a+=r.writeIceParameters(n.iceGatherer.getLocalParameters()),a+=r.writeDtlsParameters(n.dtlsTransport.getLocalParameters(),"offer"===t?"actpass":"active"),a+="a=mid:"+n.mid+"\r\n",n.direction?a+="a="+n.direction+"\r\n":n.rtpSender&&n.rtpReceiver?a+="a=sendrecv\r\n":n.rtpSender?a+="a=sendonly\r\n":n.rtpReceiver?a+="a=recvonly\r\n":a+="a=inactive\r\n",n.rtpSender){var s="msid:"+i.id+" "+n.rtpSender.track.id+"\r\n";a+="a="+s,a+="a=ssrc:"+n.sendEncodingParameters[0].ssrc+" "+s,n.sendEncodingParameters[0].rtx&&(a+="a=ssrc:"+n.sendEncodingParameters[0].rtx.ssrc+" "+s,a+="a=ssrc-group:FID "+n.sendEncodingParameters[0].ssrc+" "+n.sendEncodingParameters[0].rtx.ssrc+"\r\n")}return a+="a=ssrc:"+n.sendEncodingParameters[0].ssrc+" cname:"+r.localCName+"\r\n",n.rtpSender&&n.sendEncodingParameters[0].rtx&&(a+="a=ssrc:"+n.sendEncodingParameters[0].rtx.ssrc+" cname:"+r.localCName+"\r\n"),a},r.getDirection=function(n,e){for(var t=r.splitLines(n),i=0;i<t.length;i++)switch(t[i]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return t[i].substr(2)}return e?r.getDirection(e):"sendrecv"},r.getKind=function(n){return r.splitLines(n)[0].split(" ")[0].substr(2)},r.isRejected=function(n){return"0"===n.split(" ",2)[1]},r.parseMLine=function(n){var e=r.splitLines(n)[0].substr(2).split(" ");return{kind:e[0],port:parseInt(e[1],10),protocol:e[2],fmt:e.slice(3).join(" ")}},r.parseOLine=function(n){var e=r.matchPrefix(n,"o=")[0].substr(2).split(" ");return{username:e[0],sessionId:e[1],sessionVersion:parseInt(e[2],10),netType:e[3],addressType:e[4],address:e[5]}},r.isValidSDP=function(n){if("string"!==typeof n||0===n.length)return!1;for(var e=r.splitLines(n),t=0;t<e.length;t++)if(e[t].length<2||"="!==e[t].charAt(1))return!1;return!0},n.exports=r},function(n,e,t){"use strict";(function(n){var r=this&&this.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(e,"__esModule",{value:!0}),e.detectDeviceChange=e.audioDevDicSetter=e.updateAudioDeviceFlags=e.unmute=e.ringtoneDevices=e.outputDevices=e.inputDevices=e.checkAudioDevChange=e.setAudioDeviceForForWindows=e.updateWindowDeviceList=e.getAudioDevicesInfo=e.matchDevices=e.isElectronApp=e.audioDevDictionary=e.replaceStream=e.stopVolumeDataStreaming=e.startVolumeDataStreaming=e.resetMuteOnHangup=e.mute=e.speechListeners=e.revealAudioDevices=e.availableDevices=e.setAudioContraints=void 0;const i=t(1),a=r(t(35)),s=t(0),o=t(3),c=r(t(2)),l=t(4),u=t(16),d={log:s.Logger,audioConstraints:{}};let h,p,f,g=null,m=null,b=!1;let v,y=!1;const _=a.default();let C=[];const S={},T={};let E=null;const w={},k={},R=navigator.userAgent.search("Safari")>=0&&navigator.userAgent.search("Chrome")<0,I="Win32"===navigator.platform||"Win16"===navigator.platform||navigator.platform.toString().toLocaleLowerCase().includes("win");e.setAudioContraints=function(n){g=n,d.audioConstraints=g.audioConstraints};const A=function(n){n.forEach((n=>{"audioinput"===n.kind&&(S[n.deviceId]=n.groupId,T[n.groupId]=n.deviceId)}))};e.availableDevices=function(n){return new Promise(((e,t)=>{navigator.mediaDevices.enumerateDevices().then((t=>{const r=[];t.forEach((e=>{"input"===n?"audioinput"===e.kind&&"communications"!==e.deviceId&&r.push(e):"output"===n?"audiooutput"===e.kind&&"communications"!==e.deviceId&&r.push(e):/video/i.test(e.kind)||"communications"!==e.deviceId&&r.push(e)})),e(r)})).catch((n=>{t(n)}))}))};e.revealAudioDevices=function(n){return new Promise(((e,t)=>{navigator.mediaDevices.getUserMedia?navigator.mediaDevices.getUserMedia({audio:!0,video:!1}).then((t=>{"returnStream"===n?e(t):(t.getTracks().forEach((n=>{n.stop()})),e("success"))})).catch((n=>{d.log.error(`${i.LOGCAT.CALL} | Failed to get user media during init ${n.message}`),t(n.name)})):t("no getUserMedia support")}))};e.speechListeners=function(){var n;if(this._currentSession.state!==this._currentSession.STATE.ANSWERED)return;const e=this;e.speechRecognition.stop(),e.speechRecognition.continuous=!0,e.speechRecognition.interimResults=!0,e.speechRecognition.onerror=n=>{var t;d.log.error(`${i.LOGCAT.CALL} | Error in Recognizing speech :`,n.error),"network"===n.error&&(null===(t=e._currentSession)||void 0===t||t.setSpeechState(e._currentSession.SPEECH_STATE.STOPPED_DUE_TO_NETWORK_ERROR),d.log.info(`${i.LOGCAT.CALL} | Speech Recognition stopped due to network disruption`))},e.speechRecognition.onend=()=>{var n,t,r,a,s,o,c;d.log.info(`${i.LOGCAT.CALL} | Recognizing speech Stopped`),e.isMuteCalled&&(null===(n=e._currentSession)||void 0===n?void 0:n.speech_state)!==(null===(t=e._currentSession)||void 0===t?void 0:t.SPEECH_STATE.STOPPED_AFTER_DETECTION)&&(null===(r=e._currentSession)||void 0===r?void 0:r.speech_state)!==(null===(a=e._currentSession)||void 0===a?void 0:a.SPEECH_STATE.STOPPED_DUE_TO_NETWORK_ERROR)?(null===(s=e._currentSession)||void 0===s||s.setSpeechState(e._currentSession.SPEECH_STATE.STOPPED),null===(o=e._currentSession)||void 0===o||o.startSpeechRecognition(e)):null===(c=e._currentSession)||void 0===c||c.setSpeechState(e._currentSession.SPEECH_STATE.STOPPED)},e.speechRecognition.onstart=()=>{var n,t,r,a,s,o;d.log.info(`${i.LOGCAT.CALL} | Recognizing speech Running`),e.isMuteCalled||(null===(n=e._currentSession)||void 0===n?void 0:n.speech_state)===(null===(t=e._currentSession)||void 0===t?void 0:t.SPEECH_STATE.STOPPED)&&(null===(r=e._currentSession)||void 0===r?void 0:r.speech_state)===(null===(a=e._currentSession)||void 0===a?void 0:a.SPEECH_STATE.STOPPING)?null===(o=e._currentSession)||void 0===o||o.setSpeechState(e._currentSession.SPEECH_STATE.RUNNING):null===(s=e._currentSession)||void 0===s||s.stopSpeechRecognition(e)},e.speechRecognition.onresult=()=>{var n;l.emitMetrics.call(this,"audio","warning","speaking_on_mute",0,!0,"User is trying to speak on mute",""),null===(n=e._currentSession)||void 0===n||n.setSpeechState(e._currentSession.SPEECH_STATE.STOPPED_AFTER_DETECTION),e.speechRecognition.stop(),d.log.info(`${i.LOGCAT.CALL} | User speaking on mute`)},null===(n=e._currentSession)||void 0===n||n.setSpeechState(e._currentSession.SPEECH_STATE.STARTING),e.speechRecognition.start()};e.mute=function(){var n;d.log.debug(`${i.LOGCAT.CALL} | call is now muted`);const e=this;null===(n=this._currentSession)||void 0===n||n.startSpeechRecognition(e),m?m.getAudioTracks()[0].enabled=!1:this._currentSession.session.mute(),e.noiseSuppresion&&e.noiseSuppresion.muteStream(),h=!1};e.resetMuteOnHangup=function(){h=!0};e.startVolumeDataStreaming=function(n){if(n._currentSession){const e=n._currentSession.session.connection;let t=null;const r=e.getRemoteStreams()[0];if(m?(t=m,setTimeout((()=>{n._currentSession&&_.start(n,t,r)}),3e3)):(t=e.getLocalStreams()[0],_.start(n,t,r)),R&&t&&!1===t.active){const n=Object.keys(w)[0],e=w[n];g&&g.audio.microphoneDevices.set(e)}}};e.stopVolumeDataStreaming=function(){setTimeout((()=>{d.log.debug(`${i.LOGCAT.CALL} | stopping the emission of audio level`),window._localContext&&window._localContext.suspend(),_&&_.stop()}),3e3)};e.replaceStream=function(n,t){return new Promise(((r,a)=>{const s=n._currentSession?n._currentSession.session.connection:null;s?navigator&&navigator.mediaDevices&&navigator.mediaDevices.getUserMedia?navigator.mediaDevices.getUserMedia(t).then((t=>{d.log.debug(`${i.LOGCAT.CALL_QUALITY} | Got new stream while replacing stream`);let r=null;r=s.getSenders()[0],m&&(d.log.debug(`${i.LOGCAT.CALL_QUALITY} | Stopping current local stream in replacing stream`),m.getTracks().forEach((n=>n.stop())),m=null),r&&(d.log.debug("replaced sender : ",r),n.noiseSuppresion.updateProcessingStream(t).then((a=>{null!=a&&(t=a),m=t,!1===h&&(d.log.debug(`${i.LOGCAT.CALL_QUALITY} | call was muted before replacing stream. Muting new stream`),function(n){e.mute.call(n)}(n)),n._currentSession&&n._currentSession.stats&&(n._currentSession.stats.senderMediaStream=t,n._currentSession.stats.localAudioLevelHelper=new u.AudioLevel(n._currentSession.stats.senderMediaStream)),d.log.debug(`${i.LOGCAT.CALL_QUALITY} | replacing track`),r.replaceTrack(t.getAudioTracks()[0]).catch((()=>{d.log.debug(`${i.LOGCAT.CALL_QUALITY} | error in replacing track`);const n=null===g||void 0===g?void 0:g.getPeerConnection().pc;n&&(r=n.getSenders()[0],r&&r.replaceTrack(t.getAudioTracks()[0]).catch((()=>{})))}))})))})).catch((n=>{d.log.debug(`${i.LOGCAT.CALL_QUALITY} | error in replacing stream ${n}`),a(n)})).then((()=>{e.stopVolumeDataStreaming()})).then((()=>{e.startVolumeDataStreaming(n),r()})).catch((n=>{d.log.debug(`${i.LOGCAT.CALL_QUALITY} | main error in replacing stream ${n}`),a(n)})):(d.log.debug(`${i.LOGCAT.CALL_QUALITY} | No getUserMedia support in replaceStream`),a(new Error("No getUserMedia support"))):(d.log.debug(`${i.LOGCAT.CALL_QUALITY} | session is not active while replacing stream`),r())}))};const O=function(n,t,r,a){d.log.debug(`${i.LOGCAT.CALL_QUALITY} |inside replacetrack with device id  : ${n}`);const s=function(n,e,t){if("added"===n)return"object"===typeof d.audioConstraints&&"optional"in d.audioConstraints?(d.audioConstraints.optional.forEach((n=>{Object.entries(n).forEach((([n,e])=>{d.audioConstraints&&(n=n.replace(/goog(.)/i,((n,e)=>e.toLowerCase())),d.audioConstraints[n]=e)}))})),d.audioConstraints.deviceId={exact:e},delete d.audioConstraints.optional,A(C)):"boolean"===typeof d.audioConstraints?d.audioConstraints={deviceId:{exact:e}}:d.audioConstraints.deviceId={exact:e},{audio:d.audioConstraints,video:!1};let r=null;if(R){const n=w[t];r={deviceId:n?{exact:n}:void 0}}else r=!0;return{audio:r,video:!1}}(r,n,a);t._currentSession?e.replaceStream(t,s):m?m.getTracks().forEach((n=>n.stop())):t.permOnClick||window.localStream&&(window.localStream.getTracks().forEach((n=>{n.stop(),window.localStream.removeTrack(n)})),window.localStream=null)};e.audioDevDictionary=function(n){return new Promise(((t,r)=>{e.availableDevices().then((e=>{let r=[],i=!1;e.forEach((n=>{if(n.label){const e=JSON.stringify(n);r.push(e),i=!0}else r=[]})),n?(i&&(C=e),E&&E(r),t(!0)):t({devices:e,audioRef:r})})).catch((n=>{d.log.error("Error availableDevices() ",n),r(n)}))}))};e.isElectronApp=function(){return"undefined"!==typeof window&&"object"===typeof window.process&&"renderer"===window.process.type||(!("undefined"===typeof n||"object"!==typeof n.versions||!n.versions.electron)||"object"===typeof navigator&&"string"===typeof navigator.userAgent&&navigator.userAgent.indexOf("Electron")>=0)};e.matchDevices=function(n,e,t,r){return n===e||(d.log.debug(`${i.LOGCAT.CALL} | Input and output group IDs mismatch found inputGroupId: ${n}, outputGroupId: ${e}`),d.log.debug(`${i.LOGCAT.CALL} | Checking if the active input and output devices are same, activeInputDevice: ${t}, activeOutputDevice: ${r}`),t===r||((n,e)=>{const t=null===n||void 0===n?void 0:n.match(/\(([^)]+)\)/);return t&&e.includes(t[1])})(t,r))};e.getAudioDevicesInfo=function(){return navigator.mediaDevices.enumerateDevices().then((n=>{const e=new Map,t=new Map,r=new Map,i=new Map,a={noOfAudioInput:0,noOfAudioOutput:0,audioInputLables:"",audioOutputLables:"",audioInputGroupIds:"",audioOutputGroupIds:"",audioInputIdSet:this.audio.microphoneDevices.get()||"",audioOutputIdSet:this.audio.speakerDevices.get()||"",activeInputAudioDevice:"",activeOutputAudioDevice:"",activeInputDeviceGroupId:"",activeOutputDeviceGroupId:""};let s=null;return n.forEach((n=>{"default"===n.deviceId&&"audioinput"===n.kind?n.defaultInputDeviceGroupId=n.groupId:"default"===n.deviceId&&"audiooutput"===n.kind&&(n.defaultOutputDeviceGroupId=n.groupId),"audioinput"===n.kind?(e.set(n.deviceId,n.label),r.set(n.label,n.groupId),a.noOfAudioInput+=1,1===a.noOfAudioInput&&(s=n.label),a.audioInputLables+=`${n.label} ,`,a.audioInputGroupIds+=`${n.groupId} ,`):"audiooutput"===n.kind&&(t.set(n.deviceId,n.label),i.set(n.label,n.groupId),a.noOfAudioOutput+=1,a.audioOutputLables+=`${n.label} ,`,a.audioOutputGroupIds+=`${n.groupId} ,`)})),""===a.audioInputIdSet?(a.activeInputAudioDevice=e.get("default"),"safari"===c.default().browser&&(a.activeInputAudioDevice=s)):a.activeInputAudioDevice=e.get(a.audioInputIdSet),""===a.audioOutputIdSet?a.activeOutputAudioDevice=t.get("default"):a.activeOutputAudioDevice=t.get(a.audioOutputIdSet),a.activeInputDeviceGroupId=r.get(a.activeInputAudioDevice),a.activeOutputDeviceGroupId=i.get(a.activeOutputAudioDevice),a}))};e.updateWindowDeviceList=function(n){const e={};n.forEach((n=>{"audioinput"===n.kind&&"default"===n.deviceId&&(p=n.groupId),"audiooutput"===n.kind&&("default"===n.deviceId&&(f=n.groupId),e[n.groupId]=n.deviceId)})),p!==f&&(y=!0,e[p]&&(null===g||void 0===g||g.audio.speakerDevices.set(e[p]),b=!0,d.log.debug(`Updated the windows audio device with id ${e[p]}`)))};e.setAudioDeviceForForWindows=function(n,t,r){""!==t&&"default"!==t||null!==r&&"default"!==r&&!b||(C=n,e.updateWindowDeviceList(n))};e.checkAudioDevChange=function(){const n=this,t="undefined"!==typeof window.InstallTrigger,r=g?g.audio.speakerDevices.get():"",a=g?g.audio.microphoneDevices.get():"";e.audioDevDictionary().then((e=>{const{devices:s,audioRef:o}=e;return C&&s&&(s.forEach((e=>{w[e.label]=e.deviceId,k[e.deviceId]=e.label,C.filter((n=>n.deviceId===e.deviceId)).length||/default/i.test(e.deviceId)||(n.emit("audioDeviceChange",{change:"added",device:e}),v=e.label,"audioinput"===e.kind?(d.log.info(`${i.LOGCAT.CALL_QUALITY} Audio input device added:- `,JSON.stringify(e)),setTimeout((()=>{n&&(t||R)?(d.log.debug(`${i.LOGCAT.CALL_QUALITY} Setting mic to ${e.deviceId} in firefox/safari`),n.audio.microphoneDevices.set(e.deviceId)):n&&(d.log.debug(`${i.LOGCAT.CALL_QUALITY} Setting mic to ${I&&!n.options.useDefaultAudioDevice?e.deviceId:"default"} `),n.audio.microphoneDevices.set(I&&!n.options.useDefaultAudioDevice?e.deviceId:"default"))}),200)):n&&"audiooutput"===e.kind&&(d.log.info(`${i.LOGCAT.CALL_QUALITY} Audio output device added:- `,JSON.stringify(e)),setTimeout((()=>{n&&t?(n.audio.speakerDevices.set(e.deviceId),d.log.debug(`${i.LOGCAT.CALL_QUALITY} Setting speaker to ${e.deviceId} in firefox`)):!n||R||t||(d.log.debug(`${i.LOGCAT.CALL_QUALITY} Setting speaker to ${I&&!n.options.useDefaultAudioDevice?e.deviceId:"default"} `),n.audio.speakerDevices.set(I&&!n.options.useDefaultAudioDevice?e.deviceId:"default"))}),200)))})),C.forEach((e=>{s.filter((n=>n.deviceId===e.deviceId)).length||/default/i.test(e.deviceId)||(n.emit("audioDeviceChange",{change:"removed",device:e}),void 0!==w[e.label]&&(delete w[e.label],delete k[e.deviceId]),"audioinput"===e.kind&&(d.log.info(`${i.LOGCAT.CALL_QUALITY} Audio input device removed:- `,JSON.stringify(e)),d.log.debug(`${i.LOGCAT.CALL_QUALITY} Setting microphone to default`),setTimeout((()=>{n&&(t||R)?(d.log.debug(`${i.LOGCAT.CALL_QUALITY} Setting microphone to ${C[0].deviceId} in firefox/safari`),n.audio.microphoneDevices.set(C[0].deviceId)):n&&(d.log.debug(`${i.LOGCAT.CALL_QUALITY} Setting microphone to default`),n.audio.microphoneDevices.set("default"))}),200)),"audiooutput"===e.kind&&(d.log.info(`${i.LOGCAT.CALL_QUALITY} Audio output device removed:- `,JSON.stringify(e)),setTimeout((()=>{n&&t?C.every((e=>"audiooutput"!==e.kind||(d.log.debug(`${i.LOGCAT.CALL_QUALITY} Setting output to default ${e.deviceId} in firefox`),n&&n.audio.speakerDevices.set(e.deviceId),!1))):!n||R||t||(d.log.debug(`${i.LOGCAT.CALL_QUALITY} Setting output to default`),n.audio.speakerDevices.set("default"))}),200)))}))),C||n.emit("audioDeviceChange",{change:"",device:""}),s&&(C=s,E&&E(o)),[s,v,r,a]})).then((()=>{y=!1})).catch((n=>{d.log.error("Error checkAudioDevChange() ",n)}))},e.inputDevices={set(n){if("string"!==typeof n)return d.log.error("Device id should be string"),!1;const t=C.filter((e=>e.deviceId===n&&"audioinput"===e.kind));if(!t.length)return d.log.error("Invalid input device id"),!1;if(A(C),g){if("default"===n){const e=S[n];n=T[e],O(n,g,"added",k[n])}else O(n,g,"added",k[n]);setTimeout((()=>{e.getAudioDevicesInfo.call(g).then((n=>{e.matchDevices(n.activeInputDeviceGroupId,n.activeOutputDeviceGroupId,n.activeInputAudioDevice,n.activeOutputAudioDevice)||d.log.debug(`${i.LOGCAT.CALL} | Input and output device mismatch while adding new input device${JSON.stringify(n)}`);const r=g;if(null!==r&&r._currentSession){d.log.info(`${i.LOGCAT.CALL} | Audio device toggled to`,JSON.stringify(t));const e={msg:"AUDIO_DEVICES_TOGGLE",deviceInfo:n};o.sendEvents.call(g,e,r._currentSession),r.deviceToggledInCurrentSession=!0}}))}),1e3)}return!0},get(){if(d.audioConstraints.optional){const n=d.audioConstraints.optional.filter((n=>n.sourceId));return n.length>0?n[0].sourceId:""}if(d.audioConstraints&&d.audioConstraints.deviceId){if("object"!==typeof d.audioConstraints.deviceId||null===d.audioConstraints.deviceId)return d.audioConstraints.deviceId;if("exact"in d.audioConstraints.deviceId)return d.audioConstraints.deviceId.exact;if("ideal"in d.audioConstraints.deviceId)return d.audioConstraints.deviceId.ideal;d.log.error("Invalid audio constraints",d.audioConstraints.deviceId)}return""},reset:()=>(d.audioConstraints.optional?d.audioConstraints.optional=d.audioConstraints.optional.filter((n=>!n.sourceId)):d.audioConstraints&&d.audioConstraints.deviceId&&delete d.audioConstraints.deviceId,!0)},e.outputDevices={set(n){const t=C.filter((e=>e.deviceId===n&&"audiooutput"===e.kind));if(!t.length)return d.log.error("Invalid output device id"),!1;const r=document.querySelectorAll('[data-devicetype="speakerDevice"]'),a=[];return r.forEach((e=>{if(e&&"undefined"!==typeof e.sinkId){const t=e=>new Promise((t=>{e.setSinkId(n).then((()=>{t("success")})).catch((r=>{if(r.code===i.AUDIO_DEVICE_ABORT_ERROR_CODE)e.src="",e.setSinkId(n).then((()=>{t("success")})).catch((n=>{d.log.error(n.message),t("Fail")}));else{let n=r.message;r.name===i.AUDIO_DEVICE_SECURITY_ERROR&&(n=`You need to use HTTPS for selecting audio output device: ${r}`),d.log.error(n),t("errorMessage")}return t("Fail"),!1}))}));a.push(t(e))}else d.log.warn(`${i.LOGCAT.CALL} | Browser does not support output device selection.`)})),Promise.all(a).then((()=>{setTimeout((()=>{e.getAudioDevicesInfo.call(g).then((n=>{const r=g;if(e.matchDevices(n.activeInputDeviceGroupId,n.activeOutputDeviceGroupId,n.activeInputAudioDevice,n.activeOutputAudioDevice)||d.log.debug(`${i.LOGCAT.CALL} | Input and output device mismatch while adding new output device${JSON.stringify(n)}`),null!==r&&r._currentSession){d.log.info(`${i.LOGCAT.CALL} Audio device toggled to`,JSON.stringify(t));const e={msg:"AUDIO_DEVICES_TOGGLE",deviceInfo:n};o.sendEvents.call(g,e,r._currentSession),r.deviceToggledInCurrentSession=!0}}))}),1e3)})),y||(b=!1),!0},get(){const n=document.querySelector('[data-devicetype="speakerDevice"]');return n&&n.sinkId?n.sinkId:(d.log.warn(`${i.LOGCAT.CALL} | No speaker element found`),null)},reset:()=>(document.querySelectorAll('[data-devicetype="speakerDevice"]').forEach((n=>{n&&n.setSinkId?n.setSinkId(""):d.log.warn(`${i.LOGCAT.CALL} | No speaker element found.`)})),!0),media(n){const e={dtmf:"dtmfstar",ringback:i.RINGBACK_ELEMENT_ID};return n&&n in e?document.getElementById(e[n]):document.getElementById(i.RINGBACK_ELEMENT_ID)}},e.ringtoneDevices={set(n){if(!C.filter((e=>e.deviceId===n&&"audiooutput"===e.kind)).length)return d.log.error("Invalid output device id"),!1;const e=document.getElementById(i.RINGTONE_ELEMENT_ID);return e.setSinkId&&e.setSinkId(n),!0},get(){const n=document.getElementById(i.RINGTONE_ELEMENT_ID);return n.sinkId?n.sinkId:null},reset(){const n=document.getElementById(i.RINGTONE_ELEMENT_ID);return n.setSinkId&&n.setSinkId(""),!0},media:()=>document.getElementById(i.RINGTONE_ELEMENT_ID)};e.unmute=function(){var n;d.log.debug(`${i.LOGCAT.CALL} | call is now unmuted`);const e=this;m?m.getAudioTracks()[0].enabled=!0:this._currentSession.session.unmute(),null===(n=e._currentSession)||void 0===n||n.stopSpeechRecognition(e),e.noiseSuppresion&&e.noiseSuppresion.unmuteStream(),h=!0};e.updateAudioDeviceFlags=function(){m&&m.getTracks().forEach((n=>n.stop())),m=null};e.audioDevDicSetter=function(n){E=n};e.detectDeviceChange=function(){"chrome"===this.browserDetails.browser&&this.browserDetails.version<57?setInterval((()=>{e.checkAudioDevChange.call(this)}),5e3):navigator.mediaDevices.ondevicechange=n=>{n.isTrusted?d.log.debug(`${i.LOGCAT.CALL} | Device change event is trusted`):d.log.debug(`${i.LOGCAT.CALL} | Device change event is not trusted`),e.checkAudioDevChange.call(this)}}}).call(this,t(13))},function(n,e,t){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.stopAudio=e.playAudio=e.getDTMFOption=e.setup=e.setupRemoteView=void 0;const r=t(1),i=t(0),a=t(6),s={log:i.Logger},o=function(n,e){window.RTCPeerConnection||(s.log.error("No WebRTC support"),document.onreadystatechange=()=>{"complete"===document.readyState&&n.emit("onWebrtcNotSupported")}),n.emit("onMediaPermission",e),"failure"===e.status&&n.userName&&n.callStats&&n.callStats.reportError(null,n.userName,n.callStats.webRTCFunctions.getUserMedia),"success"===e.status&&e.stream&&a.audioDevDictionary.call(n,!0).then((()=>{a.availableDevices().then((e=>{let t=null,i=null;e.forEach((n=>{"default"===n.deviceId&&"audioinput"===n.kind&&(t=n),"default"===n.deviceId&&"audiooutput"===n.kind&&(i=n)})),s.log.debug(`${r.LOGCAT.CALL} Setting Input device set to default i.e ${JSON.stringify(t)}`),n.audio.microphoneDevices.set("default"),s.log.debug(`${r.LOGCAT.CALL} Setting Output device set to default i.e ${JSON.stringify(i)}`),n.audio.speakerDevices.set("default")})),s.log.debug(`${r.LOGCAT.LOGIN} UserMedia:audioDevDictionary is updated, onMediaPermission:${e.status}`)})),n.remoteView=document.getElementById(r.REMOTE_VIEW_ID),n.ringToneView=document.getElementById(r.RINGTONE_ELEMENT_ID),n.ringBackToneView=document.getElementById(r.RINGBACK_ELEMENT_ID),n.connectToneView=document.getElementById(r.CONNECT_TONE_ELEMENT_ID)};e.setupRemoteView=()=>{const n=document.createElement("audio");n.id=r.REMOTE_VIEW_ID,n.hidden=!0,n.autoplay=!0,n.width=0,n.height=0,n.setAttribute("data-devicetype","speakerDevice"),document.body.appendChild(n)};e.setup=function(n,t){e.setupRemoteView();const i=document.createElement("audio");i.id=r.CONNECT_TONE_ELEMENT_ID,i.loop="loop",i.src=r.CONNECT_TONE_URL,i.setAttribute("data-devicetype","speakerDevice"),document.body.appendChild(i);const a=document.createElement("audio");a.id=r.RINGBACK_ELEMENT_ID,a.loop="loop",a.src=r.RINGBACK_URL,a.setAttribute("data-devicetype","speakerDevice"),document.body.appendChild(a);const c=document.createElement("audio");c.id=r.RINGTONE_ELEMENT_ID,c.loop="loop",c.src=r.RINGTONE_URL,c.setAttribute("data-devicetype","ringtoneDevice"),document.body.appendChild(c);const l=document.createElement("audio");l.id=r.SILENT_TONE_ELEMENT_ID,l.src=r.SILENT_TONE_URL,l.setAttribute("data-devicetype","silentDevice"),document.body.appendChild(l);const u=function(n){const e=`dtmf${n}`,t="https://cdn.plivo.com/sdk/browser/audio/dtmf-"+n+".mp3",r=document.createElement("audio");r.id=e,r.src=t,r.setAttribute("data-devicetype","speakerDevice"),document.body.appendChild(r)};for(let n=0;n<=9;n+=1)u(n);u("star"),u("pound"),t.permOnClick?(window.localStream=null,o(n,{status:"success",stream:!1})):function(n,e,t){navigator.mediaDevices.getUserMedia?navigator.mediaDevices.getUserMedia({audio:n,video:!1}).then((n=>{window.localStream=n,s.log.debug(`${r.LOGCAT.LOGIN} UserMedia:Access granted for audio`),t(e,{status:"success",stream:!0})})).catch((n=>{s.log.error(`${r.LOGCAT.LOGIN}UserMedia:Access to audio failed - ${n.name}`),t(e,{status:"failure",error:n.name})})):(s.log.error(`${r.LOGCAT.LOGIN} UserMedia:Not available`),t(e,{status:"failure",error:"getUserMedia not supported"}))}(t.audioConstraints,n,((n,e)=>{o(n,e)}))};e.getDTMFOption=function(n){let e;return n&&"sendDtmfType"in n?(e=n.sendDtmfType,e=e.map((n=>n.toUpperCase())),-1!==e.indexOf("INBAND")&&-1===e.indexOf("OUTBAND")?"INBAND":-1===e.indexOf("INBAND")&&-1!==e.indexOf("OUTBAND")?"OUTBAND":"DEFAULT"):"DEFAULT"};e.playAudio=function(n,t){try{let o=!1;const c=r.DTMF_TONE_PLAY_RETRY_ATTEMPTS,l=document.getElementById(n);s.log.debug(`${r.LOGCAT.CALL} | Unmuting audio for element: ${n}`),l.muted=!1;let u="";n.includes("dtmf")&&(u=e.getDTMFOption(null===t||void 0===t?void 0:t.options.dtmfOptions),i.Logger.debug(`DTMF Options :  ${u}`)),n.includes("dtmf")&&t&&"OUTBAND"===u.toUpperCase()&&a.mute.call(t),l.currentTime=0;const d=function(n){if(n<=0&&!o)return t&&a.unmute.call(t),void(o=!0);setTimeout((()=>{n>0&&!o&&d(n-1)}),100)},h=l.play().then((()=>{s.log.debug(`${r.LOGCAT.CALL} | Audio played for element: ${n}`),n.includes("dtmf")&&"OUTBAND"===u.toUpperCase()?l.onended=()=>{o=!0,t&&a.unmute.call(t)}:n.includes("dtmf")&&s.log.info("sent inband dtmf")}));void 0!==h&&h.catch((e=>{s.log.error(`${r.LOGCAT.CALL} | error while playing audio for element: ${n}, err: ${e.name}`)})),n.includes("dtmf")&&"OUTBAND"===u.toUpperCase()&&d(c),s.log.debug(`${r.LOGCAT.CALL} | playAudio - ${n}`)}catch(e){s.log.error(`${r.LOGCAT.CALL} | failed to play audio for elementId ${n} Cause: ${e}`)}};e.stopAudio=function(n){try{s.log.debug(`${r.LOGCAT.CALL} | stopping audio for element - ${n}`);const e=document.getElementById(n);e.pause(),e.muted=!0,s.log.debug(`${r.LOGCAT.CALL} | stopAudio - ${n}`)}catch(e){s.log.error(`${r.LOGCAT.CALL} | failed to stop audio for elementId ${n} Cause: ${e}`)}}},function(n,e,t){"use strict";var r=this&&this.__awaiter||function(n,e,t,r){return new(t||(t=Promise))((function(i,a){function s(n){try{c(r.next(n))}catch(n){a(n)}}function o(n){try{c(r.throw(n))}catch(n){a(n)}}function c(n){var e;n.done?i(n.value):(e=n.value,e instanceof t?e:new t((function(n){n(e)}))).then(s,o)}c((r=r.apply(n,e||[])).next())}))},i=this&&this.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(e,"__esModule",{value:!0}),e.removeSpaces=e.logCandidatePairs=e.mobileBrowserCheck=e.isSessionConfirmed=e.handleMediaError=e.addCallstatsIOFabric=e.addMidAttribute=e.hangupClearance=e.statsCollector=e.extractReason=e.extractReasonInfo=e.onIceConnectionChange=e.getUTCTImeString=e.setEncodingParameters=e.iceConnectionCheck=e.callStart=e.getCurrentTime=e.replaceMdnsIceCandidates=e.addCloseProtectionListeners=e.setErrorCollector=void 0;const a=t(10),s=t(9),o=t(3),c=t(4),l=t(39),u=t(6),d=t(0),h=t(1),p=i(t(2)),f={log:d.Logger,sendEvents:o.sendEvents,AppError:o.AppError,emitMetrics:c.emitMetrics};e.setErrorCollector=()=>{window.onerror=n=>{f.log.error(`${h.LOGCAT.CRASH} | ${n} |`,(new Error).stack)}};e.addCloseProtectionListeners=function(){const n=this;(function(n){var e;return r(this,void 0,void 0,(function*(){const t=s.getClientVersion(),r=s.getSDKVersion(),i=s.getOS(),o={msg:"CALL_SUMMARY",userAgent:navigator.userAgent,clientVersionMajor:t.major||t[0]||"0",clientVersionMinor:t.minor||t[1]||"0",clientVersionPatch:t.patch||t[2]||"0",sdkName:a.name,sdkVersionMajor:r.major,sdkVersionMinor:r.minor,sdkVersionPatch:r.patch,clientName:p.default().browser,devicePlatform:navigator.platform,deviceOs:i,setupOptions:n.options,noiseReduction:{enabled:null!==(e=n.enableNoiseReduction)&&void 0!==e&&e,noiseSuprressionStarted:n.noiseSuppresion.started},isAudioDeviceToggled:n.deviceToggledInCurrentSession,isNetworkChanged:n.networkChangeInCurrentSession,jsFramework:n.jsFramework};n._currentSession&&(o.signalling=n._currentSession.signallingInfo);const c=yield u.getAudioDevicesInfo.call(n);return c&&(o.audioDeviceInfo=c),o}))})(n).then((e=>{n.options.closeProtection?window.onbeforeunload=t=>{f.sendEvents.call(n,e,n._currentSession),t.preventDefault(),t.returnValue=""}:window.onbeforeunload=()=>{f.sendEvents.call(n,e,n._currentSession),n._currentSession&&n._currentSession.session.terminate()},window.onunload=()=>{n._currentSession&&n._currentSession.session.terminate(),f.sendEvents.call(n,e,n._currentSession),f.log.send(n)}}))};const g=n=>{const e=n.split(" ");return e[4]=h.DEFAULT_MDNS_CANDIDATE,e.join(" ")};e.replaceMdnsIceCandidates=n=>{const e=n;let t=0,r=0;const i=[],a=n.split("\n");for(let n=0;n<a.length;n+=1)-1!==a[n].indexOf("a=candidate")&&(r+=1,-1!==a[n].indexOf(".local")&&(t+=1,a[n]=g(a[n]))),i.push(a[n]);return t!==r?e:i.join("\n")};e.getCurrentTime=()=>Date.now();const m=function(){const{storage:n}=this;return n&&(n.local_audio=[],n.remote_audio=[],n.mosLocalMeasures=[],n.mosRemoteMeasures=[],n.jitterLocalMeasures=[],n.jitterRemoteMeasures=[],n.packetLossRemoteMeasures=[],n.packetLossLocalMeasures=[],n.rtt=[],n.audioCodec=null,n.warning={audioLocalMeasures:!1,audioRemoteMeasures:!1,mosLocalMeasures:!1,mosRemoteMeasures:!1,jitterLocalMeasures:!1,jitterRemoteMeasures:!1,packetLossRemoteMeasures:!1,packetLossLocalMeasures:!1,rtt:!1,ice_connection:!1},n.startAnalysis=!1,setTimeout((()=>{n.startAnalysis=!0,f.log.debug("Stats analysis started")}),h.STATS_ANALYSIS_WAIT_TIME)),!0};e.callStart=function(){return this.storage={},m.call(this)};e.iceConnectionCheck=function(n){const e=this;-1!==["disconnected","failed"].indexOf(n)&&(f.log.info(`${h.LOGCAT.NETWORK_CHANGE} | Network drop while performing ice connection check`),f.emitMetrics.call(e,"network","warning","ice_connection",n,!0,"network drop","None"),e.storage&&(e.storage.warning.ice_connection=!0)),"connected"===n&&e.storage&&!0===e.storage.warning.ice_connection&&(f.emitMetrics.call(e,"network","warning","ice_connection",n,!1,"network drop","None"),e.storage.warning.ice_connection=!1)};e.setEncodingParameters=function(){const n=this;if(n._currentSession&&n._currentSession.session&&n._currentSession.session.connection){const e=n._currentSession.session.connection.getSenders()[0];if(!n.options.dscp||!e||"function"!==typeof e.getParameters||"function"!==typeof e.setParameters)return;const t=e.getParameters();if(!t.priority&&(!t.encodings||!t.encodings.length))return;t.priority="high",t.encodings&&t.encodings.length&&t.encodings.forEach((n=>{n.priority="high",n.networkPriority="high"})),e.setParameters(t)}};e.getUTCTImeString=function(){const n=new Date;return`${n.toISOString().substring(0,10)} ${n.toISOString().split("T")[1].split(".")[0]}.${n.getUTCMilliseconds()}`};e.onIceConnectionChange=function(n,t){return r(this,void 0,void 0,(function*(){const i=this,a=n.iceConnectionState;f.log.debug(`${h.LOGCAT.CALL} | oniceconnectionstatechange is ${a}`),function(n,t){r(this,void 0,void 0,(function*(){(yield n.getStats()).forEach((r=>{switch(r.type){case"candidate-pair":t.candidatePairsList.set(r.id,{iceConnectionState:n.iceConnectionState,localCandidateId:r.localCandidateId,remoteCandidateId:r.remoteCandidateId,state:r.state,timeStamp:e.getUTCTImeString()});break;case"local-candidate":case"remote-candidate":t.candidateList.set(r.id,{ip:r.ip,port:r.port,candidateType:r.candidateType,isLocal:"local-candidate"===r.type})}}))}))}(n,t),t.addConnectionStage(`iceConnectionState-${a}@${e.getCurrentTime()}`),t.updateMediaConnectionInfo({[`ice_connection_state_${a}`]:e.getCurrentTime()}),e.iceConnectionCheck.call(i,a),t.callUUID&&n&&("failed"!==a&&"disconnected"!==a||i.callStats&&i.callStats.reportError(n,t.callUUID,i.callStats.webRTCFunctions.iceConnectionFailure),"connected"===a&&i.emit("onMediaConnected",t.getCallInfo("local")))}))};e.extractReasonInfo=n=>{if(null==n||"object"!==typeof n)return f.log.debug(`${h.LOGCAT.CALL} | evt.message could be null or not an object: ${n?typeof n:"null"}`),{protocol:"none",cause:-1,text:"none"};const e=n.getHeader("Reason");if(null==e)return f.log.debug(`${h.LOGCAT.CALL} | No reason header present}`),{protocol:"none",cause:-1,text:"none"};const t=e.match(/cause=(\d+)/),r=e.match(/^([^;]+)/),i=e.match(/text="([^"]+)"/);return{protocol:r?r[1]:"none",cause:t?parseInt(t[1],10):-1,text:i?i[1]:"none"}};e.extractReason=n=>"local"===n.originator?{protocol:"none",cause:h.LOCAL_ERROR_CODES[n.cause],text:n.cause}:e.extractReasonInfo(n.message);e.statsCollector=function(n){const e=this;if(e.statsSocket&&e.callstatskey&&("chrome"===e.browserDetails.browser&&e.browserDetails.version>63||"firefox"===e.browserDetails.browser&&e.browserDetails.version>59||"safari"===e.browserDetails.browser&&e.browserDetails.version>10||"edge"===e.browserDetails.browser&&e.browserDetails.version>79)||"chrome"===e.browserDetails.browser&&e.browserDetails.version>63){const t=new l.GetRTPStats(e);n.setCallStats(t)}else e.statsSocket&&e.callstatskey&&f.log.warn("This browser version is not supported for collecting data for Call Insights API but the call will proceed despite this. Supported versions are Chrome version - 64 and above, Firefox version - 63 and above, Safari version - 10 and above")};const b=function(n){const e=this;n===e._currentSession?(e.remoteView&&e.remoteView.pause(),e._lastCallSession=n,e.lastCallUUID=n.callUUID,e._currentSession=null,e.callSession=null,e.callUUID=null,e.callDirection=null):e&&e.incomingInvites&&n.callUUID&&e.incomingInvites.has(n.callUUID)&&e.incomingInvites.delete(n.callUUID),e.lastIncomingCall&&e.lastIncomingCall.callUUID===n.callUUID&&(e.lastIncomingCall=null,e.options.allowMultipleIncomingCalls||(e.callSession=null,e.callUUID=null,e.callDirection=null),e.incomingInvites.size&&(e.lastIncomingCall=e.incomingInvites.values().next().value,!e.options.allowMultipleIncomingCalls&&e.lastIncomingCall&&(e.callSession=e.lastIncomingCall.session,e.callUUID=e.lastIncomingCall.callUUID,e.callDirection=e.lastIncomingCall.direction)))},v=function(){!this._currentSession&&this.incomingInvites&&0===this.incomingInvites.size&&(window.onbeforeunload=()=>{},window.onunload=()=>{})},y=function(){if(window.localStream){if("firefox"===p.default().browser||"chrome"===p.default().browser||this.permOnClick||u.isElectronApp())try{window.localStream.getTracks().forEach((n=>{n.stop(),window.localStream.removeTrack(n)})),window.localStream=null}catch(n){f.log.debug(`${h.LOGCAT.CALL} | error in stopping tracks in localStream : ${n.message}`)}if("safari"===p.default().browser)try{window.localStream.getTracks().forEach((n=>{n.enabled||(n.enabled=!0)}))}catch(n){f.log.debug(`${h.LOGCAT.CALL} | error in enabling tracks in localStream : ${n.message}`)}}};e.hangupClearance=function(n){try{const e=this;f.AppError.call(e,function(n){const e=[];let t="";for(let r=0;n.length>r;r+=1){const i=n[r].split("@");if(0===r)t=i[1],e.push(`${i[0]} = ${i[1]}#`);else{let n=new Date(i[1]).valueOf()-new Date(t).valueOf();n>1e3?(n/=1e3,n=`${String(n)}s#`):n=`${String(n)}ms#`,e.push(`${i[0]} = ${i[1]} +${n}`)}}let r=JSON.stringify(e);return r=r.replace(/[[",\]]/g,""),r=r.replace(/#/g,"\n"),r}(n.connectionStages),"log"),n.clearCallStats(),b.call(e,n);const t=n.getSignallingInfo(),r=n.getMediaConnectionInfo();if(e.callstatskey&&(n.isAudioDeviceMismatch=!1,u.getAudioDevicesInfo.call(e).then((i=>{u.matchDevices(i.activeInputDeviceGroupId,i.activeOutputDeviceGroupId,i.activeInputAudioDevice,i.activeOutputAudioDevice)||(n.isAudioDeviceMismatch=!0,f.log.debug(`${h.LOGCAT.CALL} | Input and output device mismatch while hangup: ${JSON.stringify(i)}`)),o.sendCallSummaryEvent.call(e,i,t,r,n)})).catch((()=>{o.sendCallSummaryEvent.call(e,null,t,r,n)}))),v.call(e),e.isCallMuted=!1,e._currentSession)return;e.storage&&(e.storage=null),y.call(e),u.updateAudioDeviceFlags(),u.resetMuteOnHangup(),e.noiseSuppresion.stopNoiseSuppresion()}catch(n){f.log.info(`${h.LOGCAT.CALL} | error while hangup clearance : ${n.message}`)}};e.addMidAttribute=function(n){"firefox"===this.browserDetails.browser&&this.browserDetails.version>62&&n.response&&n.response.body&&-1===n.response.body.indexOf("a=mid:0")&&(n.response.body=n.response.body.replace("a=ice-pwd","a=mid:0\na=ice-pwd"))};const _=n=>{f.log.debug(`Stats new fabric message: ${n}`)};e.addCallstatsIOFabric=function(n,e,t){this.callStats&&n.session.connection&&this.callStats.addNewFabric(n.session.connection,e,this.callStats.fabricUsage.audio,t,_)};e.handleMediaError=function(n,t){const r=this;if(r.callStats&&t.callUUID&&!n.cause.match("edia")&&(f.log.debug(`${h.LOGCAT.CALL} | Sending error to stats when media error occurs`),t.session.connection?r.callStats.reportError(t.session.connection,t.callUUID,r.callStats.webRTCFunctions.signalingError):r.callStats.reportError(null,t.callUUID,r.callStats.webRTCFunctions.signalingError)),r.statsSocket&&t.callUUID&&r.callstatskey&&!n.cause.match("edia")){const r=n.cause;let i;i=n.message&&n.message.status_code?String(n.message.status_code):n.cause,t.updateSignallingInfo({signalling_errors:{timestamp:e.getCurrentTime(),error_code:i,error_description:r}})}};e.isSessionConfirmed=function(n){return n?n.isEstablished():(f.log.debug("session not available"),!1)};e.mobileBrowserCheck=function(){let n=!1;var e;return e=navigator.userAgent||navigator.vendor||window.opera,(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4)))&&(n=!0),n};e.logCandidatePairs=function(n){if(n){const{candidateList:e}=n;n.candidatePairsList.forEach(((n,t)=>{f.log.debug(`${h.LOGCAT.CALL}| iceConnectionState-${n.iceConnectionState}, CandidatePair(${t}): state-${n.state} at [${n.timeStamp}] has local-candidate(${n.localCandidateId}):[${JSON.stringify(e.get(n.localCandidateId)).slice(1,-1)}] and remote-candidate(${n.remoteCandidateId}):[${JSON.stringify(e.get(n.remoteCandidateId)).slice(1,-1)}]`)}))}else f.log.debug(`${h.LOGCAT.CALL} |can't logCandidatePairs, callSession is null`)};e.removeSpaces=function(n){return n.replace(/\s/g,"")}},function(n,e,t){"use strict";var r=this&&this.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(e,"__esModule",{value:!0}),e.getClientVersion=e.getSDKVersion=e.checkMediaDevices=e.getOS=void 0;const i=r(t(32)),a=r(t(10));e.getOS=()=>{let n="Unknown OS";return-1!==navigator.userAgent.indexOf("Win")&&(n="Windows"),-1!==navigator.userAgent.indexOf("Mac")&&(n="Macintosh"),-1!==navigator.userAgent.indexOf("Linux")&&(n="Linux"),-1!==navigator.userAgent.indexOf("Android")&&(n="Android"),-1!==navigator.userAgent.indexOf("like Mac")&&(n="iOS"),-1!==navigator.userAgent.indexOf("CrOS")&&(n="Chromium"),n};e.checkMediaDevices=()=>{if(!navigator.mediaDevices)throw/Chrome/.test(navigator.userAgent)?new Error("This Chrome version supports microphone access only in HTTPS web applications. https://bit.ly/2SiWjWN"):/Firefox/.test(navigator.userAgent)?new Error("This Firefox version supports microphone access only in HTTPS web applications. https://mzl.la/2LSLIkr"):new Error("This Browser version supports microphone access only in HTTPS web applications.")};e.getSDKVersion=()=>i.default.parseSemVer(a.default.version,!1);e.getClientVersion=()=>{const n=(()=>{const n=navigator.appName,e=navigator.userAgent;let t,r=e.match(/(opera|chrome|safari|firefox|msie|trident)\/?\s*(\.?\d+(\.\d+)*)/i);return r&&null!==(t=e.match(/version\/([.\d]+)/i))&&(r[2]=t[1]),r=r?[r[1],r[2]]:[n,navigator.appVersion,"-?"],r[1]})();return i.default.parseSemVer(n,!1).matches?i.default.parseSemVer(n,!1):n.split(".")}},function(n){n.exports=JSON.parse('{"name":"plivo-browser-sdk","title":"plivo-browser-sdk","version":"2.2.21","description":"This library allows you to connect with plivo\'s voice enviroment from browser","main":"./dist/plivobrowsersdk.js","types":"index.d.ts","scripts":{"start":"webpack-dev-server --env.development --env.PLIVO_ENV=production","build:es5":"babel lib -d types/lib","build:ts":"./node_modules/typescript/bin/tsc","clean:ts":"rm -rf types","build:me":"webpack lib/rnnoise/workletProcessor.ts ./bundling.js","build:webpack":"webpack  --env.production --env.PLIVO_ENV=production","build":"npm-run-all build:webpack clean:ts","build:sellular":"npm-run-all build:ts build:es5","build:npm":"webpack  --env.production --env.npm --env.PLIVO_ENV=production","build:nominify":"webpack  --env.production --env.nominify --env.PLIVO_ENV=production","publish:npm":"rm -rf dist && npm run build:npm && npm publish","publish:npm_beta":"rm -rf dist && npm run build:npm && npm publish --tag beta","test":"npm-run-all test:integration test:unit","test:unit":"export USERAGENT_OS=darwin && jest --testPathPattern=test/unit/ --coverage --colors","test:unit-jenkins":"export USERAGENT_OS=linux && jest --testPathPattern=test/unit/ --coverage --colors","test:integration":"karma start --single-run --browsers ChromeWebRTC karma.conf.js","test:integration-safari":"karma start --single-run --browsers Safari karma.conf.js","beta-version-patch":"npm version $(semver $npm_package_version -i prerelease --preid beta)","beta-version-minor":"npm version $(semver $npm_package_version -i preminor --preid beta)","beta-version-major":"npm version $(semver $npm_package_version -i premajor --preid beta)","rc-version":"npm version $(semver $npm_package_version -i prerelease --preid rc)","final-release":"npm version $(semver $npm_package_version -i)","semver":"npm version $(semver $npm_package_version -i $release --preid $preid)","lint":"eslint lib --ext .ts"},"jest":{"preset":"ts-jest"},"author":"Plivo","license":"Apache-2.0","bugs":{"url":"https://github.com/plivo/plivo-websdk-2.0-example/issues"},"homepage":"https://www.plivo.com/docs/sdk/client/browser/reference","pre-commit":["lint","test:unit","build"],"dependencies":{"@types/audioworklet":"^0.0.50","@types/emscripten":"^1.39.8","compare-versions":"^3.6.0","debug":"^4.2.0","events":"^3.2.0","null-loader":"4.0.1","sdp-transform":"^2.14.0","semver-parser":"^3.0.5","plivo-jssip":"^1.0.5","uuid":"^8.3.0","wasm-feature-detect":"^1.5.1","wasm-pack":"^0.12.1","webrtc-adapter":"^7.7.0"},"devDependencies":{"@types/chrome":"0.0.123","@types/jest":"^26.0.14","@types/mocha":"^8.2.0","@types/node":"^14.11.1","@types/terser-webpack-plugin":"^5.0.2","@types/webpack":"^4.41.26","@typescript-eslint/eslint-plugin":"^4.1.1","@typescript-eslint/parser":"^4.1.1","awesome-typescript-loader":"^5.2.1","babel-cli":"^6.26.0","babel-plugin-transform-class-properties":"^6.24.1","babel-preset-es2015":"^6.24.1","babelify":"^10.0.0","browserify":"^16.5.2","chai":"^4.2.0","create-file-webpack":"^1.0.2","dotenv":"^8.2.0","dts-bundle":"^0.7.3","envify":"^4.1.0","eslint":"^7.22.0","eslint-config-airbnb-base":"^14.2.0","eslint-config-airbnb-typescript":"^10.0.0","eslint-plugin-import":"^2.22.0","file-loader":"^6.2.0","jest":"^26.4.2","karma":"^5.2.3","karma-browserify":"^7.0.0","karma-chai":"^0.1.0","karma-chrome-launcher":"^3.1.0","karma-firefox-launcher":"^1.3.0","karma-html-reporter":"^0.2.7","karma-jasmine-html-reporter":"^1.5.4","karma-mocha":"^2.0.1","karma-mocha-reporter":"^2.2.5","karma-safari-launcher":"^1.0.0","karma-sinon":"^1.0.5","karma-spec-reporter":"0.0.32","karma-summary-reporter":"^2.0.0","karma-typescript":"^5.2.0","karma-typescript-es6-transform":"^5.2.0","mkdirp":"^1.0.4","mocha":"^8.1.3","npm-run-all":"^4.1.5","pre-commit":"^1.2.2","replace-in-file-webpack-plugin":"^1.0.6","script-loader":"^0.7.2","sinon":"^9.2.3","source-map-loader":"^1.1.0","string-replace-loader":"^2.3.0","string-replace-webpack-plugin":"^0.1.3","terser-webpack-plugin":"^4.2.2","ts-jest":"^26.4.0","ts-node":"^9.0.0","tsify":"^5.0.2","tslint-config-airbnb":"^5.11.2","typescript":"^4.0.3","wasm-feature-detect":"^1.5.1","webpack":"^4.47.0","webpack-cli":"^3.3.12","webpack-dev-server":"^3.11.0"}}')},function(n,e,t){n.exports=function n(e,t,r){function i(s,o){if(!t[s]){if(!e[s]){if(a)return a(s,!0);var c=new Error("Cannot find module '"+s+"'");throw c.code="MODULE_NOT_FOUND",c}var l=t[s]={exports:{}};e[s][0].call(l.exports,(function(n){return i(e[s][1][n]||n)}),l,l.exports,n,e,t,r)}return t[s].exports}for(var a=!1,s=0;s<r.length;s++)i(r[s]);return i}({1:[function(n,e,t){const r=n("./Utils"),i=n("./Constants"),a=n("./Grammar"),s=n("./URI"),o=n("./Socket"),c=n("./Exceptions");t.settings={authorization_user:null,password:null,realm:null,ha1:null,display_name:null,uri:null,contact_uri:null,instance_id:null,use_preloaded_route:!1,session_timers:!0,session_timers_refresh_method:i.UPDATE,no_answer_timeout:60,register:!0,register_expires:600,registrar_server:null,sockets:null,connection_recovery_max_interval:i.CONNECTION_RECOVERY_MAX_INTERVAL,connection_recovery_min_interval:i.CONNECTION_RECOVERY_MIN_INTERVAL,via_host:`${r.createRandomToken(12)}.invalid`};const l={mandatory:{sockets(n){const e=[];if(o.isSocket(n))e.push({socket:n});else{if(!Array.isArray(n)||!n.length)return;for(const t of n)Object.prototype.hasOwnProperty.call(t,"socket")&&o.isSocket(t.socket)?e.push(t):o.isSocket(t)&&e.push({socket:t})}return e},uri(n){/^sip:/i.test(n)||(n=`${i.SIP}:${n}`);const e=s.parse(n);return e&&e.user?e:void 0}},optional:{authorization_user:n=>-1===a.parse(`"${n}"`,"quoted_string")?void 0:n,authorization_jwt(n){if("string"==typeof n)return n},user_agent(n){if("string"==typeof n)return n},connection_recovery_max_interval(n){if(r.isDecimal(n)){const e=Number(n);if(e>0)return e}},connection_recovery_min_interval(n){if(r.isDecimal(n)){const e=Number(n);if(e>0)return e}},contact_uri(n){if("string"==typeof n){const e=a.parse(n,"SIP_URI");if(-1!==e)return e}},display_name:n=>n,instance_id:n=>(/^uuid:/i.test(n)&&(n=n.substr(5)),-1===a.parse(n,"uuid")?void 0:n),no_answer_timeout(n){if(r.isDecimal(n)){const e=Number(n);if(e>0)return e}},session_timers(n){if("boolean"==typeof n)return n},session_timers_refresh_method(n){if("string"==typeof n&&((n=n.toUpperCase())===i.INVITE||n===i.UPDATE))return n},password:n=>String(n),realm:n=>String(n),ha1:n=>String(n),register(n){if("boolean"==typeof n)return n},register_expires(n){if(r.isDecimal(n)){const e=Number(n);if(e>0)return e}},registrar_server(n){/^sip:/i.test(n)||(n=`${i.SIP}:${n}`);const e=s.parse(n);return e?e.user?void 0:e:void 0},use_preloaded_route(n){if("boolean"==typeof n)return n}}};t.load=(n,e)=>{for(const t in l.mandatory){if(!e.hasOwnProperty(t))throw new c.ConfigurationError(t);{const r=e[t],i=l.mandatory[t](r);if(void 0===i)throw new c.ConfigurationError(t,r);n[t]=i}}for(const t in l.optional)if(e.hasOwnProperty(t)){const i=e[t];if(r.isEmpty(i))continue;const a=l.optional[t](i);if(void 0===a)throw new c.ConfigurationError(t,i);n[t]=a}}},{"./Constants":2,"./Exceptions":6,"./Grammar":7,"./Socket":20,"./URI":25,"./Utils":26}],2:[function(n,e,t){const r=n("../package.json");e.exports={USER_AGENT:`${r.title} ${r.version}`,SIP:"sip",SIPS:"sips",causes:{CONNECTION_ERROR:"Connection Error",REQUEST_TIMEOUT:"Request Timeout",SIP_FAILURE_CODE:"SIP Failure Code",INTERNAL_ERROR:"Internal Error",BUSY:"Busy",REJECTED:"Rejected",REDIRECTED:"Redirected",UNAVAILABLE:"Unavailable",NOT_FOUND:"Not Found",ADDRESS_INCOMPLETE:"Address Incomplete",INCOMPATIBLE_SDP:"Incompatible SDP",MISSING_SDP:"Missing SDP",AUTHENTICATION_ERROR:"Authentication Error",BYE:"Terminated",WEBRTC_ERROR:"WebRTC Error",CANCELED:"Canceled",NO_ANSWER:"No Answer",EXPIRES:"Expires",NO_ACK:"No ACK",DIALOG_ERROR:"Dialog Error",USER_DENIED_MEDIA_ACCESS:"User Denied Media Access",BAD_MEDIA_DESCRIPTION:"Bad Media Description",RTP_TIMEOUT:"RTP Timeout"},SIP_ERROR_CAUSES:{REDIRECTED:[300,301,302,305,380],BUSY:[486,600],REJECTED:[403,603],NOT_FOUND:[404,604],UNAVAILABLE:[480,410,408,430],ADDRESS_INCOMPLETE:[484,424],INCOMPATIBLE_SDP:[488,606],AUTHENTICATION_ERROR:[401,407]},ACK:"ACK",BYE:"BYE",CANCEL:"CANCEL",INFO:"INFO",INVITE:"INVITE",MESSAGE:"MESSAGE",NOTIFY:"NOTIFY",OPTIONS:"OPTIONS",REGISTER:"REGISTER",REFER:"REFER",UPDATE:"UPDATE",SUBSCRIBE:"SUBSCRIBE",DTMF_TRANSPORT:{INFO:"INFO",RFC2833:"RFC2833"},REASON_PHRASE:{100:"Trying",180:"Ringing",181:"Call Is Being Forwarded",182:"Queued",183:"Session Progress",199:"Early Dialog Terminated",200:"OK",202:"Accepted",204:"No Notification",300:"Multiple Choices",301:"Moved Permanently",302:"Moved Temporarily",305:"Use Proxy",380:"Alternative Service",400:"Bad Request",401:"Unauthorized",402:"Payment Required",403:"Forbidden",404:"Not Found",405:"Method Not Allowed",406:"Not Acceptable",407:"Proxy Authentication Required",408:"Request Timeout",410:"Gone",412:"Conditional Request Failed",413:"Request Entity Too Large",414:"Request-URI Too Long",415:"Unsupported Media Type",416:"Unsupported URI Scheme",417:"Unknown Resource-Priority",420:"Bad Extension",421:"Extension Required",422:"Session Interval Too Small",423:"Interval Too Brief",424:"Bad Location Information",428:"Use Identity Header",429:"Provide Referrer Identity",430:"Flow Failed",433:"Anonymity Disallowed",436:"Bad Identity-Info",437:"Unsupported Certificate",438:"Invalid Identity Header",439:"First Hop Lacks Outbound Support",440:"Max-Breadth Exceeded",469:"Bad Info Package",470:"Consent Needed",478:"Unresolvable Destination",480:"Temporarily Unavailable",481:"Call/Transaction Does Not Exist",482:"Loop Detected",483:"Too Many Hops",484:"Address Incomplete",485:"Ambiguous",486:"Busy Here",487:"Request Terminated",488:"Not Acceptable Here",489:"Bad Event",491:"Request Pending",493:"Undecipherable",494:"Security Agreement Required",500:"JsSIP Internal Error",501:"Not Implemented",502:"Bad Gateway",503:"Service Unavailable",504:"Server Time-out",505:"Version Not Supported",513:"Message Too Large",580:"Precondition Failure",600:"Busy Everywhere",603:"Decline",604:"Does Not Exist Anywhere",606:"Not Acceptable"},ALLOWED_METHODS:"INVITE,ACK,CANCEL,BYE,UPDATE,MESSAGE,OPTIONS,REFER,INFO,NOTIFY",ACCEPTED_BODY_TYPES:"application/sdp, application/dtmf-relay",MAX_FORWARDS:69,SESSION_EXPIRES:90,MIN_SESSION_EXPIRES:60,CONNECTION_RECOVERY_MAX_INTERVAL:30,CONNECTION_RECOVERY_MIN_INTERVAL:2,SESSION_CONSTANTS:{STATUS_NULL:0,STATUS_INVITE_SENT:1,STATUS_1XX_RECEIVED:2,STATUS_INVITE_RECEIVED:3,STATUS_WAITING_FOR_ANSWER:4,STATUS_ANSWERED:5,STATUS_WAITING_FOR_ACK:6,STATUS_CANCELED:7,STATUS_TERMINATED:8,STATUS_CONFIRMED:9}}},{"../package.json":55}],3:[function(n,e,t){const r=n("./SIPMessage"),i=n("./Constants"),a=n("./Transactions"),s=n("./Dialog/RequestSender"),o=n("./Utils"),c=n("debug")("JsSIP:Dialog"),l={STATUS_EARLY:1,STATUS_CONFIRMED:2};e.exports=class{static get C(){return l}constructor(n,e,t,i=l.STATUS_CONFIRMED){if(this._owner=n,this._ua=n._ua,this._uac_pending_reply=!1,this._uas_pending_reply=!1,!e.hasHeader("contact"))return{error:"unable to create a Dialog without Contact header field"};e instanceof r.IncomingResponse&&(i=e.status_code<200?l.STATUS_EARLY:l.STATUS_CONFIRMED);const a=e.parseHeader("contact");"UAS"===t?(this._id={call_id:e.call_id,local_tag:e.to_tag,remote_tag:e.from_tag,toString(){return this.call_id+this.local_tag+this.remote_tag}},this._state=i,this._remote_seqnum=e.cseq,this._local_uri=e.parseHeader("to").uri,this._remote_uri=e.parseHeader("from").uri,this._remote_target=a.uri,this._route_set=e.getHeaders("record-route"),this._ack_seqnum=this._remote_seqnum):"UAC"===t&&(this._id={call_id:e.call_id,local_tag:e.from_tag,remote_tag:e.to_tag,toString(){return this.call_id+this.local_tag+this.remote_tag}},this._state=i,this._local_seqnum=e.cseq,this._local_uri=e.parseHeader("from").uri,this._remote_uri=e.parseHeader("to").uri,this._remote_target=a.uri,this._route_set=e.getHeaders("record-route").reverse(),this._ack_seqnum=null),this._ua.newDialog(this),c(`new ${t} dialog created with status ${this._state===l.STATUS_EARLY?"EARLY":"CONFIRMED"}`)}get id(){return this._id}get local_seqnum(){return this._local_seqnum}set local_seqnum(n){this._local_seqnum=n}get owner(){return this._owner}get uac_pending_reply(){return this._uac_pending_reply}set uac_pending_reply(n){this._uac_pending_reply=n}get uas_pending_reply(){return this._uas_pending_reply}update(n,e){this._state=l.STATUS_CONFIRMED,c(`dialog ${this._id.toString()}  changed to CONFIRMED state`),"UAC"===e&&(this._route_set=n.getHeaders("record-route").reverse())}terminate(){c(`dialog ${this._id.toString()} deleted`),this._ua.destroyDialog(this)}sendRequest(n,e={}){const t=o.cloneArray(e.extraHeaders),r=o.cloneObject(e.eventHandlers),i=e.body||null,a=this._createRequest(n,t,i);return r.onAuthenticated=()=>{this._local_seqnum+=1},new s(this,a,r).send(),a}receiveRequest(n){this._checkInDialogRequest(n)&&(n.method===i.ACK&&null!==this._ack_seqnum?this._ack_seqnum=null:n.method===i.INVITE&&(this._ack_seqnum=n.cseq),this._owner.receiveRequest(n))}_createRequest(n,e,t){e=o.cloneArray(e),this._local_seqnum||(this._local_seqnum=Math.floor(1e4*Math.random()));const a=n===i.CANCEL||n===i.ACK?this._local_seqnum:this._local_seqnum+=1;return new r.OutgoingRequest(n,this._remote_target,this._ua,{cseq:a,call_id:this._id.call_id,from_uri:this._local_uri,from_tag:this._id.local_tag,to_uri:this._remote_uri,to_tag:this._id.remote_tag,route_set:this._route_set},e,t)}_checkInDialogRequest(n){if(this._remote_seqnum)if(n.cseq<this._remote_seqnum){if(n.method!==i.ACK)return n.reply(500),!1;if(null===this._ack_seqnum||n.cseq!==this._ack_seqnum)return!1}else n.cseq>this._remote_seqnum&&(this._remote_seqnum=n.cseq);else this._remote_seqnum=n.cseq;if(n.method===i.INVITE||n.method===i.UPDATE&&n.body){if(!0===this._uac_pending_reply)n.reply(491);else{if(!0===this._uas_pending_reply){const e=1+(10*Math.random()|0);return n.reply(500,null,[`Retry-After:${e}`]),!1}{this._uas_pending_reply=!0;const e=()=>{n.server_transaction.state!==a.C.STATUS_ACCEPTED&&n.server_transaction.state!==a.C.STATUS_COMPLETED&&n.server_transaction.state!==a.C.STATUS_TERMINATED||(n.server_transaction.removeListener("stateChanged",e),this._uas_pending_reply=!1)};n.server_transaction.on("stateChanged",e)}}n.hasHeader("contact")&&n.server_transaction.on("stateChanged",(()=>{n.server_transaction.state===a.C.STATUS_ACCEPTED&&(this._remote_target=n.parseHeader("contact").uri)}))}else n.method===i.NOTIFY&&n.hasHeader("contact")&&n.server_transaction.on("stateChanged",(()=>{n.server_transaction.state===a.C.STATUS_COMPLETED&&(this._remote_target=n.parseHeader("contact").uri)}));return!0}}},{"./Constants":2,"./Dialog/RequestSender":4,"./SIPMessage":19,"./Transactions":22,"./Utils":26,debug:30}],4:[function(n,e,t){const r=n("../Constants"),i=n("../Transactions"),a=n("../RequestSender"),s={onRequestTimeout:()=>{},onTransportError:()=>{},onSuccessResponse:()=>{},onErrorResponse:()=>{},onAuthenticated:()=>{},onDialogError:()=>{}};e.exports=class{constructor(n,e,t){this._dialog=n,this._ua=n._ua,this._request=e,this._eventHandlers=t,this._reattempt=!1,this._reattemptTimer=null;for(const n in s)Object.prototype.hasOwnProperty.call(s,n)&&(this._eventHandlers[n]||(this._eventHandlers[n]=s[n]))}get request(){return this._request}send(){const n=new a(this._ua,this._request,{onRequestTimeout:()=>{this._eventHandlers.onRequestTimeout()},onTransportError:()=>{this._eventHandlers.onTransportError()},onAuthenticated:n=>{this._eventHandlers.onAuthenticated(n)},onReceiveResponse:n=>{this._receiveResponse(n)}});if(n.send(),(this._request.method===r.INVITE||this._request.method===r.UPDATE&&this._request.body)&&n.clientTransaction.state!==i.C.STATUS_TERMINATED){this._dialog.uac_pending_reply=!0;const e=()=>{n.clientTransaction.state!==i.C.STATUS_ACCEPTED&&n.clientTransaction.state!==i.C.STATUS_COMPLETED&&n.clientTransaction.state!==i.C.STATUS_TERMINATED||(n.clientTransaction.removeListener("stateChanged",e),this._dialog.uac_pending_reply=!1)};n.clientTransaction.on("stateChanged",e)}}_receiveResponse(n){if(408===n.status_code||481===n.status_code){for(const e in this._ua._sessions)this._ua._sessions[e].isEnded()||this._ua._sessions[e].emitNoCallExists(n);this._eventHandlers.onDialogError(n)}else n.method===r.INVITE&&491===n.status_code?this._reattempt?n.status_code>=200&&n.status_code<300?this._eventHandlers.onSuccessResponse(n):n.status_code>=300&&this._eventHandlers.onErrorResponse(n):(this._request.cseq=this._dialog.local_seqnum+=1,this._reattemptTimer=setTimeout((()=>{this._dialog.owner.status!==r.SESSION_CONSTANTS.STATUS_TERMINATED&&(this._reattempt=!0,this._request_sender.send())}),1e3)):n.status_code>=200&&n.status_code<300?this._eventHandlers.onSuccessResponse(n):n.status_code>=300&&this._eventHandlers.onErrorResponse(n)}}},{"../Constants":2,"../RequestSender":18,"../Transactions":22}],5:[function(n,e,t){const r=n("./Utils"),i=n("debug")("JsSIP:DigestAuthentication"),a=n("debug")("JsSIP:ERROR:DigestAuthentication");a.log=console.warn.bind(console),e.exports=class{constructor(n){this._credentials=n,this._cnonce=null,this._nc=0,this._ncHex="00000000",this._algorithm=null,this._realm=null,this._nonce=null,this._opaque=null,this._stale=null,this._qop=null,this._method=null,this._uri=null,this._ha1=null,this._response=null}get(n){switch(n){case"realm":return this._realm;case"ha1":return this._ha1;default:return void a('get() | cannot get "%s" parameter',n)}}authenticate({method:n,ruri:e,body:t},s,o=null){if(this._algorithm=s.algorithm,this._realm=s.realm,this._nonce=s.nonce,this._opaque=s.opaque,this._stale=s.stale,this._algorithm){if("MD5"!==this._algorithm)return a('authenticate() | challenge with Digest algorithm different than "MD5", authentication aborted'),!1}else this._algorithm="MD5";if(!this._nonce)return a("authenticate() | challenge without Digest nonce, authentication aborted"),!1;if(!this._realm)return a("authenticate() | challenge without Digest realm, authentication aborted"),!1;if(!this._credentials.password){if(!this._credentials.ha1)return a("authenticate() | no plain SIP password nor ha1 provided, authentication aborted"),!1;if(this._credentials.realm!==this._realm)return a('authenticate() | no plain SIP password, and stored `realm` does not match the given `realm`, cannot authenticate [stored:"%s", given:"%s"]',this._credentials.realm,this._realm),!1}if(s.qop)if(s.qop.indexOf("auth-int")>-1)this._qop="auth-int";else{if(!(s.qop.indexOf("auth")>-1))return a('authenticate() | challenge without Digest qop different than "auth" or "auth-int", authentication aborted'),!1;this._qop="auth"}else this._qop=null;this._method=n,this._uri=e,this._cnonce=o||r.createRandomToken(12),this._nc+=1;const c=Number(this._nc).toString(16);let l,u;return this._ncHex="00000000".substr(0,8-c.length)+c,4294967296===this._nc&&(this._nc=1,this._ncHex="00000001"),this._credentials.password?this._ha1=r.calculateMD5(`${this._credentials.username}:${this._realm}:${this._credentials.password}`):this._ha1=this._credentials.ha1,"auth"===this._qop?(l=`${this._method}:${this._uri}`,u=r.calculateMD5(l),i('authenticate() | using qop=auth [a2:"%s"]',l),this._response=r.calculateMD5(`${this._ha1}:${this._nonce}:${this._ncHex}:${this._cnonce}:auth:${u}`)):"auth-int"===this._qop?(l=`${this._method}:${this._uri}:${r.calculateMD5(t||"")}`,u=r.calculateMD5(l),i('authenticate() | using qop=auth-int [a2:"%s"]',l),this._response=r.calculateMD5(`${this._ha1}:${this._nonce}:${this._ncHex}:${this._cnonce}:auth-int:${u}`)):null===this._qop&&(l=`${this._method}:${this._uri}`,u=r.calculateMD5(l),i('authenticate() | using qop=null [a2:"%s"]',l),this._response=r.calculateMD5(`${this._ha1}:${this._nonce}:${u}`)),i("authenticate() | response generated"),!0}toString(){const n=[];if(!this._response)throw new Error("response field does not exist, cannot generate Authorization header");return n.push(`algorithm=${this._algorithm}`),n.push(`username="${this._credentials.username}"`),n.push(`realm="${this._realm}"`),n.push(`nonce="${this._nonce}"`),n.push(`uri="${this._uri}"`),n.push(`response="${this._response}"`),this._opaque&&n.push(`opaque="${this._opaque}"`),this._qop&&(n.push(`qop=${this._qop}`),n.push(`cnonce="${this._cnonce}"`),n.push(`nc=${this._ncHex}`)),`Digest ${n.join(", ")}`}}},{"./Utils":26,debug:30}],6:[function(n,e,t){e.exports={ConfigurationError:class extends Error{constructor(n,e){super(),this.code=1,this.name="CONFIGURATION_ERROR",this.parameter=n,this.value=e,this.message=this.value?`Invalid value ${JSON.stringify(this.value)} for parameter "${this.parameter}"`:`Missing parameter: ${this.parameter}`}},InvalidStateError:class extends Error{constructor(n){super(),this.code=2,this.name="INVALID_STATE_ERROR",this.status=n,this.message=`Invalid status: ${n}`}},NotSupportedError:class extends Error{constructor(n){super(),this.code=3,this.name="NOT_SUPPORTED_ERROR",this.message=n}},NotReadyError:class extends Error{constructor(n){super(),this.code=4,this.name="NOT_READY_ERROR",this.message=n}}}},{}],7:[function(n,e,t){e.exports=function(){function e(n){return'"'+n.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\x08/g,"\\b").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\f/g,"\\f").replace(/\r/g,"\\r").replace(/[\x00-\x07\x0B\x0E-\x1F\x80-\uFFFF]/g,escape)+'"'}var t={parse:function(t,r){var i={CRLF:u,DIGIT:d,ALPHA:h,HEXDIG:p,WSP:f,OCTET:g,DQUOTE:m,SP:b,HTAB:v,alphanum:y,reserved:_,unreserved:C,mark:S,escaped:T,LWS:E,SWS:w,HCOLON:k,TEXT_UTF8_TRIM:R,TEXT_UTF8char:I,UTF8_NONASCII:A,UTF8_CONT:O,LHEX:function(){var n;return null===(n=d())&&(/^[a-f]/.test(t.charAt(a))?(n=t.charAt(a),a++):(n=null,0===s&&l("[a-f]"))),n},token:P,token_nodot:L,separators:function(){var n;return 40===t.charCodeAt(a)?(n="(",a++):(n=null,0===s&&l('"("')),null===n&&(41===t.charCodeAt(a)?(n=")",a++):(n=null,0===s&&l('")"')),null===n&&(60===t.charCodeAt(a)?(n="<",a++):(n=null,0===s&&l('"<"')),null===n&&(62===t.charCodeAt(a)?(n=">",a++):(n=null,0===s&&l('">"')),null===n&&(64===t.charCodeAt(a)?(n="@",a++):(n=null,0===s&&l('"@"')),null===n&&(44===t.charCodeAt(a)?(n=",",a++):(n=null,0===s&&l('","')),null===n&&(59===t.charCodeAt(a)?(n=";",a++):(n=null,0===s&&l('";"')),null===n&&(58===t.charCodeAt(a)?(n=":",a++):(n=null,0===s&&l('":"')),null===n&&(92===t.charCodeAt(a)?(n="\\",a++):(n=null,0===s&&l('"\\\\"')),null===n&&null===(n=m())&&(47===t.charCodeAt(a)?(n="/",a++):(n=null,0===s&&l('"/"')),null===n&&(91===t.charCodeAt(a)?(n="[",a++):(n=null,0===s&&l('"["')),null===n&&(93===t.charCodeAt(a)?(n="]",a++):(n=null,0===s&&l('"]"')),null===n&&(63===t.charCodeAt(a)?(n="?",a++):(n=null,0===s&&l('"?"')),null===n&&(61===t.charCodeAt(a)?(n="=",a++):(n=null,0===s&&l('"="')),null===n&&(123===t.charCodeAt(a)?(n="{",a++):(n=null,0===s&&l('"{"')),null===n&&(125===t.charCodeAt(a)?(n="}",a++):(n=null,0===s&&l('"}"')),null===n&&null===(n=b())&&(n=v())))))))))))))))),n},word:D,STAR:N,SLASH:M,EQUAL:j,LPAREN:x,RPAREN:U,RAQUOT:F,LAQUOT:G,COMMA:$,SEMI:H,COLON:B,LDQUOT:q,RDQUOT:V,comment:function n(){var e,t,r,i;if(i=a,null!==(e=x())){for(t=[],null===(r=W())&&null===(r=Q())&&(r=n());null!==r;)t.push(r),null===(r=W())&&null===(r=Q())&&(r=n());null!==t&&null!==(r=U())?e=[e,t,r]:(e=null,a=i)}else e=null,a=i;return e},ctext:W,quoted_string:z,quoted_string_clean:K,qdtext:J,quoted_pair:Q,SIP_URI_noparams:Y,SIP_URI:X,uri_scheme:Z,uri_scheme_sips:nn,uri_scheme_sip:en,userinfo:tn,user:rn,user_unreserved:an,password:sn,hostport:on,host:cn,hostname:ln,domainlabel:un,toplabel:dn,IPv6reference:hn,IPv6address:pn,h16:fn,ls32:gn,IPv4address:mn,dec_octet:bn,port:vn,uri_parameters:yn,uri_parameter:_n,transport_param:Cn,user_param:Sn,method_param:Tn,ttl_param:En,maddr_param:wn,lr_param:kn,other_param:Rn,pname:In,pvalue:An,paramchar:On,param_unreserved:Pn,headers:Ln,header:Dn,hname:Nn,hvalue:Mn,hnv_unreserved:jn,Request_Response:function(){var n;return null===(n=he())&&(n=xn()),n},Request_Line:xn,Request_URI:Un,absoluteURI:Fn,hier_part:Gn,net_path:$n,abs_path:Hn,opaque_part:Bn,uric:qn,uric_no_slash:Vn,path_segments:Wn,segment:zn,param:Kn,pchar:Jn,scheme:Qn,authority:Yn,srvr:Xn,reg_name:Zn,query:ne,SIP_Version:ee,INVITEm:te,ACKm:re,OPTIONSm:ie,BYEm:ae,CANCELm:se,REGISTERm:oe,SUBSCRIBEm:ce,NOTIFYm:le,REFERm:ue,Method:de,Status_Line:he,Status_Code:pe,extension_code:fe,Reason_Phrase:ge,Allow_Events:function(){var n,e,t,r,i,s;if(i=a,null!==(n=Fe())){for(e=[],s=a,null!==(t=$())&&null!==(r=Fe())?t=[t,r]:(t=null,a=s);null!==t;)e.push(t),s=a,null!==(t=$())&&null!==(r=Fe())?t=[t,r]:(t=null,a=s);null!==e?n=[n,e]:(n=null,a=i)}else n=null,a=i;return n},Call_ID:function(){var n,e,r,i,o,c,u;return i=a,o=a,null!==(n=D())?(c=a,64===t.charCodeAt(a)?(e="@",a++):(e=null,0===s&&l('"@"')),null!==e&&null!==(r=D())?e=[e,r]:(e=null,a=c),null!==(e=null!==e?e:"")?n=[n,e]:(n=null,a=o)):(n=null,a=o),null!==n&&(u=i,n=void($t=t.substring(a,u))),null===n&&(a=i),n},Contact:function(){var n,e,t,r,i,s,o;if(i=a,null===(n=N()))if(s=a,null!==(n=me())){for(e=[],o=a,null!==(t=$())&&null!==(r=me())?t=[t,r]:(t=null,a=o);null!==t;)e.push(t),o=a,null!==(t=$())&&null!==(r=me())?t=[t,r]:(t=null,a=o);null!==e?n=[n,e]:(n=null,a=s)}else n=null,a=s;return null!==n&&(n=function(n){var e,t;for(t=$t.multi_header.length,e=0;e<t;e++)if(null===$t.multi_header[e].parsed){$t=null;break}$t=null!==$t?$t.multi_header:-1}()),null===n&&(a=i),n},contact_param:me,name_addr:be,display_name:ve,contact_params:ye,c_p_q:_e,c_p_expires:Ce,delta_seconds:Se,qvalue:Te,generic_param:Ee,gen_value:we,Content_Disposition:function(){var n,e,t,r,i,s;if(i=a,null!==(n=ke())){for(e=[],s=a,null!==(t=H())&&null!==(r=Re())?t=[t,r]:(t=null,a=s);null!==t;)e.push(t),s=a,null!==(t=H())&&null!==(r=Re())?t=[t,r]:(t=null,a=s);null!==e?n=[n,e]:(n=null,a=i)}else n=null,a=i;return n},disp_type:ke,disp_param:Re,handling_param:Ie,Content_Encoding:function(){var n,e,t,r,i,s;if(i=a,null!==(n=P())){for(e=[],s=a,null!==(t=$())&&null!==(r=P())?t=[t,r]:(t=null,a=s);null!==t;)e.push(t),s=a,null!==(t=$())&&null!==(r=P())?t=[t,r]:(t=null,a=s);null!==e?n=[n,e]:(n=null,a=i)}else n=null,a=i;return n},Content_Length:function(){var n,e,t;if(t=a,null!==(e=d()))for(n=[];null!==e;)n.push(e),e=d();else n=null;return null!==n&&(n=void($t=parseInt(n.join("")))),null===n&&(a=t),n},Content_Type:function(){var n,e,r;return e=a,null!==(n=Ae())&&(r=e,n=void($t=t.substring(a,r))),null===n&&(a=e),n},media_type:Ae,m_type:Oe,discrete_type:Pe,composite_type:Le,extension_token:De,x_token:Ne,m_subtype:Me,m_parameter:je,m_value:xe,CSeq:function(){var n,e,t,r;return r=a,null!==(n=Ue())&&null!==(e=E())&&null!==(t=de())?n=[n,e,t]:(n=null,a=r),n},CSeq_value:Ue,Expires:function(){var n,e;return e=a,null!==(n=Se())&&(n=void($t=n)),null===n&&(a=e),n},Event:function(){var n,e,t,r,i,s,o,c;if(i=a,s=a,null!==(n=Fe())){for(e=[],o=a,null!==(t=H())&&null!==(r=Ee())?t=[t,r]:(t=null,a=o);null!==t;)e.push(t),o=a,null!==(t=H())&&null!==(r=Ee())?t=[t,r]:(t=null,a=o);null!==e?n=[n,e]:(n=null,a=s)}else n=null,a=s;return null!==n&&(c=n[0],n=void($t.event=c.join("").toLowerCase())),null===n&&(a=i),n},event_type:Fe,From:function(){var n,e,t,r,i,s,o;if(i=a,s=a,null===(n=Y())&&(n=be()),null!==n){for(e=[],o=a,null!==(t=H())&&null!==(r=Ge())?t=[t,r]:(t=null,a=o);null!==t;)e.push(t),o=a,null!==(t=H())&&null!==(r=Ge())?t=[t,r]:(t=null,a=o);null!==e?n=[n,e]:(n=null,a=s)}else n=null,a=s;return null!==n&&(n=function(n){var e=$t.tag;try{$t=new Gt($t.uri,$t.display_name,$t.params),e&&$t.setParam("tag",e)}catch(n){$t=-1}}()),null===n&&(a=i),n},from_param:Ge,tag_param:$e,Max_Forwards:function(){var n,e,t;if(t=a,null!==(e=d()))for(n=[];null!==e;)n.push(e),e=d();else n=null;return null!==n&&(n=void($t=parseInt(n.join("")))),null===n&&(a=t),n},Min_Expires:function(){var n,e;return e=a,null!==(n=Se())&&(n=void($t=n)),null===n&&(a=e),n},Name_Addr_Header:function(){var n,e,t,r,i,s,o,c,l,u;for(c=a,l=a,n=[],e=ve();null!==e;)n.push(e),e=ve();if(null!==n)if(null!==(e=G()))if(null!==(t=X()))if(null!==(r=F())){for(i=[],u=a,null!==(s=H())&&null!==(o=Ee())?s=[s,o]:(s=null,a=u);null!==s;)i.push(s),u=a,null!==(s=H())&&null!==(o=Ee())?s=[s,o]:(s=null,a=u);null!==i?n=[n,e,t,r,i]:(n=null,a=l)}else n=null,a=l;else n=null,a=l;else n=null,a=l;else n=null,a=l;return null!==n&&(n=function(n){try{$t=new Gt($t.uri,$t.display_name,$t.params)}catch(n){$t=-1}}()),null===n&&(a=c),n},Proxy_Authenticate:function(){return He()},challenge:He,other_challenge:Be,auth_param:qe,digest_cln:Ve,realm:We,realm_value:ze,domain:Ke,URI:Je,nonce:Qe,nonce_value:Ye,opaque:Xe,stale:Ze,algorithm:nt,qop_options:et,qop_value:tt,Proxy_Require:function(){var n,e,t,r,i,s;if(i=a,null!==(n=P())){for(e=[],s=a,null!==(t=$())&&null!==(r=P())?t=[t,r]:(t=null,a=s);null!==t;)e.push(t),s=a,null!==(t=$())&&null!==(r=P())?t=[t,r]:(t=null,a=s);null!==e?n=[n,e]:(n=null,a=i)}else n=null,a=i;return n},Record_Route:function(){var n,e,t,r,i,s,o;if(i=a,s=a,null!==(n=rt())){for(e=[],o=a,null!==(t=$())&&null!==(r=rt())?t=[t,r]:(t=null,a=o);null!==t;)e.push(t),o=a,null!==(t=$())&&null!==(r=rt())?t=[t,r]:(t=null,a=o);null!==e?n=[n,e]:(n=null,a=s)}else n=null,a=s;return null!==n&&(n=function(n){var e,t;for(t=$t.multi_header.length,e=0;e<t;e++)if(null===$t.multi_header[e].parsed){$t=null;break}$t=null!==$t?$t.multi_header:-1}()),null===n&&(a=i),n},rec_route:rt,Reason:function(){var n,e,r,i,o,c,u;if(o=a,c=a,"sip"===t.substr(a,3).toLowerCase()?(n=t.substr(a,3),a+=3):(n=null,0===s&&l('"SIP"')),null===n&&(n=P()),null!==n){for(e=[],u=a,null!==(r=H())&&null!==(i=it())?r=[r,i]:(r=null,a=u);null!==r;)e.push(r),u=a,null!==(r=H())&&null!==(i=it())?r=[r,i]:(r=null,a=u);null!==e?n=[n,e]:(n=null,a=c)}else n=null,a=c;return null!==n&&(n=function(n,e){if($t.protocol=e.toLowerCase(),$t.params||($t.params={}),$t.params.text&&'"'===$t.params.text[0]){var t=$t.params.text;$t.text=t.substring(1,t.length-1),delete $t.params.text}}(0,n[0])),null===n&&(a=o),n},reason_param:it,reason_cause:at,Require:function(){var n,e,t,r,i,s;if(i=a,null!==(n=P())){for(e=[],s=a,null!==(t=$())&&null!==(r=P())?t=[t,r]:(t=null,a=s);null!==t;)e.push(t),s=a,null!==(t=$())&&null!==(r=P())?t=[t,r]:(t=null,a=s);null!==e?n=[n,e]:(n=null,a=i)}else n=null,a=i;return n},Route:function(){var n,e,t,r,i,s;if(i=a,null!==(n=st())){for(e=[],s=a,null!==(t=$())&&null!==(r=st())?t=[t,r]:(t=null,a=s);null!==t;)e.push(t),s=a,null!==(t=$())&&null!==(r=st())?t=[t,r]:(t=null,a=s);null!==e?n=[n,e]:(n=null,a=i)}else n=null,a=i;return n},route_param:st,Subscription_State:function(){var n,e,t,r,i,s;if(i=a,null!==(n=ot())){for(e=[],s=a,null!==(t=H())&&null!==(r=ct())?t=[t,r]:(t=null,a=s);null!==t;)e.push(t),s=a,null!==(t=H())&&null!==(r=ct())?t=[t,r]:(t=null,a=s);null!==e?n=[n,e]:(n=null,a=i)}else n=null,a=i;return n},substate_value:ot,subexp_params:ct,event_reason_value:lt,Subject:function(){var n;return null!==(n=R())?n:""},Supported:function(){var n,e,t,r,i,s;if(i=a,null!==(n=P())){for(e=[],s=a,null!==(t=$())&&null!==(r=P())?t=[t,r]:(t=null,a=s);null!==t;)e.push(t),s=a,null!==(t=$())&&null!==(r=P())?t=[t,r]:(t=null,a=s);null!==e?n=[n,e]:(n=null,a=i)}else n=null,a=i;return null!==n?n:""},To:function(){var n,e,t,r,i,s,o;if(i=a,s=a,null===(n=Y())&&(n=be()),null!==n){for(e=[],o=a,null!==(t=H())&&null!==(r=ut())?t=[t,r]:(t=null,a=o);null!==t;)e.push(t),o=a,null!==(t=H())&&null!==(r=ut())?t=[t,r]:(t=null,a=o);null!==e?n=[n,e]:(n=null,a=s)}else n=null,a=s;return null!==n&&(n=function(n){var e=$t.tag;try{$t=new Gt($t.uri,$t.display_name,$t.params),e&&$t.setParam("tag",e)}catch(n){$t=-1}}()),null===n&&(a=i),n},to_param:ut,Via:function(){var n,e,t,r,i,s;if(i=a,null!==(n=dt())){for(e=[],s=a,null!==(t=$())&&null!==(r=dt())?t=[t,r]:(t=null,a=s);null!==t;)e.push(t),s=a,null!==(t=$())&&null!==(r=dt())?t=[t,r]:(t=null,a=s);null!==e?n=[n,e]:(n=null,a=i)}else n=null,a=i;return n},via_param:dt,via_params:ht,via_ttl:pt,via_maddr:ft,via_received:gt,via_branch:mt,response_port:bt,rport:vt,sent_protocol:yt,protocol_name:_t,transport:Ct,sent_by:St,via_host:Tt,via_port:Et,ttl:wt,WWW_Authenticate:function(){return He()},Session_Expires:function(){var n,e,t,r,i,s;if(i=a,null!==(n=kt())){for(e=[],s=a,null!==(t=H())&&null!==(r=Rt())?t=[t,r]:(t=null,a=s);null!==t;)e.push(t),s=a,null!==(t=H())&&null!==(r=Rt())?t=[t,r]:(t=null,a=s);null!==e?n=[n,e]:(n=null,a=i)}else n=null,a=i;return n},s_e_expires:kt,s_e_params:Rt,s_e_refresher:It,extension_header:function(){var n,e,t,r;return r=a,null!==(n=P())&&null!==(e=k())&&null!==(t=At())?n=[n,e,t]:(n=null,a=r),n},header_value:At,message_body:function(){var n,e;for(n=[],e=g();null!==e;)n.push(e),e=g();return n},uuid_URI:function(){var n,e,r;return r=a,"uuid:"===t.substr(a,5)?(n="uuid:",a+=5):(n=null,0===s&&l('"uuid:"')),null!==n&&null!==(e=Ot())?n=[n,e]:(n=null,a=r),n},uuid:Ot,hex4:Pt,hex8:Lt,hex12:Dt,Refer_To:function(){var n,e,t,r,i,s,o;if(i=a,s=a,null===(n=Y())&&(n=be()),null!==n){for(e=[],o=a,null!==(t=H())&&null!==(r=Ee())?t=[t,r]:(t=null,a=o);null!==t;)e.push(t),o=a,null!==(t=H())&&null!==(r=Ee())?t=[t,r]:(t=null,a=o);null!==e?n=[n,e]:(n=null,a=s)}else n=null,a=s;return null!==n&&(n=function(n){try{$t=new Gt($t.uri,$t.display_name,$t.params)}catch(n){$t=-1}}()),null===n&&(a=i),n},Replaces:function(){var n,e,t,r,i,s;if(i=a,null!==(n=Nt())){for(e=[],s=a,null!==(t=H())&&null!==(r=Mt())?t=[t,r]:(t=null,a=s);null!==t;)e.push(t),s=a,null!==(t=H())&&null!==(r=Mt())?t=[t,r]:(t=null,a=s);null!==e?n=[n,e]:(n=null,a=i)}else n=null,a=i;return n},call_id:Nt,replaces_param:Mt,to_tag:jt,from_tag:xt,early_flag:Ut};if(void 0!==r){if(void 0===i[r])throw new Error("Invalid rule name: "+e(r)+".")}else r="CRLF";var a=0,s=0,o=0,c=[];function l(n){a<o||(a>o&&(o=a,c=[]),c.push(n))}function u(){var n;return"\r\n"===t.substr(a,2)?(n="\r\n",a+=2):(n=null,0===s&&l('"\\r\\n"')),n}function d(){var n;return/^[0-9]/.test(t.charAt(a))?(n=t.charAt(a),a++):(n=null,0===s&&l("[0-9]")),n}function h(){var n;return/^[a-zA-Z]/.test(t.charAt(a))?(n=t.charAt(a),a++):(n=null,0===s&&l("[a-zA-Z]")),n}function p(){var n;return/^[0-9a-fA-F]/.test(t.charAt(a))?(n=t.charAt(a),a++):(n=null,0===s&&l("[0-9a-fA-F]")),n}function f(){var n;return null===(n=b())&&(n=v()),n}function g(){var n;return/^[\0-\xFF]/.test(t.charAt(a))?(n=t.charAt(a),a++):(n=null,0===s&&l("[\\0-\\xFF]")),n}function m(){var n;return/^["]/.test(t.charAt(a))?(n=t.charAt(a),a++):(n=null,0===s&&l('["]')),n}function b(){var n;return 32===t.charCodeAt(a)?(n=" ",a++):(n=null,0===s&&l('" "')),n}function v(){var n;return 9===t.charCodeAt(a)?(n="\t",a++):(n=null,0===s&&l('"\\t"')),n}function y(){var n;return/^[a-zA-Z0-9]/.test(t.charAt(a))?(n=t.charAt(a),a++):(n=null,0===s&&l("[a-zA-Z0-9]")),n}function _(){var n;return 59===t.charCodeAt(a)?(n=";",a++):(n=null,0===s&&l('";"')),null===n&&(47===t.charCodeAt(a)?(n="/",a++):(n=null,0===s&&l('"/"')),null===n&&(63===t.charCodeAt(a)?(n="?",a++):(n=null,0===s&&l('"?"')),null===n&&(58===t.charCodeAt(a)?(n=":",a++):(n=null,0===s&&l('":"')),null===n&&(64===t.charCodeAt(a)?(n="@",a++):(n=null,0===s&&l('"@"')),null===n&&(38===t.charCodeAt(a)?(n="&",a++):(n=null,0===s&&l('"&"')),null===n&&(61===t.charCodeAt(a)?(n="=",a++):(n=null,0===s&&l('"="')),null===n&&(43===t.charCodeAt(a)?(n="+",a++):(n=null,0===s&&l('"+"')),null===n&&(36===t.charCodeAt(a)?(n="$",a++):(n=null,0===s&&l('"$"')),null===n&&(44===t.charCodeAt(a)?(n=",",a++):(n=null,0===s&&l('","'))))))))))),n}function C(){var n;return null===(n=y())&&(n=S()),n}function S(){var n;return 45===t.charCodeAt(a)?(n="-",a++):(n=null,0===s&&l('"-"')),null===n&&(95===t.charCodeAt(a)?(n="_",a++):(n=null,0===s&&l('"_"')),null===n&&(46===t.charCodeAt(a)?(n=".",a++):(n=null,0===s&&l('"."')),null===n&&(33===t.charCodeAt(a)?(n="!",a++):(n=null,0===s&&l('"!"')),null===n&&(126===t.charCodeAt(a)?(n="~",a++):(n=null,0===s&&l('"~"')),null===n&&(42===t.charCodeAt(a)?(n="*",a++):(n=null,0===s&&l('"*"')),null===n&&(39===t.charCodeAt(a)?(n="'",a++):(n=null,0===s&&l('"\'"')),null===n&&(40===t.charCodeAt(a)?(n="(",a++):(n=null,0===s&&l('"("')),null===n&&(41===t.charCodeAt(a)?(n=")",a++):(n=null,0===s&&l('")"')))))))))),n}function T(){var n,e,r,i,o;return i=a,o=a,37===t.charCodeAt(a)?(n="%",a++):(n=null,0===s&&l('"%"')),null!==n&&null!==(e=p())&&null!==(r=p())?n=[n,e,r]:(n=null,a=o),null!==n&&(n=n.join("")),null===n&&(a=i),n}function E(){var n,e,t,r,i,s;for(r=a,i=a,s=a,n=[],e=f();null!==e;)n.push(e),e=f();if(null!==n&&null!==(e=u())?n=[n,e]:(n=null,a=s),null!==(n=null!==n?n:"")){if(null!==(t=f()))for(e=[];null!==t;)e.push(t),t=f();else e=null;null!==e?n=[n,e]:(n=null,a=i)}else n=null,a=i;return null!==n&&(n=" "),null===n&&(a=r),n}function w(){var n;return null!==(n=E())?n:""}function k(){var n,e,r,i,o;for(i=a,o=a,n=[],null===(e=b())&&(e=v());null!==e;)n.push(e),null===(e=b())&&(e=v());return null!==n?(58===t.charCodeAt(a)?(e=":",a++):(e=null,0===s&&l('":"')),null!==e&&null!==(r=w())?n=[n,e,r]:(n=null,a=o)):(n=null,a=o),null!==n&&(n=":"),null===n&&(a=i),n}function R(){var n,e,r,i,s,o,c,l;if(s=a,o=a,null!==(e=I()))for(n=[];null!==e;)n.push(e),e=I();else n=null;if(null!==n){for(e=[],c=a,r=[],i=E();null!==i;)r.push(i),i=E();for(null!==r&&null!==(i=I())?r=[r,i]:(r=null,a=c);null!==r;){for(e.push(r),c=a,r=[],i=E();null!==i;)r.push(i),i=E();null!==r&&null!==(i=I())?r=[r,i]:(r=null,a=c)}null!==e?n=[n,e]:(n=null,a=o)}else n=null,a=o;return null!==n&&(l=s,n=t.substring(a,l)),null===n&&(a=s),n}function I(){var n;return/^[!-~]/.test(t.charAt(a))?(n=t.charAt(a),a++):(n=null,0===s&&l("[!-~]")),null===n&&(n=A()),n}function A(){var n;return/^[\x80-\uFFFF]/.test(t.charAt(a))?(n=t.charAt(a),a++):(n=null,0===s&&l("[\\x80-\\uFFFF]")),n}function O(){var n;return/^[\x80-\xBF]/.test(t.charAt(a))?(n=t.charAt(a),a++):(n=null,0===s&&l("[\\x80-\\xBF]")),n}function P(){var n,e,r,i;if(r=a,null===(e=y())&&(45===t.charCodeAt(a)?(e="-",a++):(e=null,0===s&&l('"-"')),null===e&&(46===t.charCodeAt(a)?(e=".",a++):(e=null,0===s&&l('"."')),null===e&&(33===t.charCodeAt(a)?(e="!",a++):(e=null,0===s&&l('"!"')),null===e&&(37===t.charCodeAt(a)?(e="%",a++):(e=null,0===s&&l('"%"')),null===e&&(42===t.charCodeAt(a)?(e="*",a++):(e=null,0===s&&l('"*"')),null===e&&(95===t.charCodeAt(a)?(e="_",a++):(e=null,0===s&&l('"_"')),null===e&&(43===t.charCodeAt(a)?(e="+",a++):(e=null,0===s&&l('"+"')),null===e&&(96===t.charCodeAt(a)?(e="`",a++):(e=null,0===s&&l('"`"')),null===e&&(39===t.charCodeAt(a)?(e="'",a++):(e=null,0===s&&l('"\'"')),null===e&&(126===t.charCodeAt(a)?(e="~",a++):(e=null,0===s&&l('"~"')))))))))))),null!==e)for(n=[];null!==e;)n.push(e),null===(e=y())&&(45===t.charCodeAt(a)?(e="-",a++):(e=null,0===s&&l('"-"')),null===e&&(46===t.charCodeAt(a)?(e=".",a++):(e=null,0===s&&l('"."')),null===e&&(33===t.charCodeAt(a)?(e="!",a++):(e=null,0===s&&l('"!"')),null===e&&(37===t.charCodeAt(a)?(e="%",a++):(e=null,0===s&&l('"%"')),null===e&&(42===t.charCodeAt(a)?(e="*",a++):(e=null,0===s&&l('"*"')),null===e&&(95===t.charCodeAt(a)?(e="_",a++):(e=null,0===s&&l('"_"')),null===e&&(43===t.charCodeAt(a)?(e="+",a++):(e=null,0===s&&l('"+"')),null===e&&(96===t.charCodeAt(a)?(e="`",a++):(e=null,0===s&&l('"`"')),null===e&&(39===t.charCodeAt(a)?(e="'",a++):(e=null,0===s&&l('"\'"')),null===e&&(126===t.charCodeAt(a)?(e="~",a++):(e=null,0===s&&l('"~"'))))))))))));else n=null;return null!==n&&(i=r,n=t.substring(a,i)),null===n&&(a=r),n}function L(){var n,e,r,i;if(r=a,null===(e=y())&&(45===t.charCodeAt(a)?(e="-",a++):(e=null,0===s&&l('"-"')),null===e&&(33===t.charCodeAt(a)?(e="!",a++):(e=null,0===s&&l('"!"')),null===e&&(37===t.charCodeAt(a)?(e="%",a++):(e=null,0===s&&l('"%"')),null===e&&(42===t.charCodeAt(a)?(e="*",a++):(e=null,0===s&&l('"*"')),null===e&&(95===t.charCodeAt(a)?(e="_",a++):(e=null,0===s&&l('"_"')),null===e&&(43===t.charCodeAt(a)?(e="+",a++):(e=null,0===s&&l('"+"')),null===e&&(96===t.charCodeAt(a)?(e="`",a++):(e=null,0===s&&l('"`"')),null===e&&(39===t.charCodeAt(a)?(e="'",a++):(e=null,0===s&&l('"\'"')),null===e&&(126===t.charCodeAt(a)?(e="~",a++):(e=null,0===s&&l('"~"'))))))))))),null!==e)for(n=[];null!==e;)n.push(e),null===(e=y())&&(45===t.charCodeAt(a)?(e="-",a++):(e=null,0===s&&l('"-"')),null===e&&(33===t.charCodeAt(a)?(e="!",a++):(e=null,0===s&&l('"!"')),null===e&&(37===t.charCodeAt(a)?(e="%",a++):(e=null,0===s&&l('"%"')),null===e&&(42===t.charCodeAt(a)?(e="*",a++):(e=null,0===s&&l('"*"')),null===e&&(95===t.charCodeAt(a)?(e="_",a++):(e=null,0===s&&l('"_"')),null===e&&(43===t.charCodeAt(a)?(e="+",a++):(e=null,0===s&&l('"+"')),null===e&&(96===t.charCodeAt(a)?(e="`",a++):(e=null,0===s&&l('"`"')),null===e&&(39===t.charCodeAt(a)?(e="'",a++):(e=null,0===s&&l('"\'"')),null===e&&(126===t.charCodeAt(a)?(e="~",a++):(e=null,0===s&&l('"~"')))))))))));else n=null;return null!==n&&(i=r,n=t.substring(a,i)),null===n&&(a=r),n}function D(){var n,e,r,i;if(r=a,null===(e=y())&&(45===t.charCodeAt(a)?(e="-",a++):(e=null,0===s&&l('"-"')),null===e&&(46===t.charCodeAt(a)?(e=".",a++):(e=null,0===s&&l('"."')),null===e&&(33===t.charCodeAt(a)?(e="!",a++):(e=null,0===s&&l('"!"')),null===e&&(37===t.charCodeAt(a)?(e="%",a++):(e=null,0===s&&l('"%"')),null===e&&(42===t.charCodeAt(a)?(e="*",a++):(e=null,0===s&&l('"*"')),null===e&&(95===t.charCodeAt(a)?(e="_",a++):(e=null,0===s&&l('"_"')),null===e&&(43===t.charCodeAt(a)?(e="+",a++):(e=null,0===s&&l('"+"')),null===e&&(96===t.charCodeAt(a)?(e="`",a++):(e=null,0===s&&l('"`"')),null===e&&(39===t.charCodeAt(a)?(e="'",a++):(e=null,0===s&&l('"\'"')),null===e&&(126===t.charCodeAt(a)?(e="~",a++):(e=null,0===s&&l('"~"')),null===e&&(40===t.charCodeAt(a)?(e="(",a++):(e=null,0===s&&l('"("')),null===e&&(41===t.charCodeAt(a)?(e=")",a++):(e=null,0===s&&l('")"')),null===e&&(60===t.charCodeAt(a)?(e="<",a++):(e=null,0===s&&l('"<"')),null===e&&(62===t.charCodeAt(a)?(e=">",a++):(e=null,0===s&&l('">"')),null===e&&(58===t.charCodeAt(a)?(e=":",a++):(e=null,0===s&&l('":"')),null===e&&(92===t.charCodeAt(a)?(e="\\",a++):(e=null,0===s&&l('"\\\\"')),null===e&&null===(e=m())&&(47===t.charCodeAt(a)?(e="/",a++):(e=null,0===s&&l('"/"')),null===e&&(91===t.charCodeAt(a)?(e="[",a++):(e=null,0===s&&l('"["')),null===e&&(93===t.charCodeAt(a)?(e="]",a++):(e=null,0===s&&l('"]"')),null===e&&(63===t.charCodeAt(a)?(e="?",a++):(e=null,0===s&&l('"?"')),null===e&&(123===t.charCodeAt(a)?(e="{",a++):(e=null,0===s&&l('"{"')),null===e&&(125===t.charCodeAt(a)?(e="}",a++):(e=null,0===s&&l('"}"')))))))))))))))))))))))),null!==e)for(n=[];null!==e;)n.push(e),null===(e=y())&&(45===t.charCodeAt(a)?(e="-",a++):(e=null,0===s&&l('"-"')),null===e&&(46===t.charCodeAt(a)?(e=".",a++):(e=null,0===s&&l('"."')),null===e&&(33===t.charCodeAt(a)?(e="!",a++):(e=null,0===s&&l('"!"')),null===e&&(37===t.charCodeAt(a)?(e="%",a++):(e=null,0===s&&l('"%"')),null===e&&(42===t.charCodeAt(a)?(e="*",a++):(e=null,0===s&&l('"*"')),null===e&&(95===t.charCodeAt(a)?(e="_",a++):(e=null,0===s&&l('"_"')),null===e&&(43===t.charCodeAt(a)?(e="+",a++):(e=null,0===s&&l('"+"')),null===e&&(96===t.charCodeAt(a)?(e="`",a++):(e=null,0===s&&l('"`"')),null===e&&(39===t.charCodeAt(a)?(e="'",a++):(e=null,0===s&&l('"\'"')),null===e&&(126===t.charCodeAt(a)?(e="~",a++):(e=null,0===s&&l('"~"')),null===e&&(40===t.charCodeAt(a)?(e="(",a++):(e=null,0===s&&l('"("')),null===e&&(41===t.charCodeAt(a)?(e=")",a++):(e=null,0===s&&l('")"')),null===e&&(60===t.charCodeAt(a)?(e="<",a++):(e=null,0===s&&l('"<"')),null===e&&(62===t.charCodeAt(a)?(e=">",a++):(e=null,0===s&&l('">"')),null===e&&(58===t.charCodeAt(a)?(e=":",a++):(e=null,0===s&&l('":"')),null===e&&(92===t.charCodeAt(a)?(e="\\",a++):(e=null,0===s&&l('"\\\\"')),null===e&&null===(e=m())&&(47===t.charCodeAt(a)?(e="/",a++):(e=null,0===s&&l('"/"')),null===e&&(91===t.charCodeAt(a)?(e="[",a++):(e=null,0===s&&l('"["')),null===e&&(93===t.charCodeAt(a)?(e="]",a++):(e=null,0===s&&l('"]"')),null===e&&(63===t.charCodeAt(a)?(e="?",a++):(e=null,0===s&&l('"?"')),null===e&&(123===t.charCodeAt(a)?(e="{",a++):(e=null,0===s&&l('"{"')),null===e&&(125===t.charCodeAt(a)?(e="}",a++):(e=null,0===s&&l('"}"'))))))))))))))))))))))));else n=null;return null!==n&&(i=r,n=t.substring(a,i)),null===n&&(a=r),n}function N(){var n,e,r,i,o;return i=a,o=a,null!==(n=w())?(42===t.charCodeAt(a)?(e="*",a++):(e=null,0===s&&l('"*"')),null!==e&&null!==(r=w())?n=[n,e,r]:(n=null,a=o)):(n=null,a=o),null!==n&&(n="*"),null===n&&(a=i),n}function M(){var n,e,r,i,o;return i=a,o=a,null!==(n=w())?(47===t.charCodeAt(a)?(e="/",a++):(e=null,0===s&&l('"/"')),null!==e&&null!==(r=w())?n=[n,e,r]:(n=null,a=o)):(n=null,a=o),null!==n&&(n="/"),null===n&&(a=i),n}function j(){var n,e,r,i,o;return i=a,o=a,null!==(n=w())?(61===t.charCodeAt(a)?(e="=",a++):(e=null,0===s&&l('"="')),null!==e&&null!==(r=w())?n=[n,e,r]:(n=null,a=o)):(n=null,a=o),null!==n&&(n="="),null===n&&(a=i),n}function x(){var n,e,r,i,o;return i=a,o=a,null!==(n=w())?(40===t.charCodeAt(a)?(e="(",a++):(e=null,0===s&&l('"("')),null!==e&&null!==(r=w())?n=[n,e,r]:(n=null,a=o)):(n=null,a=o),null!==n&&(n="("),null===n&&(a=i),n}function U(){var n,e,r,i,o;return i=a,o=a,null!==(n=w())?(41===t.charCodeAt(a)?(e=")",a++):(e=null,0===s&&l('")"')),null!==e&&null!==(r=w())?n=[n,e,r]:(n=null,a=o)):(n=null,a=o),null!==n&&(n=")"),null===n&&(a=i),n}function F(){var n,e,r,i;return r=a,i=a,62===t.charCodeAt(a)?(n=">",a++):(n=null,0===s&&l('">"')),null!==n&&null!==(e=w())?n=[n,e]:(n=null,a=i),null!==n&&(n=">"),null===n&&(a=r),n}function G(){var n,e,r,i;return r=a,i=a,null!==(n=w())?(60===t.charCodeAt(a)?(e="<",a++):(e=null,0===s&&l('"<"')),null!==e?n=[n,e]:(n=null,a=i)):(n=null,a=i),null!==n&&(n="<"),null===n&&(a=r),n}function $(){var n,e,r,i,o;return i=a,o=a,null!==(n=w())?(44===t.charCodeAt(a)?(e=",",a++):(e=null,0===s&&l('","')),null!==e&&null!==(r=w())?n=[n,e,r]:(n=null,a=o)):(n=null,a=o),null!==n&&(n=","),null===n&&(a=i),n}function H(){var n,e,r,i,o;return i=a,o=a,null!==(n=w())?(59===t.charCodeAt(a)?(e=";",a++):(e=null,0===s&&l('";"')),null!==e&&null!==(r=w())?n=[n,e,r]:(n=null,a=o)):(n=null,a=o),null!==n&&(n=";"),null===n&&(a=i),n}function B(){var n,e,r,i,o;return i=a,o=a,null!==(n=w())?(58===t.charCodeAt(a)?(e=":",a++):(e=null,0===s&&l('":"')),null!==e&&null!==(r=w())?n=[n,e,r]:(n=null,a=o)):(n=null,a=o),null!==n&&(n=":"),null===n&&(a=i),n}function q(){var n,e,t,r;return t=a,r=a,null!==(n=w())&&null!==(e=m())?n=[n,e]:(n=null,a=r),null!==n&&(n='"'),null===n&&(a=t),n}function V(){var n,e,t,r;return t=a,r=a,null!==(n=m())&&null!==(e=w())?n=[n,e]:(n=null,a=r),null!==n&&(n='"'),null===n&&(a=t),n}function W(){var n;return/^[!-']/.test(t.charAt(a))?(n=t.charAt(a),a++):(n=null,0===s&&l("[!-']")),null===n&&(/^[*-[]/.test(t.charAt(a))?(n=t.charAt(a),a++):(n=null,0===s&&l("[*-[]")),null===n&&(/^[\]-~]/.test(t.charAt(a))?(n=t.charAt(a),a++):(n=null,0===s&&l("[\\]-~]")),null===n&&null===(n=A())&&(n=E()))),n}function z(){var n,e,r,i,s,o,c;if(s=a,o=a,null!==(n=w()))if(null!==(e=m())){for(r=[],null===(i=J())&&(i=Q());null!==i;)r.push(i),null===(i=J())&&(i=Q());null!==r&&null!==(i=m())?n=[n,e,r,i]:(n=null,a=o)}else n=null,a=o;else n=null,a=o;return null!==n&&(c=s,n=t.substring(a,c)),null===n&&(a=s),n}function K(){var n,e,r,i,s,o,c,l;if(s=a,o=a,null!==(n=w()))if(null!==(e=m())){for(r=[],null===(i=J())&&(i=Q());null!==i;)r.push(i),null===(i=J())&&(i=Q());null!==r&&null!==(i=m())?n=[n,e,r,i]:(n=null,a=o)}else n=null,a=o;else n=null,a=o;return null!==n&&(c=s,n=(l=t.substring(a,c).trim()).substring(1,l.length-1).replace(/\\([\x00-\x09\x0b-\x0c\x0e-\x7f])/g,"$1")),null===n&&(a=s),n}function J(){var n;return null===(n=E())&&(33===t.charCodeAt(a)?(n="!",a++):(n=null,0===s&&l('"!"')),null===n&&(/^[#-[]/.test(t.charAt(a))?(n=t.charAt(a),a++):(n=null,0===s&&l("[#-[]")),null===n&&(/^[\]-~]/.test(t.charAt(a))?(n=t.charAt(a),a++):(n=null,0===s&&l("[\\]-~]")),null===n&&(n=A())))),n}function Q(){var n,e,r;return r=a,92===t.charCodeAt(a)?(n="\\",a++):(n=null,0===s&&l('"\\\\"')),null!==n?(/^[\0-\t]/.test(t.charAt(a))?(e=t.charAt(a),a++):(e=null,0===s&&l("[\\0-\\t]")),null===e&&(/^[\x0B-\f]/.test(t.charAt(a))?(e=t.charAt(a),a++):(e=null,0===s&&l("[\\x0B-\\f]")),null===e&&(/^[\x0E-]/.test(t.charAt(a))?(e=t.charAt(a),a++):(e=null,0===s&&l("[\\x0E-]")))),null!==e?n=[n,e]:(n=null,a=r)):(n=null,a=r),n}function Y(){var n,e,r,i,o,c;return o=a,c=a,null!==(n=Z())?(58===t.charCodeAt(a)?(e=":",a++):(e=null,0===s&&l('":"')),null!==e&&null!==(r=null!==(r=tn())?r:"")&&null!==(i=on())?n=[n,e,r,i]:(n=null,a=c)):(n=null,a=c),null!==n&&(n=function(n){try{$t.uri=new Ft($t.scheme,$t.user,$t.host,$t.port),delete $t.scheme,delete $t.user,delete $t.host,delete $t.host_type,delete $t.port}catch(n){$t=-1}}()),null===n&&(a=o),n}function X(){var n,e,i,o,c,u,d,h;return d=a,h=a,null!==(n=Z())?(58===t.charCodeAt(a)?(e=":",a++):(e=null,0===s&&l('":"')),null!==e&&null!==(i=null!==(i=tn())?i:"")&&null!==(o=on())&&null!==(c=yn())&&null!==(u=null!==(u=Ln())?u:"")?n=[n,e,i,o,c,u]:(n=null,a=h)):(n=null,a=h),null!==n&&(n=function(n){try{$t.uri=new Ft($t.scheme,$t.user,$t.host,$t.port,$t.uri_params,$t.uri_headers),delete $t.scheme,delete $t.user,delete $t.host,delete $t.host_type,delete $t.port,delete $t.uri_params,"SIP_URI"===r&&($t=$t.uri)}catch(n){$t=-1}}()),null===n&&(a=d),n}function Z(){var n;return null===(n=nn())&&(n=en()),n}function nn(){var n,e,r;return e=a,"sips"===t.substr(a,4).toLowerCase()?(n=t.substr(a,4),a+=4):(n=null,0===s&&l('"sips"')),null!==n&&(r=n,n=void($t.scheme=r.toLowerCase())),null===n&&(a=e),n}function en(){var n,e,r;return e=a,"sip"===t.substr(a,3).toLowerCase()?(n=t.substr(a,3),a+=3):(n=null,0===s&&l('"sip"')),null!==n&&(r=n,n=void($t.scheme=r.toLowerCase())),null===n&&(a=e),n}function tn(){var n,e,r,i,o,c,u;return i=a,o=a,null!==(n=rn())?(c=a,58===t.charCodeAt(a)?(e=":",a++):(e=null,0===s&&l('":"')),null!==e&&null!==(r=sn())?e=[e,r]:(e=null,a=c),null!==(e=null!==e?e:"")?(64===t.charCodeAt(a)?(r="@",a++):(r=null,0===s&&l('"@"')),null!==r?n=[n,e,r]:(n=null,a=o)):(n=null,a=o)):(n=null,a=o),null!==n&&(u=i,n=void($t.user=decodeURIComponent(t.substring(a-1,u)))),null===n&&(a=i),n}function rn(){var n,e;if(null===(e=C())&&null===(e=T())&&(e=an()),null!==e)for(n=[];null!==e;)n.push(e),null===(e=C())&&null===(e=T())&&(e=an());else n=null;return n}function an(){var n;return 38===t.charCodeAt(a)?(n="&",a++):(n=null,0===s&&l('"&"')),null===n&&(61===t.charCodeAt(a)?(n="=",a++):(n=null,0===s&&l('"="')),null===n&&(43===t.charCodeAt(a)?(n="+",a++):(n=null,0===s&&l('"+"')),null===n&&(36===t.charCodeAt(a)?(n="$",a++):(n=null,0===s&&l('"$"')),null===n&&(44===t.charCodeAt(a)?(n=",",a++):(n=null,0===s&&l('","')),null===n&&(59===t.charCodeAt(a)?(n=";",a++):(n=null,0===s&&l('";"')),null===n&&(63===t.charCodeAt(a)?(n="?",a++):(n=null,0===s&&l('"?"')),null===n&&(47===t.charCodeAt(a)?(n="/",a++):(n=null,0===s&&l('"/"'))))))))),n}function sn(){var n,e,r,i;for(r=a,n=[],null===(e=C())&&null===(e=T())&&(38===t.charCodeAt(a)?(e="&",a++):(e=null,0===s&&l('"&"')),null===e&&(61===t.charCodeAt(a)?(e="=",a++):(e=null,0===s&&l('"="')),null===e&&(43===t.charCodeAt(a)?(e="+",a++):(e=null,0===s&&l('"+"')),null===e&&(36===t.charCodeAt(a)?(e="$",a++):(e=null,0===s&&l('"$"')),null===e&&(44===t.charCodeAt(a)?(e=",",a++):(e=null,0===s&&l('","')))))));null!==e;)n.push(e),null===(e=C())&&null===(e=T())&&(38===t.charCodeAt(a)?(e="&",a++):(e=null,0===s&&l('"&"')),null===e&&(61===t.charCodeAt(a)?(e="=",a++):(e=null,0===s&&l('"="')),null===e&&(43===t.charCodeAt(a)?(e="+",a++):(e=null,0===s&&l('"+"')),null===e&&(36===t.charCodeAt(a)?(e="$",a++):(e=null,0===s&&l('"$"')),null===e&&(44===t.charCodeAt(a)?(e=",",a++):(e=null,0===s&&l('","')))))));return null!==n&&(i=r,n=void($t.password=t.substring(a,i))),null===n&&(a=r),n}function on(){var n,e,r,i,o;return i=a,null!==(n=cn())?(o=a,58===t.charCodeAt(a)?(e=":",a++):(e=null,0===s&&l('":"')),null!==e&&null!==(r=vn())?e=[e,r]:(e=null,a=o),null!==(e=null!==e?e:"")?n=[n,e]:(n=null,a=i)):(n=null,a=i),n}function cn(){var n,e,r;return e=a,null===(n=ln())&&null===(n=mn())&&(n=hn()),null!==n&&(r=e,$t.host=t.substring(a,r).toLowerCase(),n=$t.host),null===n&&(a=e),n}function ln(){var n,e,r,i,o,c,u;for(i=a,o=a,n=[],c=a,null!==(e=un())?(46===t.charCodeAt(a)?(r=".",a++):(r=null,0===s&&l('"."')),null!==r?e=[e,r]:(e=null,a=c)):(e=null,a=c);null!==e;)n.push(e),c=a,null!==(e=un())?(46===t.charCodeAt(a)?(r=".",a++):(r=null,0===s&&l('"."')),null!==r?e=[e,r]:(e=null,a=c)):(e=null,a=c);return null!==n&&null!==(e=dn())?(46===t.charCodeAt(a)?(r=".",a++):(r=null,0===s&&l('"."')),null!==(r=null!==r?r:"")?n=[n,e,r]:(n=null,a=o)):(n=null,a=o),null!==n&&(u=i,$t.host_type="domain",n=t.substring(a,u)),null===n&&(a=i),n}function un(){var n,e,r,i;if(i=a,null!==(n=y())){for(e=[],null===(r=y())&&(45===t.charCodeAt(a)?(r="-",a++):(r=null,0===s&&l('"-"')),null===r&&(95===t.charCodeAt(a)?(r="_",a++):(r=null,0===s&&l('"_"'))));null!==r;)e.push(r),null===(r=y())&&(45===t.charCodeAt(a)?(r="-",a++):(r=null,0===s&&l('"-"')),null===r&&(95===t.charCodeAt(a)?(r="_",a++):(r=null,0===s&&l('"_"'))));null!==e?n=[n,e]:(n=null,a=i)}else n=null,a=i;return n}function dn(){var n,e,r,i;if(i=a,null!==(n=h())){for(e=[],null===(r=y())&&(45===t.charCodeAt(a)?(r="-",a++):(r=null,0===s&&l('"-"')),null===r&&(95===t.charCodeAt(a)?(r="_",a++):(r=null,0===s&&l('"_"'))));null!==r;)e.push(r),null===(r=y())&&(45===t.charCodeAt(a)?(r="-",a++):(r=null,0===s&&l('"-"')),null===r&&(95===t.charCodeAt(a)?(r="_",a++):(r=null,0===s&&l('"_"'))));null!==e?n=[n,e]:(n=null,a=i)}else n=null,a=i;return n}function hn(){var n,e,r,i,o,c;return i=a,o=a,91===t.charCodeAt(a)?(n="[",a++):(n=null,0===s&&l('"["')),null!==n&&null!==(e=pn())?(93===t.charCodeAt(a)?(r="]",a++):(r=null,0===s&&l('"]"')),null!==r?n=[n,e,r]:(n=null,a=o)):(n=null,a=o),null!==n&&(c=i,$t.host_type="IPv6",n=t.substring(a,c)),null===n&&(a=i),n}function pn(){var n,e,r,i,o,c,u,d,h,p,f,g,m,b,v,y,_;return b=a,v=a,null!==(n=fn())?(58===t.charCodeAt(a)?(e=":",a++):(e=null,0===s&&l('":"')),null!==e&&null!==(r=fn())?(58===t.charCodeAt(a)?(i=":",a++):(i=null,0===s&&l('":"')),null!==i&&null!==(o=fn())?(58===t.charCodeAt(a)?(c=":",a++):(c=null,0===s&&l('":"')),null!==c&&null!==(u=fn())?(58===t.charCodeAt(a)?(d=":",a++):(d=null,0===s&&l('":"')),null!==d&&null!==(h=fn())?(58===t.charCodeAt(a)?(p=":",a++):(p=null,0===s&&l('":"')),null!==p&&null!==(f=fn())?(58===t.charCodeAt(a)?(g=":",a++):(g=null,0===s&&l('":"')),null!==g&&null!==(m=gn())?n=[n,e,r,i,o,c,u,d,h,p,f,g,m]:(n=null,a=v)):(n=null,a=v)):(n=null,a=v)):(n=null,a=v)):(n=null,a=v)):(n=null,a=v)):(n=null,a=v),null===n&&(v=a,"::"===t.substr(a,2)?(n="::",a+=2):(n=null,0===s&&l('"::"')),null!==n&&null!==(e=fn())?(58===t.charCodeAt(a)?(r=":",a++):(r=null,0===s&&l('":"')),null!==r&&null!==(i=fn())?(58===t.charCodeAt(a)?(o=":",a++):(o=null,0===s&&l('":"')),null!==o&&null!==(c=fn())?(58===t.charCodeAt(a)?(u=":",a++):(u=null,0===s&&l('":"')),null!==u&&null!==(d=fn())?(58===t.charCodeAt(a)?(h=":",a++):(h=null,0===s&&l('":"')),null!==h&&null!==(p=fn())?(58===t.charCodeAt(a)?(f=":",a++):(f=null,0===s&&l('":"')),null!==f&&null!==(g=gn())?n=[n,e,r,i,o,c,u,d,h,p,f,g]:(n=null,a=v)):(n=null,a=v)):(n=null,a=v)):(n=null,a=v)):(n=null,a=v)):(n=null,a=v),null===n&&(v=a,"::"===t.substr(a,2)?(n="::",a+=2):(n=null,0===s&&l('"::"')),null!==n&&null!==(e=fn())?(58===t.charCodeAt(a)?(r=":",a++):(r=null,0===s&&l('":"')),null!==r&&null!==(i=fn())?(58===t.charCodeAt(a)?(o=":",a++):(o=null,0===s&&l('":"')),null!==o&&null!==(c=fn())?(58===t.charCodeAt(a)?(u=":",a++):(u=null,0===s&&l('":"')),null!==u&&null!==(d=fn())?(58===t.charCodeAt(a)?(h=":",a++):(h=null,0===s&&l('":"')),null!==h&&null!==(p=gn())?n=[n,e,r,i,o,c,u,d,h,p]:(n=null,a=v)):(n=null,a=v)):(n=null,a=v)):(n=null,a=v)):(n=null,a=v),null===n&&(v=a,"::"===t.substr(a,2)?(n="::",a+=2):(n=null,0===s&&l('"::"')),null!==n&&null!==(e=fn())?(58===t.charCodeAt(a)?(r=":",a++):(r=null,0===s&&l('":"')),null!==r&&null!==(i=fn())?(58===t.charCodeAt(a)?(o=":",a++):(o=null,0===s&&l('":"')),null!==o&&null!==(c=fn())?(58===t.charCodeAt(a)?(u=":",a++):(u=null,0===s&&l('":"')),null!==u&&null!==(d=gn())?n=[n,e,r,i,o,c,u,d]:(n=null,a=v)):(n=null,a=v)):(n=null,a=v)):(n=null,a=v),null===n&&(v=a,"::"===t.substr(a,2)?(n="::",a+=2):(n=null,0===s&&l('"::"')),null!==n&&null!==(e=fn())?(58===t.charCodeAt(a)?(r=":",a++):(r=null,0===s&&l('":"')),null!==r&&null!==(i=fn())?(58===t.charCodeAt(a)?(o=":",a++):(o=null,0===s&&l('":"')),null!==o&&null!==(c=gn())?n=[n,e,r,i,o,c]:(n=null,a=v)):(n=null,a=v)):(n=null,a=v),null===n&&(v=a,"::"===t.substr(a,2)?(n="::",a+=2):(n=null,0===s&&l('"::"')),null!==n&&null!==(e=fn())?(58===t.charCodeAt(a)?(r=":",a++):(r=null,0===s&&l('":"')),null!==r&&null!==(i=gn())?n=[n,e,r,i]:(n=null,a=v)):(n=null,a=v),null===n&&(v=a,"::"===t.substr(a,2)?(n="::",a+=2):(n=null,0===s&&l('"::"')),null!==n&&null!==(e=gn())?n=[n,e]:(n=null,a=v),null===n&&(v=a,"::"===t.substr(a,2)?(n="::",a+=2):(n=null,0===s&&l('"::"')),null!==n&&null!==(e=fn())?n=[n,e]:(n=null,a=v),null===n&&(v=a,null!==(n=fn())?("::"===t.substr(a,2)?(e="::",a+=2):(e=null,0===s&&l('"::"')),null!==e&&null!==(r=fn())?(58===t.charCodeAt(a)?(i=":",a++):(i=null,0===s&&l('":"')),null!==i&&null!==(o=fn())?(58===t.charCodeAt(a)?(c=":",a++):(c=null,0===s&&l('":"')),null!==c&&null!==(u=fn())?(58===t.charCodeAt(a)?(d=":",a++):(d=null,0===s&&l('":"')),null!==d&&null!==(h=fn())?(58===t.charCodeAt(a)?(p=":",a++):(p=null,0===s&&l('":"')),null!==p&&null!==(f=gn())?n=[n,e,r,i,o,c,u,d,h,p,f]:(n=null,a=v)):(n=null,a=v)):(n=null,a=v)):(n=null,a=v)):(n=null,a=v)):(n=null,a=v),null===n&&(v=a,null!==(n=fn())?(y=a,58===t.charCodeAt(a)?(e=":",a++):(e=null,0===s&&l('":"')),null!==e&&null!==(r=fn())?e=[e,r]:(e=null,a=y),null!==(e=null!==e?e:"")?("::"===t.substr(a,2)?(r="::",a+=2):(r=null,0===s&&l('"::"')),null!==r&&null!==(i=fn())?(58===t.charCodeAt(a)?(o=":",a++):(o=null,0===s&&l('":"')),null!==o&&null!==(c=fn())?(58===t.charCodeAt(a)?(u=":",a++):(u=null,0===s&&l('":"')),null!==u&&null!==(d=fn())?(58===t.charCodeAt(a)?(h=":",a++):(h=null,0===s&&l('":"')),null!==h&&null!==(p=gn())?n=[n,e,r,i,o,c,u,d,h,p]:(n=null,a=v)):(n=null,a=v)):(n=null,a=v)):(n=null,a=v)):(n=null,a=v)):(n=null,a=v),null===n&&(v=a,null!==(n=fn())?(y=a,58===t.charCodeAt(a)?(e=":",a++):(e=null,0===s&&l('":"')),null!==e&&null!==(r=fn())?e=[e,r]:(e=null,a=y),null!==(e=null!==e?e:"")?(y=a,58===t.charCodeAt(a)?(r=":",a++):(r=null,0===s&&l('":"')),null!==r&&null!==(i=fn())?r=[r,i]:(r=null,a=y),null!==(r=null!==r?r:"")?("::"===t.substr(a,2)?(i="::",a+=2):(i=null,0===s&&l('"::"')),null!==i&&null!==(o=fn())?(58===t.charCodeAt(a)?(c=":",a++):(c=null,0===s&&l('":"')),null!==c&&null!==(u=fn())?(58===t.charCodeAt(a)?(d=":",a++):(d=null,0===s&&l('":"')),null!==d&&null!==(h=gn())?n=[n,e,r,i,o,c,u,d,h]:(n=null,a=v)):(n=null,a=v)):(n=null,a=v)):(n=null,a=v)):(n=null,a=v)):(n=null,a=v),null===n&&(v=a,null!==(n=fn())?(y=a,58===t.charCodeAt(a)?(e=":",a++):(e=null,0===s&&l('":"')),null!==e&&null!==(r=fn())?e=[e,r]:(e=null,a=y),null!==(e=null!==e?e:"")?(y=a,58===t.charCodeAt(a)?(r=":",a++):(r=null,0===s&&l('":"')),null!==r&&null!==(i=fn())?r=[r,i]:(r=null,a=y),null!==(r=null!==r?r:"")?(y=a,58===t.charCodeAt(a)?(i=":",a++):(i=null,0===s&&l('":"')),null!==i&&null!==(o=fn())?i=[i,o]:(i=null,a=y),null!==(i=null!==i?i:"")?("::"===t.substr(a,2)?(o="::",a+=2):(o=null,0===s&&l('"::"')),null!==o&&null!==(c=fn())?(58===t.charCodeAt(a)?(u=":",a++):(u=null,0===s&&l('":"')),null!==u&&null!==(d=gn())?n=[n,e,r,i,o,c,u,d]:(n=null,a=v)):(n=null,a=v)):(n=null,a=v)):(n=null,a=v)):(n=null,a=v)):(n=null,a=v),null===n&&(v=a,null!==(n=fn())?(y=a,58===t.charCodeAt(a)?(e=":",a++):(e=null,0===s&&l('":"')),null!==e&&null!==(r=fn())?e=[e,r]:(e=null,a=y),null!==(e=null!==e?e:"")?(y=a,58===t.charCodeAt(a)?(r=":",a++):(r=null,0===s&&l('":"')),null!==r&&null!==(i=fn())?r=[r,i]:(r=null,a=y),null!==(r=null!==r?r:"")?(y=a,58===t.charCodeAt(a)?(i=":",a++):(i=null,0===s&&l('":"')),null!==i&&null!==(o=fn())?i=[i,o]:(i=null,a=y),null!==(i=null!==i?i:"")?(y=a,58===t.charCodeAt(a)?(o=":",a++):(o=null,0===s&&l('":"')),null!==o&&null!==(c=fn())?o=[o,c]:(o=null,a=y),null!==(o=null!==o?o:"")?("::"===t.substr(a,2)?(c="::",a+=2):(c=null,0===s&&l('"::"')),null!==c&&null!==(u=gn())?n=[n,e,r,i,o,c,u]:(n=null,a=v)):(n=null,a=v)):(n=null,a=v)):(n=null,a=v)):(n=null,a=v)):(n=null,a=v),null===n&&(v=a,null!==(n=fn())?(y=a,58===t.charCodeAt(a)?(e=":",a++):(e=null,0===s&&l('":"')),null!==e&&null!==(r=fn())?e=[e,r]:(e=null,a=y),null!==(e=null!==e?e:"")?(y=a,58===t.charCodeAt(a)?(r=":",a++):(r=null,0===s&&l('":"')),null!==r&&null!==(i=fn())?r=[r,i]:(r=null,a=y),null!==(r=null!==r?r:"")?(y=a,58===t.charCodeAt(a)?(i=":",a++):(i=null,0===s&&l('":"')),null!==i&&null!==(o=fn())?i=[i,o]:(i=null,a=y),null!==(i=null!==i?i:"")?(y=a,58===t.charCodeAt(a)?(o=":",a++):(o=null,0===s&&l('":"')),null!==o&&null!==(c=fn())?o=[o,c]:(o=null,a=y),null!==(o=null!==o?o:"")?(y=a,58===t.charCodeAt(a)?(c=":",a++):(c=null,0===s&&l('":"')),null!==c&&null!==(u=fn())?c=[c,u]:(c=null,a=y),null!==(c=null!==c?c:"")?("::"===t.substr(a,2)?(u="::",a+=2):(u=null,0===s&&l('"::"')),null!==u&&null!==(d=fn())?n=[n,e,r,i,o,c,u,d]:(n=null,a=v)):(n=null,a=v)):(n=null,a=v)):(n=null,a=v)):(n=null,a=v)):(n=null,a=v)):(n=null,a=v),null===n&&(v=a,null!==(n=fn())?(y=a,58===t.charCodeAt(a)?(e=":",a++):(e=null,0===s&&l('":"')),null!==e&&null!==(r=fn())?e=[e,r]:(e=null,a=y),null!==(e=null!==e?e:"")?(y=a,58===t.charCodeAt(a)?(r=":",a++):(r=null,0===s&&l('":"')),null!==r&&null!==(i=fn())?r=[r,i]:(r=null,a=y),null!==(r=null!==r?r:"")?(y=a,58===t.charCodeAt(a)?(i=":",a++):(i=null,0===s&&l('":"')),null!==i&&null!==(o=fn())?i=[i,o]:(i=null,a=y),null!==(i=null!==i?i:"")?(y=a,58===t.charCodeAt(a)?(o=":",a++):(o=null,0===s&&l('":"')),null!==o&&null!==(c=fn())?o=[o,c]:(o=null,a=y),null!==(o=null!==o?o:"")?(y=a,58===t.charCodeAt(a)?(c=":",a++):(c=null,0===s&&l('":"')),null!==c&&null!==(u=fn())?c=[c,u]:(c=null,a=y),null!==(c=null!==c?c:"")?(y=a,58===t.charCodeAt(a)?(u=":",a++):(u=null,0===s&&l('":"')),null!==u&&null!==(d=fn())?u=[u,d]:(u=null,a=y),null!==(u=null!==u?u:"")?("::"===t.substr(a,2)?(d="::",a+=2):(d=null,0===s&&l('"::"')),null!==d?n=[n,e,r,i,o,c,u,d]:(n=null,a=v)):(n=null,a=v)):(n=null,a=v)):(n=null,a=v)):(n=null,a=v)):(n=null,a=v)):(n=null,a=v)):(n=null,a=v))))))))))))))),null!==n&&(_=b,$t.host_type="IPv6",n=t.substring(a,_)),null===n&&(a=b),n}function fn(){var n,e,t,r,i;return i=a,null!==(n=p())&&null!==(e=null!==(e=p())?e:"")&&null!==(t=null!==(t=p())?t:"")&&null!==(r=null!==(r=p())?r:"")?n=[n,e,t,r]:(n=null,a=i),n}function gn(){var n,e,r,i;return i=a,null!==(n=fn())?(58===t.charCodeAt(a)?(e=":",a++):(e=null,0===s&&l('":"')),null!==e&&null!==(r=fn())?n=[n,e,r]:(n=null,a=i)):(n=null,a=i),null===n&&(n=mn()),n}function mn(){var n,e,r,i,o,c,u,d,h,p;return d=a,h=a,null!==(n=bn())?(46===t.charCodeAt(a)?(e=".",a++):(e=null,0===s&&l('"."')),null!==e&&null!==(r=bn())?(46===t.charCodeAt(a)?(i=".",a++):(i=null,0===s&&l('"."')),null!==i&&null!==(o=bn())?(46===t.charCodeAt(a)?(c=".",a++):(c=null,0===s&&l('"."')),null!==c&&null!==(u=bn())?n=[n,e,r,i,o,c,u]:(n=null,a=h)):(n=null,a=h)):(n=null,a=h)):(n=null,a=h),null!==n&&(p=d,$t.host_type="IPv4",n=t.substring(a,p)),null===n&&(a=d),n}function bn(){var n,e,r,i;return i=a,"25"===t.substr(a,2)?(n="25",a+=2):(n=null,0===s&&l('"25"')),null!==n?(/^[0-5]/.test(t.charAt(a))?(e=t.charAt(a),a++):(e=null,0===s&&l("[0-5]")),null!==e?n=[n,e]:(n=null,a=i)):(n=null,a=i),null===n&&(i=a,50===t.charCodeAt(a)?(n="2",a++):(n=null,0===s&&l('"2"')),null!==n?(/^[0-4]/.test(t.charAt(a))?(e=t.charAt(a),a++):(e=null,0===s&&l("[0-4]")),null!==e&&null!==(r=d())?n=[n,e,r]:(n=null,a=i)):(n=null,a=i),null===n&&(i=a,49===t.charCodeAt(a)?(n="1",a++):(n=null,0===s&&l('"1"')),null!==n&&null!==(e=d())&&null!==(r=d())?n=[n,e,r]:(n=null,a=i),null===n&&(i=a,/^[1-9]/.test(t.charAt(a))?(n=t.charAt(a),a++):(n=null,0===s&&l("[1-9]")),null!==n&&null!==(e=d())?n=[n,e]:(n=null,a=i),null===n&&(n=d())))),n}function vn(){var n,e,t,r,i,s,o,c;return s=a,o=a,null!==(n=null!==(n=d())?n:"")&&null!==(e=null!==(e=d())?e:"")&&null!==(t=null!==(t=d())?t:"")&&null!==(r=null!==(r=d())?r:"")&&null!==(i=null!==(i=d())?i:"")?n=[n,e,t,r,i]:(n=null,a=o),null!==n&&(c=n,c=parseInt(c.join("")),$t.port=c,n=c),null===n&&(a=s),n}function yn(){var n,e,r,i;for(n=[],i=a,59===t.charCodeAt(a)?(e=";",a++):(e=null,0===s&&l('";"')),null!==e&&null!==(r=_n())?e=[e,r]:(e=null,a=i);null!==e;)n.push(e),i=a,59===t.charCodeAt(a)?(e=";",a++):(e=null,0===s&&l('";"')),null!==e&&null!==(r=_n())?e=[e,r]:(e=null,a=i);return n}function _n(){var n;return null===(n=Cn())&&null===(n=Sn())&&null===(n=Tn())&&null===(n=En())&&null===(n=wn())&&null===(n=kn())&&(n=Rn()),n}function Cn(){var n,e,r,i,o;return r=a,i=a,"transport="===t.substr(a,10).toLowerCase()?(n=t.substr(a,10),a+=10):(n=null,0===s&&l('"transport="')),null!==n?("udp"===t.substr(a,3).toLowerCase()?(e=t.substr(a,3),a+=3):(e=null,0===s&&l('"udp"')),null===e&&("tcp"===t.substr(a,3).toLowerCase()?(e=t.substr(a,3),a+=3):(e=null,0===s&&l('"tcp"')),null===e&&("sctp"===t.substr(a,4).toLowerCase()?(e=t.substr(a,4),a+=4):(e=null,0===s&&l('"sctp"')),null===e&&("tls"===t.substr(a,3).toLowerCase()?(e=t.substr(a,3),a+=3):(e=null,0===s&&l('"tls"')),null===e&&(e=P())))),null!==e?n=[n,e]:(n=null,a=i)):(n=null,a=i),null!==n&&(o=n[1],$t.uri_params||($t.uri_params={}),n=void($t.uri_params.transport=o.toLowerCase())),null===n&&(a=r),n}function Sn(){var n,e,r,i,o;return r=a,i=a,"user="===t.substr(a,5).toLowerCase()?(n=t.substr(a,5),a+=5):(n=null,0===s&&l('"user="')),null!==n?("phone"===t.substr(a,5).toLowerCase()?(e=t.substr(a,5),a+=5):(e=null,0===s&&l('"phone"')),null===e&&("ip"===t.substr(a,2).toLowerCase()?(e=t.substr(a,2),a+=2):(e=null,0===s&&l('"ip"')),null===e&&(e=P())),null!==e?n=[n,e]:(n=null,a=i)):(n=null,a=i),null!==n&&(o=n[1],$t.uri_params||($t.uri_params={}),n=void($t.uri_params.user=o.toLowerCase())),null===n&&(a=r),n}function Tn(){var n,e,r,i,o;return r=a,i=a,"method="===t.substr(a,7).toLowerCase()?(n=t.substr(a,7),a+=7):(n=null,0===s&&l('"method="')),null!==n&&null!==(e=de())?n=[n,e]:(n=null,a=i),null!==n&&(o=n[1],$t.uri_params||($t.uri_params={}),n=void($t.uri_params.method=o)),null===n&&(a=r),n}function En(){var n,e,r,i,o;return r=a,i=a,"ttl="===t.substr(a,4).toLowerCase()?(n=t.substr(a,4),a+=4):(n=null,0===s&&l('"ttl="')),null!==n&&null!==(e=wt())?n=[n,e]:(n=null,a=i),null!==n&&(o=n[1],$t.params||($t.params={}),n=void($t.params.ttl=o)),null===n&&(a=r),n}function wn(){var n,e,r,i,o;return r=a,i=a,"maddr="===t.substr(a,6).toLowerCase()?(n=t.substr(a,6),a+=6):(n=null,0===s&&l('"maddr="')),null!==n&&null!==(e=cn())?n=[n,e]:(n=null,a=i),null!==n&&(o=n[1],$t.uri_params||($t.uri_params={}),n=void($t.uri_params.maddr=o)),null===n&&(a=r),n}function kn(){var n,e,r,i,o,c;return i=a,o=a,"lr"===t.substr(a,2).toLowerCase()?(n=t.substr(a,2),a+=2):(n=null,0===s&&l('"lr"')),null!==n?(c=a,61===t.charCodeAt(a)?(e="=",a++):(e=null,0===s&&l('"="')),null!==e&&null!==(r=P())?e=[e,r]:(e=null,a=c),null!==(e=null!==e?e:"")?n=[n,e]:(n=null,a=o)):(n=null,a=o),null!==n&&($t.uri_params||($t.uri_params={}),n=void($t.uri_params.lr=void 0)),null===n&&(a=i),n}function Rn(){var n,e,r,i,o,c,u,d;return i=a,o=a,null!==(n=In())?(c=a,61===t.charCodeAt(a)?(e="=",a++):(e=null,0===s&&l('"="')),null!==e&&null!==(r=An())?e=[e,r]:(e=null,a=c),null!==(e=null!==e?e:"")?n=[n,e]:(n=null,a=o)):(n=null,a=o),null!==n&&(u=n[0],d=n[1],$t.uri_params||($t.uri_params={}),d=void 0===d?void 0:d[1],n=void($t.uri_params[u.toLowerCase()]=d)),null===n&&(a=i),n}function In(){var n,e,t;if(t=a,null!==(e=On()))for(n=[];null!==e;)n.push(e),e=On();else n=null;return null!==n&&(n=n.join("")),null===n&&(a=t),n}function An(){var n,e,t;if(t=a,null!==(e=On()))for(n=[];null!==e;)n.push(e),e=On();else n=null;return null!==n&&(n=n.join("")),null===n&&(a=t),n}function On(){var n;return null===(n=Pn())&&null===(n=C())&&(n=T()),n}function Pn(){var n;return 91===t.charCodeAt(a)?(n="[",a++):(n=null,0===s&&l('"["')),null===n&&(93===t.charCodeAt(a)?(n="]",a++):(n=null,0===s&&l('"]"')),null===n&&(47===t.charCodeAt(a)?(n="/",a++):(n=null,0===s&&l('"/"')),null===n&&(58===t.charCodeAt(a)?(n=":",a++):(n=null,0===s&&l('":"')),null===n&&(38===t.charCodeAt(a)?(n="&",a++):(n=null,0===s&&l('"&"')),null===n&&(43===t.charCodeAt(a)?(n="+",a++):(n=null,0===s&&l('"+"')),null===n&&(36===t.charCodeAt(a)?(n="$",a++):(n=null,0===s&&l('"$"')))))))),n}function Ln(){var n,e,r,i,o,c,u;if(c=a,63===t.charCodeAt(a)?(n="?",a++):(n=null,0===s&&l('"?"')),null!==n)if(null!==(e=Dn())){for(r=[],u=a,38===t.charCodeAt(a)?(i="&",a++):(i=null,0===s&&l('"&"')),null!==i&&null!==(o=Dn())?i=[i,o]:(i=null,a=u);null!==i;)r.push(i),u=a,38===t.charCodeAt(a)?(i="&",a++):(i=null,0===s&&l('"&"')),null!==i&&null!==(o=Dn())?i=[i,o]:(i=null,a=u);null!==r?n=[n,e,r]:(n=null,a=c)}else n=null,a=c;else n=null,a=c;return n}function Dn(){var n,e,r,i,o,c,u;return i=a,o=a,null!==(n=Nn())?(61===t.charCodeAt(a)?(e="=",a++):(e=null,0===s&&l('"="')),null!==e&&null!==(r=Mn())?n=[n,e,r]:(n=null,a=o)):(n=null,a=o),null!==n&&(c=n[0],u=n[2],c=c.join("").toLowerCase(),u=u.join(""),$t.uri_headers||($t.uri_headers={}),n=void($t.uri_headers[c]?$t.uri_headers[c].push(u):$t.uri_headers[c]=[u])),null===n&&(a=i),n}function Nn(){var n,e;if(null===(e=jn())&&null===(e=C())&&(e=T()),null!==e)for(n=[];null!==e;)n.push(e),null===(e=jn())&&null===(e=C())&&(e=T());else n=null;return n}function Mn(){var n,e;for(n=[],null===(e=jn())&&null===(e=C())&&(e=T());null!==e;)n.push(e),null===(e=jn())&&null===(e=C())&&(e=T());return n}function jn(){var n;return 91===t.charCodeAt(a)?(n="[",a++):(n=null,0===s&&l('"["')),null===n&&(93===t.charCodeAt(a)?(n="]",a++):(n=null,0===s&&l('"]"')),null===n&&(47===t.charCodeAt(a)?(n="/",a++):(n=null,0===s&&l('"/"')),null===n&&(63===t.charCodeAt(a)?(n="?",a++):(n=null,0===s&&l('"?"')),null===n&&(58===t.charCodeAt(a)?(n=":",a++):(n=null,0===s&&l('":"')),null===n&&(43===t.charCodeAt(a)?(n="+",a++):(n=null,0===s&&l('"+"')),null===n&&(36===t.charCodeAt(a)?(n="$",a++):(n=null,0===s&&l('"$"')))))))),n}function xn(){var n,e,t,r,i,s;return s=a,null!==(n=de())&&null!==(e=b())&&null!==(t=Un())&&null!==(r=b())&&null!==(i=ee())?n=[n,e,t,r,i]:(n=null,a=s),n}function Un(){var n;return null===(n=X())&&(n=Fn()),n}function Fn(){var n,e,r,i;return i=a,null!==(n=Qn())?(58===t.charCodeAt(a)?(e=":",a++):(e=null,0===s&&l('":"')),null!==e?(null===(r=Gn())&&(r=Bn()),null!==r?n=[n,e,r]:(n=null,a=i)):(n=null,a=i)):(n=null,a=i),n}function Gn(){var n,e,r,i,o;return i=a,null===(n=$n())&&(n=Hn()),null!==n?(o=a,63===t.charCodeAt(a)?(e="?",a++):(e=null,0===s&&l('"?"')),null!==e&&null!==(r=ne())?e=[e,r]:(e=null,a=o),null!==(e=null!==e?e:"")?n=[n,e]:(n=null,a=i)):(n=null,a=i),n}function $n(){var n,e,r,i;return i=a,"//"===t.substr(a,2)?(n="//",a+=2):(n=null,0===s&&l('"//"')),null!==n&&null!==(e=Yn())&&null!==(r=null!==(r=Hn())?r:"")?n=[n,e,r]:(n=null,a=i),n}function Hn(){var n,e,r;return r=a,47===t.charCodeAt(a)?(n="/",a++):(n=null,0===s&&l('"/"')),null!==n&&null!==(e=Wn())?n=[n,e]:(n=null,a=r),n}function Bn(){var n,e,t,r;if(r=a,null!==(n=Vn())){for(e=[],t=qn();null!==t;)e.push(t),t=qn();null!==e?n=[n,e]:(n=null,a=r)}else n=null,a=r;return n}function qn(){var n;return null===(n=_())&&null===(n=C())&&(n=T()),n}function Vn(){var n;return null===(n=C())&&null===(n=T())&&(59===t.charCodeAt(a)?(n=";",a++):(n=null,0===s&&l('";"')),null===n&&(63===t.charCodeAt(a)?(n="?",a++):(n=null,0===s&&l('"?"')),null===n&&(58===t.charCodeAt(a)?(n=":",a++):(n=null,0===s&&l('":"')),null===n&&(64===t.charCodeAt(a)?(n="@",a++):(n=null,0===s&&l('"@"')),null===n&&(38===t.charCodeAt(a)?(n="&",a++):(n=null,0===s&&l('"&"')),null===n&&(61===t.charCodeAt(a)?(n="=",a++):(n=null,0===s&&l('"="')),null===n&&(43===t.charCodeAt(a)?(n="+",a++):(n=null,0===s&&l('"+"')),null===n&&(36===t.charCodeAt(a)?(n="$",a++):(n=null,0===s&&l('"$"')),null===n&&(44===t.charCodeAt(a)?(n=",",a++):(n=null,0===s&&l('","'))))))))))),n}function Wn(){var n,e,r,i,o,c;if(o=a,null!==(n=zn())){for(e=[],c=a,47===t.charCodeAt(a)?(r="/",a++):(r=null,0===s&&l('"/"')),null!==r&&null!==(i=zn())?r=[r,i]:(r=null,a=c);null!==r;)e.push(r),c=a,47===t.charCodeAt(a)?(r="/",a++):(r=null,0===s&&l('"/"')),null!==r&&null!==(i=zn())?r=[r,i]:(r=null,a=c);null!==e?n=[n,e]:(n=null,a=o)}else n=null,a=o;return n}function zn(){var n,e,r,i,o,c;for(o=a,n=[],e=Jn();null!==e;)n.push(e),e=Jn();if(null!==n){for(e=[],c=a,59===t.charCodeAt(a)?(r=";",a++):(r=null,0===s&&l('";"')),null!==r&&null!==(i=Kn())?r=[r,i]:(r=null,a=c);null!==r;)e.push(r),c=a,59===t.charCodeAt(a)?(r=";",a++):(r=null,0===s&&l('";"')),null!==r&&null!==(i=Kn())?r=[r,i]:(r=null,a=c);null!==e?n=[n,e]:(n=null,a=o)}else n=null,a=o;return n}function Kn(){var n,e;for(n=[],e=Jn();null!==e;)n.push(e),e=Jn();return n}function Jn(){var n;return null===(n=C())&&null===(n=T())&&(58===t.charCodeAt(a)?(n=":",a++):(n=null,0===s&&l('":"')),null===n&&(64===t.charCodeAt(a)?(n="@",a++):(n=null,0===s&&l('"@"')),null===n&&(38===t.charCodeAt(a)?(n="&",a++):(n=null,0===s&&l('"&"')),null===n&&(61===t.charCodeAt(a)?(n="=",a++):(n=null,0===s&&l('"="')),null===n&&(43===t.charCodeAt(a)?(n="+",a++):(n=null,0===s&&l('"+"')),null===n&&(36===t.charCodeAt(a)?(n="$",a++):(n=null,0===s&&l('"$"')),null===n&&(44===t.charCodeAt(a)?(n=",",a++):(n=null,0===s&&l('","'))))))))),n}function Qn(){var n,e,r,i,o,c;if(i=a,o=a,null!==(n=h())){for(e=[],null===(r=h())&&null===(r=d())&&(43===t.charCodeAt(a)?(r="+",a++):(r=null,0===s&&l('"+"')),null===r&&(45===t.charCodeAt(a)?(r="-",a++):(r=null,0===s&&l('"-"')),null===r&&(46===t.charCodeAt(a)?(r=".",a++):(r=null,0===s&&l('"."')))));null!==r;)e.push(r),null===(r=h())&&null===(r=d())&&(43===t.charCodeAt(a)?(r="+",a++):(r=null,0===s&&l('"+"')),null===r&&(45===t.charCodeAt(a)?(r="-",a++):(r=null,0===s&&l('"-"')),null===r&&(46===t.charCodeAt(a)?(r=".",a++):(r=null,0===s&&l('"."')))));null!==e?n=[n,e]:(n=null,a=o)}else n=null,a=o;return null!==n&&(c=i,n=void($t.scheme=t.substring(a,c))),null===n&&(a=i),n}function Yn(){var n;return null===(n=Xn())&&(n=Zn()),n}function Xn(){var n,e,r,i;return r=a,i=a,null!==(n=tn())?(64===t.charCodeAt(a)?(e="@",a++):(e=null,0===s&&l('"@"')),null!==e?n=[n,e]:(n=null,a=i)):(n=null,a=i),null!==(n=null!==n?n:"")&&null!==(e=on())?n=[n,e]:(n=null,a=r),null!==n?n:""}function Zn(){var n,e;if(null===(e=C())&&null===(e=T())&&(36===t.charCodeAt(a)?(e="$",a++):(e=null,0===s&&l('"$"')),null===e&&(44===t.charCodeAt(a)?(e=",",a++):(e=null,0===s&&l('","')),null===e&&(59===t.charCodeAt(a)?(e=";",a++):(e=null,0===s&&l('";"')),null===e&&(58===t.charCodeAt(a)?(e=":",a++):(e=null,0===s&&l('":"')),null===e&&(64===t.charCodeAt(a)?(e="@",a++):(e=null,0===s&&l('"@"')),null===e&&(38===t.charCodeAt(a)?(e="&",a++):(e=null,0===s&&l('"&"')),null===e&&(61===t.charCodeAt(a)?(e="=",a++):(e=null,0===s&&l('"="')),null===e&&(43===t.charCodeAt(a)?(e="+",a++):(e=null,0===s&&l('"+"')))))))))),null!==e)for(n=[];null!==e;)n.push(e),null===(e=C())&&null===(e=T())&&(36===t.charCodeAt(a)?(e="$",a++):(e=null,0===s&&l('"$"')),null===e&&(44===t.charCodeAt(a)?(e=",",a++):(e=null,0===s&&l('","')),null===e&&(59===t.charCodeAt(a)?(e=";",a++):(e=null,0===s&&l('";"')),null===e&&(58===t.charCodeAt(a)?(e=":",a++):(e=null,0===s&&l('":"')),null===e&&(64===t.charCodeAt(a)?(e="@",a++):(e=null,0===s&&l('"@"')),null===e&&(38===t.charCodeAt(a)?(e="&",a++):(e=null,0===s&&l('"&"')),null===e&&(61===t.charCodeAt(a)?(e="=",a++):(e=null,0===s&&l('"="')),null===e&&(43===t.charCodeAt(a)?(e="+",a++):(e=null,0===s&&l('"+"'))))))))));else n=null;return n}function ne(){var n,e;for(n=[],e=qn();null!==e;)n.push(e),e=qn();return n}function ee(){var n,e,r,i,o,c,u,h,p;if(u=a,h=a,"sip"===t.substr(a,3).toLowerCase()?(n=t.substr(a,3),a+=3):(n=null,0===s&&l('"SIP"')),null!==n)if(47===t.charCodeAt(a)?(e="/",a++):(e=null,0===s&&l('"/"')),null!==e){if(null!==(i=d()))for(r=[];null!==i;)r.push(i),i=d();else r=null;if(null!==r)if(46===t.charCodeAt(a)?(i=".",a++):(i=null,0===s&&l('"."')),null!==i){if(null!==(c=d()))for(o=[];null!==c;)o.push(c),c=d();else o=null;null!==o?n=[n,e,r,i,o]:(n=null,a=h)}else n=null,a=h;else n=null,a=h}else n=null,a=h;else n=null,a=h;return null!==n&&(p=u,n=void($t.sip_version=t.substring(a,p))),null===n&&(a=u),n}function te(){var n;return"INVITE"===t.substr(a,6)?(n="INVITE",a+=6):(n=null,0===s&&l('"INVITE"')),n}function re(){var n;return"ACK"===t.substr(a,3)?(n="ACK",a+=3):(n=null,0===s&&l('"ACK"')),n}function ie(){var n;return"OPTIONS"===t.substr(a,7)?(n="OPTIONS",a+=7):(n=null,0===s&&l('"OPTIONS"')),n}function ae(){var n;return"BYE"===t.substr(a,3)?(n="BYE",a+=3):(n=null,0===s&&l('"BYE"')),n}function se(){var n;return"CANCEL"===t.substr(a,6)?(n="CANCEL",a+=6):(n=null,0===s&&l('"CANCEL"')),n}function oe(){var n;return"REGISTER"===t.substr(a,8)?(n="REGISTER",a+=8):(n=null,0===s&&l('"REGISTER"')),n}function ce(){var n;return"SUBSCRIBE"===t.substr(a,9)?(n="SUBSCRIBE",a+=9):(n=null,0===s&&l('"SUBSCRIBE"')),n}function le(){var n;return"NOTIFY"===t.substr(a,6)?(n="NOTIFY",a+=6):(n=null,0===s&&l('"NOTIFY"')),n}function ue(){var n;return"REFER"===t.substr(a,5)?(n="REFER",a+=5):(n=null,0===s&&l('"REFER"')),n}function de(){var n,e,r;return e=a,null===(n=te())&&null===(n=re())&&null===(n=ie())&&null===(n=ae())&&null===(n=se())&&null===(n=oe())&&null===(n=ce())&&null===(n=le())&&null===(n=ue())&&(n=P()),null!==n&&(r=e,$t.method=t.substring(a,r),n=$t.method),null===n&&(a=e),n}function he(){var n,e,t,r,i,s;return s=a,null!==(n=ee())&&null!==(e=b())&&null!==(t=pe())&&null!==(r=b())&&null!==(i=ge())?n=[n,e,t,r,i]:(n=null,a=s),n}function pe(){var n,e,t;return e=a,null!==(n=fe())&&(t=n,n=void($t.status_code=parseInt(t.join("")))),null===n&&(a=e),n}function fe(){var n,e,t,r;return r=a,null!==(n=d())&&null!==(e=d())&&null!==(t=d())?n=[n,e,t]:(n=null,a=r),n}function ge(){var n,e,r,i;for(r=a,n=[],null===(e=_())&&null===(e=C())&&null===(e=T())&&null===(e=A())&&null===(e=O())&&null===(e=b())&&(e=v());null!==e;)n.push(e),null===(e=_())&&null===(e=C())&&null===(e=T())&&null===(e=A())&&null===(e=O())&&null===(e=b())&&(e=v());return null!==n&&(i=r,n=void($t.reason_phrase=t.substring(a,i))),null===n&&(a=r),n}function me(){var n,e,t,r,i,s,o;if(i=a,s=a,null===(n=Y())&&(n=be()),null!==n){for(e=[],o=a,null!==(t=H())&&null!==(r=ye())?t=[t,r]:(t=null,a=o);null!==t;)e.push(t),o=a,null!==(t=H())&&null!==(r=ye())?t=[t,r]:(t=null,a=o);null!==e?n=[n,e]:(n=null,a=s)}else n=null,a=s;return null!==n&&(n=function(n){var e;$t.multi_header||($t.multi_header=[]);try{e=new Gt($t.uri,$t.display_name,$t.params),delete $t.uri,delete $t.display_name,delete $t.params}catch(n){e=null}$t.multi_header.push({possition:a,offset:n,parsed:e})}(i)),null===n&&(a=i),n}function be(){var n,e,t,r,i;return i=a,null!==(n=null!==(n=ve())?n:"")&&null!==(e=G())&&null!==(t=X())&&null!==(r=F())?n=[n,e,t,r]:(n=null,a=i),n}function ve(){var n,e,t,r,i,s,o,c;if(i=a,s=a,null!==(n=P())){for(e=[],o=a,null!==(t=E())&&null!==(r=P())?t=[t,r]:(t=null,a=o);null!==t;)e.push(t),o=a,null!==(t=E())&&null!==(r=P())?t=[t,r]:(t=null,a=o);null!==e?n=[n,e]:(n=null,a=s)}else n=null,a=s;return null===n&&(n=K()),null!==n&&(c=n,n=void($t.display_name="string"==typeof c?c:c[1].reduce((function(n,e){return n+e[0]+e[1]}),c[0]))),null===n&&(a=i),n}function ye(){var n;return null===(n=_e())&&null===(n=Ce())&&(n=Ee()),n}function _e(){var n,e,r,i,o,c;return i=a,o=a,"q"===t.substr(a,1).toLowerCase()?(n=t.substr(a,1),a++):(n=null,0===s&&l('"q"')),null!==n&&null!==(e=j())&&null!==(r=Te())?n=[n,e,r]:(n=null,a=o),null!==n&&(c=n[2],$t.params||($t.params={}),n=void($t.params.q=c)),null===n&&(a=i),n}function Ce(){var n,e,r,i,o,c;return i=a,o=a,"expires"===t.substr(a,7).toLowerCase()?(n=t.substr(a,7),a+=7):(n=null,0===s&&l('"expires"')),null!==n&&null!==(e=j())&&null!==(r=Se())?n=[n,e,r]:(n=null,a=o),null!==n&&(c=n[2],$t.params||($t.params={}),n=void($t.params.expires=c)),null===n&&(a=i),n}function Se(){var n,e,t;if(t=a,null!==(e=d()))for(n=[];null!==e;)n.push(e),e=d();else n=null;return null!==n&&(n=parseInt(n.join(""))),null===n&&(a=t),n}function Te(){var n,e,r,i,o,c,u,h,p;return c=a,u=a,48===t.charCodeAt(a)?(n="0",a++):(n=null,0===s&&l('"0"')),null!==n?(h=a,46===t.charCodeAt(a)?(e=".",a++):(e=null,0===s&&l('"."')),null!==e&&null!==(r=null!==(r=d())?r:"")&&null!==(i=null!==(i=d())?i:"")&&null!==(o=null!==(o=d())?o:"")?e=[e,r,i,o]:(e=null,a=h),null!==(e=null!==e?e:"")?n=[n,e]:(n=null,a=u)):(n=null,a=u),null!==n&&(p=c,n=parseFloat(t.substring(a,p))),null===n&&(a=c),n}function Ee(){var n,e,t,r,i,s,o,c;return r=a,i=a,null!==(n=P())?(s=a,null!==(e=j())&&null!==(t=we())?e=[e,t]:(e=null,a=s),null!==(e=null!==e?e:"")?n=[n,e]:(n=null,a=i)):(n=null,a=i),null!==n&&(o=n[0],c=n[1],$t.params||($t.params={}),c=void 0===c?void 0:c[1],n=void($t.params[o.toLowerCase()]=c)),null===n&&(a=r),n}function we(){var n;return null===(n=P())&&null===(n=cn())&&(n=z()),n}function ke(){var n;return"render"===t.substr(a,6).toLowerCase()?(n=t.substr(a,6),a+=6):(n=null,0===s&&l('"render"')),null===n&&("session"===t.substr(a,7).toLowerCase()?(n=t.substr(a,7),a+=7):(n=null,0===s&&l('"session"')),null===n&&("icon"===t.substr(a,4).toLowerCase()?(n=t.substr(a,4),a+=4):(n=null,0===s&&l('"icon"')),null===n&&("alert"===t.substr(a,5).toLowerCase()?(n=t.substr(a,5),a+=5):(n=null,0===s&&l('"alert"')),null===n&&(n=P())))),n}function Re(){var n;return null===(n=Ie())&&(n=Ee()),n}function Ie(){var n,e,r,i;return i=a,"handling"===t.substr(a,8).toLowerCase()?(n=t.substr(a,8),a+=8):(n=null,0===s&&l('"handling"')),null!==n&&null!==(e=j())?("optional"===t.substr(a,8).toLowerCase()?(r=t.substr(a,8),a+=8):(r=null,0===s&&l('"optional"')),null===r&&("required"===t.substr(a,8).toLowerCase()?(r=t.substr(a,8),a+=8):(r=null,0===s&&l('"required"')),null===r&&(r=P())),null!==r?n=[n,e,r]:(n=null,a=i)):(n=null,a=i),n}function Ae(){var n,e,t,r,i,s,o,c;if(o=a,null!==(n=Oe()))if(null!==(e=M()))if(null!==(t=Me())){for(r=[],c=a,null!==(i=H())&&null!==(s=je())?i=[i,s]:(i=null,a=c);null!==i;)r.push(i),c=a,null!==(i=H())&&null!==(s=je())?i=[i,s]:(i=null,a=c);null!==r?n=[n,e,t,r]:(n=null,a=o)}else n=null,a=o;else n=null,a=o;else n=null,a=o;return n}function Oe(){var n;return null===(n=Pe())&&(n=Le()),n}function Pe(){var n;return"text"===t.substr(a,4).toLowerCase()?(n=t.substr(a,4),a+=4):(n=null,0===s&&l('"text"')),null===n&&("image"===t.substr(a,5).toLowerCase()?(n=t.substr(a,5),a+=5):(n=null,0===s&&l('"image"')),null===n&&("audio"===t.substr(a,5).toLowerCase()?(n=t.substr(a,5),a+=5):(n=null,0===s&&l('"audio"')),null===n&&("video"===t.substr(a,5).toLowerCase()?(n=t.substr(a,5),a+=5):(n=null,0===s&&l('"video"')),null===n&&("application"===t.substr(a,11).toLowerCase()?(n=t.substr(a,11),a+=11):(n=null,0===s&&l('"application"')),null===n&&(n=De()))))),n}function Le(){var n;return"message"===t.substr(a,7).toLowerCase()?(n=t.substr(a,7),a+=7):(n=null,0===s&&l('"message"')),null===n&&("multipart"===t.substr(a,9).toLowerCase()?(n=t.substr(a,9),a+=9):(n=null,0===s&&l('"multipart"')),null===n&&(n=De())),n}function De(){var n;return null===(n=P())&&(n=Ne()),n}function Ne(){var n,e,r;return r=a,"x-"===t.substr(a,2).toLowerCase()?(n=t.substr(a,2),a+=2):(n=null,0===s&&l('"x-"')),null!==n&&null!==(e=P())?n=[n,e]:(n=null,a=r),n}function Me(){var n;return null===(n=De())&&(n=P()),n}function je(){var n,e,t,r;return r=a,null!==(n=P())&&null!==(e=j())&&null!==(t=xe())?n=[n,e,t]:(n=null,a=r),n}function xe(){var n;return null===(n=P())&&(n=z()),n}function Ue(){var n,e,t,r;if(t=a,null!==(e=d()))for(n=[];null!==e;)n.push(e),e=d();else n=null;return null!==n&&(r=n,n=void($t.value=parseInt(r.join("")))),null===n&&(a=t),n}function Fe(){var n,e,r,i,o,c;if(o=a,null!==(n=L())){for(e=[],c=a,46===t.charCodeAt(a)?(r=".",a++):(r=null,0===s&&l('"."')),null!==r&&null!==(i=L())?r=[r,i]:(r=null,a=c);null!==r;)e.push(r),c=a,46===t.charCodeAt(a)?(r=".",a++):(r=null,0===s&&l('"."')),null!==r&&null!==(i=L())?r=[r,i]:(r=null,a=c);null!==e?n=[n,e]:(n=null,a=o)}else n=null,a=o;return n}function Ge(){var n;return null===(n=$e())&&(n=Ee()),n}function $e(){var n,e,r,i,o,c;return i=a,o=a,"tag"===t.substr(a,3).toLowerCase()?(n=t.substr(a,3),a+=3):(n=null,0===s&&l('"tag"')),null!==n&&null!==(e=j())&&null!==(r=P())?n=[n,e,r]:(n=null,a=o),null!==n&&(c=n[2],n=void($t.tag=c)),null===n&&(a=i),n}function He(){var n,e,r,i,o,c,u,d;if(u=a,"digest"===t.substr(a,6).toLowerCase()?(n=t.substr(a,6),a+=6):(n=null,0===s&&l('"Digest"')),null!==n)if(null!==(e=E()))if(null!==(r=Ve())){for(i=[],d=a,null!==(o=$())&&null!==(c=Ve())?o=[o,c]:(o=null,a=d);null!==o;)i.push(o),d=a,null!==(o=$())&&null!==(c=Ve())?o=[o,c]:(o=null,a=d);null!==i?n=[n,e,r,i]:(n=null,a=u)}else n=null,a=u;else n=null,a=u;else n=null,a=u;return null===n&&(n=Be()),n}function Be(){var n,e,t,r,i,s,o,c;if(o=a,null!==(n=P()))if(null!==(e=E()))if(null!==(t=qe())){for(r=[],c=a,null!==(i=$())&&null!==(s=qe())?i=[i,s]:(i=null,a=c);null!==i;)r.push(i),c=a,null!==(i=$())&&null!==(s=qe())?i=[i,s]:(i=null,a=c);null!==r?n=[n,e,t,r]:(n=null,a=o)}else n=null,a=o;else n=null,a=o;else n=null,a=o;return n}function qe(){var n,e,t,r;return r=a,null!==(n=P())&&null!==(e=j())?(null===(t=P())&&(t=z()),null!==t?n=[n,e,t]:(n=null,a=r)):(n=null,a=r),n}function Ve(){var n;return null===(n=We())&&null===(n=Ke())&&null===(n=Qe())&&null===(n=Xe())&&null===(n=Ze())&&null===(n=nt())&&null===(n=et())&&(n=qe()),n}function We(){var n,e,r,i;return i=a,"realm"===t.substr(a,5).toLowerCase()?(n=t.substr(a,5),a+=5):(n=null,0===s&&l('"realm"')),null!==n&&null!==(e=j())&&null!==(r=ze())?n=[n,e,r]:(n=null,a=i),n}function ze(){var n,e,t;return e=a,null!==(n=K())&&(t=n,n=void($t.realm=t)),null===n&&(a=e),n}function Ke(){var n,e,r,i,o,c,u,d,h;if(d=a,"domain"===t.substr(a,6).toLowerCase()?(n=t.substr(a,6),a+=6):(n=null,0===s&&l('"domain"')),null!==n)if(null!==(e=j()))if(null!==(r=q()))if(null!==(i=Je())){if(o=[],h=a,null!==(u=b()))for(c=[];null!==u;)c.push(u),u=b();else c=null;for(null!==c&&null!==(u=Je())?c=[c,u]:(c=null,a=h);null!==c;){if(o.push(c),h=a,null!==(u=b()))for(c=[];null!==u;)c.push(u),u=b();else c=null;null!==c&&null!==(u=Je())?c=[c,u]:(c=null,a=h)}null!==o&&null!==(c=V())?n=[n,e,r,i,o,c]:(n=null,a=d)}else n=null,a=d;else n=null,a=d;else n=null,a=d;else n=null,a=d;return n}function Je(){var n;return null===(n=Fn())&&(n=Hn()),n}function Qe(){var n,e,r,i;return i=a,"nonce"===t.substr(a,5).toLowerCase()?(n=t.substr(a,5),a+=5):(n=null,0===s&&l('"nonce"')),null!==n&&null!==(e=j())&&null!==(r=Ye())?n=[n,e,r]:(n=null,a=i),n}function Ye(){var n,e,t;return e=a,null!==(n=K())&&(t=n,n=void($t.nonce=t)),null===n&&(a=e),n}function Xe(){var n,e,r,i,o,c;return i=a,o=a,"opaque"===t.substr(a,6).toLowerCase()?(n=t.substr(a,6),a+=6):(n=null,0===s&&l('"opaque"')),null!==n&&null!==(e=j())&&null!==(r=K())?n=[n,e,r]:(n=null,a=o),null!==n&&(c=n[2],n=void($t.opaque=c)),null===n&&(a=i),n}function Ze(){var n,e,r,i,o;return i=a,"stale"===t.substr(a,5).toLowerCase()?(n=t.substr(a,5),a+=5):(n=null,0===s&&l('"stale"')),null!==n&&null!==(e=j())?(o=a,"true"===t.substr(a,4).toLowerCase()?(r=t.substr(a,4),a+=4):(r=null,0===s&&l('"true"')),null!==r&&(r=void($t.stale=!0)),null===r&&(a=o),null===r&&(o=a,"false"===t.substr(a,5).toLowerCase()?(r=t.substr(a,5),a+=5):(r=null,0===s&&l('"false"')),null!==r&&(r=void($t.stale=!1)),null===r&&(a=o)),null!==r?n=[n,e,r]:(n=null,a=i)):(n=null,a=i),n}function nt(){var n,e,r,i,o,c;return i=a,o=a,"algorithm"===t.substr(a,9).toLowerCase()?(n=t.substr(a,9),a+=9):(n=null,0===s&&l('"algorithm"')),null!==n&&null!==(e=j())?("md5"===t.substr(a,3).toLowerCase()?(r=t.substr(a,3),a+=3):(r=null,0===s&&l('"MD5"')),null===r&&("md5-sess"===t.substr(a,8).toLowerCase()?(r=t.substr(a,8),a+=8):(r=null,0===s&&l('"MD5-sess"')),null===r&&(r=P())),null!==r?n=[n,e,r]:(n=null,a=o)):(n=null,a=o),null!==n&&(c=n[2],n=void($t.algorithm=c.toUpperCase())),null===n&&(a=i),n}function et(){var n,e,r,i,o,c,u,d,h,p;if(d=a,"qop"===t.substr(a,3).toLowerCase()?(n=t.substr(a,3),a+=3):(n=null,0===s&&l('"qop"')),null!==n)if(null!==(e=j()))if(null!==(r=q())){if(h=a,null!==(i=tt())){for(o=[],p=a,44===t.charCodeAt(a)?(c=",",a++):(c=null,0===s&&l('","')),null!==c&&null!==(u=tt())?c=[c,u]:(c=null,a=p);null!==c;)o.push(c),p=a,44===t.charCodeAt(a)?(c=",",a++):(c=null,0===s&&l('","')),null!==c&&null!==(u=tt())?c=[c,u]:(c=null,a=p);null!==o?i=[i,o]:(i=null,a=h)}else i=null,a=h;null!==i&&null!==(o=V())?n=[n,e,r,i,o]:(n=null,a=d)}else n=null,a=d;else n=null,a=d;else n=null,a=d;return n}function tt(){var n,e,r;return e=a,"auth-int"===t.substr(a,8).toLowerCase()?(n=t.substr(a,8),a+=8):(n=null,0===s&&l('"auth-int"')),null===n&&("auth"===t.substr(a,4).toLowerCase()?(n=t.substr(a,4),a+=4):(n=null,0===s&&l('"auth"')),null===n&&(n=P())),null!==n&&(r=n,$t.qop||($t.qop=[]),n=void $t.qop.push(r.toLowerCase())),null===n&&(a=e),n}function rt(){var n,e,t,r,i,s,o;if(i=a,s=a,null!==(n=be())){for(e=[],o=a,null!==(t=H())&&null!==(r=Ee())?t=[t,r]:(t=null,a=o);null!==t;)e.push(t),o=a,null!==(t=H())&&null!==(r=Ee())?t=[t,r]:(t=null,a=o);null!==e?n=[n,e]:(n=null,a=s)}else n=null,a=s;return null!==n&&(n=function(n){var e;$t.multi_header||($t.multi_header=[]);try{e=new Gt($t.uri,$t.display_name,$t.params),delete $t.uri,delete $t.display_name,delete $t.params}catch(n){e=null}$t.multi_header.push({possition:a,offset:n,parsed:e})}(i)),null===n&&(a=i),n}function it(){var n;return null===(n=at())&&(n=Ee()),n}function at(){var n,e,r,i,o,c,u;if(o=a,c=a,"cause"===t.substr(a,5).toLowerCase()?(n=t.substr(a,5),a+=5):(n=null,0===s&&l('"cause"')),null!==n)if(null!==(e=j())){if(null!==(i=d()))for(r=[];null!==i;)r.push(i),i=d();else r=null;null!==r?n=[n,e,r]:(n=null,a=c)}else n=null,a=c;else n=null,a=c;return null!==n&&(u=n[2],n=void($t.cause=parseInt(u.join("")))),null===n&&(a=o),n}function st(){var n,e,t,r,i,s;if(i=a,null!==(n=be())){for(e=[],s=a,null!==(t=H())&&null!==(r=Ee())?t=[t,r]:(t=null,a=s);null!==t;)e.push(t),s=a,null!==(t=H())&&null!==(r=Ee())?t=[t,r]:(t=null,a=s);null!==e?n=[n,e]:(n=null,a=i)}else n=null,a=i;return n}function ot(){var n,e,r;return e=a,"active"===t.substr(a,6).toLowerCase()?(n=t.substr(a,6),a+=6):(n=null,0===s&&l('"active"')),null===n&&("pending"===t.substr(a,7).toLowerCase()?(n=t.substr(a,7),a+=7):(n=null,0===s&&l('"pending"')),null===n&&("terminated"===t.substr(a,10).toLowerCase()?(n=t.substr(a,10),a+=10):(n=null,0===s&&l('"terminated"')),null===n&&(n=P()))),null!==n&&(r=e,n=void($t.state=t.substring(a,r))),null===n&&(a=e),n}function ct(){var n,e,r,i,o,c,u,d;return i=a,o=a,"reason"===t.substr(a,6).toLowerCase()?(n=t.substr(a,6),a+=6):(n=null,0===s&&l('"reason"')),null!==n&&null!==(e=j())&&null!==(r=lt())?n=[n,e,r]:(n=null,a=o),null!==n&&(n=void(void 0!==(c=n[2])&&($t.reason=c))),null===n&&(a=i),null===n&&(i=a,o=a,"expires"===t.substr(a,7).toLowerCase()?(n=t.substr(a,7),a+=7):(n=null,0===s&&l('"expires"')),null!==n&&null!==(e=j())&&null!==(r=Se())?n=[n,e,r]:(n=null,a=o),null!==n&&(n=void(void 0!==(d=n[2])&&($t.expires=d))),null===n&&(a=i),null===n&&(i=a,o=a,"retry_after"===t.substr(a,11).toLowerCase()?(n=t.substr(a,11),a+=11):(n=null,0===s&&l('"retry_after"')),null!==n&&null!==(e=j())&&null!==(r=Se())?n=[n,e,r]:(n=null,a=o),null!==n&&(n=void(void 0!==(u=n[2])&&($t.retry_after=u))),null===n&&(a=i),null===n&&(n=Ee()))),n}function lt(){var n;return"deactivated"===t.substr(a,11).toLowerCase()?(n=t.substr(a,11),a+=11):(n=null,0===s&&l('"deactivated"')),null===n&&("probation"===t.substr(a,9).toLowerCase()?(n=t.substr(a,9),a+=9):(n=null,0===s&&l('"probation"')),null===n&&("rejected"===t.substr(a,8).toLowerCase()?(n=t.substr(a,8),a+=8):(n=null,0===s&&l('"rejected"')),null===n&&("timeout"===t.substr(a,7).toLowerCase()?(n=t.substr(a,7),a+=7):(n=null,0===s&&l('"timeout"')),null===n&&("giveup"===t.substr(a,6).toLowerCase()?(n=t.substr(a,6),a+=6):(n=null,0===s&&l('"giveup"')),null===n&&("noresource"===t.substr(a,10).toLowerCase()?(n=t.substr(a,10),a+=10):(n=null,0===s&&l('"noresource"')),null===n&&("invariant"===t.substr(a,9).toLowerCase()?(n=t.substr(a,9),a+=9):(n=null,0===s&&l('"invariant"')),null===n&&(n=P()))))))),n}function ut(){var n;return null===(n=$e())&&(n=Ee()),n}function dt(){var n,e,t,r,i,s,o,c;if(o=a,null!==(n=yt()))if(null!==(e=E()))if(null!==(t=St())){for(r=[],c=a,null!==(i=H())&&null!==(s=ht())?i=[i,s]:(i=null,a=c);null!==i;)r.push(i),c=a,null!==(i=H())&&null!==(s=ht())?i=[i,s]:(i=null,a=c);null!==r?n=[n,e,t,r]:(n=null,a=o)}else n=null,a=o;else n=null,a=o;else n=null,a=o;return n}function ht(){var n;return null===(n=pt())&&null===(n=ft())&&null===(n=gt())&&null===(n=mt())&&null===(n=bt())&&(n=Ee()),n}function pt(){var n,e,r,i,o,c;return i=a,o=a,"ttl"===t.substr(a,3).toLowerCase()?(n=t.substr(a,3),a+=3):(n=null,0===s&&l('"ttl"')),null!==n&&null!==(e=j())&&null!==(r=wt())?n=[n,e,r]:(n=null,a=o),null!==n&&(c=n[2],n=void($t.ttl=c)),null===n&&(a=i),n}function ft(){var n,e,r,i,o,c;return i=a,o=a,"maddr"===t.substr(a,5).toLowerCase()?(n=t.substr(a,5),a+=5):(n=null,0===s&&l('"maddr"')),null!==n&&null!==(e=j())&&null!==(r=cn())?n=[n,e,r]:(n=null,a=o),null!==n&&(c=n[2],n=void($t.maddr=c)),null===n&&(a=i),n}function gt(){var n,e,r,i,o,c;return i=a,o=a,"received"===t.substr(a,8).toLowerCase()?(n=t.substr(a,8),a+=8):(n=null,0===s&&l('"received"')),null!==n&&null!==(e=j())?(null===(r=mn())&&(r=pn()),null!==r?n=[n,e,r]:(n=null,a=o)):(n=null,a=o),null!==n&&(c=n[2],n=void($t.received=c)),null===n&&(a=i),n}function mt(){var n,e,r,i,o,c;return i=a,o=a,"branch"===t.substr(a,6).toLowerCase()?(n=t.substr(a,6),a+=6):(n=null,0===s&&l('"branch"')),null!==n&&null!==(e=j())&&null!==(r=P())?n=[n,e,r]:(n=null,a=o),null!==n&&(c=n[2],n=void($t.branch=c)),null===n&&(a=i),n}function bt(){var n,e,r,i,o;return i=a,"rport"===t.substr(a,5).toLowerCase()?(n=t.substr(a,5),a+=5):(n=null,0===s&&l('"rport"')),null!==n?(o=a,null!==(e=j())&&null!==(r=vt())?e=[e,r]:(e=null,a=o),null!==(e=null!==e?e:"")?n=[n,e]:(n=null,a=i)):(n=null,a=i),n}function vt(){var n,e,t,r,i,s,o,c;return s=a,o=a,null!==(n=null!==(n=d())?n:"")&&null!==(e=null!==(e=d())?e:"")&&null!==(t=null!==(t=d())?t:"")&&null!==(r=null!==(r=d())?r:"")&&null!==(i=null!==(i=d())?i:"")?n=[n,e,t,r,i]:(n=null,a=o),null!==n&&(c=n,n=void($t.rport=parseInt(c.join("")))),null===n&&(a=s),n}function yt(){var n,e,t,r,i,s;return s=a,null!==(n=_t())&&null!==(e=M())&&null!==(t=P())&&null!==(r=M())&&null!==(i=Ct())?n=[n,e,t,r,i]:(n=null,a=s),n}function _t(){var n,e,r;return e=a,"sip"===t.substr(a,3).toLowerCase()?(n=t.substr(a,3),a+=3):(n=null,0===s&&l('"SIP"')),null===n&&(n=P()),null!==n&&(r=n,n=void($t.protocol=r)),null===n&&(a=e),n}function Ct(){var n,e,r;return e=a,"udp"===t.substr(a,3).toLowerCase()?(n=t.substr(a,3),a+=3):(n=null,0===s&&l('"UDP"')),null===n&&("tcp"===t.substr(a,3).toLowerCase()?(n=t.substr(a,3),a+=3):(n=null,0===s&&l('"TCP"')),null===n&&("tls"===t.substr(a,3).toLowerCase()?(n=t.substr(a,3),a+=3):(n=null,0===s&&l('"TLS"')),null===n&&("sctp"===t.substr(a,4).toLowerCase()?(n=t.substr(a,4),a+=4):(n=null,0===s&&l('"SCTP"')),null===n&&(n=P())))),null!==n&&(r=n,n=void($t.transport=r)),null===n&&(a=e),n}function St(){var n,e,t,r,i;return r=a,null!==(n=Tt())?(i=a,null!==(e=B())&&null!==(t=Et())?e=[e,t]:(e=null,a=i),null!==(e=null!==e?e:"")?n=[n,e]:(n=null,a=r)):(n=null,a=r),n}function Tt(){var n,e,r;return e=a,null===(n=mn())&&null===(n=hn())&&(n=ln()),null!==n&&(r=e,n=void($t.host=t.substring(a,r))),null===n&&(a=e),n}function Et(){var n,e,t,r,i,s,o,c;return s=a,o=a,null!==(n=null!==(n=d())?n:"")&&null!==(e=null!==(e=d())?e:"")&&null!==(t=null!==(t=d())?t:"")&&null!==(r=null!==(r=d())?r:"")&&null!==(i=null!==(i=d())?i:"")?n=[n,e,t,r,i]:(n=null,a=o),null!==n&&(c=n,n=void($t.port=parseInt(c.join("")))),null===n&&(a=s),n}function wt(){var n,e,t,r,i;return r=a,i=a,null!==(n=d())&&null!==(e=null!==(e=d())?e:"")&&null!==(t=null!==(t=d())?t:"")?n=[n,e,t]:(n=null,a=i),null!==n&&(n=parseInt(n.join(""))),null===n&&(a=r),n}function kt(){var n,e,t;return e=a,null!==(n=Se())&&(t=n,n=void($t.expires=t)),null===n&&(a=e),n}function Rt(){var n;return null===(n=It())&&(n=Ee()),n}function It(){var n,e,r,i,o,c;return i=a,o=a,"refresher"===t.substr(a,9).toLowerCase()?(n=t.substr(a,9),a+=9):(n=null,0===s&&l('"refresher"')),null!==n&&null!==(e=j())?("uac"===t.substr(a,3).toLowerCase()?(r=t.substr(a,3),a+=3):(r=null,0===s&&l('"uac"')),null===r&&("uas"===t.substr(a,3).toLowerCase()?(r=t.substr(a,3),a+=3):(r=null,0===s&&l('"uas"'))),null!==r?n=[n,e,r]:(n=null,a=o)):(n=null,a=o),null!==n&&(c=n[2],n=void($t.refresher=c.toLowerCase())),null===n&&(a=i),n}function At(){var n,e;for(n=[],null===(e=I())&&null===(e=O())&&(e=E());null!==e;)n.push(e),null===(e=I())&&null===(e=O())&&(e=E());return n}function Ot(){var n,e,r,i,o,c,u,d,h,p,f,g;return p=a,f=a,null!==(n=Lt())?(45===t.charCodeAt(a)?(e="-",a++):(e=null,0===s&&l('"-"')),null!==e&&null!==(r=Pt())?(45===t.charCodeAt(a)?(i="-",a++):(i=null,0===s&&l('"-"')),null!==i&&null!==(o=Pt())?(45===t.charCodeAt(a)?(c="-",a++):(c=null,0===s&&l('"-"')),null!==c&&null!==(u=Pt())?(45===t.charCodeAt(a)?(d="-",a++):(d=null,0===s&&l('"-"')),null!==d&&null!==(h=Dt())?n=[n,e,r,i,o,c,u,d,h]:(n=null,a=f)):(n=null,a=f)):(n=null,a=f)):(n=null,a=f)):(n=null,a=f),null!==n&&(g=p,n[0],n=void($t=t.substring(a+5,g))),null===n&&(a=p),n}function Pt(){var n,e,t,r,i;return i=a,null!==(n=p())&&null!==(e=p())&&null!==(t=p())&&null!==(r=p())?n=[n,e,t,r]:(n=null,a=i),n}function Lt(){var n,e,t;return t=a,null!==(n=Pt())&&null!==(e=Pt())?n=[n,e]:(n=null,a=t),n}function Dt(){var n,e,t,r;return r=a,null!==(n=Pt())&&null!==(e=Pt())&&null!==(t=Pt())?n=[n,e,t]:(n=null,a=r),n}function Nt(){var n,e,r,i,o,c,u;return i=a,o=a,null!==(n=D())?(c=a,64===t.charCodeAt(a)?(e="@",a++):(e=null,0===s&&l('"@"')),null!==e&&null!==(r=D())?e=[e,r]:(e=null,a=c),null!==(e=null!==e?e:"")?n=[n,e]:(n=null,a=o)):(n=null,a=o),null!==n&&(u=i,n=void($t.call_id=t.substring(a,u))),null===n&&(a=i),n}function Mt(){var n;return null===(n=jt())&&null===(n=xt())&&null===(n=Ut())&&(n=Ee()),n}function jt(){var n,e,r,i,o,c;return i=a,o=a,"to-tag"===t.substr(a,6)?(n="to-tag",a+=6):(n=null,0===s&&l('"to-tag"')),null!==n&&null!==(e=j())&&null!==(r=P())?n=[n,e,r]:(n=null,a=o),null!==n&&(c=n[2],n=void($t.to_tag=c)),null===n&&(a=i),n}function xt(){var n,e,r,i,o,c;return i=a,o=a,"from-tag"===t.substr(a,8)?(n="from-tag",a+=8):(n=null,0===s&&l('"from-tag"')),null!==n&&null!==(e=j())&&null!==(r=P())?n=[n,e,r]:(n=null,a=o),null!==n&&(c=n[2],n=void($t.from_tag=c)),null===n&&(a=i),n}function Ut(){var n,e;return e=a,"early-only"===t.substr(a,10)?(n="early-only",a+=10):(n=null,0===s&&l('"early-only"')),null!==n&&(n=void($t.early_only=!0)),null===n&&(a=e),n}var Ft=n("./URI"),Gt=n("./NameAddrHeader"),$t={};if(null===i[r]()||a!==t.length){var Ht=Math.max(a,o),Bt=Ht<t.length?t.charAt(Ht):null,qt=function(){for(var n=1,e=1,r=!1,i=0;i<Math.max(a,o);i++){var s=t.charAt(i);"\n"===s?(r||n++,e=1,r=!1):"\r"===s||"\u2028"===s||"\u2029"===s?(n++,e=1,r=!0):(e++,r=!1)}return{line:n,column:e}}();return new this.SyntaxError(function(n){n.sort();for(var e=null,t=[],r=0;r<n.length;r++)n[r]!==e&&(t.push(n[r]),e=n[r]);return t}(c),Bt,Ht,qt.line,qt.column),-1}return $t},toSource:function(){return this._source},SyntaxError:function(n,t,r,i,a){this.name="SyntaxError",this.expected=n,this.found=t,this.message=function(n,t){var r;switch(n.length){case 0:r="end of input";break;case 1:r=n[0];break;default:r=n.slice(0,n.length-1).join(", ")+" or "+n[n.length-1]}return"Expected "+r+" but "+(t?e(t):"end of input")+" found."}(n,t),this.offset=r,this.line=i,this.column=a}};return t.SyntaxError.prototype=Error.prototype,t}()},{"./NameAddrHeader":10,"./URI":25}],8:[function(n,e,t){const r=n("webrtc-adapter"),i=n("../package.json"),a=n("./Constants"),s=n("./Exceptions"),o=n("./Utils"),c=n("./UA"),l=n("./URI"),u=n("./NameAddrHeader"),d=n("./Grammar"),h=n("./WebSocketInterface"),p=n("debug")("JsSIP"),f=n("./Message");p("version %s",i.version),e.exports={C:a,Exceptions:s,Utils:o,UA:c,URI:l,NameAddrHeader:u,WebSocketInterface:h,Message:f,Grammar:d,debug:n("debug"),adapter:r,get name(){return i.title},get version(){return i.version}}},{"../package.json":55,"./Constants":2,"./Exceptions":6,"./Grammar":7,"./Message":9,"./NameAddrHeader":10,"./UA":24,"./URI":25,"./Utils":26,"./WebSocketInterface":27,debug:30,"webrtc-adapter":40}],9:[function(n,e,t){const r=n("events").EventEmitter,i=n("./Constants"),a=n("./SIPMessage"),s=n("./Utils"),o=n("./RequestSender"),c=n("./Exceptions"),l=n("debug")("JsSIP:Message");e.exports=class extends r{constructor(n){super(),this._ua=n,this._request=null,this._closed=!1,this._direction=null,this._local_identity=null,this._remote_identity=null,this._is_replied=!1,this._data={}}get direction(){return this._direction}get local_identity(){return this._local_identity}get remote_identity(){return this._remote_identity}send(n,e,t,r={}){const c=n;if(void 0===n||void 0===e)throw new TypeError("Not enough arguments");if(!(n=this._ua.normalizeTarget(n)))throw new TypeError(`Invalid target: ${c}`);const l=s.cloneArray(r.extraHeaders),u=s.cloneObject(r.eventHandlers),d=r.contentType||"text/plain";for(const n in u)Object.prototype.hasOwnProperty.call(u,n)&&this.on(n,u[n]);l.push(`Content-Type: ${d}`),this._request=new a.OutgoingRequest(t||i.MESSAGE,n,this._ua,null,l),e&&(this._request.body=e),r.identifier&&""!==r.identifier&&this._request.setHeader("call-id",`${this._request.call_id}_${r.identifier}`);const h=new o(this._ua,this._request,{onRequestTimeout:()=>{this._onRequestTimeout()},onTransportError:()=>{this._onTransportError()},onReceiveResponse:n=>{this._receiveResponse(n)}});this._newMessage("local",this._request),h.send()}init_incoming(n){this._request=n,this._newMessage("remote",n),this._is_replied||(this._is_replied=!0,n.reply(200)),this._close()}accept(n={}){const e=s.cloneArray(n.extraHeaders),t=n.body;if("incoming"!==this._direction)throw new c.NotSupportedError('"accept" not supported for outgoing Message');if(this._is_replied)throw new Error("incoming Message already replied");this._is_replied=!0,this._request.reply(200,null,e,t)}reject(n={}){const e=n.status_code||480,t=n.reason_phrase,r=s.cloneArray(n.extraHeaders),i=n.body;if("incoming"!==this._direction)throw new c.NotSupportedError('"reject" not supported for outgoing Message');if(this._is_replied)throw new Error("incoming Message already replied");if(e<300||e>=700)throw new TypeError(`Invalid status_code: ${e}`);this._is_replied=!0,this._request.reply(e,t,r,i)}_receiveResponse(n){if(!this._closed)switch(!0){case/^1[0-9]{2}$/.test(n.status_code):break;case/^2[0-9]{2}$/.test(n.status_code):this._succeeded("remote",n);break;default:{const e=s.sipErrorCause(n.status_code);this._failed("remote",n,e);break}}}_onRequestTimeout(){this._closed||this._failed("system",null,i.causes.REQUEST_TIMEOUT)}_onTransportError(){this._closed||this._failed("system",null,i.causes.CONNECTION_ERROR)}_close(){this._closed=!0,this._ua.destroyMessage(this)}_newMessage(n,e){"remote"===n?(this._direction="incoming",this._local_identity=e.to,this._remote_identity=e.from):"local"===n&&(this._direction="outgoing",this._local_identity=e.from,this._remote_identity=e.to),this._ua.newMessage(this,{originator:n,message:this,request:e})}_failed(n,e,t){this._close(),e&&e.method!==i.OPTIONS&&l('emit "failed"'),this.emit("failed",{originator:n,response:e||null,cause:t})}_succeeded(n,e){l("MESSAGE succeeded"),this._close(),l('emit "succeeded"'),this.emit("succeeded",{originator:n,response:e})}}},{"./Constants":2,"./Exceptions":6,"./RequestSender":18,"./SIPMessage":19,"./Utils":26,debug:30,events:29}],10:[function(n,e,t){const r=n("./URI"),i=n("./Grammar");e.exports=class n{static parse(n){return-1!==(n=i.parse(n,"Name_Addr_Header"))?n:void 0}constructor(n,e,t){if(!(n&&n instanceof r))throw new TypeError('missing or invalid "uri" parameter');this._uri=n,this._parameters={},this.display_name=e;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&this.setParam(n,t[n])}get uri(){return this._uri}get display_name(){return this._display_name}set display_name(n){this._display_name=0===n?"0":n}setParam(n,e){n&&(this._parameters[n.toLowerCase()]=null==e?null:e.toString())}getParam(n){if(n)return this._parameters[n.toLowerCase()]}hasParam(n){if(n)return!!this._parameters.hasOwnProperty(n.toLowerCase())}deleteParam(n){if(n=n.toLowerCase(),this._parameters.hasOwnProperty(n)){const e=this._parameters[n];return delete this._parameters[n],e}}clearParams(){this._parameters={}}clone(){return new n(this._uri.clone(),this._display_name,JSON.parse(JSON.stringify(this._parameters)))}_quote(n){return n.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}toString(){let n=this._display_name?`"${this._quote(this._display_name)}" `:"";n+=`<${this._uri.toString()}>`;for(const e in this._parameters)Object.prototype.hasOwnProperty.call(this._parameters,e)&&(n+=`;${e}`,null!==this._parameters[e]&&(n+=`=${this._parameters[e]}`));return n}}},{"./Grammar":7,"./URI":25}],11:[function(n,e,t){const r=n("./Grammar"),i=n("./SIPMessage"),a=n("debug")("JsSIP:ERROR:Parser");function s(n,e){let t=e,r=0,i=0;if(n.substring(t,t+2).match(/(^\r\n)/))return-2;for(;0===r;){if(-1===(i=n.indexOf("\r\n",t)))return i;!n.substring(i+2,i+4).match(/(^\r\n)/)&&n.charAt(i+2).match(/(^\s+)/)?t=i+2:r=i}return r}function o(n,e,t,a){let s;const o=e.indexOf(":",t),c=e.substring(t,o).trim(),l=e.substring(o+1,a).trim();switch(c.toLowerCase()){case"via":case"v":n.addHeader("via",l),1===n.getHeaders("via").length?(s=n.parseHeader("Via"))&&(n.via=s,n.via_branch=s.branch):s=0;break;case"from":case"f":n.setHeader("from",l),(s=n.parseHeader("from"))&&(n.from=s,n.from_tag=s.getParam("tag"));break;case"to":case"t":n.setHeader("to",l),(s=n.parseHeader("to"))&&(n.to=s,n.to_tag=s.getParam("tag"));break;case"record-route":if(-1===(s=r.parse(l,"Record_Route")))s=void 0;else for(const e of s)n.addHeader("record-route",l.substring(e.possition,e.offset)),n.headers["Record-Route"][n.getHeaders("record-route").length-1].parsed=e.parsed;break;case"call-id":case"i":n.setHeader("call-id",l),(s=n.parseHeader("call-id"))&&(n.call_id=l);break;case"contact":case"m":if(-1===(s=r.parse(l,"Contact")))s=void 0;else for(const e of s)n.addHeader("contact",l.substring(e.possition,e.offset)),n.headers.Contact[n.getHeaders("contact").length-1].parsed=e.parsed;break;case"content-length":case"l":n.setHeader("content-length",l),s=n.parseHeader("content-length");break;case"content-type":case"c":n.setHeader("content-type",l),s=n.parseHeader("content-type");break;case"cseq":n.setHeader("cseq",l),(s=n.parseHeader("cseq"))&&(n.cseq=s.value),n instanceof i.IncomingResponse&&(n.method=s.method);break;case"max-forwards":n.setHeader("max-forwards",l),s=n.parseHeader("max-forwards");break;case"www-authenticate":n.setHeader("www-authenticate",l),s=n.parseHeader("www-authenticate");break;case"proxy-authenticate":n.setHeader("proxy-authenticate",l),s=n.parseHeader("proxy-authenticate");break;case"session-expires":case"x":n.setHeader("session-expires",l),(s=n.parseHeader("session-expires"))&&(n.session_expires=s.expires,n.session_expires_refresher=s.refresher);break;case"refer-to":case"r":n.setHeader("refer-to",l),(s=n.parseHeader("refer-to"))&&(n.refer_to=s);break;case"replaces":n.setHeader("replaces",l),(s=n.parseHeader("replaces"))&&(n.replaces=s);break;case"event":case"o":n.setHeader("event",l),(s=n.parseHeader("event"))&&(n.event=s);break;default:n.addHeader(c,l),s=0}return void 0!==s||{error:`error parsing header "${c}"`}}a.log=console.warn.bind(console),t.parseMessage=(n,e)=>{let t,c,l=n.indexOf("\r\n");if(-1===l)return void a("parseMessage() | no CRLF found, not a SIP message");const u=n.substring(0,l);let d=r.parse(u,"Request_Response");if(-1===d)return void a(`parseMessage() | error parsing first line of SIP message: "${u}"`);d.status_code?((t=new i.IncomingResponse).status_code=d.status_code,t.reason_phrase=d.reason_phrase):((t=new i.IncomingRequest(e)).method=d.method,t.ruri=d.uri),t.data=n;let h=l+2;for(;;){if(-2===(l=s(n,h))){c=h+2;break}if(-1===l)return void a("parseMessage() | malformed message");if(!0!==(d=o(t,n,h,l)))return void a("parseMessage() |",d.error);h=l+2}if(t.hasHeader("content-length")){const e=t.getHeader("content-length");t.body=n.substr(c,e)}else t.body=n.substring(c);return t}},{"./Grammar":7,"./SIPMessage":19,debug:30}],12:[function(n,e,t){const{EventEmitter:r}=n("events"),i=n("sdp-transform"),a=n("debug")("JsSIP:RTCSession"),s=n("debug")("JsSIP:ERROR:RTCSession"),o=n("./Constants"),c=n("./Exceptions"),l=n("./Transactions"),u=n("./Utils"),d=n("./Timers"),h=n("./SIPMessage"),p=n("./Dialog"),f=n("./RequestSender"),g=n("./RTCSession/DTMF"),m=n("./RTCSession/Info"),b=n("./RTCSession/ReferNotifier"),v=n("./RTCSession/ReferSubscriber");s.log=console.warn.bind(console);const y=o.SESSION_CONSTANTS,_=["audio","video"];let C=!1;e.exports=class n extends r{static get C(){return y}constructor(n){a("new"),super(),this._id=null,this._ua=n,this._transport=n._transport,this.inviteInterval=null,this._status=y.STATUS_NULL,this._dialog=null,this._earlyDialogs={},this._contact=null,this._from_tag=null,this._to_tag=null,this._connection=null,this._connectionPromiseQueue=Promise.resolve(),this._request=null,this._is_canceled=!1,this._cancel_reason="",this._is_confirmed=!1,this._late_sdp=!1,this._rtcOfferConstraints=null,this._rtcAnswerConstraints=null,this._localMediaStream=null,this._localMediaStreamLocallyGenerated=!1,this._rtcReady=!0,this._timers={ackTimer:null,expiresTimer:null,invite2xxTimer:null,userNoAnswerTimer:null},this._direction=null,this._local_identity=null,this._remote_identity=null,this._start_time=null,this._end_time=null,this._tones=null,this._audioMuted=!1,this._videoMuted=!1,this._localHold=!1,this._remoteHold=!1,this._sessionTimers={enabled:this._ua.configuration.session_timers,refreshMethod:this._ua.configuration.session_timers_refresh_method,defaultExpires:o.SESSION_EXPIRES,currentExpires:null,running:!1,refresher:!1,timer:null},this._referSubscribers={},this._data={}}get C(){return y}get causes(){return o.causes}get id(){return this._id}get connection(){return this._connection}get contact(){return this._contact}get direction(){return this._direction}get local_identity(){return this._local_identity}get remote_identity(){return this._remote_identity}get start_time(){return this._start_time}get end_time(){return this._end_time}get data(){return this._data}set data(n){this._data=n}get status(){return this._status}isInProgress(){switch(this._status){case y.STATUS_NULL:case y.STATUS_INVITE_SENT:case y.STATUS_1XX_RECEIVED:case y.STATUS_INVITE_RECEIVED:case y.STATUS_WAITING_FOR_ANSWER:return!0;default:return!1}}replaceUA(n){this._ua=n,this._transport=n._transport,this._dialog&&(this._dialog._owner._ua=n,this._dialog._ua=n,this._dialog._owner._transport=n._transport)}isEstablished(){switch(this._status){case y.STATUS_ANSWERED:case y.STATUS_WAITING_FOR_ACK:case y.STATUS_CONFIRMED:return!0;default:return!1}}isEnded(){switch(this._status){case y.STATUS_CANCELED:case y.STATUS_TERMINATED:return!0;default:return!1}}isMuted(){return{audio:this._audioMuted,video:this._videoMuted}}isOnHold(){return{local:this._localHold,remote:this._remoteHold}}emitNoCallExists(n){this.emit("noCall",{originator:"local",message:n.data,cause:n.reason_phrase})}connect(n,e={},t){a("connect()");const r=n,i=e.eventHandlers||{},s=u.cloneArray(e.extraHeaders),l=e.mediaConstraints||{audio:!0,video:!0},d=e.mediaStream||null,p=e.pcConfig||{iceServers:[]},f=e.rtcConstraints||null,g=e.rtcOfferConstraints||null;if(this._rtcOfferConstraints=g,this._rtcAnswerConstraints=e.rtcAnswerConstraints||null,this._data=e.data||this._data,void 0===n)throw new TypeError("Not enough arguments");if(this._status!==y.STATUS_NULL)throw new c.InvalidStateError(this._status);if(!window.RTCPeerConnection)throw new c.NotSupportedError("WebRTC not supported");if(!(n=this._ua.normalizeTarget(n)))throw new TypeError(`Invalid target: ${r}`);this._sessionTimers.enabled&&u.isDecimal(e.sessionTimersExpires)&&(e.sessionTimersExpires>=o.MIN_SESSION_EXPIRES?this._sessionTimers.defaultExpires=e.sessionTimersExpires:this._sessionTimers.defaultExpires=o.SESSION_EXPIRES);for(const n in i)Object.prototype.hasOwnProperty.call(i,n)&&this.on(n,i[n]);this._from_tag=u.newTag();const m=e.anonymous||!1,b={from_tag:this._from_tag};this._contact=this._ua.contact.toString({anonymous:m,outbound:!0}),m&&(b.from_display_name="Anonymous",b.from_uri="sip:anonymous@anonymous.invalid",s.push(`P-Preferred-Identity: ${this._ua.configuration.uri.toString()}`),s.push("Privacy: id")),s.push(`Contact: ${this._contact}`),s.push("Content-Type: application/sdp"),this._sessionTimers.enabled&&s.push(`Session-Expires: ${this._sessionTimers.defaultExpires}`),this._request=new h.InitialOutgoingInviteRequest(n,this._ua,b,s),this._id=this._request.call_id+this._from_tag,this._createRTCConnection(p,f),this._direction="outgoing",this._local_identity=this._request.from,this._remote_identity=this._request.to,t&&t(this),this._newRTCSession("local",this._request),this._sendInitialRequest(l,g,d)}init_incoming(n,e){let t;a("init_incoming()");const r=n.getHeader("Content-Type");n.body&&"application/sdp"!==r?n.reply(415):(this._status=y.STATUS_INVITE_RECEIVED,this._from_tag=n.from_tag,this._id=n.call_id+this._from_tag,this._request=n,this._contact=this._ua.contact.toString(),n.hasHeader("expires")&&(t=1e3*n.getHeader("expires")),n.to_tag=u.newTag(),this._createDialog(n,"UAS",!0)?(n.body?this._late_sdp=!1:this._late_sdp=!0,this._status=y.STATUS_WAITING_FOR_ANSWER,this._timers.userNoAnswerTimer=setTimeout((()=>{n.reply(408),this._failed("local",null,o.causes.NO_ANSWER)}),this._ua.configuration.no_answer_timeout),t&&(this._timers.expiresTimer=setTimeout((()=>{this._status===y.STATUS_WAITING_FOR_ANSWER&&(n.reply(487),this._failed("system",null,o.causes.EXPIRES))}),t)),this._direction="incoming",this._local_identity=n.to,this._remote_identity=n.from,e&&e(this),this._newRTCSession("remote",n),this._status!==y.STATUS_TERMINATED&&(n.reply(180,null,[`Contact: ${this._contact}`]),this._progress("local",null))):n.reply(500,"Missing Contact header field"))}answer(n={}){a("answer()");const e=this._request,t=u.cloneArray(n.extraHeaders),r=n.mediaConstraints||{},i=n.mediaStream||null,l=n.pcConfig||{iceServers:[]},d=n.rtcConstraints||null,h=n.rtcAnswerConstraints||null;let p,f=!1,g=!1,m=!1,b=!1;if(this._rtcAnswerConstraints=h,this._rtcOfferConstraints=n.rtcOfferConstraints||null,this._data=n.data||this._data,"incoming"!==this._direction)throw new c.NotSupportedError('"answer" not supported for outgoing RTCSession');if(this._status!==y.STATUS_WAITING_FOR_ANSWER)throw new c.InvalidStateError(this._status);if(this._sessionTimers.enabled&&u.isDecimal(n.sessionTimersExpires)&&(n.sessionTimersExpires>=o.MIN_SESSION_EXPIRES?this._sessionTimers.defaultExpires=n.sessionTimersExpires:this._sessionTimers.defaultExpires=o.SESSION_EXPIRES),this._status=y.STATUS_ANSWERED,!this._createDialog(e,"UAS"))return void e.reply(500,"Error creating dialog");clearTimeout(this._timers.userNoAnswerTimer),t.unshift(`Contact: ${this._contact}`);const v=e.parseSDP();Array.isArray(v.media)||(v.media=[v.media]);for(const n of v.media)"audio"===n.type&&(f=!0,n.direction&&"sendrecv"!==n.direction||(m=!0)),"video"===n.type&&(g=!0,n.direction&&"sendrecv"!==n.direction||(b=!0));if(i&&!1===r.audio){p=i.getAudioTracks();for(const n of p)i.removeTrack(n)}if(i&&!1===r.video){p=i.getVideoTracks();for(const n of p)i.removeTrack(n)}i||void 0!==r.audio||(r.audio=m),i||void 0!==r.video||(r.video=b),i||f||(r.audio=!1),i||g||(r.video=!1),this._createRTCConnection(l,d),Promise.resolve().then((()=>i||(r.audio||r.video?(this._localMediaStreamLocallyGenerated=!0,navigator.mediaDevices.getUserMedia(r).catch((n=>{if(this._status===y.STATUS_TERMINATED)throw new Error("terminated");throw e.reply(480),this._failed("local",null,o.causes.USER_DENIED_MEDIA_ACCESS),s('emit "getusermediafailed" [error:%o]',n),this.emit("getusermediafailed",n),new Error("getUserMedia() failed")}))):void 0))).then((n=>{if(this._status===y.STATUS_TERMINATED)throw new Error("terminated");this._localMediaStream=n,n&&this._connection.addStream(n)})).then((()=>{if(this._late_sdp)return;const n={originator:"remote",type:"offer",sdp:e.body};a('emit "sdp"'),this.emit("sdp",n);const t=new RTCSessionDescription({type:"offer",sdp:n.sdp});return this._connectionPromiseQueue=this._connectionPromiseQueue.then((()=>this._connection.setRemoteDescription(t))).catch((n=>{throw e.reply(488),this._failed("system",null,o.causes.WEBRTC_ERROR),s('emit "peerconnection:setremotedescriptionfailed" [error:%o]',n),this.emit("peerconnection:setremotedescriptionfailed",n),new Error("peerconnection.setRemoteDescription() failed")})),this._connectionPromiseQueue})).then((()=>{if(this._status===y.STATUS_TERMINATED)throw new Error("terminated");return this._connecting(e),this._late_sdp?this._createLocalDescription("offer",this._rtcOfferConstraints).catch((()=>{throw e.reply(500),new Error("_createLocalDescription() failed")})):this._createLocalDescription("answer",h).catch((()=>{throw e.reply(500),new Error("_createLocalDescription() failed")}))})).then((n=>{if(this._status===y.STATUS_TERMINATED)throw new Error("terminated");this._handleSessionTimersInIncomingRequest(e,t),e.reply(200,null,t,n,(()=>{this._status=y.STATUS_WAITING_FOR_ACK,this._setInvite2xxTimer(e,n),this._setACKTimer(),this._accepted("local")}),(()=>{this._failed("system",null,o.causes.CONNECTION_ERROR)}))})).catch((n=>{this._status!==y.STATUS_TERMINATED&&s(n)}))}terminate(n={}){a("terminate()");const e=n.cause||o.causes.BYE,t=u.cloneArray(n.extraHeaders),{body:r}=n;let i,{status_code:s}=n,{reason_phrase:d}=n;if(this._status===y.STATUS_TERMINATED)throw new c.InvalidStateError(this._status);switch(this._status){case y.STATUS_NULL:case y.STATUS_INVITE_SENT:case y.STATUS_1XX_RECEIVED:if(a("canceling session"),s&&(s<200||s>=700))throw new TypeError(`Invalid status_code: ${s}`);s&&(i=`SIP ;cause=${s} ;text="${d=d||o.REASON_PHRASE[s]||""}"`),this._status===y.STATUS_NULL||this._status===y.STATUS_INVITE_SENT?(this._is_canceled=!0,this._cancel_reason=i):this._status===y.STATUS_1XX_RECEIVED&&this._request.cancel(i),this._status=y.STATUS_CANCELED,this._failed("local",null,o.causes.CANCELED);break;case y.STATUS_WAITING_FOR_ANSWER:case y.STATUS_ANSWERED:if(a("rejecting session"),(s=s||480)<300||s>=700)throw new TypeError(`Invalid status_code: ${s}`);this._request.reply(s,d,t,r),this._failed("local",null,o.causes.REJECTED);break;case y.STATUS_WAITING_FOR_ACK:case y.STATUS_CONFIRMED:if(a("terminating session"),d=n.reason_phrase||o.REASON_PHRASE[s]||"",s&&(s<200||s>=700))throw new TypeError(`Invalid status_code: ${s}`);if(s&&t.push(`Reason: SIP ;cause=${s}; text="${d}"`),this._status===y.STATUS_WAITING_FOR_ACK&&"incoming"===this._direction&&this._request.server_transaction.state!==l.C.STATUS_TERMINATED){const n=this._dialog;this.receiveRequest=({method:e})=>{e===o.ACK&&(this.sendRequest(o.BYE,{extraHeaders:t,body:r}),n.terminate())},this._request.server_transaction.on("stateChanged",(()=>{this._request.server_transaction.state===l.C.STATUS_TERMINATED&&(this.sendRequest(o.BYE,{extraHeaders:t,body:r}),n.terminate())})),this._ended("local",null,e),this._dialog=n,this._ua.newDialog(n)}else this.sendRequest(o.BYE,{extraHeaders:t,body:r}),this._ended("local",null,e)}}sendDTMF(n,e={}){a("sendDTMF() | tones: %s",n);let t=0,r=e.duration||null,i=e.interToneGap||null;if(void 0===n)throw new TypeError("Not enough arguments");if(this._status!==y.STATUS_CONFIRMED&&this._status!==y.STATUS_WAITING_FOR_ACK)throw new c.InvalidStateError(this._status);if("number"==typeof n&&(n=n.toString()),!n||"string"!=typeof n||!n.match(/^[0-9A-DR#*,]+$/i))throw new TypeError(`Invalid tones: ${n}`);if(r&&!u.isDecimal(r))throw new TypeError(`Invalid tone duration: ${r}`);if(r?r<g.C.MIN_DURATION?(a(`"duration" value is lower than the minimum allowed, setting it to ${g.C.MIN_DURATION} milliseconds`),r=g.C.MIN_DURATION):r>g.C.MAX_DURATION?(a(`"duration" value is greater than the maximum allowed, setting it to ${g.C.MAX_DURATION} milliseconds`),r=g.C.MAX_DURATION):r=Math.abs(r):r=g.C.DEFAULT_DURATION,e.duration=r,i&&!u.isDecimal(i))throw new TypeError(`Invalid interToneGap: ${i}`);i?i<g.C.MIN_INTER_TONE_GAP?(a(`"interToneGap" value is lower than the minimum allowed, setting it to ${g.C.MIN_INTER_TONE_GAP} milliseconds`),i=g.C.MIN_INTER_TONE_GAP):i=Math.abs(i):i=g.C.DEFAULT_INTER_TONE_GAP,this._tones?this._tones+=n:(this._tones=n,function n(){let a;if(this._status===y.STATUS_TERMINATED||!this._tones||t>=this._tones.length)return void(this._tones=null);const s=this._tones[t];if(t+=1,","===s)a=2e3;else{const n=new g(this);e.eventHandlers={onFailed:()=>{this._tones=null}},n.send(s,e),a=r+i}setTimeout(n.bind(this),a)}.call(this))}sendInfo(n,e,t={}){if(a("sendInfo()"),this._status!==y.STATUS_CONFIRMED&&this._status!==y.STATUS_WAITING_FOR_ACK)throw new c.InvalidStateError(this._status);new m(this).send(n,e,t)}mute(n={audio:!0,video:!1}){a("mute()");let e=!1,t=!1;!1===this._audioMuted&&n.audio&&(e=!0,this._audioMuted=!0,this._toogleMuteAudio(!0)),!1===this._videoMuted&&n.video&&(t=!0,this._videoMuted=!0,this._toogleMuteVideo(!0)),!0!==e&&!0!==t||this._onmute({audio:e,video:t})}unmute(n={audio:!0,video:!0}){a("unmute()");let e=!1,t=!1;!0===this._audioMuted&&n.audio&&(e=!0,this._audioMuted=!1,!1===this._localHold&&this._toogleMuteAudio(!1)),!0===this._videoMuted&&n.video&&(t=!0,this._videoMuted=!1,!1===this._localHold&&this._toogleMuteVideo(!1)),!0!==e&&!0!==t||this._onunmute({audio:e,video:t})}hold(n={},e){if(a("hold()"),this._status!==y.STATUS_WAITING_FOR_ACK&&this._status!==y.STATUS_CONFIRMED)return!1;if(!0===this._localHold)return!1;if(!this._isReadyToReOffer())return!1;this._localHold=!0,this._onhold("local");const t={succeeded:()=>{e&&e()},failed:()=>{this.terminate({cause:o.causes.WEBRTC_ERROR,status_code:500,reason_phrase:"Hold Failed"})}};return n.useUpdate?this._sendUpdate({sdpOffer:!0,eventHandlers:t,extraHeaders:n.extraHeaders}):this._sendReinvite({eventHandlers:t,extraHeaders:n.extraHeaders}),!0}unhold(n={},e){if(a("unhold()"),this._status!==y.STATUS_WAITING_FOR_ACK&&this._status!==y.STATUS_CONFIRMED)return!1;if(!1===this._localHold)return!1;if(!this._isReadyToReOffer())return!1;this._localHold=!1,this._onunhold("local");const t={succeeded:()=>{e&&e()},failed:()=>{this.terminate({cause:o.causes.WEBRTC_ERROR,status_code:500,reason_phrase:"Unhold Failed"})}};return n.useUpdate?this._sendUpdate({sdpOffer:!0,eventHandlers:t,extraHeaders:n.extraHeaders}):this._sendReinvite({eventHandlers:t,extraHeaders:n.extraHeaders}),!0}setReInviteIceGathering(n){C=n}renegotiate(n={},e){a("renegotiate()");const t=n.rtcOfferConstraints||null;if(this._status!==y.STATUS_WAITING_FOR_ACK&&this._status!==y.STATUS_CONFIRMED)return!1;if(!this._isReadyToReOffer())return!1;const r={succeeded:()=>{e&&e()},failed:()=>{}};return this._setLocalMediaStatus(),n.useUpdate?this._sendUpdate({sdpOffer:!0,eventHandlers:r,rtcOfferConstraints:t,extraHeaders:n.extraHeaders}):(this._transport.isConnecting()||this._ua.isRegistering()||n.sendReinviteOnly||(this._transport.disconnect(!0),this._transport.connect()),this._sendReinvite({eventHandlers:r,rtcOfferConstraints:t,extraHeaders:n.extraHeaders})),!0}refer(n,e){a("refer()");const t=n;if(!(n=this._ua.normalizeTarget(n)))throw new TypeError(`Invalid target: ${t}`);const r=new v(this);r.sendRefer(n,e);const{id:i}=r;return this._referSubscribers[i]=r,r.on("requestFailed",(()=>{delete this._referSubscribers[i]})),r.on("accepted",(()=>{delete this._referSubscribers[i]})),r.on("failed",(()=>{delete this._referSubscribers[i]})),r}sendRequest(n,e){return a("sendRequest()"),this._dialog.sendRequest(n,e)}receiveRequest(n){if(a("receiveRequest()"),n.method===o.CANCEL)this._status!==y.STATUS_WAITING_FOR_ANSWER&&this._status!==y.STATUS_ANSWERED||(this._status=y.STATUS_CANCELED,this._request.reply(487),this._failed("remote",n,o.causes.CANCELED));else switch(n.method){case o.ACK:if(this._status!==y.STATUS_WAITING_FOR_ACK)return;if(this._status=y.STATUS_CONFIRMED,clearTimeout(this._timers.ackTimer),clearTimeout(this._timers.invite2xxTimer),this._late_sdp){if(!n.body){this.terminate({cause:o.causes.MISSING_SDP,status_code:400});break}const e={originator:"remote",type:"answer",sdp:n.body};a('emit "sdp"'),this.emit("sdp",e);const t=new RTCSessionDescription({type:"answer",sdp:e.sdp});this._connectionPromiseQueue=this._connectionPromiseQueue.then((()=>this._connection.setRemoteDescription(t))).then((()=>{this._is_confirmed||this._confirmed("remote",n)})).catch((n=>{this.terminate({cause:o.causes.BAD_MEDIA_DESCRIPTION,status_code:488}),s('emit "peerconnection:setremotedescriptionfailed" [error:%o]',n),this.emit("peerconnection:setremotedescriptionfailed",n)}))}else this._is_confirmed||this._confirmed("remote",n);break;case o.BYE:this._status===y.STATUS_CONFIRMED?(n.reply(200),this._ended("remote",n,o.causes.BYE)):this._status===y.STATUS_INVITE_RECEIVED?(n.reply(200),this._request.reply(487,"BYE Received"),this._ended("remote",n,o.causes.BYE)):n.reply(403,"Wrong Status");break;case o.INVITE:this._status===y.STATUS_CONFIRMED?n.hasHeader("replaces")?this._receiveReplaces(n):this._receiveReinvite(n):n.reply(403,"Wrong Status");break;case o.INFO:if(this._status===y.STATUS_1XX_RECEIVED||this._status===y.STATUS_WAITING_FOR_ANSWER||this._status===y.STATUS_ANSWERED||this._status===y.STATUS_WAITING_FOR_ACK||this._status===y.STATUS_CONFIRMED){const e=n.getHeader("content-type");e&&e.match(/^application\/dtmf-relay/i)?new g(this).init_incoming(n):void 0!==e?new m(this).init_incoming(n):n.reply(415)}else n.reply(403,"Wrong Status");break;case o.UPDATE:this._status===y.STATUS_CONFIRMED?this._receiveUpdate(n):n.reply(403,"Wrong Status");break;case o.REFER:this._status===y.STATUS_CONFIRMED?this._receiveRefer(n):n.reply(403,"Wrong Status");break;case o.NOTIFY:this._status===y.STATUS_CONFIRMED?this._receiveNotify(n):n.reply(403,"Wrong Status");break;default:n.reply(501)}}onTransportError(){s("onTransportError()"),this._status!==y.STATUS_TERMINATED&&this.terminate({status_code:500,reason_phrase:o.causes.CONNECTION_ERROR,cause:o.causes.CONNECTION_ERROR})}onRequestTimeout(){s("onRequestTimeout()"),this._status!==y.STATUS_TERMINATED&&this.terminate({status_code:408,reason_phrase:o.causes.REQUEST_TIMEOUT,cause:o.causes.REQUEST_TIMEOUT})}onDialogError(){s("onDialogError()"),this._status!==y.STATUS_TERMINATED&&this.terminate({status_code:500,reason_phrase:o.causes.DIALOG_ERROR,cause:o.causes.DIALOG_ERROR})}newDTMF(n){a("newDTMF()"),this.emit("newDTMF",n)}newInfo(n){a("newInfo()"),this.emit("newInfo",n)}_isReadyToReOffer(){return this._rtcReady?this._dialog?!0!==this._dialog.uac_pending_reply&&!0!==this._dialog.uas_pending_reply||(a("_isReadyToReOffer() | there is another INVITE/UPDATE transaction in progress"),!1):(a("_isReadyToReOffer() | session not established yet"),!1):(a("_isReadyToReOffer() | internal WebRTC status not ready"),!1)}_close(){if(a("close()"),this._status!==y.STATUS_TERMINATED){if(this._status=y.STATUS_TERMINATED,this._connection)try{this._connection.close()}catch(n){s("close() | error closing the RTCPeerConnection: %o",n)}this._localMediaStream&&this._localMediaStreamLocallyGenerated&&(a("close() | closing local MediaStream"),u.closeMediaStream(this._localMediaStream));for(const n in this._timers)Object.prototype.hasOwnProperty.call(this._timers,n)&&clearTimeout(this._timers[n]);clearTimeout(this._sessionTimers.timer),this._dialog&&(this._dialog.terminate(),delete this._dialog);for(const n in this._earlyDialogs)Object.prototype.hasOwnProperty.call(this._earlyDialogs,n)&&(this._earlyDialogs[n].terminate(),delete this._earlyDialogs[n]);for(const n in this._referSubscribers)Object.prototype.hasOwnProperty.call(this._referSubscribers,n)&&delete this._referSubscribers[n];this._ua.destroyRTCSession(this)}}_setInvite2xxTimer(n,e){let t=d.T1;this._timers.invite2xxTimer=setTimeout(function r(){this._status===y.STATUS_WAITING_FOR_ACK&&(n.reply(200,null,[`Contact: ${this._contact}`],e),t<d.T2&&(t*=2)>d.T2&&(t=d.T2),this._timers.invite2xxTimer=setTimeout(r.bind(this),t))}.bind(this),t)}_setACKTimer(){this._timers.ackTimer=setTimeout((()=>{this._status===y.STATUS_WAITING_FOR_ACK&&(a("no ACK received, terminating the session"),clearTimeout(this._timers.invite2xxTimer),this.sendRequest(o.BYE),this._ended("remote",null,o.causes.NO_ACK))}),d.TIMER_H)}_createRTCConnection(n,e){this._connection=new RTCPeerConnection(n,e),this._connection.addEventListener("iceconnectionstatechange",(()=>{this._connection.iceConnectionState})),a('emit "peerconnection"'),this.emit("peerconnection",{peerconnection:this._connection})}_createLocalDescription(n,e,t=!1){if(a("createLocalDescription()"),"offer"!==n&&"answer"!==n)throw new Error(`createLocalDescription() | invalid type "${n}"`);const r=this._connection;return this._rtcReady=!1,Promise.resolve().then((()=>"offer"===n?r.createOffer(e).catch((n=>(s('emit "peerconnection:createofferfailed" [error:%o]',n),this.emit("peerconnection:createofferfailed",n),Promise.reject(n)))):r.createAnswer(e).catch((n=>(s('emit "peerconnection:createanswerfailed" [error:%o]',n),this.emit("peerconnection:createanswerfailed",n),Promise.reject(n)))))).then((n=>r.setLocalDescription(n).catch((n=>(this._rtcReady=!0,s('emit "peerconnection:setlocaldescriptionfailed" [error:%o]',n),this.emit("peerconnection:setlocaldescriptionfailed",n),Promise.reject(n)))))).then((()=>{if("complete"===r.iceGatheringState&&!t){this._rtcReady=!0;const e={originator:"local",type:n,sdp:r.localDescription.sdp};return a('emit "sdp"'),this.emit("sdp",e),Promise.resolve(e.sdp)}return new Promise((e=>{let t,i=!1;const s=()=>{r.removeEventListener("icecandidate",t),i=!0,this._rtcReady=!0;const s={originator:"local",type:n,sdp:r.localDescription.sdp};a('emit "sdp"'),this.emit("sdp",s),e(s.sdp)};r.addEventListener("icecandidate",t=n=>{const{candidate:e}=n;e?this.emit("icecandidate",{candidate:e,ready:s}):i||s()})}))}))}_createDialog(n,e,t){const r="UAS"===e?n.to_tag:n.from_tag,i="UAS"===e?n.from_tag:n.to_tag,s=n.call_id+r+i;let c=this._earlyDialogs[s];if(t)return!!c||((c=new p(this,n,e,p.C.STATUS_EARLY)).error?(a(c.error),this._failed("remote",n,o.causes.INTERNAL_ERROR),!1):(this._earlyDialogs[s]=c,!0));if(this._from_tag=n.from_tag,this._to_tag=n.to_tag,c)return c.update(n,e),this._dialog=c,delete this._earlyDialogs[s],!0;const l=new p(this,n,e);return l.error?(a(l.error),this._failed("remote",n,o.causes.INTERNAL_ERROR),!1):(this._dialog=l,!0)}_receiveReinvite(n){a("receiveReinvite()");const e=n.getHeader("Content-Type"),t={request:n,callback:void 0,reject:function(e={}){r=!0;const t=e.status_code||403,i=e.reason_phrase||"",a=u.cloneArray(e.extraHeaders);if(this._status!==y.STATUS_CONFIRMED)return!1;if(t<300||t>=700)throw new TypeError(`Invalid status_code: ${t}`);n.reply(t,i,a)}.bind(this)};let r=!1;if(this.emit("reinvite",t),!r){if(this._late_sdp=!1,!n.body)return this._late_sdp=!0,void(this._connectionPromiseQueue=this._connectionPromiseQueue.then((()=>this._createLocalDescription("offer",this._rtcOfferConstraints))).then((n=>{i.call(this,n)})).catch((()=>{n.reply(500)})));if("application/sdp"!==e)return a("invalid Content-Type"),void n.reply(415);this._processInDialogSdpOffer(n).then((n=>{this._status!==y.STATUS_TERMINATED&&i.call(this,n)})).catch((n=>{s(n)}))}function i(e){const r=[`Contact: ${this._contact}`];this._handleSessionTimersInIncomingRequest(n,r),this._late_sdp&&(e=this._mangleOffer(e)),n.reply(200,null,r,e,(()=>{this._status=y.STATUS_WAITING_FOR_ACK,this._setInvite2xxTimer(n,e),this._setACKTimer()})),"function"==typeof t.callback&&t.callback()}}_receiveUpdate(n){a("receiveUpdate()");const e=n.getHeader("Content-Type"),t={request:n,callback:void 0,reject:function(e={}){r=!0;const t=e.status_code||403,i=e.reason_phrase||"",a=u.cloneArray(e.extraHeaders);if(this._status!==y.STATUS_CONFIRMED)return!1;if(t<300||t>=700)throw new TypeError(`Invalid status_code: ${t}`);n.reply(t,i,a)}.bind(this)};let r=!1;if(this.emit("update",t),!r)if(n.body){if("application/sdp"!==e)return a("invalid Content-Type"),void n.reply(415);this._processInDialogSdpOffer(n).then((n=>{this._status!==y.STATUS_TERMINATED&&i.call(this,n)})).catch((n=>{s(n)}))}else i.call(this,null);function i(e){const r=[`Contact: ${this._contact}`];this._handleSessionTimersInIncomingRequest(n,r),n.reply(200,null,r,e),"function"==typeof t.callback&&t.callback()}}_processInDialogSdpOffer(n){a("_processInDialogSdpOffer()");const e=n.parseSDP();let t=!1;for(const n of e.media){if(-1===_.indexOf(n.type))continue;const r=n.direction||e.direction||"sendrecv";if("sendonly"!==r&&"inactive"!==r){t=!1;break}t=!0}const r={originator:"remote",type:"offer",sdp:n.body};a('emit "sdp"'),this.emit("sdp",r);const i=new RTCSessionDescription({type:"offer",sdp:r.sdp});return this._connectionPromiseQueue=this._connectionPromiseQueue.then((()=>{if(this._status===y.STATUS_TERMINATED)throw new Error("terminated");return this._connection.setRemoteDescription(i).catch((e=>{throw n.reply(488),s('emit "peerconnection:setremotedescriptionfailed" [error:%o]',e),this.emit("peerconnection:setremotedescriptionfailed",e),new Error("peerconnection.setRemoteDescription() failed")}))})).then((()=>{if(this._status===y.STATUS_TERMINATED)throw new Error("terminated");!0===this._remoteHold&&!1===t?(this._remoteHold=!1,this._onunhold("remote")):!1===this._remoteHold&&!0===t&&(this._remoteHold=!0,this._onhold("remote"))})).then((()=>{if(this._status===y.STATUS_TERMINATED)throw new Error("terminated");return this._createLocalDescription("answer",this._rtcAnswerConstraints).catch((()=>{throw n.reply(500),new Error("_createLocalDescription() failed")}))})),this._connectionPromiseQueue}_receiveRefer(e){if(a("receiveRefer()"),void 0===typeof e.refer_to)return a("no Refer-To header field present in REFER"),void e.reply(400);if(e.refer_to.uri.scheme!==o.SIP)return a("Refer-To header field points to a non-SIP URI scheme"),void e.reply(416);e.reply(202);const t=new b(this,e.cseq);a('emit "refer"'),this.emit("refer",{request:e,accept:(r,i)=>{(function(r,i={}){if(r="function"==typeof r?r:null,this._status!==y.STATUS_WAITING_FOR_ACK&&this._status!==y.STATUS_CONFIRMED)return!1;const a=new n(this._ua);if(a.on("progress",(({response:n})=>{t.notify(n.status_code,n.reason_phrase)})),a.on("accepted",(({response:n})=>{t.notify(n.status_code,n.reason_phrase)})),a.on("failed",(({message:n,cause:e})=>{n?t.notify(n.status_code,n.reason_phrase):t.notify(487,e)})),e.refer_to.uri.hasHeader("replaces")){const n=decodeURIComponent(e.refer_to.uri.getHeader("replaces"));i.extraHeaders=u.cloneArray(i.extraHeaders),i.extraHeaders.push(`Replaces: ${n}`)}a.connect(e.refer_to.uri.toAor(),i,r)}).call(this,r,i)},reject:()=>{(function(){t.notify(603)}).call(this)}})}_receiveNotify(n){switch(a("receiveNotify()"),void 0===typeof n.event&&n.reply(400),n.event.event){case"refer":{let e,t;if(n.event.params&&n.event.params.id)e=n.event.params.id,t=this._referSubscribers[e];else{if(1!==Object.keys(this._referSubscribers).length)return void n.reply(400,"Missing event id parameter");t=this._referSubscribers[Object.keys(this._referSubscribers)[0]]}if(!t)return void n.reply(481,"Subscription does not exist");t.receiveNotify(n),n.reply(200);break}default:n.reply(489)}}_receiveReplaces(e){a("receiveReplaces()"),this.emit("replaces",{request:e,accept:t=>{(function(t){if(this._status!==y.STATUS_WAITING_FOR_ACK&&this._status!==y.STATUS_CONFIRMED)return!1;const r=new n(this._ua);r.on("confirmed",(()=>{this.terminate()})),r.init_incoming(e,t)}).call(this,t)},reject:()=>{(function(){a("Replaced INVITE rejected by the user"),e.reply(486)}).call(this)}})}_sendInitialRequest(n,e,t){const r=new f(this._ua,this._request,{onRequestTimeout:()=>{this.onRequestTimeout()},onTransportError:()=>{this.onTransportError()},onAuthenticated:n=>{this._request=n},onReceiveResponse:n=>{this._receiveInviteResponse(n)}});Promise.resolve().then((()=>t||(n.audio||n.video?(this._localMediaStreamLocallyGenerated=!0,navigator.mediaDevices.getUserMedia(n).catch((n=>{if(this._status===y.STATUS_TERMINATED)throw new Error("terminated");throw this._failed("local",null,o.causes.USER_DENIED_MEDIA_ACCESS),s('emit "getusermediafailed" [error:%o]',n),this.emit("getusermediafailed"),n}))):void 0))).then((n=>{if(this._status===y.STATUS_TERMINATED)throw new Error("terminated");return this._localMediaStream=n,n&&this._connection.addStream(n),this._connecting(this._request),this._createLocalDescription("offer",e).catch((n=>{throw this._failed("local",null,o.causes.WEBRTC_ERROR),n}))})).then((n=>{if(this._is_canceled||this._status===y.STATUS_TERMINATED)throw new Error("terminated");this._request.body=n,this._status=y.STATUS_INVITE_SENT,a('emit "sending" [request:%o]',this._request),this.emit("sending",{request:this._request}),r.send()})).catch((n=>{this._status!==y.STATUS_TERMINATED&&s(n)}))}_receiveInviteResponse(n){if(a("receiveInviteResponse()"),this._dialog&&n.status_code>=200&&n.status_code<=299){if(this._dialog.id.call_id===n.call_id&&this._dialog.id.local_tag===n.from_tag&&this._dialog.id.remote_tag===n.to_tag)return void this.sendRequest(o.ACK);const e=new p(this,n,"UAC");return void 0!==e.error?void a(e.error):(this.sendRequest(o.ACK),void this.sendRequest(o.BYE))}if(this._is_canceled)n.status_code>=100&&n.status_code<200?this._request.cancel(this._cancel_reason):n.status_code>=200&&n.status_code<299&&this._acceptAndTerminate(n);else if(this._status===y.STATUS_INVITE_SENT||this._status===y.STATUS_1XX_RECEIVED)switch(!0){case/^100$/.test(n.status_code):this._status=y.STATUS_1XX_RECEIVED;break;case/^1[0-9]{2}$/.test(n.status_code):{if(!n.to_tag){a("1xx response received without to tag");break}if(n.hasHeader("contact")&&!this._createDialog(n,"UAC",!0))break;if(this._status=y.STATUS_1XX_RECEIVED,this._progress("remote",n),!n.body)break;const e={originator:"remote",type:"answer",sdp:n.body};a('emit "sdp"'),this.emit("sdp",e);const t=new RTCSessionDescription({type:"answer",sdp:e.sdp});this._connectionPromiseQueue=this._connectionPromiseQueue.then((()=>this._connection.setRemoteDescription(t))).catch((n=>{s('emit "peerconnection:setremotedescriptionfailed" [error:%o]',n),this.emit("peerconnection:setremotedescriptionfailed",n)}));break}case/^2[0-9]{2}$/.test(n.status_code):{if(this._status=y.STATUS_CONFIRMED,!n.body){this._acceptAndTerminate(n,400,o.causes.MISSING_SDP),this._failed("remote",n,o.causes.BAD_MEDIA_DESCRIPTION);break}if(!this._createDialog(n,"UAC"))break;const e={originator:"remote",type:"answer",sdp:n.body};a('emit "sdp"'),this.emit("sdp",e);const t=new RTCSessionDescription({type:"answer",sdp:e.sdp});this._connectionPromiseQueue=this._connectionPromiseQueue.then((()=>{if("stable"===this._connection.signalingState)return this._connection.createOffer().then((n=>this._connection.setLocalDescription(n))).catch((e=>{this._acceptAndTerminate(n,500,e.toString()),this._failed("local",n,o.causes.WEBRTC_ERROR)}))})).then((()=>{this._connection.setRemoteDescription(t).then((()=>{this._handleSessionTimersInIncomingResponse(n),this._accepted("remote",n),this.sendRequest(o.ACK),this._confirmed("local",null)})).catch((e=>{this._acceptAndTerminate(n,488,"Not Acceptable Here"),this._failed("remote",n,o.causes.BAD_MEDIA_DESCRIPTION),s('emit "peerconnection:setremotedescriptionfailed" [error:%o]',e),this.emit("peerconnection:setremotedescriptionfailed",e)}))}));break}default:{const e=u.sipErrorCause(n.status_code);this._failed("remote",n,e)}}}_sendReinvite(n={}){a("sendReinvite()");const e=u.cloneArray(n.extraHeaders),t=n.eventHandlers||{},r=n.rtcOfferConstraints||this._rtcOfferConstraints||null;let i=!1;function c(n){t.failed&&t.failed(n)}function l(){clearInterval(this.inviteInterval),this.inviteInterval=null,this.reconnectTryCount=0}e.push(`Contact: ${this._contact}`),e.push("Content-Type: application/sdp"),this._sessionTimers.running&&e.push(`Session-Expires: ${this._sessionTimers.currentExpires};refresher=${this._sessionTimers.refresher?"uac":"uas"}`),this._connectionPromiseQueue=this._connectionPromiseQueue.then((()=>this._createLocalDescription("offer",r))).then((n=>{n=this._mangleOffer(n)})).catch((()=>{c()})),null==this.inviteInterval?(this.reconnectTryCount=0,this.inviteInterval=setInterval((()=>{this.reconnectTryCount+=1,0===this._transport.status&&(this._ua.isConnected()||this._ua.isRegistered())&&(this._connectionPromiseQueue=this._connectionPromiseQueue.then((()=>this._createLocalDescription("offer",r,!0))).then((n=>{(function(n){const e=n.split("\n");let t=0;for(let n=0;n<e.length;n++)-1!=e[n].indexOf("a=candidate")&&t++;return t>0}).call(this,n)&&(n=this._mangleOffer(n),this.sendRequest(o.INVITE,{extraHeaders:e,body:n,eventHandlers:{onSuccessResponse:n=>{(function(n){if(this._status===y.STATUS_TERMINATED)return;if(this.sendRequest(o.ACK),i)return;if(this._handleSessionTimersInIncomingResponse(n),!n.body)return void c.call(this);if("application/sdp"!==n.getHeader("Content-Type"))return void c.call(this);const e={originator:"remote",type:"answer",sdp:n.body};a('emit "sdp"'),this.emit("sdp",e);const r=new RTCSessionDescription({type:"answer",sdp:e.sdp});this._connectionPromiseQueue=this._connectionPromiseQueue.then((()=>this._connection.setRemoteDescription(r))).then((()=>{t.succeeded&&t.succeeded(n)})).catch((n=>{c.call(this),s('emit "peerconnection:setremotedescriptionfailed" [error:%o]',n),this.emit("peerconnection:setremotedescriptionfailed",n)}))}).call(this,n),i=!0},onErrorResponse:n=>{c.call(this,n)},onTransportError:()=>{},onRequestTimeout:()=>{},onDialogError:()=>{}}}),console.log("Re-Invite Sent"),l.call(this))})).catch((()=>{c(),l.call(this)}))),this.reconnectTryCount>20&&l.call(this)}),1e3)):this.reconnectTryCount=0}_sendUpdate(n={}){a("sendUpdate()");const e=u.cloneArray(n.extraHeaders),t=n.eventHandlers||{},r=n.rtcOfferConstraints||this._rtcOfferConstraints||null,i=n.sdpOffer||!1;let c=!1;function l(n){if(this._status!==y.STATUS_TERMINATED&&!c)if(this._handleSessionTimersInIncomingResponse(n),i){if(!n.body)return void d.call(this);if("application/sdp"!==n.getHeader("Content-Type"))return void d.call(this);const e={originator:"remote",type:"answer",sdp:n.body};a('emit "sdp"'),this.emit("sdp",e);const r=new RTCSessionDescription({type:"answer",sdp:e.sdp});this._connectionPromiseQueue=this._connectionPromiseQueue.then((()=>this._connection.setRemoteDescription(r))).then((()=>{t.succeeded&&t.succeeded(n)})).catch((n=>{d.call(this),s('emit "peerconnection:setremotedescriptionfailed" [error:%o]',n),this.emit("peerconnection:setremotedescriptionfailed",n)}))}else t.succeeded&&t.succeeded(n)}function d(n){t.failed&&t.failed(n)}e.push(`Contact: ${this._contact}`),this._sessionTimers.running&&e.push(`Session-Expires: ${this._sessionTimers.currentExpires};refresher=${this._sessionTimers.refresher?"uac":"uas"}`),i?(e.push("Content-Type: application/sdp"),this._connectionPromiseQueue=this._connectionPromiseQueue.then((()=>this._createLocalDescription("offer",r))).then((n=>{n=this._mangleOffer(n),this.sendRequest(o.UPDATE,{extraHeaders:e,body:n,eventHandlers:{onSuccessResponse:n=>{l.call(this,n),c=!0},onErrorResponse:n=>{d.call(this,n)},onTransportError:()=>{this.onTransportError()},onRequestTimeout:()=>{this.onRequestTimeout()},onDialogError:()=>{this.onDialogError()}}})})).catch((()=>{d.call(this)}))):this.sendRequest(o.UPDATE,{extraHeaders:e,eventHandlers:{onSuccessResponse:n=>{l.call(this,n)},onErrorResponse:n=>{d.call(this,n)},onTransportError:()=>{this.onTransportError()},onRequestTimeout:()=>{this.onRequestTimeout()},onDialogError:()=>{this.onDialogError()}}})}_acceptAndTerminate(n,e,t){a("acceptAndTerminate()");const r=[];e&&(t=t||o.REASON_PHRASE[e]||"",r.push(`Reason: SIP ;cause=${e}; text="${t}"`)),(this._dialog||this._createDialog(n,"UAC"))&&(this.sendRequest(o.ACK),this.sendRequest(o.BYE,{extraHeaders:r})),this._status=y.STATUS_TERMINATED}_mangleOffer(n){if(!this._localHold&&!this._remoteHold)return n;if(n=i.parse(n),this._localHold&&!this._remoteHold){a("mangleOffer() | me on hold, mangling offer");for(const e of n.media)-1!==_.indexOf(e.type)&&(e.direction?"sendrecv"===e.direction?e.direction="sendonly":"recvonly"===e.direction&&(e.direction="inactive"):e.direction="sendonly")}else if(this._localHold&&this._remoteHold){a("mangleOffer() | both on hold, mangling offer");for(const e of n.media)-1!==_.indexOf(e.type)&&(e.direction="inactive")}else if(this._remoteHold){a("mangleOffer() | remote on hold, mangling offer");for(const e of n.media)-1!==_.indexOf(e.type)&&(e.direction?"sendrecv"===e.direction?e.direction="recvonly":"recvonly"===e.direction&&(e.direction="inactive"):e.direction="recvonly")}return i.write(n)}_setLocalMediaStatus(){let n=!0,e=!0;(this._localHold||this._remoteHold)&&(n=!1,e=!1),this._audioMuted&&(n=!1),this._videoMuted&&(e=!1),this._toogleMuteAudio(!n),this._toogleMuteVideo(!e)}_handleSessionTimersInIncomingRequest(n,e){if(!this._sessionTimers.enabled)return;let t;n.session_expires&&n.session_expires>=o.MIN_SESSION_EXPIRES?(this._sessionTimers.currentExpires=n.session_expires,t=n.session_expires_refresher||"uas"):(this._sessionTimers.currentExpires=this._sessionTimers.defaultExpires,t="uas"),e.push(`Session-Expires: ${this._sessionTimers.currentExpires};refresher=${t}`),this._sessionTimers.refresher="uas"===t,this._runSessionTimer()}_handleSessionTimersInIncomingResponse(n){if(!this._sessionTimers.enabled)return;let e;n.session_expires&&n.session_expires>=o.MIN_SESSION_EXPIRES?(this._sessionTimers.currentExpires=n.session_expires,e=n.session_expires_refresher||"uac"):(this._sessionTimers.currentExpires=this._sessionTimers.defaultExpires,e="uac"),this._sessionTimers.refresher="uac"===e,this._runSessionTimer()}_runSessionTimer(){const n=this._sessionTimers.currentExpires;this._sessionTimers.running=!0,clearTimeout(this._sessionTimers.timer),this._sessionTimers.refresher?this._sessionTimers.timer=setTimeout((()=>{this._status!==y.STATUS_TERMINATED&&(a("runSessionTimer() | sending session refresh request"),this._sessionTimers.refreshMethod===o.UPDATE?this._sendUpdate():this._sendReinvite())}),500*n):this._sessionTimers.timer=setTimeout((()=>{this._status!==y.STATUS_TERMINATED&&(s("runSessionTimer() | timer expired, terminating the session"),this.terminate({cause:o.causes.REQUEST_TIMEOUT,status_code:408,reason_phrase:"Session Timer Expired"}))}),1100*n)}_toogleMuteAudio(n){const e=this._connection.getLocalStreams();for(const t of e){const e=t.getAudioTracks();for(const t of e)t.enabled=!n}}_toogleMuteVideo(n){const e=this._connection.getLocalStreams();for(const t of e){const e=t.getVideoTracks();for(const t of e)t.enabled=!n}}_newRTCSession(n,e){a("newRTCSession()"),this._ua.newRTCSession(this,{originator:n,session:this,request:e})}_connecting(n){a("session connecting"),a('emit "connecting"'),this.emit("connecting",{request:n})}_progress(n,e){a("session progress"),a('emit "progress"'),this.emit("progress",{originator:n,response:e||null})}_accepted(n,e){a("session accepted"),this._start_time=new Date,a('emit "accepted"'),this.emit("accepted",{originator:n,response:e||null})}_confirmed(n,e){a("session confirmed"),this._is_confirmed=!0,a('emit "confirmed"'),this.emit("confirmed",{originator:n,ack:e||null})}_ended(n,e,t){a("session ended"),this._end_time=new Date,this._close(),a('emit "ended"'),this.emit("ended",{originator:n,message:e||null,cause:t})}_failed(n,e,t){a("session failed"),this._close(),a('emit "failed"'),this.emit("failed",{originator:n,message:e||null,cause:t})}_onhold(n){a("session onhold"),this._setLocalMediaStatus(),a('emit "hold"'),this.emit("hold",{originator:n})}_onunhold(n){a("session onunhold"),this._setLocalMediaStatus(),a('emit "unhold"'),this.emit("unhold",{originator:n})}_onmute({audio:n,video:e}){a("session onmute"),this._setLocalMediaStatus(),a('emit "muted"'),this.emit("muted",{audio:n,video:e})}_onunmute({audio:n,video:e}){a("session onunmute"),this._setLocalMediaStatus(),a('emit "unmuted"'),this.emit("unmuted",{audio:n,video:e})}}},{"./Constants":2,"./Dialog":3,"./Exceptions":6,"./RTCSession/DTMF":13,"./RTCSession/Info":14,"./RTCSession/ReferNotifier":15,"./RTCSession/ReferSubscriber":16,"./RequestSender":18,"./SIPMessage":19,"./Timers":21,"./Transactions":22,"./Utils":26,debug:30,events:29,"sdp-transform":36}],13:[function(n,e,t){const r=n("events").EventEmitter,i=n("../Constants"),a=n("../Exceptions"),s=n("../Utils"),o=n("debug")("JsSIP:RTCSession:DTMF");n("debug")("JsSIP:ERROR:RTCSession:DTMF").log=console.warn.bind(console);const c={MIN_DURATION:70,MAX_DURATION:6e3,DEFAULT_DURATION:100,MIN_INTER_TONE_GAP:50,DEFAULT_INTER_TONE_GAP:500};e.exports=class extends r{constructor(n){super(),this._session=n,this._direction=null,this._tone=null,this._duration=null,this._request=null}get tone(){return this._tone}get duration(){return this._duration}send(n,e={}){if(void 0===n)throw new TypeError("Not enough arguments");if(this._direction="outgoing",this._session.status!==this._session.C.STATUS_CONFIRMED&&this._session.status!==this._session.C.STATUS_WAITING_FOR_ACK)throw new a.InvalidStateError(this._session.status);const t=s.cloneArray(e.extraHeaders);if(this.eventHandlers=s.cloneObject(e.eventHandlers),"string"==typeof n)n=n.toUpperCase();else{if("number"!=typeof n)throw new TypeError(`Invalid tone: ${n}`);n=n.toString()}if(!n.match(/^[0-9A-DR#*]$/))throw new TypeError(`Invalid tone: ${n}`);this._tone=n,this._duration=e.duration,t.push("Content-Type: application/dtmf-relay");let r=`Signal=${this._tone}\r\n`;r+=`Duration=${this._duration}`,this._session.newDTMF({originator:"local",dtmf:this,request:this._request}),this._session.sendRequest(i.INFO,{extraHeaders:t,eventHandlers:{onSuccessResponse:n=>{this.emit("succeeded",{originator:"remote",response:n})},onErrorResponse:n=>{this.eventHandlers.onFailed&&this.eventHandlers.onFailed(),this.emit("failed",{originator:"remote",response:n})},onRequestTimeout:()=>{this._session.onRequestTimeout()},onTransportError:()=>{this._session.onTransportError()},onDialogError:()=>{this._session.onDialogError()}},body:r})}init_incoming(n){const e=/^(Signal\s*?=\s*?)([0-9A-D#*]{1})(\s)?.*/,t=/^(Duration\s?=\s?)([0-9]{1,4})(\s)?.*/;if(this._direction="incoming",this._request=n,n.reply(200),n.body){const r=n.body.split("\n");r.length>=1&&e.test(r[0])&&(this._tone=r[0].replace(e,"$2")),r.length>=2&&t.test(r[1])&&(this._duration=parseInt(r[1].replace(t,"$2"),10))}this._duration||(this._duration=c.DEFAULT_DURATION),this._tone?this._session.newDTMF({originator:"remote",dtmf:this,request:n}):o("invalid INFO DTMF received, discarded")}},e.exports.C=c},{"../Constants":2,"../Exceptions":6,"../Utils":26,debug:30,events:29}],14:[function(n,e,t){const r=n("events").EventEmitter;n("debug")("JsSIP:ERROR:RTCSession:Info").log=console.warn.bind(console);const i=n("../Constants"),a=n("../Exceptions"),s=n("../Utils");e.exports=class extends r{constructor(n){super(),this._session=n,this._direction=null,this._contentType=null,this._body=null}get contentType(){return this._contentType}get body(){return this._body}send(n,e,t={}){if(this._direction="outgoing",void 0===n)throw new TypeError("Not enough arguments");if(this._session.status!==this._session.C.STATUS_CONFIRMED&&this._session.status!==this._session.C.STATUS_WAITING_FOR_ACK)throw new a.InvalidStateError(this._session.status);this._contentType=n,this._body=e;const r=s.cloneArray(t.extraHeaders);r.push(`Content-Type: ${n}`),this._session.newInfo({originator:"local",info:this,request:this.request}),this._session.sendRequest(i.INFO,{extraHeaders:r,eventHandlers:{onSuccessResponse:n=>{this.emit("succeeded",{originator:"remote",response:n})},onErrorResponse:n=>{this.emit("failed",{originator:"remote",response:n})},onTransportError:()=>{this._session.onTransportError()},onRequestTimeout:()=>{this._session.onRequestTimeout()},onDialogError:()=>{this._session.onDialogError()}},body:e})}init_incoming(n){this._direction="incoming",this.request=n,n.reply(200),this._contentType=n.hasHeader("Content-Type")?n.getHeader("Content-Type").toLowerCase():void 0,this._body=n.body,this._session.newInfo({originator:"remote",info:this,request:n})}}},{"../Constants":2,"../Exceptions":6,"../Utils":26,debug:30,events:29}],15:[function(n,e,t){const r=n("../Constants"),i=n("debug")("JsSIP:RTCSession:ReferNotifier"),a="refer",s="message/sipfrag;version=2.0",o=300;e.exports=class{constructor(n,e,t){this._session=n,this._id=e,this._expires=t||o,this._active=!0,this.notify(100)}notify(n,e){if(i("notify()"),!1===this._active)return;let t;e=e||r.REASON_PHRASE[n]||"",t=n>=200?"terminated;reason=noresource":`active;expires=${this._expires}`,this._session.sendRequest(r.NOTIFY,{extraHeaders:[`Event: ${a};id=${this._id}`,`Subscription-State: ${t}`,`Content-Type: ${s}`],body:`SIP/2.0 ${n} ${e}`,eventHandlers:{onErrorResponse(){this._active=!1}}})}}},{"../Constants":2,debug:30}],16:[function(n,e,t){const r=n("events").EventEmitter,i=n("../Constants"),a=n("../Grammar"),s=n("../Utils"),o=n("debug")("JsSIP:RTCSession:ReferSubscriber");e.exports=class extends r{constructor(n){super(),this._id=null,this._session=n}get id(){return this._id}sendRefer(n,e={}){o("sendRefer()");const t=s.cloneArray(e.extraHeaders),r=s.cloneObject(e.eventHandlers);for(const n in r)Object.prototype.hasOwnProperty.call(r,n)&&this.on(n,r[n]);let a=null;e.replaces&&(a=e.replaces._request.call_id,a+=`;to-tag=${e.replaces._to_tag}`,a+=`;from-tag=${e.replaces._from_tag}`,a=encodeURIComponent(a));const c=`Refer-To: <${n}${a?`?Replaces=${a}`:""}>`;t.push(c);const l=`Referred-By: <${this._session._ua._configuration.uri._scheme}:${this._session._ua._configuration.uri._user}@${this._session._ua._configuration.uri._host}>`;if(t.push(l),t.push(`Contact: ${this._session.contact}`),!this._session._dialog)return o("redirecting the call"),this._session._request.reply("302","redirecting",e.extraHeaders,e.body),void(this._id=this._session._request.cseq);const u=this._session.sendRequest(i.REFER,{extraHeaders:t,eventHandlers:{onSuccessResponse:n=>{this._requestSucceeded(n)},onErrorResponse:n=>{this._requestFailed(n,i.causes.REJECTED)},onTransportError:()=>{this._requestFailed(null,i.causes.CONNECTION_ERROR)},onRequestTimeout:()=>{this._requestFailed(null,i.causes.REQUEST_TIMEOUT)},onDialogError:()=>{this._requestFailed(null,i.causes.DIALOG_ERROR)}}});this._id=u.cseq}receiveNotify(n){if(o("receiveNotify()"),!n.body)return;const e=a.parse(n.body.trim(),"Status_Line");if(-1!==e)switch(!0){case/^100$/.test(e.status_code):this.emit("trying",{request:n,status_line:e});break;case/^1[0-9]{2}$/.test(e.status_code):this.emit("progress",{request:n,status_line:e});break;case/^2[0-9]{2}$/.test(e.status_code):this.emit("accepted",{request:n,status_line:e});break;default:this.emit("failed",{request:n,status_line:e})}else o(`receiveNotify() | error parsing NOTIFY body: "${n.body}"`)}_requestSucceeded(n){o("REFER succeeded"),o('emit "requestSucceeded"'),this.emit("requestSucceeded",{response:n})}_requestFailed(n,e){o("REFER failed"),o('emit "requestFailed"'),this.emit("requestFailed",{response:n||null,cause:e})}}},{"../Constants":2,"../Grammar":7,"../Utils":26,debug:30,events:29}],17:[function(n,e,t){const r=n("./Utils"),i=n("./Constants"),a=n("./SIPMessage"),s=n("./RequestSender"),o=n("debug")("JsSIP:Registrator");e.exports=class{constructor(n,e){this._ua=n,this._transport=e,this._registrar=n.configuration.registrar_server,this._expires=n.configuration.register_expires,this._call_id=r.createRandomToken(22),this._cseq=0,this._to_uri=n.configuration.uri,this._registrationTimer=null,this._registering=!1,this._registered=!1,this._contact=this._ua.contact.toString(),this._contact+=";+sip.ice",this._extraHeaders=[],this._extraContactParams="",this._contact+=";reg-id=1",this._contact+=`;+sip.instance="<urn:uuid:${this._ua.configuration.instance_id}>"`}get registered(){return this._registered}get registering(){return this._registering}setExtraHeaders(n){Array.isArray(n)||(n=[]),this._extraHeaders=n.slice()}setExtraContactParams(n){n instanceof Object||(n={}),this._extraContactParams="";for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e)){const t=n[e];this._extraContactParams+=`;${e}`,t&&(this._extraContactParams+=`=${t}`)}}register(){if(this._registering)return void o("Register request in progress...");const n=this._extraHeaders.slice();n.push(`Contact: ${this._contact};expires=${this._expires}${this._extraContactParams}`),n.push(`Expires: ${this._expires}`);const e=new a.OutgoingRequest(i.REGISTER,this._registrar,this._ua,{to_uri:this._to_uri,call_id:this._call_id,cseq:this._cseq+=1},n),t=new s(this._ua,e,{onRequestTimeout:()=>{this._registrationFailure(null,i.causes.REQUEST_TIMEOUT)},onTransportError:()=>{this._registrationFailure(null,i.causes.CONNECTION_ERROR)},onAuthenticated:()=>{this._cseq+=1},onReceiveResponse:n=>{let e,t,a=n.getHeaders("contact").length;if(n.cseq===this._cseq)switch(null!==this._registrationTimer&&(clearTimeout(this._registrationTimer),this._registrationTimer=null),!0){case/^1[0-9]{2}$/.test(n.status_code):break;case/^2[0-9]{2}$/.test(n.status_code):if(this._registering=!1,!a){o("no Contact header in response to REGISTER, response ignored");break}for(;a--;){if((e=n.parseHeader("contact",a)).uri.user===this._ua.contact.uri.user){t=e.getParam("expires");break}e=null}if(!e){o("no Contact header pointing to us, response ignored");break}!t&&n.hasHeader("expires")&&(t=n.getHeader("expires")),t||(t=this._expires),(t=Number(t))<10&&(t=10),this._registrationTimer=setTimeout((()=>{this._registrationTimer=null,0===this._ua.listeners("registrationExpiring").length?this.register():this._ua.emit("registrationExpiring")}),1e3*t-5e3),e.hasParam("temp-gruu")&&(this._ua.contact.temp_gruu=e.getParam("temp-gruu").replace(/"/g,"")),e.hasParam("pub-gruu")&&(this._ua.contact.pub_gruu=e.getParam("pub-gruu").replace(/"/g,"")),this._registered||(this._registered=!0,this._ua.registered({response:n}));break;case/^423$/.test(n.status_code):n.hasHeader("min-expires")?(this._expires=Number(n.getHeader("min-expires")),this._expires<10&&(this._expires=10),this.register()):(o("423 response received for REGISTER without Min-Expires"),this._registrationFailure(n,i.causes.SIP_FAILURE_CODE));break;default:{const e=r.sipErrorCause(n.status_code);this._registrationFailure(n,e)}}}});this._registering=!0,t.send()}unregister(n={}){if(!this._registered)return void o("already unregistered");this._registered=!1,null!==this._registrationTimer&&(clearTimeout(this._registrationTimer),this._registrationTimer=null);const e=this._extraHeaders.slice();n.all?e.push(`Contact: *${this._extraContactParams}`):e.push(`Contact: ${this._contact};expires=0${this._extraContactParams}`),e.push("Expires: 0");const t=new a.OutgoingRequest(i.REGISTER,this._registrar,this._ua,{to_uri:this._to_uri,call_id:this._call_id,cseq:this._cseq+=1},e);new s(this._ua,t,{onRequestTimeout:()=>{this._unregistered(null,i.causes.REQUEST_TIMEOUT)},onTransportError:()=>{this._unregistered(null,i.causes.CONNECTION_ERROR)},onAuthenticated:()=>{this._cseq+=1},onReceiveResponse:n=>{switch(!0){case/^1[0-9]{2}$/.test(n.status_code):break;case/^2[0-9]{2}$/.test(n.status_code):this._unregistered(n);break;default:{const e=r.sipErrorCause(n.status_code);this._unregistered(n,e)}}}}).send()}close(){this._registered&&this.unregister()}onTransportClosed(){this._registering=!1,null!==this._registrationTimer&&(clearTimeout(this._registrationTimer),this._registrationTimer=null),this._registered&&(this._registered=!1,this._ua.unregistered({}))}_registrationFailure(n,e){this._registering=!1,this._ua.registrationFailed({response:n||null,cause:e}),this._registered&&(this._registered=!1,this._ua.unregistered({response:n||null,cause:e}))}_unregistered(n,e){this._registering=!1,this._registered=!1,this._ua.unregistered({response:n||null,cause:e||null})}}},{"./Constants":2,"./RequestSender":18,"./SIPMessage":19,"./Utils":26,debug:30}],18:[function(n,e,t){const r=n("./Constants"),i=n("./DigestAuthentication"),a=n("./Transactions"),s=n("debug")("JsSIP:RequestSender"),o={onRequestTimeout:()=>{},onTransportError:()=>{},onReceiveResponse:()=>{},onAuthenticated:()=>{}};e.exports=class{constructor(n,e,t){this._ua=n,this._eventHandlers=t,this._method=e.method,this._request=e,this._auth=null,this._challenged=!1,this._staled=!1;for(const n in o)Object.prototype.hasOwnProperty.call(o,n)&&(this._eventHandlers[n]||(this._eventHandlers[n]=o[n]));n.status!==n.C.STATUS_USER_CLOSED||this._method===r.BYE&&this._method===r.ACK||this._eventHandlers.onTransportError()}send(){const n={onRequestTimeout:()=>{this._eventHandlers.onRequestTimeout()},onTransportError:()=>{this._eventHandlers.onTransportError()},onReceiveResponse:n=>{this._receiveResponse(n)}};switch(this._method){case"INVITE":this.clientTransaction=new a.InviteClientTransaction(this._ua,this._ua.transport,this._request,n);break;case"ACK":this.clientTransaction=new a.AckClientTransaction(this._ua,this._ua.transport,this._request,n);break;default:this.clientTransaction=new a.NonInviteClientTransaction(this._ua,this._ua.transport,this._request,n)}this._ua._configuration.authorization_jwt&&this._request.setHeader("Authorization",this._ua._configuration.authorization_jwt),this.clientTransaction.send()}_receiveResponse(n){let e,t;const r=n.status_code;if(401!==r&&407!==r||null===this._ua.configuration.password&&null===this._ua.configuration.ha1)this._eventHandlers.onReceiveResponse(n);else{if(401===n.status_code?(e=n.parseHeader("www-authenticate"),t="authorization"):(e=n.parseHeader("proxy-authenticate"),t="proxy-authorization"),!e)return s(`${n.status_code} with wrong or missing challenge, cannot authenticate`),void this._eventHandlers.onReceiveResponse(n);if(!this._challenged||!this._staled&&!0===e.stale){if(this._auth||(this._auth=new i({username:this._ua.configuration.authorization_user,password:this._ua.configuration.password,realm:this._ua.configuration.realm,ha1:this._ua.configuration.ha1})),!this._auth.authenticate(this._request,e))return void this._eventHandlers.onReceiveResponse(n);this._challenged=!0,this._ua.set("realm",this._auth.get("realm")),this._ua.set("ha1",this._auth.get("ha1")),e.stale&&(this._staled=!0),this._request=this._request.clone(),this._request.cseq+=1,this._request.setHeader("cseq",`${this._request.cseq} ${this._method}`),this._request.setHeader(t,this._auth.toString()),this._eventHandlers.onAuthenticated(this._request),this.send()}else this._eventHandlers.onReceiveResponse(n)}}}},{"./Constants":2,"./DigestAuthentication":5,"./Transactions":22,debug:30}],19:[function(n,e,t){const r=n("sdp-transform"),i=n("./Constants"),a=n("./Utils"),s=n("./NameAddrHeader"),o=n("./Grammar"),c=n("debug")("JsSIP:SIPMessage");class l{constructor(n,e,t,r,o,c){if(!n||!e||!t)return null;r=r||{},this.ua=t,this.headers={},this.method=n,this.ruri=e,this.body=c,this.extraHeaders=a.cloneArray(o),r.route_set?this.setHeader("route",r.route_set):t.configuration.use_preloaded_route&&this.setHeader("route",`<${t.transport.sip_uri};lr>`),this.setHeader("via",""),this.setHeader("max-forwards",i.MAX_FORWARDS);const l=r.to_uri||e,u=r.to_tag?{tag:r.to_tag}:null,d=void 0!==r.to_display_name?r.to_display_name:null;this.to=new s(l,d,u),this.setHeader("to",this.to.toString());const h=r.from_uri||t.configuration.uri,p={tag:r.from_tag||a.newTag()};let f;f=void 0!==r.from_display_name?r.from_display_name:t.configuration.display_name?t.configuration.display_name:null,this.from=new s(h,f,p),this.setHeader("from",this.from.toString());const g=r.call_id||t.configuration.jssip_id+a.createRandomToken(15);this.call_id=g,this.setHeader("call-id",g);const m=r.cseq||Math.floor(1e4*Math.random());this.cseq=m,this.setHeader("cseq",`${m} ${n}`)}setHeader(n,e){const t=new RegExp(`^\\s*${n}\\s*:`,"i");for(let n=0;n<this.extraHeaders.length;n++)t.test(this.extraHeaders[n])&&this.extraHeaders.splice(n,1);this.headers[a.headerize(n)]=Array.isArray(e)?e:[e]}getHeader(n){const e=this.headers[a.headerize(n)];if(e){if(e[0])return e[0]}else{const e=new RegExp(`^\\s*${n}\\s*:`,"i");for(const n of this.extraHeaders)if(e.test(n))return n.substring(n.indexOf(":")+1).trim()}}getHeaders(n){const e=this.headers[a.headerize(n)],t=[];if(e){for(const n of e)t.push(n);return t}{const e=new RegExp(`^\\s*${n}\\s*:`,"i");for(const n of this.extraHeaders)e.test(n)&&t.push(n.substring(n.indexOf(":")+1).trim());return t}}hasHeader(n){if(this.headers[a.headerize(n)])return!0;{const e=new RegExp(`^\\s*${n}\\s*:`,"i");for(const n of this.extraHeaders)if(e.test(n))return!0}return!1}parseSDP(n){return!n&&this.sdp||(this.sdp=r.parse(this.body||"")),this.sdp}toString(){let n=`${this.method} ${this.ruri} SIP/2.0\r\n`;for(const e in this.headers)if(Object.prototype.hasOwnProperty.call(this.headers,e))for(const t of this.headers[e])n+=`${e}: ${t}\r\n`;for(const e of this.extraHeaders)n+=`${e.trim()}\r\n`;const e=[];switch(this.method){case i.REGISTER:e.push("path","gruu");break;case i.INVITE:this.ua.configuration.session_timers&&e.push("timer"),(this.ua.contact.pub_gruu||this.ua.contact.temp_gruu)&&e.push("gruu"),e.push("ice","replaces");break;case i.UPDATE:this.ua.configuration.session_timers&&e.push("timer"),e.push("ice")}e.push("outbound");const t=this.ua.configuration.user_agent||i.USER_AGENT;return n+=`Allow: ${i.ALLOWED_METHODS}\r\n`,n+=`Supported: ${e}\r\n`,n+=`User-Agent: ${t}\r\n`,this.body?(n+=`Content-Length: ${a.str_utf8_length(this.body)}\r\n\r\n`,n+=this.body):n+="Content-Length: 0\r\n\r\n",n}clone(){const n=new l(this.method,this.ruri,this.ua);return Object.keys(this.headers).forEach((function(e){n.headers[e]=this.headers[e].slice()}),this),n.body=this.body,n.extraHeaders=a.cloneArray(this.extraHeaders),n.to=this.to,n.from=this.from,n.call_id=this.call_id,n.cseq=this.cseq,n}}class u extends l{constructor(n,e,t,r,a){super(i.INVITE,n,e,t,r,a),this.transaction=null}cancel(n){this.transaction.cancel(n)}clone(){const n=new u(this.ruri,this.ua);return Object.keys(this.headers).forEach((function(e){n.headers[e]=this.headers[e].slice()}),this),n.body=this.body,n.extraHeaders=a.cloneArray(this.extraHeaders),n.to=this.to,n.from=this.from,n.call_id=this.call_id,n.cseq=this.cseq,n.transaction=this.transaction,n}}class d{constructor(){this.data=null,this.headers=null,this.method=null,this.via=null,this.via_branch=null,this.call_id=null,this.cseq=null,this.from=null,this.from_tag=null,this.to=null,this.to_tag=null,this.body=null,this.sdp=null}addHeader(n,e){const t={raw:e};n=a.headerize(n),this.headers[n]?this.headers[n].push(t):this.headers[n]=[t]}getHeader(n){const e=this.headers[a.headerize(n)];if(e)return e[0]?e[0].raw:void 0}getHeaders(n){const e=this.headers[a.headerize(n)],t=[];if(!e)return[];for(const n of e)t.push(n.raw);return t}hasHeader(n){return!!this.headers[a.headerize(n)]}parseHeader(n,e=0){if(n=a.headerize(n),!this.headers[n])return void c(`header "${n}" not present`);if(e>=this.headers[n].length)return void c(`not so many "${n}" headers present`);const t=this.headers[n][e],r=t.raw;if(t.parsed)return t.parsed;const i=o.parse(r,n.replace(/-/g,"_"));return-1===i?(this.headers[n].splice(e,1),void c(`error parsing "${n}" header field with value "${r}"`)):(t.parsed=i,i)}s(n,e){return this.parseHeader(n,e)}setHeader(n,e){const t={raw:e};this.headers[a.headerize(n)]=[t]}parseSDP(n){return!n&&this.sdp||(this.sdp=r.parse(this.body||"")),this.sdp}toString(){return this.data}}e.exports={OutgoingRequest:l,InitialOutgoingInviteRequest:u,IncomingRequest:class extends d{constructor(n){super(),this.ua=n,this.headers={},this.ruri=null,this.transport=null,this.server_transaction=null}reply(n,e,t,r,s,o){const c=[];let l=this.getHeader("To");if(e=e||null,!(n=n||null)||n<100||n>699)throw new TypeError(`Invalid status_code: ${n}`);if(e&&"string"!=typeof e&&!(e instanceof String))throw new TypeError(`Invalid reason_phrase: ${e}`);e=e||i.REASON_PHRASE[n]||"",t=a.cloneArray(t);let u=`SIP/2.0 ${n} ${e}\r\n`;if(this.method===i.INVITE&&n>100&&n<=200){const n=this.getHeaders("record-route");for(const e of n)u+=`Record-Route: ${e}\r\n`}const d=this.getHeaders("via");for(const n of d)u+=`Via: ${n}\r\n`;!this.to_tag&&n>100?l+=`;tag=${a.newTag()}`:this.to_tag&&!this.s("to").hasParam("tag")&&(l+=`;tag=${this.to_tag}`),u+=`To: ${l}\r\n`,u+=`From: ${this.getHeader("From")}\r\n`,u+=`Call-ID: ${this.call_id}\r\n`,u+=`CSeq: ${this.cseq} ${this.method}\r\n`;for(const n of t)u+=`${n.trim()}\r\n`;switch(this.method){case i.INVITE:this.ua.configuration.session_timers&&c.push("timer"),(this.ua.contact.pub_gruu||this.ua.contact.temp_gruu)&&c.push("gruu"),c.push("ice","replaces");break;case i.UPDATE:this.ua.configuration.session_timers&&c.push("timer"),r&&c.push("ice"),c.push("replaces")}c.push("outbound"),this.method===i.OPTIONS?(u+=`Allow: ${i.ALLOWED_METHODS}\r\n`,u+=`Accept: ${i.ACCEPTED_BODY_TYPES}\r\n`):405===n?u+=`Allow: ${i.ALLOWED_METHODS}\r\n`:415===n&&(u+=`Accept: ${i.ACCEPTED_BODY_TYPES}\r\n`),u+=`Supported: ${c}\r\n`,r?(u+="Content-Type: application/sdp\r\n",u+=`Content-Length: ${a.str_utf8_length(r)}\r\n\r\n`,u+=r):u+="Content-Length: 0\r\n\r\n",this.server_transaction.receiveResponse(n,u,s,o)}reply_sl(n=null,e=null){const t=this.getHeaders("via");if(!n||n<100||n>699)throw new TypeError(`Invalid status_code: ${n}`);if(e&&"string"!=typeof e&&!(e instanceof String))throw new TypeError(`Invalid reason_phrase: ${e}`);let r=`SIP/2.0 ${n} ${e=e||i.REASON_PHRASE[n]||""}\r\n`;for(const n of t)r+=`Via: ${n}\r\n`;let s=this.getHeader("To");!this.to_tag&&n>100?s+=`;tag=${a.newTag()}`:this.to_tag&&!this.s("to").hasParam("tag")&&(s+=`;tag=${this.to_tag}`),r+=`To: ${s}\r\n`,r+=`From: ${this.getHeader("From")}\r\n`,r+=`Call-ID: ${this.call_id}\r\n`,r+=`CSeq: ${this.cseq} ${this.method}\r\n`,r+="Content-Length: 0\r\n\r\n",this.transport.send(r)}},IncomingResponse:class extends d{constructor(){super(),this.headers={},this.status_code=null,this.reason_phrase=null}}}},{"./Constants":2,"./Grammar":7,"./NameAddrHeader":10,"./Utils":26,debug:30,"sdp-transform":36}],20:[function(n,e,t){const r=n("./Utils"),i=n("./Grammar"),a=n("debug")("JsSIP:ERROR:Socket");a.log=console.warn.bind(console),t.isSocket=n=>{if(Array.isArray(n))return!1;if(void 0===n)return a("undefined JsSIP.Socket instance"),!1;try{if(!r.isString(n.url))throw a("missing or invalid JsSIP.Socket url property"),new Error;if(!r.isString(n.via_transport))throw a("missing or invalid JsSIP.Socket via_transport property"),new Error;if(-1===i.parse(n.sip_uri,"SIP_URI"))throw a("missing or invalid JsSIP.Socket sip_uri property"),new Error}catch(n){return!1}try{["connect","disconnect","send"].forEach((e=>{if(!r.isFunction(n[e]))throw a(`missing or invalid JsSIP.Socket method: ${e}`),new Error}))}catch(n){return!1}return!0}},{"./Grammar":7,"./Utils":26,debug:30}],21:[function(n,e,t){const r=500;e.exports={T1:r,T2:4e3,T4:5e3,TIMER_B:32e3,TIMER_D:0,TIMER_F:32e3,TIMER_H:32e3,TIMER_I:0,TIMER_J:0,TIMER_K:0,TIMER_L:32e3,TIMER_M:32e3,PROVISIONAL_RESPONSE_INTERVAL:6e4}},{}],22:[function(n,e,t){const r=n("events").EventEmitter,i=n("./Constants"),a=n("./SIPMessage"),s=n("./Timers"),o=n("debug")("JsSIP:NonInviteClientTransaction"),c=n("debug")("JsSIP:InviteClientTransaction"),l=n("debug")("JsSIP:AckClientTransaction"),u=n("debug")("JsSIP:NonInviteServerTransaction"),d=n("debug")("JsSIP:InviteServerTransaction"),h={STATUS_TRYING:1,STATUS_PROCEEDING:2,STATUS_CALLING:3,STATUS_ACCEPTED:4,STATUS_COMPLETED:5,STATUS_TERMINATED:6,STATUS_CONFIRMED:7,NON_INVITE_CLIENT:"nict",NON_INVITE_SERVER:"nist",INVITE_CLIENT:"ict",INVITE_SERVER:"ist"};e.exports={C:h,NonInviteClientTransaction:class extends r{constructor(n,e,t,r){super(),this.type=h.NON_INVITE_CLIENT,this.id=`z9hG4bK${Math.floor(1e7*Math.random())}`,this.ua=n,this.transport=e,this.request=t,this.eventHandlers=r;let i=`SIP/2.0/${e.via_transport}`;i+=` ${n.configuration.via_host};branch=${this.id}`,this.request.setHeader("via",i),this.ua.newTransaction(this)}get C(){return h}stateChanged(n){this.state=n,this.emit("stateChanged")}send(){this.stateChanged(h.STATUS_TRYING),this.F=setTimeout((()=>{this.timer_F()}),s.TIMER_F),this.transport.send(this.request)||this.onTransportError()}onTransportError(){o(`transport error occurred, deleting transaction ${this.id}`),clearTimeout(this.F),clearTimeout(this.K),this.stateChanged(h.STATUS_TERMINATED),this.ua.destroyTransaction(this),this.eventHandlers.onTransportError()}timer_F(){o(`Timer F expired for transaction ${this.id}`),this.stateChanged(h.STATUS_TERMINATED),this.ua.destroyTransaction(this),this.eventHandlers.onRequestTimeout()}timer_K(){this.stateChanged(h.STATUS_TERMINATED),this.ua.destroyTransaction(this)}receiveResponse(n){const e=n.status_code;if(e<200)switch(this.state){case h.STATUS_TRYING:case h.STATUS_PROCEEDING:this.stateChanged(h.STATUS_PROCEEDING),this.eventHandlers.onReceiveResponse(n)}else switch(this.state){case h.STATUS_TRYING:case h.STATUS_PROCEEDING:this.stateChanged(h.STATUS_COMPLETED),clearTimeout(this.F),408===e?this.eventHandlers.onRequestTimeout():this.eventHandlers.onReceiveResponse(n),this.K=setTimeout((()=>{this.timer_K()}),s.TIMER_K);break;case h.STATUS_COMPLETED:}}},InviteClientTransaction:class extends r{constructor(n,e,t,r){super(),this.type=h.INVITE_CLIENT,this.id=`z9hG4bK${Math.floor(1e7*Math.random())}`,this.ua=n,this.transport=e,this.request=t,this.eventHandlers=r,t.transaction=this;let i=`SIP/2.0/${e.via_transport}`;i+=` ${n.configuration.via_host};branch=${this.id}`,this.request.setHeader("via",i),this.ua.newTransaction(this)}get C(){return h}stateChanged(n){this.state=n,this.emit("stateChanged")}send(){this.stateChanged(h.STATUS_CALLING),this.B=setTimeout((()=>{this.timer_B()}),s.TIMER_B),this.transport.send(this.request)||this.onTransportError()}onTransportError(){clearTimeout(this.B),clearTimeout(this.D),clearTimeout(this.M),this.state!==h.STATUS_ACCEPTED&&(c(`transport error occurred, deleting transaction ${this.id}`),this.eventHandlers.onTransportError()),this.stateChanged(h.STATUS_TERMINATED),this.ua.destroyTransaction(this)}timer_M(){c(`Timer M expired for transaction ${this.id}`),this.state===h.STATUS_ACCEPTED&&(clearTimeout(this.B),this.stateChanged(h.STATUS_TERMINATED),this.ua.destroyTransaction(this))}timer_B(){c(`Timer B expired for transaction ${this.id}`),this.state===h.STATUS_CALLING&&(this.stateChanged(h.STATUS_TERMINATED),this.ua.destroyTransaction(this),this.eventHandlers.onRequestTimeout())}timer_D(){c(`Timer D expired for transaction ${this.id}`),clearTimeout(this.B),this.stateChanged(h.STATUS_TERMINATED),this.ua.destroyTransaction(this)}sendACK(n){const e=new a.OutgoingRequest(i.ACK,this.request.ruri,this.ua,{route_set:this.request.getHeaders("route"),call_id:this.request.getHeader("call-id"),cseq:this.request.cseq});e.setHeader("from",this.request.getHeader("from")),e.setHeader("via",this.request.getHeader("via")),e.setHeader("to",n.getHeader("to")),this.D=setTimeout((()=>{this.timer_D()}),s.TIMER_D),this.transport.send(e)}cancel(n){if(this.state!==h.STATUS_PROCEEDING)return;const e=new a.OutgoingRequest(i.CANCEL,this.request.ruri,this.ua,{route_set:this.request.getHeaders("route"),call_id:this.request.getHeader("call-id"),cseq:this.request.cseq});e.setHeader("from",this.request.getHeader("from")),e.setHeader("via",this.request.getHeader("via")),e.setHeader("to",this.request.getHeader("to")),n&&e.setHeader("reason",n),this.transport.send(e)}receiveResponse(n){const e=n.status_code;if(e>=100&&e<=199)switch(this.state){case h.STATUS_CALLING:this.stateChanged(h.STATUS_PROCEEDING),this.eventHandlers.onReceiveResponse(n);break;case h.STATUS_PROCEEDING:this.eventHandlers.onReceiveResponse(n)}else if(e>=200&&e<=299)switch(this.state){case h.STATUS_CALLING:case h.STATUS_PROCEEDING:this.stateChanged(h.STATUS_ACCEPTED),this.M=setTimeout((()=>{this.timer_M()}),s.TIMER_M),this.eventHandlers.onReceiveResponse(n);break;case h.STATUS_ACCEPTED:this.eventHandlers.onReceiveResponse(n)}else if(e>=300&&e<=699)switch(this.state){case h.STATUS_CALLING:case h.STATUS_PROCEEDING:this.stateChanged(h.STATUS_COMPLETED),this.sendACK(n),this.eventHandlers.onReceiveResponse(n);break;case h.STATUS_COMPLETED:this.sendACK(n)}}},AckClientTransaction:class extends r{constructor(n,e,t,r){super(),this.id=`z9hG4bK${Math.floor(1e7*Math.random())}`,this.transport=e,this.request=t,this.eventHandlers=r;let i=`SIP/2.0/${e.via_transport}`;i+=` ${n.configuration.via_host};branch=${this.id}`,this.request.setHeader("via",i)}get C(){return h}send(){this.transport.send(this.request)||this.onTransportError()}onTransportError(){l(`transport error occurred for transaction ${this.id}`),this.eventHandlers.onTransportError()}},NonInviteServerTransaction:class extends r{constructor(n,e,t){super(),this.type=h.NON_INVITE_SERVER,this.id=t.via_branch,this.ua=n,this.transport=e,this.request=t,this.last_response="",t.server_transaction=this,this.state=h.STATUS_TRYING,n.newTransaction(this)}get C(){return h}stateChanged(n){this.state=n,this.emit("stateChanged")}timer_J(){u(`Timer J expired for transaction ${this.id}`),this.stateChanged(h.STATUS_TERMINATED),this.ua.destroyTransaction(this)}onTransportError(){this.transportError||(this.transportError=!0,u(`transport error occurred, deleting transaction ${this.id}`),clearTimeout(this.J),this.stateChanged(h.STATUS_TERMINATED),this.ua.destroyTransaction(this))}receiveResponse(n,e,t,r){if(100===n)switch(this.state){case h.STATUS_TRYING:this.stateChanged(h.STATUS_PROCEEDING),this.transport.send(e)||this.onTransportError();break;case h.STATUS_PROCEEDING:this.last_response=e,this.transport.send(e)?t&&t():(this.onTransportError(),r&&r())}else if(n>=200&&n<=699)switch(this.state){case h.STATUS_TRYING:case h.STATUS_PROCEEDING:this.stateChanged(h.STATUS_COMPLETED),this.last_response=e,this.J=setTimeout((()=>{this.timer_J()}),s.TIMER_J),this.transport.send(e)?t&&t():(this.onTransportError(),r&&r());break;case h.STATUS_COMPLETED:}}},InviteServerTransaction:class extends r{constructor(n,e,t){super(),this.type=h.INVITE_SERVER,this.id=t.via_branch,this.ua=n,this.transport=e,this.request=t,this.last_response="",t.server_transaction=this,this.state=h.STATUS_PROCEEDING,n.newTransaction(this),this.resendProvisionalTimer=null,t.reply(100)}get C(){return h}stateChanged(n){this.state=n,this.emit("stateChanged")}timer_H(){d(`Timer H expired for transaction ${this.id}`),this.state===h.STATUS_COMPLETED&&d("ACK not received, dialog will be terminated"),this.stateChanged(h.STATUS_TERMINATED),this.ua.destroyTransaction(this)}timer_I(){this.stateChanged(h.STATUS_TERMINATED),this.ua.destroyTransaction(this)}timer_L(){d(`Timer L expired for transaction ${this.id}`),this.state===h.STATUS_ACCEPTED&&(this.stateChanged(h.STATUS_TERMINATED),this.ua.destroyTransaction(this))}onTransportError(){this.transportError||(this.transportError=!0,d(`transport error occurred, deleting transaction ${this.id}`),null!==this.resendProvisionalTimer&&(clearInterval(this.resendProvisionalTimer),this.resendProvisionalTimer=null),clearTimeout(this.L),clearTimeout(this.H),clearTimeout(this.I),this.stateChanged(h.STATUS_TERMINATED),this.ua.destroyTransaction(this))}resend_provisional(){this.transport.send(this.last_response)||this.onTransportError()}receiveResponse(n,e,t,r){if(n>=100&&n<=199)switch(this.state){case h.STATUS_PROCEEDING:this.transport.send(e)||this.onTransportError(),this.last_response=e}if(n>100&&n<=199&&this.state===h.STATUS_PROCEEDING)null===this.resendProvisionalTimer&&(this.resendProvisionalTimer=setInterval((()=>{this.resend_provisional()}),s.PROVISIONAL_RESPONSE_INTERVAL));else if(n>=200&&n<=299)switch(this.state){case h.STATUS_PROCEEDING:this.stateChanged(h.STATUS_ACCEPTED),this.last_response=e,this.L=setTimeout((()=>{this.timer_L()}),s.TIMER_L),null!==this.resendProvisionalTimer&&(clearInterval(this.resendProvisionalTimer),this.resendProvisionalTimer=null);case h.STATUS_ACCEPTED:this.transport.send(e)?t&&t():(this.onTransportError(),r&&r())}else if(n>=300&&n<=699)switch(this.state){case h.STATUS_PROCEEDING:null!==this.resendProvisionalTimer&&(clearInterval(this.resendProvisionalTimer),this.resendProvisionalTimer=null),this.transport.send(e)?(this.stateChanged(h.STATUS_COMPLETED),this.H=setTimeout((()=>{this.timer_H()}),s.TIMER_H),t&&t()):(this.onTransportError(),r&&r())}}},checkTransaction:function({_transactions:n},e){let t;switch(e.method){case i.INVITE:if(t=n.ist[e.via_branch]){switch(t.state){case h.STATUS_PROCEEDING:t.transport.send(t.last_response);break;case h.STATUS_ACCEPTED:}return!0}break;case i.ACK:if(!(t=n.ist[e.via_branch]))return!1;if(t.state===h.STATUS_ACCEPTED)return!1;if(t.state===h.STATUS_COMPLETED)return t.state=h.STATUS_CONFIRMED,t.I=setTimeout((()=>{t.timer_I()}),s.TIMER_I),!0;break;case i.CANCEL:return(t=n.ist[e.via_branch])?(e.reply_sl(200),t.state!==h.STATUS_PROCEEDING):(e.reply_sl(481),!0);default:if(t=n.nist[e.via_branch]){switch(t.state){case h.STATUS_TRYING:break;case h.STATUS_PROCEEDING:case h.STATUS_COMPLETED:t.transport.send(t.last_response)}return!0}}}}},{"./Constants":2,"./SIPMessage":19,"./Timers":21,debug:30,events:29}],23:[function(n,e,t){const r=n("./Socket"),i=n("debug")("JsSIP:Transport"),a=n("debug")("JsSIP:ERROR:Transport"),s=n("./Constants");a.log=console.warn.bind(console);const o=0,c=1,l=2,u=0,d=1,h={min_interval:2,max_interval:30},p=.5;e.exports=class{constructor(n,e=h){if(i("new()"),this.status=l,this.socket=null,this.sockets=[],this.recovery_options=e,this.recover_attempts=0,this.recovery_timer=null,this.close_requested=!1,void 0===n)throw new TypeError("Invalid argument. undefined 'sockets' argument");n instanceof Array||(n=[n]),n.forEach((function(n){if(!r.isSocket(n.socket))throw new TypeError("Invalid argument. invalid 'JsSIP.Socket' instance");if(n.weight&&!Number(n.weight))throw new TypeError("Invalid argument. 'weight' attribute is not a number");this.sockets.push({socket:n.socket,weight:n.weight||0,status:u})}),this),this._getSocket()}get via_transport(){return this.socket.via_transport}get url(){return this.socket.url}get sip_uri(){return this.socket.sip_uri}connect(){i("connect()"),this.isConnected()?i("Transport is already connected"):this.isConnecting()?i("Transport is connecting"):(this.close_requested=!1,this.status=c,this.onconnecting({socket:this.socket,attempts:this.recover_attempts}),this.close_requested||(this.socket.onconnect=this._onConnect.bind(this),this.socket.ondisconnect=this._onDisconnect.bind(this),this.socket.ondata=this._onData.bind(this),this.socket.connect()))}disconnect(n){i("close()"),this.close_requested=!0,this.recover_attempts=0,this.status=l,null!==this.recovery_timer&&(clearTimeout(this.recovery_timer),this.recovery_timer=null),this.socket.onconnect=()=>{},this.socket.ondisconnect=()=>{},this.socket.ondata=()=>{},this.socket.disconnect(),this.ondisconnect({socket:this.socket,error:!1,ignoreReconnection:n})}send(n){if(i("send()"),!this.isConnected())return a("unable to send message, transport is not connected"),!1;const e=n.toString();return n.method!=s.OPTIONS&&i(`sending message:\n\n${e}\n`),this.socket.send(e)}isConnected(){return this.status===o}isConnecting(){return this.status===c}_reconnect(n,e,t,r,a){this.recover_attempts+=p;let s=Math.floor(Math.random()*Math.pow(2,this.recover_attempts)+1);s<this.recovery_options.min_interval?s=this.recovery_options.min_interval:s>this.recovery_options.max_interval&&(s=this.recovery_options.max_interval),this.recover_attempts>2?r({socket:a,error:n,code:e,reason:t}):(i(`reconnection attempt in ${1e3*p} milli seconds`),this.recovery_timer=setTimeout((()=>{this.close_requested||this.isConnected()||this.isConnecting()||(this._getSocket(),this.connect())}),500))}_getSocket(){let n=[];if(this.sockets.forEach((e=>{e.status!==d&&(0===n.length?n.push(e):e.weight>n[0].weight?n=[e]:e.weight===n[0].weight&&n.push(e))})),0===n.length)return this.sockets.forEach((n=>{n.status=u})),void this._getSocket();const e=Math.floor(Math.random()*n.length);this.socket=n[e].socket}_onConnect(){this.recover_attempts=0,this.status=o,null!==this.recovery_timer&&(clearTimeout(this.recovery_timer),this.recovery_timer=null),this.onconnect({socket:this})}_onDisconnect({error:n,code:e,reason:t}){this.status=l,this.close_requested||(this.sockets.forEach((function(n){this.socket===n.socket&&(n.status=d)}),this),this._reconnect(n,e,t,this.ondisconnect,this.socket))}_onData(n){if("\r\n"!==n){if("string"!=typeof n){try{n=String.fromCharCode.apply(null,new Uint8Array(n))}catch(n){return void i("received binary message failed to be converted into string, message discarded")}i(`received binary message:\n\n${n}\n`)}else new RegExp("admin@phone.plivo.com").test(n)||i(`received text message:\n\n${n}\n`);this.ondata({transport:this,message:n})}else i("received message with CRLF Keep Alive response")}}},{"./Constants":2,"./Socket":20,debug:30}],24:[function(n,e,t){const r=n("events").EventEmitter,i=n("./Constants"),a=n("./Registrator"),s=n("./RTCSession"),o=n("./Message"),c=n("./Transactions"),l=n("./Transport"),u=n("./Utils"),d=n("./Exceptions"),h=n("./URI"),p=n("./Grammar"),f=n("./Parser"),g=n("./SIPMessage"),m=n("./sanityCheck"),b=n("./Config"),v=n("debug")("JsSIP:UA"),y=n("debug")("JsSIP:ERROR:UA");y.log=console.warn.bind(console);const _={STATUS_INIT:0,STATUS_READY:1,STATUS_USER_CLOSED:2,STATUS_NOT_READY:3,CONFIGURATION_ERROR:1,NETWORK_ERROR:2};e.exports=class extends r{static get C(){return _}constructor(n){if(super(),this._cache={credentials:{}},this._configuration=Object.assign({},b.settings),this._dynConfiguration={},this._dialogs={},this._applicants={},this._sessions={},this._transport=null,this._contact=null,this._status=_.STATUS_INIT,this._error=null,this._transactions={nist:{},nict:{},ist:{},ict:{}},this._data={},this._closeTimer=null,this.sendReInviteOnTransportConnect=!0,this.sendRegisterOnTransportConnect=!0,void 0===n)throw new TypeError("Not enough arguments");try{this._loadConfig(n)}catch(n){throw this._status=_.STATUS_NOT_READY,this._error=_.CONFIGURATION_ERROR,n}this._registrator=new a(this)}get C(){return _}get status(){return this._status}get contact(){return this._contact}get configuration(){return this._configuration}get transport(){return this._transport}start(){v("start()"),this._status===_.STATUS_INIT?this._transport.connect():this._status===_.STATUS_USER_CLOSED?(v("restarting UA"),null!==this._closeTimer&&(clearTimeout(this._closeTimer),this._closeTimer=null,this._transport.disconnect(!0)),this._status=_.STATUS_INIT,this._transport.connect()):this._status===_.STATUS_READY?v("UA is in READY status, not restarted"):v("ERROR: connection is down, Auto-Recovery system is trying to reconnect"),this._dynConfiguration.register=this._configuration.register}register(){v("register()"),this._dynConfiguration.register=!0,this._registrator.register()}unregister(n){v("unregister()"),this._dynConfiguration.register=!1,this._registrator.unregister(n)}registrator(){return this._registrator}isRegistered(){return this._registrator.registered}isRegistering(){return this._registrator.registering}isConnected(){return this._transport.isConnected()}call(n,e){v("call()");const t=new s(this);return t.connect(n,e),t}sendMessage(n,e,t){v("sendMessage()");const r=new o(this);return r.send(n,e,t),r}terminateSessions(n){v("terminateSessions()");for(const e in this._sessions)this._sessions[e].isEnded()||this._sessions[e].terminate(n)}stop(){if(v("stop()"),this._dynConfiguration={},this._status===_.STATUS_USER_CLOSED)return void v("UA already closed");this._registrator.close();const n=Object.keys(this._sessions).length;for(const e in this._sessions)if(Object.prototype.hasOwnProperty.call(this._sessions,e)){v(`closing session ${e}`);try{this._sessions[e].terminate()}catch(n){}}for(const e in this._applicants)if(Object.prototype.hasOwnProperty.call(this._applicants,e))try{this._applicants[e].close()}catch(n){}this._status=_.STATUS_USER_CLOSED,0===Object.keys(this._transactions.nict).length+Object.keys(this._transactions.nist).length+Object.keys(this._transactions.ict).length+Object.keys(this._transactions.ist).length&&0===n?this._transport.disconnect(!0):this._closeTimer=setTimeout((()=>{this._closeTimer=null,this._transport.disconnect(!0)}),2e3)}normalizeTarget(n){return u.normalizeTarget(n,this._configuration.hostport_params)}get(n){switch(n){case"realm":return this._configuration.realm;case"ha1":return this._configuration.ha1;default:return void y('get() | cannot get "%s" parameter in runtime',n)}}set(n,e){switch(n){case"password":this._configuration.password=String(e);break;case"realm":this._configuration.realm=String(e);break;case"ha1":this._configuration.ha1=String(e),this._configuration.password=null;break;case"display_name":if(-1===p.parse(`"${e}"`,"display_name"))return y('set() | wrong "display_name"'),!1;this._configuration.display_name=e;break;default:return y('set() | cannot set "%s" parameter in runtime',n),!1}return!0}newTransaction(n){this._transactions[n.type][n.id]=n,this.emit("newTransaction",{transaction:n})}destroyTransaction(n){delete this._transactions[n.type][n.id],this.emit("transactionDestroyed",{transaction:n})}newDialog(n){this._dialogs[n.id]=n}destroyDialog(n){delete this._dialogs[n.id]}newMessage(n,e){this._applicants[n]=n,this.emit("newMessage",e)}destroyMessage(n){delete this._applicants[n]}newRTCSession(n,e){this._sessions[n.id]=n,this.emit("newRTCSession",e)}destroyRTCSession(n){delete this._sessions[n.id]}registered(n){this.emit("registered",n)}unregistered(n){this.emit("unregistered",n)}registrationFailed(n){this.emit("registrationFailed",n)}receiveRequest(n){const e=n.method;if(n.ruri.user!==this._configuration.uri.user&&n.ruri.user!==this._contact.uri.user)return v("Request-URI does not point to us"),void(n.method!==i.ACK&&n.reply_sl(404));if(n.ruri.scheme===i.SIPS)return void n.reply_sl(416);if(c.checkTransaction(this,n))return;if(e===i.INVITE?new c.InviteServerTransaction(this,this._transport,n):e!==i.ACK&&e!==i.CANCEL&&new c.NonInviteServerTransaction(this,this._transport,n),e===i.OPTIONS)n.reply(200);else if(e===i.MESSAGE){if(0===this.listeners("newMessage").length)return void n.reply(405);new o(this).init_incoming(n)}else if(e===i.INVITE&&!n.to_tag&&0===this.listeners("newRTCSession").length)return void n.reply(405);let t,r;if(n.to_tag)(t=this._findDialog(n.call_id,n.from_tag,n.to_tag))?t.receiveRequest(n):e===i.NOTIFY?(r=this._findSession(n))?r.receiveRequest(n):(v("received NOTIFY request for a non existent subscription"),n.reply(481,"Subscription does not exist")):e!==i.ACK&&n.reply(481);else switch(e){case i.INVITE:if(window.RTCPeerConnection)if(n.hasHeader("replaces")){const e=n.replaces;(t=this._findDialog(e.call_id,e.from_tag,e.to_tag))?(r=t.owner).isEnded()?n.reply(603):r.receiveRequest(n):n.reply(481)}else(r=new s(this)).init_incoming(n);else y("INVITE received but WebRTC is not supported"),n.reply(488);break;case i.BYE:n.reply(481);break;case i.CANCEL:(r=this._findSession(n))?r.receiveRequest(n):v("received CANCEL request for a non existent session");break;case i.ACK:break;default:n.reply(405)}}_findSession({call_id:n,from_tag:e,to_tag:t}){const r=n+e,i=this._sessions[r],a=n+t,s=this._sessions[a];return i||s||null}_findDialog(n,e,t){let r=n+e+t,i=this._dialogs[r];return i||(r=n+t+e,(i=this._dialogs[r])||null)}createNewUATransport(n){b.load(this._configuration,n),this._transport=new l(this._configuration.sockets,{max_interval:this._configuration.connection_recovery_max_interval,min_interval:this._configuration.connection_recovery_min_interval}),this._transport.onconnecting=function(n){this.emit("connecting",n)}.bind(this),this._transport.onconnect=function(n){if(this._status!==_.STATUS_USER_CLOSED&&(this._status=_.STATUS_READY,this._error=null,this.emit("connected",n),this._dynConfiguration.register&&(this.sendRegisterOnTransportConnect&&this._registrator.register(),this.sendReInviteOnTransportConnect)))for(const n in this._sessions)if(9===this._sessions[n].status){const e={succeeded:()=>{},failed:()=>{}};return void this._sessions[n]._sendReinvite({eventHandlers:e,rtcOfferConstraints:{iceRestart:!0}},this._sessions[n])}}.bind(this),this._transport.ondisconnect=function(n){const e=["nict","ict","nist","ist"];for(const n of e)for(const e in this._transactions[n])Object.prototype.hasOwnProperty.call(this._transactions[n],e)&&this._transactions[n][e].onTransportError();this.emit("disconnected",n),this._registrator.onTransportClosed(),this._status!==_.STATUS_USER_CLOSED&&(this._status=_.STATUS_NOT_READY,this._error=_.NETWORK_ERROR)}.bind(this),this._transport.ondata=function(n){const e=n.transport;let t=n.message;if((t=f.parseMessage(t,this))&&!(this._status===_.STATUS_USER_CLOSED&&t instanceof g.IncomingRequest)&&m(t,this,e))if(t instanceof g.IncomingRequest)t.transport=e,this.receiveRequest(t);else if(t instanceof g.IncomingResponse){let n;switch(t.method){case i.INVITE:(n=this._transactions.ict[t.via_branch])&&n.receiveResponse(t);break;case i.ACK:break;default:(n=this._transactions.nict[t.via_branch])&&n.receiveResponse(t)}}}.bind(this),this._status=_.STATUS_INIT}_loadConfig(n){try{b.load(this._configuration,n)}catch(n){throw n}0===this._configuration.display_name&&(this._configuration.display_name="0"),this._configuration.instance_id||(this._configuration.instance_id=u.newUUID()),this._configuration.jssip_id=u.createRandomToken(5);const e=this._configuration.uri.clone();e.user=null,this._configuration.hostport_params=e.toString().replace(/^sip:/i,"");try{this.createNewUATransport(n)}catch(n){throw y(n),new d.ConfigurationError("sockets",this._configuration.sockets)}if(delete this._configuration.sockets,this._configuration.authorization_user||(this._configuration.authorization_user=this._configuration.uri.user),!this._configuration.registrar_server){const n=this._configuration.uri.clone();n.user=null,n.clearParams(),n.clearHeaders(),this._configuration.registrar_server=n}this._configuration.no_answer_timeout*=1e3,this._configuration.contact_uri?this._configuration.via_host=this._configuration.contact_uri.host:this._configuration.contact_uri=new h("sip",u.createRandomToken(8),this._configuration.via_host,null,{transport:"ws"}),this._contact={pub_gruu:null,temp_gruu:null,uri:this._configuration.contact_uri,toString(n={}){const e=n.anonymous||null,t=n.outbound||null;let r="<";return r+=e?this.temp_gruu||"sip:anonymous@anonymous.invalid;transport=ws":this.pub_gruu||this.uri.toString(),!t||(e?this.temp_gruu:this.pub_gruu)||(r+=";ob"),r+">"}};const t=["password","realm","ha1","display_name","register","uri","user_agent","connection_recovery_max_interval","connection_recovery_min_interval","session_timers","register_expires","sockets","token","googIPv6"];for(const n in this._configuration)Object.prototype.hasOwnProperty.call(this._configuration,n)&&(-1!==t.indexOf(n)?Object.defineProperty(this._configuration,n,{writable:!0,configurable:!1}):Object.defineProperty(this._configuration,n,{writable:!1,configurable:!1}));v("configuration parameters after validation:");for(const n in this._configuration)if(Object.prototype.hasOwnProperty.call(b.settings,n))switch(n){case"uri":case"registrar_server":v(`- ${n}: ${this._configuration[n]}`);break;case"password":case"ha1":v(`- ${n}: NOT SHOWN`);break;default:v(`- ${n}: ${JSON.stringify(this._configuration[n])}`)}}}},{"./Config":1,"./Constants":2,"./Exceptions":6,"./Grammar":7,"./Message":9,"./Parser":11,"./RTCSession":12,"./Registrator":17,"./SIPMessage":19,"./Transactions":22,"./Transport":23,"./URI":25,"./Utils":26,"./sanityCheck":28,debug:30,events:29}],25:[function(n,e,t){const r=n("./Constants"),i=n("./Utils"),a=n("./Grammar");e.exports=class n{static parse(n){return-1!==(n=a.parse(n,"SIP_URI"))?n:void 0}constructor(n,e,t,i,a={},s={}){if(!t)throw new TypeError('missing or invalid "host" parameter');this._parameters={},this._headers={},this._scheme=n||r.SIP,this._user=e,this._host=t,this._port=i;for(const n in a)Object.prototype.hasOwnProperty.call(a,n)&&this.setParam(n,a[n]);for(const n in s)Object.prototype.hasOwnProperty.call(s,n)&&this.setHeader(n,s[n])}get scheme(){return this._scheme}set scheme(n){this._scheme=n.toLowerCase()}get user(){return this._user}set user(n){this._user=n}get host(){return this._host}set host(n){this._host=n.toLowerCase()}get port(){return this._port}set port(n){this._port=0===n?n:parseInt(n,10)||null}setParam(n,e){n&&(this._parameters[n.toLowerCase()]=null==e?null:e.toString())}getParam(n){if(n)return this._parameters[n.toLowerCase()]}hasParam(n){if(n)return!!this._parameters.hasOwnProperty(n.toLowerCase())}deleteParam(n){if(n=n.toLowerCase(),this._parameters.hasOwnProperty(n)){const e=this._parameters[n];return delete this._parameters[n],e}}clearParams(){this._parameters={}}setHeader(n,e){this._headers[i.headerize(n)]=Array.isArray(e)?e:[e]}getHeader(n){if(n)return this._headers[i.headerize(n)]}hasHeader(n){if(n)return!!this._headers.hasOwnProperty(i.headerize(n))}deleteHeader(n){if(n=i.headerize(n),this._headers.hasOwnProperty(n)){const e=this._headers[n];return delete this._headers[n],e}}clearHeaders(){this._headers={}}clone(){return new n(this._scheme,this._user,this._host,this._port,JSON.parse(JSON.stringify(this._parameters)),JSON.parse(JSON.stringify(this._headers)))}toString(){const n=[];let e=`${this._scheme}:`;this._user&&(e+=`${i.escapeUser(this._user)}@`),e+=this._host,(this._port||0===this._port)&&(e+=`:${this._port}`);for(const n in this._parameters)Object.prototype.hasOwnProperty.call(this._parameters,n)&&(e+=`;${n}`,null!==this._parameters[n]&&(e+=`=${this._parameters[n]}`));for(const e in this._headers)if(Object.prototype.hasOwnProperty.call(this._headers,e))for(const t of this._headers[e])n.push(`${e}=${t}`);return n.length>0&&(e+=`?${n.join("&")}`),e}toAor(n){let e=`${this._scheme}:`;return this._user&&(e+=`${i.escapeUser(this._user)}@`),e+=this._host,n&&(this._port||0===this._port)&&(e+=`:${this._port}`),e}}},{"./Constants":2,"./Grammar":7,"./Utils":26}],26:[function(n,e,t){const r=n("./Constants"),i=n("./URI"),a=n("./Grammar");t.str_utf8_length=n=>unescape(encodeURIComponent(n)).length;const s=t.isFunction=n=>void 0!==n&&"[object Function]"===Object.prototype.toString.call(n);t.isString=n=>void 0!==n&&"[object String]"===Object.prototype.toString.call(n),t.isDecimal=n=>!isNaN(n)&&parseFloat(n)===parseInt(n,10),t.isEmpty=n=>null===n||""===n||void 0===n||Array.isArray(n)&&0===n.length||"number"==typeof n&&isNaN(n),t.hasMethods=function(n,...e){for(const t of e)if(s(n[t]))return!1;return!0};const o=t.createRandomToken=(n,e=32)=>{let t,r,i="";for(t=0;t<n;t++)i+=(r=Math.random()*e|0).toString(e);return i};t.newTag=()=>o(10),t.newUUID=()=>"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(n=>{const e=16*Math.random()|0;return("x"===n?e:3&e|8).toString(16)})),t.hostType=n=>{if(n)return-1!==(n=a.parse(n,"host"))?n.host_type:void 0};const c=t.escapeUser=n=>encodeURIComponent(decodeURIComponent(n)).replace(/%3A/gi,":").replace(/%2B/gi,"+").replace(/%3F/gi,"?").replace(/%2F/gi,"/");t.normalizeTarget=(n,e)=>{if(n){if(n instanceof i)return n;if("string"==typeof n){const t=n.split("@");let a,s,o;switch(t.length){case 1:if(!e)return;a=n,s=e;break;case 2:a=t[0],s=t[1];break;default:a=t.slice(0,t.length-1).join("@"),s=t[t.length-1]}return a=a.replace(/^(sips?|tel):/i,""),/^[-.()]*\+?[0-9\-.()]+$/.test(a)&&(a=a.replace(/[-.()]/g,"")),n=`${r.SIP}:${c(a)}@${s}`,(o=i.parse(n))?o:void 0}}},t.headerize=n=>{const e={"Call-Id":"Call-ID",Cseq:"CSeq","Www-Authenticate":"WWW-Authenticate"},t=n.toLowerCase().replace(/_/g,"-").split("-");let r="";const i=t.length;let a;for(a=0;a<i;a++)0!==a&&(r+="-"),r+=t[a].charAt(0).toUpperCase()+t[a].substring(1);return e[r]&&(r=e[r]),r},t.sipErrorCause=n=>{for(const e in r.SIP_ERROR_CAUSES)if(-1!==r.SIP_ERROR_CAUSES[e].indexOf(n))return r.causes[e];return r.causes.SIP_FAILURE_CODE},t.getRandomTestNetIP=()=>`192.0.2.${function(n,e){return Math.floor(Math.random()*(e-n+1)+n)}(1,254)}`,t.calculateMD5=n=>{function e(n,e){return n<<e|n>>>32-e}function t(n,e){const t=2147483648&n,r=2147483648&e,i=1073741824&n,a=1073741824&e,s=(1073741823&n)+(1073741823&e);return i&a?2147483648^s^t^r:i|a?1073741824&s?3221225472^s^t^r:1073741824^s^t^r:s^t^r}function r(n,r,i,a,s,o,c){return n=t(n,t(t(function(n,e,t){return n&e|~n&t}(r,i,a),s),c)),t(e(n,o),r)}function i(n,r,i,a,s,o,c){return n=t(n,t(t(function(n,e,t){return n&t|e&~t}(r,i,a),s),c)),t(e(n,o),r)}function a(n,r,i,a,s,o,c){return n=t(n,t(t(function(n,e,t){return n^e^t}(r,i,a),s),c)),t(e(n,o),r)}function s(n,r,i,a,s,o,c){return n=t(n,t(t(function(n,e,t){return e^(n|~t)}(r,i,a),s),c)),t(e(n,o),r)}function o(n){let e,t,r="",i="";for(t=0;t<=3;t++)r+=(i=`0${(e=n>>>8*t&255).toString(16)}`).substr(i.length-2,2);return r}let c,l,u,d,h,p,f,g,m,b=[];for(b=function(n){let e;const t=n.length,r=t+8,i=16*((r-r%64)/64+1),a=new Array(i-1);let s=0,o=0;for(;o<t;)s=o%4*8,a[e=(o-o%4)/4]=a[e]|n.charCodeAt(o)<<s,o++;return s=o%4*8,a[e=(o-o%4)/4]=a[e]|128<<s,a[i-2]=t<<3,a[i-1]=t>>>29,a}(n=function(n){n=n.replace(/\r\n/g,"\n");let e="";for(let t=0;t<n.length;t++){const r=n.charCodeAt(t);r<128?e+=String.fromCharCode(r):r>127&&r<2048?(e+=String.fromCharCode(r>>6|192),e+=String.fromCharCode(63&r|128)):(e+=String.fromCharCode(r>>12|224),e+=String.fromCharCode(r>>6&63|128),e+=String.fromCharCode(63&r|128))}return e}(n)),p=1732584193,f=4023233417,g=2562383102,m=271733878,c=0;c<b.length;c+=16)l=p,u=f,d=g,h=m,p=r(p,f,g,m,b[c+0],7,3614090360),m=r(m,p,f,g,b[c+1],12,3905402710),g=r(g,m,p,f,b[c+2],17,606105819),f=r(f,g,m,p,b[c+3],22,3250441966),p=r(p,f,g,m,b[c+4],7,4118548399),m=r(m,p,f,g,b[c+5],12,1200080426),g=r(g,m,p,f,b[c+6],17,2821735955),f=r(f,g,m,p,b[c+7],22,4249261313),p=r(p,f,g,m,b[c+8],7,1770035416),m=r(m,p,f,g,b[c+9],12,2336552879),g=r(g,m,p,f,b[c+10],17,4294925233),f=r(f,g,m,p,b[c+11],22,2304563134),p=r(p,f,g,m,b[c+12],7,1804603682),m=r(m,p,f,g,b[c+13],12,4254626195),g=r(g,m,p,f,b[c+14],17,2792965006),p=i(p,f=r(f,g,m,p,b[c+15],22,1236535329),g,m,b[c+1],5,4129170786),m=i(m,p,f,g,b[c+6],9,3225465664),g=i(g,m,p,f,b[c+11],14,643717713),f=i(f,g,m,p,b[c+0],20,3921069994),p=i(p,f,g,m,b[c+5],5,3593408605),m=i(m,p,f,g,b[c+10],9,38016083),g=i(g,m,p,f,b[c+15],14,3634488961),f=i(f,g,m,p,b[c+4],20,3889429448),p=i(p,f,g,m,b[c+9],5,568446438),m=i(m,p,f,g,b[c+14],9,3275163606),g=i(g,m,p,f,b[c+3],14,4107603335),f=i(f,g,m,p,b[c+8],20,1163531501),p=i(p,f,g,m,b[c+13],5,2850285829),m=i(m,p,f,g,b[c+2],9,4243563512),g=i(g,m,p,f,b[c+7],14,1735328473),p=a(p,f=i(f,g,m,p,b[c+12],20,2368359562),g,m,b[c+5],4,4294588738),m=a(m,p,f,g,b[c+8],11,2272392833),g=a(g,m,p,f,b[c+11],16,1839030562),f=a(f,g,m,p,b[c+14],23,4259657740),p=a(p,f,g,m,b[c+1],4,2763975236),m=a(m,p,f,g,b[c+4],11,1272893353),g=a(g,m,p,f,b[c+7],16,4139469664),f=a(f,g,m,p,b[c+10],23,3200236656),p=a(p,f,g,m,b[c+13],4,681279174),m=a(m,p,f,g,b[c+0],11,3936430074),g=a(g,m,p,f,b[c+3],16,3572445317),f=a(f,g,m,p,b[c+6],23,76029189),p=a(p,f,g,m,b[c+9],4,3654602809),m=a(m,p,f,g,b[c+12],11,3873151461),g=a(g,m,p,f,b[c+15],16,530742520),p=s(p,f=a(f,g,m,p,b[c+2],23,3299628645),g,m,b[c+0],6,4096336452),m=s(m,p,f,g,b[c+7],10,1126891415),g=s(g,m,p,f,b[c+14],15,2878612391),f=s(f,g,m,p,b[c+5],21,4237533241),p=s(p,f,g,m,b[c+12],6,1700485571),m=s(m,p,f,g,b[c+3],10,2399980690),g=s(g,m,p,f,b[c+10],15,4293915773),f=s(f,g,m,p,b[c+1],21,2240044497),p=s(p,f,g,m,b[c+8],6,1873313359),m=s(m,p,f,g,b[c+15],10,4264355552),g=s(g,m,p,f,b[c+6],15,2734768916),f=s(f,g,m,p,b[c+13],21,1309151649),p=s(p,f,g,m,b[c+4],6,4149444226),m=s(m,p,f,g,b[c+11],10,3174756917),g=s(g,m,p,f,b[c+2],15,718787259),f=s(f,g,m,p,b[c+9],21,3951481745),p=t(p,l),f=t(f,u),g=t(g,d),m=t(m,h);return(o(p)+o(f)+o(g)+o(m)).toLowerCase()},t.closeMediaStream=n=>{if(n)try{let e;if(n.getTracks){e=n.getTracks();for(const n of e)n.stop()}else{e=n.getAudioTracks();for(const n of e)n.stop();e=n.getVideoTracks();for(const n of e)n.stop()}}catch(e){"function"!=typeof n.stop&&"object"!=typeof n.stop||n.stop()}},t.cloneArray=n=>n&&n.slice()||[],t.cloneObject=(n,e={})=>n&&Object.assign({},n)||e},{"./Constants":2,"./Grammar":7,"./URI":25}],27:[function(n,e,t){const r=n("./Grammar"),i=n("debug")("JsSIP:WebSocketInterface"),a=n("debug")("JsSIP:ERROR:WebSocketInterface");a.log=console.warn.bind(console),e.exports=class{constructor(n){i('new() [url:"%s"]',n),this._url=n,this._sip_uri=null,this._via_transport=null,this._ws=null;const e=r.parse(n,"absoluteURI");if(-1===e)throw a(`invalid WebSocket URI: ${n}`),new TypeError(`Invalid argument: ${n}`);if("wss"!==e.scheme&&"ws"!==e.scheme)throw a(`invalid WebSocket URI scheme: ${e.scheme}`),new TypeError(`Invalid argument: ${n}`);this._sip_uri=`sip:${e.host}${e.port?`:${e.port}`:""};transport=ws`,this._via_transport=e.scheme.toUpperCase()}get via_transport(){return this._via_transport}set via_transport(n){this._via_transport=n.toUpperCase()}get sip_uri(){return this._sip_uri}get url(){return this._url}connect(){if(i("connect()"),this.isConnected())i(`WebSocket ${this._url} is already connected`);else if(this.isConnecting())i(`WebSocket ${this._url} is connecting`);else{this._ws&&this.disconnect(),i(`connecting to WebSocket ${this._url}`);try{this._ws=new WebSocket(this._url,"sip"),this._ws.binaryType="arraybuffer",this._ws.onopen=this._onOpen.bind(this),this._ws.onclose=this._onClose.bind(this),this._ws.onmessage=this._onMessage.bind(this),this._ws.onerror=this._onError.bind(this)}catch(n){this._onError(n)}}}disconnect(){i("disconnect()"),this._ws&&(this._ws.onopen=()=>{},this._ws.onclose=()=>{},this._ws.onmessage=()=>{},this._ws.onerror=()=>{},this._ws.close(),this._ws=null)}send(n){return i("send()"),this.isConnected()?(this._ws.send(n),!0):(a("unable to send message, WebSocket is not open"),!1)}isConnected(){return this._ws&&this._ws.readyState===this._ws.OPEN}isConnecting(){return this._ws&&this._ws.readyState===this._ws.CONNECTING}_onOpen(){i(`WebSocket ${this._url} connected`),this.onconnect()}_onClose({wasClean:n,code:e,reason:t}){i(`WebSocket ${this._url} closed`),!1===n&&i("WebSocket abrupt disconnection");const r={socket:this,error:!n,code:e,reason:t};this.ondisconnect(r)}_onMessage({data:n}){i("received WebSocket message"),this.ondata(n)}_onError(n){a(`WebSocket ${this._url} error: ${n}`)}}},{"./Grammar":7,debug:30}],28:[function(n,e,t){const r=n("./Constants"),i=n("./SIPMessage"),a=n("./Utils"),s=n("debug")("JsSIP:sanityCheck"),o=[function(){const n=["from","to","call_id","cseq","via"];for(const e of n)if(!u.hasHeader(e))return s(`missing mandatory header field : ${e}, dropping the response`),!1}],c=[function(){if("sip"!==u.s("to").uri.scheme)return p(416),!1},function(){if(!u.to_tag&&u.call_id.substr(0,5)===d.configuration.jssip_id)return p(482),!1},function(){if(a.str_utf8_length(u.body)<u.getHeader("content-length"))return p(400),!1},function(){const n=u.from_tag,e=u.call_id,t=u.cseq;let i;if(!u.to_tag)if(u.method===r.INVITE){if(d._transactions.ist[u.via_branch])return!1;for(const r in d._transactions.ist)if(Object.prototype.hasOwnProperty.call(d._transactions.ist,r)&&(i=d._transactions.ist[r]).request.from_tag===n&&i.request.call_id===e&&i.request.cseq===t)return p(482),!1}else{if(d._transactions.nist[u.via_branch])return!1;for(const r in d._transactions.nist)if(Object.prototype.hasOwnProperty.call(d._transactions.nist,r)&&(i=d._transactions.nist[r]).request.from_tag===n&&i.request.call_id===e&&i.request.cseq===t)return p(482),!1}}],l=[function(){if(u.getHeaders("via").length>1)return s("more than one Via header field present in the response, dropping the response"),!1},function(){if(a.str_utf8_length(u.body)<u.getHeader("content-length"))return s("message body length is lower than the value in Content-Length header field, dropping the response"),!1}];let u,d,h;function p(n){const e=u.getHeaders("via");let t,i=`SIP/2.0 ${n} ${r.REASON_PHRASE[n]}\r\n`;for(const n of e)i+=`Via: ${n}\r\n`;t=u.getHeader("To"),u.to_tag||(t+=`;tag=${a.newTag()}`),i+=`To: ${t}\r\n`,i+=`From: ${u.getHeader("From")}\r\n`,i+=`Call-ID: ${u.call_id}\r\n`,i+=`CSeq: ${u.cseq} ${u.method}\r\n`,i+="\r\n",h.send(i)}e.exports=(n,e,t)=>{u=n,d=e,h=t;for(const n of o)if(!1===n())return!1;if(u instanceof i.IncomingRequest){for(const n of c)if(!1===n())return!1}else if(u instanceof i.IncomingResponse)for(const n of l)if(!1===n())return!1;return!0}},{"./Constants":2,"./SIPMessage":19,"./Utils":26,debug:30}],29:[function(n,e,t){var r=Object.create||function(n){var e=function(){};return e.prototype=n,new e},i=Object.keys||function(n){var e=[];for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&e.push(t);return t},a=Function.prototype.bind||function(n){var e=this;return function(){return e.apply(n,arguments)}};function s(){this._events&&Object.prototype.hasOwnProperty.call(this,"_events")||(this._events=r(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0}e.exports=s,s.EventEmitter=s,s.prototype._events=void 0,s.prototype._maxListeners=void 0;var o,c=10;try{var l={};Object.defineProperty&&Object.defineProperty(l,"x",{value:0}),o=0===l.x}catch(n){o=!1}function u(n){return void 0===n._maxListeners?s.defaultMaxListeners:n._maxListeners}function d(n,e,t,i){var a,s,o;if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');if((s=n._events)?(s.newListener&&(n.emit("newListener",e,t.listener?t.listener:t),s=n._events),o=s[e]):(s=n._events=r(null),n._eventsCount=0),o){if("function"==typeof o?o=s[e]=i?[t,o]:[o,t]:i?o.unshift(t):o.push(t),!o.warned&&(a=u(n))&&a>0&&o.length>a){o.warned=!0;var c=new Error("Possible EventEmitter memory leak detected. "+o.length+' "'+String(e)+'" listeners added. Use emitter.setMaxListeners() to increase limit.');c.name="MaxListenersExceededWarning",c.emitter=n,c.type=e,c.count=o.length,"object"==typeof console&&console.warn&&console.warn("%s: %s",c.name,c.message)}}else o=s[e]=t,++n._eventsCount;return n}function h(){if(!this.fired)switch(this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length){case 0:return this.listener.call(this.target);case 1:return this.listener.call(this.target,arguments[0]);case 2:return this.listener.call(this.target,arguments[0],arguments[1]);case 3:return this.listener.call(this.target,arguments[0],arguments[1],arguments[2]);default:for(var n=new Array(arguments.length),e=0;e<n.length;++e)n[e]=arguments[e];this.listener.apply(this.target,n)}}function p(n,e,t){var r={fired:!1,wrapFn:void 0,target:n,type:e,listener:t},i=a.call(h,r);return i.listener=t,r.wrapFn=i,i}function f(n,e,t){var r=n._events;if(!r)return[];var i=r[e];return i?"function"==typeof i?t?[i.listener||i]:[i]:t?function(n){for(var e=new Array(n.length),t=0;t<e.length;++t)e[t]=n[t].listener||n[t];return e}(i):m(i,i.length):[]}function g(n){var e=this._events;if(e){var t=e[n];if("function"==typeof t)return 1;if(t)return t.length}return 0}function m(n,e){for(var t=new Array(e),r=0;r<e;++r)t[r]=n[r];return t}o?Object.defineProperty(s,"defaultMaxListeners",{enumerable:!0,get:function(){return c},set:function(n){if("number"!=typeof n||n<0||n!=n)throw new TypeError('"defaultMaxListeners" must be a positive number');c=n}}):s.defaultMaxListeners=c,s.prototype.setMaxListeners=function(n){if("number"!=typeof n||n<0||isNaN(n))throw new TypeError('"n" argument must be a positive number');return this._maxListeners=n,this},s.prototype.getMaxListeners=function(){return u(this)},s.prototype.emit=function(n){var e,t,r,i,a,s,o="error"===n;if(s=this._events)o=o&&null==s.error;else if(!o)return!1;if(o){if(arguments.length>1&&(e=arguments[1]),e instanceof Error)throw e;var c=new Error('Unhandled "error" event. ('+e+")");throw c.context=e,c}if(!(t=s[n]))return!1;var l="function"==typeof t;switch(r=arguments.length){case 1:!function(n,e,t){if(e)n.call(t);else for(var r=n.length,i=m(n,r),a=0;a<r;++a)i[a].call(t)}(t,l,this);break;case 2:!function(n,e,t,r){if(e)n.call(t,r);else for(var i=n.length,a=m(n,i),s=0;s<i;++s)a[s].call(t,r)}(t,l,this,arguments[1]);break;case 3:!function(n,e,t,r,i){if(e)n.call(t,r,i);else for(var a=n.length,s=m(n,a),o=0;o<a;++o)s[o].call(t,r,i)}(t,l,this,arguments[1],arguments[2]);break;case 4:!function(n,e,t,r,i,a){if(e)n.call(t,r,i,a);else for(var s=n.length,o=m(n,s),c=0;c<s;++c)o[c].call(t,r,i,a)}(t,l,this,arguments[1],arguments[2],arguments[3]);break;default:for(i=new Array(r-1),a=1;a<r;a++)i[a-1]=arguments[a];!function(n,e,t,r){if(e)n.apply(t,r);else for(var i=n.length,a=m(n,i),s=0;s<i;++s)a[s].apply(t,r)}(t,l,this,i)}return!0},s.prototype.addListener=function(n,e){return d(this,n,e,!1)},s.prototype.on=s.prototype.addListener,s.prototype.prependListener=function(n,e){return d(this,n,e,!0)},s.prototype.once=function(n,e){if("function"!=typeof e)throw new TypeError('"listener" argument must be a function');return this.on(n,p(this,n,e)),this},s.prototype.prependOnceListener=function(n,e){if("function"!=typeof e)throw new TypeError('"listener" argument must be a function');return this.prependListener(n,p(this,n,e)),this},s.prototype.removeListener=function(n,e){var t,i,a,s,o;if("function"!=typeof e)throw new TypeError('"listener" argument must be a function');if(!(i=this._events))return this;if(!(t=i[n]))return this;if(t===e||t.listener===e)0==--this._eventsCount?this._events=r(null):(delete i[n],i.removeListener&&this.emit("removeListener",n,t.listener||e));else if("function"!=typeof t){for(a=-1,s=t.length-1;s>=0;s--)if(t[s]===e||t[s].listener===e){o=t[s].listener,a=s;break}if(a<0)return this;0===a?t.shift():function(n,e){for(var t=e,r=t+1,i=n.length;r<i;t+=1,r+=1)n[t]=n[r];n.pop()}(t,a),1===t.length&&(i[n]=t[0]),i.removeListener&&this.emit("removeListener",n,o||e)}return this},s.prototype.removeAllListeners=function(n){var e,t,a;if(!(t=this._events))return this;if(!t.removeListener)return 0===arguments.length?(this._events=r(null),this._eventsCount=0):t[n]&&(0==--this._eventsCount?this._events=r(null):delete t[n]),this;if(0===arguments.length){var s,o=i(t);for(a=0;a<o.length;++a)"removeListener"!==(s=o[a])&&this.removeAllListeners(s);return this.removeAllListeners("removeListener"),this._events=r(null),this._eventsCount=0,this}if("function"==typeof(e=t[n]))this.removeListener(n,e);else if(e)for(a=e.length-1;a>=0;a--)this.removeListener(n,e[a]);return this},s.prototype.listeners=function(n){return f(this,n,!0)},s.prototype.rawListeners=function(n){return f(this,n,!1)},s.listenerCount=function(n,e){return"function"==typeof n.listenerCount?n.listenerCount(e):g.call(n,e)},s.prototype.listenerCount=g,s.prototype.eventNames=function(){return this._eventsCount>0?Reflect.ownKeys(this._events):[]}},{}],30:[function(n,e,t){(function(r){(function(){t.formatArgs=function(n){if(n[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+n[0]+(this.useColors?"%c ":" ")+"+"+e.exports.humanize(this.diff),!this.useColors)return;const t="color: "+this.color;n.splice(1,0,t,"color: inherit");let r=0,i=0;n[0].replace(/%[a-zA-Z%]/g,(n=>{"%%"!==n&&(r++,"%c"===n&&(i=r))})),n.splice(i,0,t)},t.save=function(n){try{n?t.storage.setItem("debug",n):t.storage.removeItem("debug")}catch(n){}},t.load=function(){let n;try{n=t.storage.getItem("debug")}catch(n){}return!n&&void 0!==r&&"env"in r&&(n=r.env.DEBUG),n},t.useColors=function(){return!("undefined"==typeof window||!window.process||"renderer"!==window.process.type&&!window.process.__nwjs)||("undefined"==typeof navigator||!navigator.userAgent||!navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&("undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},t.storage=function(){try{return localStorage}catch(n){}}(),t.destroy=(()=>{let n=!1;return()=>{n||(n=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],t.log=console.debug||console.log||(()=>{}),e.exports=n("./common")(t);const{formatters:i}=e.exports;i.j=function(n){try{return JSON.stringify(n)}catch(n){return"[UnexpectedJSONParseError]: "+n.message}}}).call(this)}).call(this,n("_process"))},{"./common":31,_process:33}],31:[function(n,e,t){e.exports=function(e){function t(n){let e,i,a,s=null;function o(...n){if(!o.enabled)return;const r=o,i=Number(new Date),a=i-(e||i);r.diff=a,r.prev=e,r.curr=i,e=i,n[0]=t.coerce(n[0]),"string"!=typeof n[0]&&n.unshift("%O");let s=0;n[0]=n[0].replace(/%([a-zA-Z%])/g,((e,i)=>{if("%%"===e)return"%";s++;const a=t.formatters[i];if("function"==typeof a){const t=n[s];e=a.call(r,t),n.splice(s,1),s--}return e})),t.formatArgs.call(r,n),(r.log||t.log).apply(r,n)}return o.namespace=n,o.useColors=t.useColors(),o.color=t.selectColor(n),o.extend=r,o.destroy=t.destroy,Object.defineProperty(o,"enabled",{enumerable:!0,configurable:!1,get:()=>null!==s?s:(i!==t.namespaces&&(i=t.namespaces,a=t.enabled(n)),a),set:n=>{s=n}}),"function"==typeof t.init&&t.init(o),o}function r(n,e){const r=t(this.namespace+(void 0===e?":":e)+n);return r.log=this.log,r}function i(n){return n.toString().substring(2,n.toString().length-2).replace(/\.\*\?$/,"*")}return t.debug=t,t.default=t,t.coerce=function(n){return n instanceof Error?n.stack||n.message:n},t.disable=function(){const n=[...t.names.map(i),...t.skips.map(i).map((n=>"-"+n))].join(",");return t.enable(""),n},t.enable=function(n){let e;t.save(n),t.namespaces=n,t.names=[],t.skips=[];const r=("string"==typeof n?n:"").split(/[\s,]+/),i=r.length;for(e=0;e<i;e++)r[e]&&("-"===(n=r[e].replace(/\*/g,".*?"))[0]?t.skips.push(new RegExp("^"+n.slice(1)+"$")):t.names.push(new RegExp("^"+n+"$")))},t.enabled=function(n){if("*"===n[n.length-1])return!0;let e,r;for(e=0,r=t.skips.length;e<r;e++)if(t.skips[e].test(n))return!1;for(e=0,r=t.names.length;e<r;e++)if(t.names[e].test(n))return!0;return!1},t.humanize=n("ms"),t.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(e).forEach((n=>{t[n]=e[n]})),t.names=[],t.skips=[],t.formatters={},t.selectColor=function(n){let e=0;for(let t=0;t<n.length;t++)e=(e<<5)-e+n.charCodeAt(t),e|=0;return t.colors[Math.abs(e)%t.colors.length]},t.enable(t.load()),t}},{ms:32}],32:[function(n,e,t){var r=1e3,i=60*r,a=60*i,s=24*a,o=7*s,c=365.25*s;function l(n,e,t,r){var i=e>=1.5*t;return Math.round(n/t)+" "+r+(i?"s":"")}e.exports=function(n,e){e=e||{};var t=typeof n;if("string"===t&&n.length>0)return function(n){if(!((n=String(n)).length>100)){var e=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(n);if(e){var t=parseFloat(e[1]);switch((e[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return t*c;case"weeks":case"week":case"w":return t*o;case"days":case"day":case"d":return t*s;case"hours":case"hour":case"hrs":case"hr":case"h":return t*a;case"minutes":case"minute":case"mins":case"min":case"m":return t*i;case"seconds":case"second":case"secs":case"sec":case"s":return t*r;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return t;default:return}}}}(n);if("number"===t&&isFinite(n))return e.long?function(n){var e=Math.abs(n);return e>=s?l(n,e,s,"day"):e>=a?l(n,e,a,"hour"):e>=i?l(n,e,i,"minute"):e>=r?l(n,e,r,"second"):n+" ms"}(n):function(n){var e=Math.abs(n);return e>=s?Math.round(n/s)+"d":e>=a?Math.round(n/a)+"h":e>=i?Math.round(n/i)+"m":e>=r?Math.round(n/r)+"s":n+"ms"}(n);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(n))}},{}],33:[function(n,e,t){var r,i,a=e.exports={};function s(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function c(n){if(r===setTimeout)return setTimeout(n,0);if((r===s||!r)&&setTimeout)return r=setTimeout,setTimeout(n,0);try{return r(n,0)}catch(e){try{return r.call(null,n,0)}catch(e){return r.call(this,n,0)}}}!function(){try{r="function"==typeof setTimeout?setTimeout:s}catch(n){r=s}try{i="function"==typeof clearTimeout?clearTimeout:o}catch(n){i=o}}();var l,u=[],d=!1,h=-1;function p(){d&&l&&(d=!1,l.length?u=l.concat(u):h=-1,u.length&&f())}function f(){if(!d){var n=c(p);d=!0;for(var e=u.length;e;){for(l=u,u=[];++h<e;)l&&l[h].run();h=-1,e=u.length}l=null,d=!1,function(n){if(i===clearTimeout)return clearTimeout(n);if((i===o||!i)&&clearTimeout)return i=clearTimeout,clearTimeout(n);try{i(n)}catch(e){try{return i.call(null,n)}catch(e){return i.call(this,n)}}}(n)}}function g(n,e){this.fun=n,this.array=e}function m(){}a.nextTick=function(n){var e=new Array(arguments.length-1);if(arguments.length>1)for(var t=1;t<arguments.length;t++)e[t-1]=arguments[t];u.push(new g(n,e)),1!==u.length||d||c(f)},g.prototype.run=function(){this.fun.apply(null,this.array)},a.title="browser",a.browser=!0,a.env={},a.argv=[],a.version="",a.versions={},a.on=m,a.addListener=m,a.once=m,a.off=m,a.removeListener=m,a.removeAllListeners=m,a.emit=m,a.prependListener=m,a.prependOnceListener=m,a.listeners=function(n){return[]},a.binding=function(n){throw new Error("process.binding is not supported")},a.cwd=function(){return"/"},a.chdir=function(n){throw new Error("process.chdir is not supported")},a.umask=function(){return 0}},{}],34:[function(n,e,t){"use strict";var r=n("sdp");function i(n,e,t,i,a){var s=r.writeRtpDescription(n.kind,e);if(s+=r.writeIceParameters(n.iceGatherer.getLocalParameters()),s+=r.writeDtlsParameters(n.dtlsTransport.getLocalParameters(),"offer"===t?"actpass":a||"active"),s+="a=mid:"+n.mid+"\r\n",n.rtpSender&&n.rtpReceiver?s+="a=sendrecv\r\n":n.rtpSender?s+="a=sendonly\r\n":n.rtpReceiver?s+="a=recvonly\r\n":s+="a=inactive\r\n",n.rtpSender){var o=n.rtpSender._initialTrackId||n.rtpSender.track.id;n.rtpSender._initialTrackId=o;var c="msid:"+(i?i.id:"-")+" "+o+"\r\n";s+="a="+c,s+="a=ssrc:"+n.sendEncodingParameters[0].ssrc+" "+c,n.sendEncodingParameters[0].rtx&&(s+="a=ssrc:"+n.sendEncodingParameters[0].rtx.ssrc+" "+c,s+="a=ssrc-group:FID "+n.sendEncodingParameters[0].ssrc+" "+n.sendEncodingParameters[0].rtx.ssrc+"\r\n")}return s+="a=ssrc:"+n.sendEncodingParameters[0].ssrc+" cname:"+r.localCName+"\r\n",n.rtpSender&&n.sendEncodingParameters[0].rtx&&(s+="a=ssrc:"+n.sendEncodingParameters[0].rtx.ssrc+" cname:"+r.localCName+"\r\n"),s}function a(n,e){var t={codecs:[],headerExtensions:[],fecMechanisms:[]},r=function(n,e){n=parseInt(n,10);for(var t=0;t<e.length;t++)if(e[t].payloadType===n||e[t].preferredPayloadType===n)return e[t]},i=function(n,e,t,i){var a=r(n.parameters.apt,t),s=r(e.parameters.apt,i);return a&&s&&a.name.toLowerCase()===s.name.toLowerCase()};return n.codecs.forEach((function(r){for(var a=0;a<e.codecs.length;a++){var s=e.codecs[a];if(r.name.toLowerCase()===s.name.toLowerCase()&&r.clockRate===s.clockRate){if("rtx"===r.name.toLowerCase()&&r.parameters&&s.parameters.apt&&!i(r,s,n.codecs,e.codecs))continue;(s=JSON.parse(JSON.stringify(s))).numChannels=Math.min(r.numChannels,s.numChannels),t.codecs.push(s),s.rtcpFeedback=s.rtcpFeedback.filter((function(n){for(var e=0;e<r.rtcpFeedback.length;e++)if(r.rtcpFeedback[e].type===n.type&&r.rtcpFeedback[e].parameter===n.parameter)return!0;return!1}));break}}})),n.headerExtensions.forEach((function(n){for(var r=0;r<e.headerExtensions.length;r++){var i=e.headerExtensions[r];if(n.uri===i.uri){t.headerExtensions.push(i);break}}})),t}function s(n,e,t){return-1!=={offer:{setLocalDescription:["stable","have-local-offer"],setRemoteDescription:["stable","have-remote-offer"]},answer:{setLocalDescription:["have-remote-offer","have-local-pranswer"],setRemoteDescription:["have-local-offer","have-remote-pranswer"]}}[e][n].indexOf(t)}function o(n,e){var t=n.getRemoteCandidates().find((function(n){return e.foundation===n.foundation&&e.ip===n.ip&&e.port===n.port&&e.priority===n.priority&&e.protocol===n.protocol&&e.type===n.type}));return t||n.addRemoteCandidate(e),!t}function c(n,e){var t=new Error(e);return t.name=n,t.code={NotSupportedError:9,InvalidStateError:11,InvalidAccessError:15,TypeError:void 0,OperationError:void 0}[n],t}e.exports=function(n,e){function t(e,t){t.addTrack(e),t.dispatchEvent(new n.MediaStreamTrackEvent("addtrack",{track:e}))}function l(e,t,r,i){var a=new Event("track");a.track=t,a.receiver=r,a.transceiver={receiver:r},a.streams=i,n.setTimeout((function(){e._dispatchEvent("track",a)}))}var u=function(t){var i=this,a=document.createDocumentFragment();if(["addEventListener","removeEventListener","dispatchEvent"].forEach((function(n){i[n]=a[n].bind(a)})),this.canTrickleIceCandidates=null,this.needNegotiation=!1,this.localStreams=[],this.remoteStreams=[],this._localDescription=null,this._remoteDescription=null,this.signalingState="stable",this.iceConnectionState="new",this.connectionState="new",this.iceGatheringState="new",t=JSON.parse(JSON.stringify(t||{})),this.usingBundle="max-bundle"===t.bundlePolicy,"negotiate"===t.rtcpMuxPolicy)throw c("NotSupportedError","rtcpMuxPolicy 'negotiate' is not supported");switch(t.rtcpMuxPolicy||(t.rtcpMuxPolicy="require"),t.iceTransportPolicy){case"all":case"relay":break;default:t.iceTransportPolicy="all"}switch(t.bundlePolicy){case"balanced":case"max-compat":case"max-bundle":break;default:t.bundlePolicy="balanced"}if(t.iceServers=function(n,e){var t=!1;return(n=JSON.parse(JSON.stringify(n))).filter((function(n){if(n&&(n.urls||n.url)){var r=n.urls||n.url;n.url&&!n.urls&&console.warn("RTCIceServer.url is deprecated! Use urls instead.");var i="string"==typeof r;return i&&(r=[r]),r=r.filter((function(n){return 0!==n.indexOf("turn:")||-1===n.indexOf("transport=udp")||-1!==n.indexOf("turn:[")||t?0===n.indexOf("stun:")&&e>=14393&&-1===n.indexOf("?transport=udp"):(t=!0,!0)})),delete n.url,n.urls=i?r[0]:r,!!r.length}}))}(t.iceServers||[],e),this._iceGatherers=[],t.iceCandidatePoolSize)for(var s=t.iceCandidatePoolSize;s>0;s--)this._iceGatherers.push(new n.RTCIceGatherer({iceServers:t.iceServers,gatherPolicy:t.iceTransportPolicy}));else t.iceCandidatePoolSize=0;this._config=t,this.transceivers=[],this._sdpSessionId=r.generateSessionId(),this._sdpSessionVersion=0,this._dtlsRole=void 0,this._isClosed=!1};Object.defineProperty(u.prototype,"localDescription",{configurable:!0,get:function(){return this._localDescription}}),Object.defineProperty(u.prototype,"remoteDescription",{configurable:!0,get:function(){return this._remoteDescription}}),u.prototype.onicecandidate=null,u.prototype.onaddstream=null,u.prototype.ontrack=null,u.prototype.onremovestream=null,u.prototype.onsignalingstatechange=null,u.prototype.oniceconnectionstatechange=null,u.prototype.onconnectionstatechange=null,u.prototype.onicegatheringstatechange=null,u.prototype.onnegotiationneeded=null,u.prototype.ondatachannel=null,u.prototype._dispatchEvent=function(n,e){this._isClosed||(this.dispatchEvent(e),"function"==typeof this["on"+n]&&this["on"+n](e))},u.prototype._emitGatheringStateChange=function(){var n=new Event("icegatheringstatechange");this._dispatchEvent("icegatheringstatechange",n)},u.prototype.getConfiguration=function(){return this._config},u.prototype.getLocalStreams=function(){return this.localStreams},u.prototype.getRemoteStreams=function(){return this.remoteStreams},u.prototype._createTransceiver=function(n,e){var t=this.transceivers.length>0,r={track:null,iceGatherer:null,iceTransport:null,dtlsTransport:null,localCapabilities:null,remoteCapabilities:null,rtpSender:null,rtpReceiver:null,kind:n,mid:null,sendEncodingParameters:null,recvEncodingParameters:null,stream:null,associatedRemoteMediaStreams:[],wantReceive:!0};if(this.usingBundle&&t)r.iceTransport=this.transceivers[0].iceTransport,r.dtlsTransport=this.transceivers[0].dtlsTransport;else{var i=this._createIceAndDtlsTransports();r.iceTransport=i.iceTransport,r.dtlsTransport=i.dtlsTransport}return e||this.transceivers.push(r),r},u.prototype.addTrack=function(e,t){if(this._isClosed)throw c("InvalidStateError","Attempted to call addTrack on a closed peerconnection.");var r;if(this.transceivers.find((function(n){return n.track===e})))throw c("InvalidAccessError","Track already exists.");for(var i=0;i<this.transceivers.length;i++)this.transceivers[i].track||this.transceivers[i].kind!==e.kind||(r=this.transceivers[i]);return r||(r=this._createTransceiver(e.kind)),this._maybeFireNegotiationNeeded(),-1===this.localStreams.indexOf(t)&&this.localStreams.push(t),r.track=e,r.stream=t,r.rtpSender=new n.RTCRtpSender(e,r.dtlsTransport),r.rtpSender},u.prototype.addStream=function(n){var t=this;if(e>=15025)n.getTracks().forEach((function(e){t.addTrack(e,n)}));else{var r=n.clone();n.getTracks().forEach((function(n,e){var t=r.getTracks()[e];n.addEventListener("enabled",(function(n){t.enabled=n.enabled}))})),r.getTracks().forEach((function(n){t.addTrack(n,r)}))}},u.prototype.removeTrack=function(e){if(this._isClosed)throw c("InvalidStateError","Attempted to call removeTrack on a closed peerconnection.");if(!(e instanceof n.RTCRtpSender))throw new TypeError("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.");var t=this.transceivers.find((function(n){return n.rtpSender===e}));if(!t)throw c("InvalidAccessError","Sender was not created by this connection.");var r=t.stream;t.rtpSender.stop(),t.rtpSender=null,t.track=null,t.stream=null,-1===this.transceivers.map((function(n){return n.stream})).indexOf(r)&&this.localStreams.indexOf(r)>-1&&this.localStreams.splice(this.localStreams.indexOf(r),1),this._maybeFireNegotiationNeeded()},u.prototype.removeStream=function(n){var e=this;n.getTracks().forEach((function(n){var t=e.getSenders().find((function(e){return e.track===n}));t&&e.removeTrack(t)}))},u.prototype.getSenders=function(){return this.transceivers.filter((function(n){return!!n.rtpSender})).map((function(n){return n.rtpSender}))},u.prototype.getReceivers=function(){return this.transceivers.filter((function(n){return!!n.rtpReceiver})).map((function(n){return n.rtpReceiver}))},u.prototype._createIceGatherer=function(e,t){var r=this;if(t&&e>0)return this.transceivers[0].iceGatherer;if(this._iceGatherers.length)return this._iceGatherers.shift();var i=new n.RTCIceGatherer({iceServers:this._config.iceServers,gatherPolicy:this._config.iceTransportPolicy});return Object.defineProperty(i,"state",{value:"new",writable:!0}),this.transceivers[e].bufferedCandidateEvents=[],this.transceivers[e].bufferCandidates=function(n){var t=!n.candidate||0===Object.keys(n.candidate).length;i.state=t?"completed":"gathering",null!==r.transceivers[e].bufferedCandidateEvents&&r.transceivers[e].bufferedCandidateEvents.push(n)},i.addEventListener("localcandidate",this.transceivers[e].bufferCandidates),i},u.prototype._gather=function(e,t){var i=this,a=this.transceivers[t].iceGatherer;if(!a.onlocalcandidate){var s=this.transceivers[t].bufferedCandidateEvents;this.transceivers[t].bufferedCandidateEvents=null,a.removeEventListener("localcandidate",this.transceivers[t].bufferCandidates),a.onlocalcandidate=function(n){if(!(i.usingBundle&&t>0)){var s=new Event("icecandidate");s.candidate={sdpMid:e,sdpMLineIndex:t};var o=n.candidate,c=!o||0===Object.keys(o).length;if(c)"new"!==a.state&&"gathering"!==a.state||(a.state="completed");else{"new"===a.state&&(a.state="gathering"),o.component=1,o.ufrag=a.getLocalParameters().usernameFragment;var l=r.writeCandidate(o);s.candidate=Object.assign(s.candidate,r.parseCandidate(l)),s.candidate.candidate=l,s.candidate.toJSON=function(){return{candidate:s.candidate.candidate,sdpMid:s.candidate.sdpMid,sdpMLineIndex:s.candidate.sdpMLineIndex,usernameFragment:s.candidate.usernameFragment}}}var u=r.getMediaSections(i._localDescription.sdp);u[s.candidate.sdpMLineIndex]+=c?"a=end-of-candidates\r\n":"a="+s.candidate.candidate+"\r\n",i._localDescription.sdp=r.getDescription(i._localDescription.sdp)+u.join("");var d=i.transceivers.every((function(n){return n.iceGatherer&&"completed"===n.iceGatherer.state}));"gathering"!==i.iceGatheringState&&(i.iceGatheringState="gathering",i._emitGatheringStateChange()),c||i._dispatchEvent("icecandidate",s),d&&(i._dispatchEvent("icecandidate",new Event("icecandidate")),i.iceGatheringState="complete",i._emitGatheringStateChange())}},n.setTimeout((function(){s.forEach((function(n){a.onlocalcandidate(n)}))}),0)}},u.prototype._createIceAndDtlsTransports=function(){var e=this,t=new n.RTCIceTransport(null);t.onicestatechange=function(){e._updateIceConnectionState(),e._updateConnectionState()};var r=new n.RTCDtlsTransport(t);return r.ondtlsstatechange=function(){e._updateConnectionState()},r.onerror=function(){Object.defineProperty(r,"state",{value:"failed",writable:!0}),e._updateConnectionState()},{iceTransport:t,dtlsTransport:r}},u.prototype._disposeIceAndDtlsTransports=function(n){var e=this.transceivers[n].iceGatherer;e&&(delete e.onlocalcandidate,delete this.transceivers[n].iceGatherer);var t=this.transceivers[n].iceTransport;t&&(delete t.onicestatechange,delete this.transceivers[n].iceTransport);var r=this.transceivers[n].dtlsTransport;r&&(delete r.ondtlsstatechange,delete r.onerror,delete this.transceivers[n].dtlsTransport)},u.prototype._transceive=function(n,t,i){var s=a(n.localCapabilities,n.remoteCapabilities);t&&n.rtpSender&&(s.encodings=n.sendEncodingParameters,s.rtcp={cname:r.localCName,compound:n.rtcpParameters.compound},n.recvEncodingParameters.length&&(s.rtcp.ssrc=n.recvEncodingParameters[0].ssrc),n.rtpSender.send(s)),i&&n.rtpReceiver&&s.codecs.length>0&&("video"===n.kind&&n.recvEncodingParameters&&e<15019&&n.recvEncodingParameters.forEach((function(n){delete n.rtx})),n.recvEncodingParameters.length?s.encodings=n.recvEncodingParameters:s.encodings=[{}],s.rtcp={compound:n.rtcpParameters.compound},n.rtcpParameters.cname&&(s.rtcp.cname=n.rtcpParameters.cname),n.sendEncodingParameters.length&&(s.rtcp.ssrc=n.sendEncodingParameters[0].ssrc),n.rtpReceiver.receive(s))},u.prototype.setLocalDescription=function(n){var e,t,i=this;if(-1===["offer","answer"].indexOf(n.type))return Promise.reject(c("TypeError",'Unsupported type "'+n.type+'"'));if(!s("setLocalDescription",n.type,i.signalingState)||i._isClosed)return Promise.reject(c("InvalidStateError","Can not set local "+n.type+" in state "+i.signalingState));if("offer"===n.type)e=r.splitSections(n.sdp),t=e.shift(),e.forEach((function(n,e){var t=r.parseRtpParameters(n);i.transceivers[e].localCapabilities=t})),i.transceivers.forEach((function(n,e){i._gather(n.mid,e)}));else if("answer"===n.type){e=r.splitSections(i._remoteDescription.sdp),t=e.shift();var o=r.matchPrefix(t,"a=ice-lite").length>0;e.forEach((function(n,e){var s=i.transceivers[e],c=s.iceGatherer,l=s.iceTransport,u=s.dtlsTransport,d=s.localCapabilities,h=s.remoteCapabilities;if((!r.isRejected(n)||0!==r.matchPrefix(n,"a=bundle-only").length)&&!s.rejected){var p=r.getIceParameters(n,t),f=r.getDtlsParameters(n,t);o&&(f.role="server"),i.usingBundle&&0!==e||(i._gather(s.mid,e),"new"===l.state&&l.start(c,p,o?"controlling":"controlled"),"new"===u.state&&u.start(f));var g=a(d,h);i._transceive(s,g.codecs.length>0,!1)}}))}return i._localDescription={type:n.type,sdp:n.sdp},"offer"===n.type?i._updateSignalingState("have-local-offer"):i._updateSignalingState("stable"),Promise.resolve()},u.prototype.setRemoteDescription=function(i){var u=this;if(-1===["offer","answer"].indexOf(i.type))return Promise.reject(c("TypeError",'Unsupported type "'+i.type+'"'));if(!s("setRemoteDescription",i.type,u.signalingState)||u._isClosed)return Promise.reject(c("InvalidStateError","Can not set remote "+i.type+" in state "+u.signalingState));var d={};u.remoteStreams.forEach((function(n){d[n.id]=n}));var h=[],p=r.splitSections(i.sdp),f=p.shift(),g=r.matchPrefix(f,"a=ice-lite").length>0,m=r.matchPrefix(f,"a=group:BUNDLE ").length>0;u.usingBundle=m;var b=r.matchPrefix(f,"a=ice-options:")[0];return u.canTrickleIceCandidates=!!b&&b.substr(14).split(" ").indexOf("trickle")>=0,p.forEach((function(s,c){var l=r.splitLines(s),p=r.getKind(s),b=r.isRejected(s)&&0===r.matchPrefix(s,"a=bundle-only").length,v=l[0].substr(2).split(" ")[2],y=r.getDirection(s,f),_=r.parseMsid(s),C=r.getMid(s)||r.generateIdentifier();if(b||"application"===p&&("DTLS/SCTP"===v||"UDP/DTLS/SCTP"===v))u.transceivers[c]={mid:C,kind:p,protocol:v,rejected:!0};else{var S,T,E,w,k,R,I,A,O;!b&&u.transceivers[c]&&u.transceivers[c].rejected&&(u.transceivers[c]=u._createTransceiver(p,!0));var P,L,D=r.parseRtpParameters(s);b||(P=r.getIceParameters(s,f),(L=r.getDtlsParameters(s,f)).role="client"),I=r.parseRtpEncodingParameters(s);var N=r.parseRtcpParameters(s),M=r.matchPrefix(s,"a=end-of-candidates",f).length>0,j=r.matchPrefix(s,"a=candidate:").map((function(n){return r.parseCandidate(n)})).filter((function(n){return 1===n.component}));if(("offer"===i.type||"answer"===i.type)&&!b&&m&&c>0&&u.transceivers[c]&&(u._disposeIceAndDtlsTransports(c),u.transceivers[c].iceGatherer=u.transceivers[0].iceGatherer,u.transceivers[c].iceTransport=u.transceivers[0].iceTransport,u.transceivers[c].dtlsTransport=u.transceivers[0].dtlsTransport,u.transceivers[c].rtpSender&&u.transceivers[c].rtpSender.setTransport(u.transceivers[0].dtlsTransport),u.transceivers[c].rtpReceiver&&u.transceivers[c].rtpReceiver.setTransport(u.transceivers[0].dtlsTransport)),"offer"!==i.type||b)"answer"!==i.type||b||(T=(S=u.transceivers[c]).iceGatherer,E=S.iceTransport,w=S.dtlsTransport,k=S.rtpReceiver,R=S.sendEncodingParameters,A=S.localCapabilities,u.transceivers[c].recvEncodingParameters=I,u.transceivers[c].remoteCapabilities=D,u.transceivers[c].rtcpParameters=N,j.length&&"new"===E.state&&(!g&&!M||m&&0!==c?j.forEach((function(n){o(S.iceTransport,n)})):E.setRemoteCandidates(j)),m&&0!==c||("new"===E.state&&E.start(T,P,"controlling"),"new"===w.state&&w.start(L)),!a(S.localCapabilities,S.remoteCapabilities).codecs.filter((function(n){return"rtx"===n.name.toLowerCase()})).length&&S.sendEncodingParameters[0].rtx&&delete S.sendEncodingParameters[0].rtx,u._transceive(S,"sendrecv"===y||"recvonly"===y,"sendrecv"===y||"sendonly"===y),!k||"sendrecv"!==y&&"sendonly"!==y?delete S.rtpReceiver:(O=k.track,_?(d[_.stream]||(d[_.stream]=new n.MediaStream),t(O,d[_.stream]),h.push([O,k,d[_.stream]])):(d.default||(d.default=new n.MediaStream),t(O,d.default),h.push([O,k,d.default]))));else{(S=u.transceivers[c]||u._createTransceiver(p)).mid=C,S.iceGatherer||(S.iceGatherer=u._createIceGatherer(c,m)),j.length&&"new"===S.iceTransport.state&&(!M||m&&0!==c?j.forEach((function(n){o(S.iceTransport,n)})):S.iceTransport.setRemoteCandidates(j)),A=n.RTCRtpReceiver.getCapabilities(p),e<15019&&(A.codecs=A.codecs.filter((function(n){return"rtx"!==n.name}))),R=S.sendEncodingParameters||[{ssrc:1001*(2*c+2)}];var x,U=!1;"sendrecv"===y||"sendonly"===y?(U=!S.rtpReceiver,k=S.rtpReceiver||new n.RTCRtpReceiver(S.dtlsTransport,p),U&&(O=k.track,_&&"-"===_.stream||(_?(d[_.stream]||(d[_.stream]=new n.MediaStream,Object.defineProperty(d[_.stream],"id",{get:function(){return _.stream}})),Object.defineProperty(O,"id",{get:function(){return _.track}}),x=d[_.stream]):(d.default||(d.default=new n.MediaStream),x=d.default)),x&&(t(O,x),S.associatedRemoteMediaStreams.push(x)),h.push([O,k,x]))):S.rtpReceiver&&S.rtpReceiver.track&&(S.associatedRemoteMediaStreams.forEach((function(e){var t,r,i=e.getTracks().find((function(n){return n.id===S.rtpReceiver.track.id}));i&&(t=i,(r=e).removeTrack(t),r.dispatchEvent(new n.MediaStreamTrackEvent("removetrack",{track:t})))})),S.associatedRemoteMediaStreams=[]),S.localCapabilities=A,S.remoteCapabilities=D,S.rtpReceiver=k,S.rtcpParameters=N,S.sendEncodingParameters=R,S.recvEncodingParameters=I,u._transceive(u.transceivers[c],!1,U)}}})),void 0===u._dtlsRole&&(u._dtlsRole="offer"===i.type?"active":"passive"),u._remoteDescription={type:i.type,sdp:i.sdp},"offer"===i.type?u._updateSignalingState("have-remote-offer"):u._updateSignalingState("stable"),Object.keys(d).forEach((function(e){var t=d[e];if(t.getTracks().length){if(-1===u.remoteStreams.indexOf(t)){u.remoteStreams.push(t);var r=new Event("addstream");r.stream=t,n.setTimeout((function(){u._dispatchEvent("addstream",r)}))}h.forEach((function(n){var e=n[0],r=n[1];t.id===n[2].id&&l(u,e,r,[t])}))}})),h.forEach((function(n){n[2]||l(u,n[0],n[1],[])})),n.setTimeout((function(){u&&u.transceivers&&u.transceivers.forEach((function(n){n.iceTransport&&"new"===n.iceTransport.state&&n.iceTransport.getRemoteCandidates().length>0&&(console.warn("Timeout for addRemoteCandidate. Consider sending an end-of-candidates notification"),n.iceTransport.addRemoteCandidate({}))}))}),4e3),Promise.resolve()},u.prototype.close=function(){this.transceivers.forEach((function(n){n.iceTransport&&n.iceTransport.stop(),n.dtlsTransport&&n.dtlsTransport.stop(),n.rtpSender&&n.rtpSender.stop(),n.rtpReceiver&&n.rtpReceiver.stop()})),this._isClosed=!0,this._updateSignalingState("closed")},u.prototype._updateSignalingState=function(n){this.signalingState=n;var e=new Event("signalingstatechange");this._dispatchEvent("signalingstatechange",e)},u.prototype._maybeFireNegotiationNeeded=function(){var e=this;"stable"===this.signalingState&&!0!==this.needNegotiation&&(this.needNegotiation=!0,n.setTimeout((function(){if(e.needNegotiation){e.needNegotiation=!1;var n=new Event("negotiationneeded");e._dispatchEvent("negotiationneeded",n)}}),0))},u.prototype._updateIceConnectionState=function(){var n,e={new:0,closed:0,checking:0,connected:0,completed:0,disconnected:0,failed:0};if(this.transceivers.forEach((function(n){n.iceTransport&&!n.rejected&&e[n.iceTransport.state]++})),n="new",e.failed>0?n="failed":e.checking>0?n="checking":e.disconnected>0?n="disconnected":e.new>0?n="new":e.connected>0?n="connected":e.completed>0&&(n="completed"),n!==this.iceConnectionState){this.iceConnectionState=n;var t=new Event("iceconnectionstatechange");this._dispatchEvent("iceconnectionstatechange",t)}},u.prototype._updateConnectionState=function(){var n,e={new:0,closed:0,connecting:0,connected:0,completed:0,disconnected:0,failed:0};if(this.transceivers.forEach((function(n){n.iceTransport&&n.dtlsTransport&&!n.rejected&&(e[n.iceTransport.state]++,e[n.dtlsTransport.state]++)})),e.connected+=e.completed,n="new",e.failed>0?n="failed":e.connecting>0?n="connecting":e.disconnected>0?n="disconnected":e.new>0?n="new":e.connected>0&&(n="connected"),n!==this.connectionState){this.connectionState=n;var t=new Event("connectionstatechange");this._dispatchEvent("connectionstatechange",t)}},u.prototype.createOffer=function(){var t=this;if(t._isClosed)return Promise.reject(c("InvalidStateError","Can not call createOffer after close"));var a=t.transceivers.filter((function(n){return"audio"===n.kind})).length,s=t.transceivers.filter((function(n){return"video"===n.kind})).length,o=arguments[0];if(o){if(o.mandatory||o.optional)throw new TypeError("Legacy mandatory/optional constraints not supported.");void 0!==o.offerToReceiveAudio&&(a=!0===o.offerToReceiveAudio?1:!1===o.offerToReceiveAudio?0:o.offerToReceiveAudio),void 0!==o.offerToReceiveVideo&&(s=!0===o.offerToReceiveVideo?1:!1===o.offerToReceiveVideo?0:o.offerToReceiveVideo)}for(t.transceivers.forEach((function(n){"audio"===n.kind?--a<0&&(n.wantReceive=!1):"video"===n.kind&&--s<0&&(n.wantReceive=!1)}));a>0||s>0;)a>0&&(t._createTransceiver("audio"),a--),s>0&&(t._createTransceiver("video"),s--);var l=r.writeSessionBoilerplate(t._sdpSessionId,t._sdpSessionVersion++);t.transceivers.forEach((function(i,a){var s=i.track,o=i.kind,c=i.mid||r.generateIdentifier();i.mid=c,i.iceGatherer||(i.iceGatherer=t._createIceGatherer(a,t.usingBundle));var l=n.RTCRtpSender.getCapabilities(o);e<15019&&(l.codecs=l.codecs.filter((function(n){return"rtx"!==n.name}))),l.codecs.forEach((function(n){"H264"===n.name&&void 0===n.parameters["level-asymmetry-allowed"]&&(n.parameters["level-asymmetry-allowed"]="1"),i.remoteCapabilities&&i.remoteCapabilities.codecs&&i.remoteCapabilities.codecs.forEach((function(e){n.name.toLowerCase()===e.name.toLowerCase()&&n.clockRate===e.clockRate&&(n.preferredPayloadType=e.payloadType)}))})),l.headerExtensions.forEach((function(n){(i.remoteCapabilities&&i.remoteCapabilities.headerExtensions||[]).forEach((function(e){n.uri===e.uri&&(n.id=e.id)}))}));var u=i.sendEncodingParameters||[{ssrc:1001*(2*a+1)}];s&&e>=15019&&"video"===o&&!u[0].rtx&&(u[0].rtx={ssrc:u[0].ssrc+1}),i.wantReceive&&(i.rtpReceiver=new n.RTCRtpReceiver(i.dtlsTransport,o)),i.localCapabilities=l,i.sendEncodingParameters=u})),"max-compat"!==t._config.bundlePolicy&&(l+="a=group:BUNDLE "+t.transceivers.map((function(n){return n.mid})).join(" ")+"\r\n"),l+="a=ice-options:trickle\r\n",t.transceivers.forEach((function(n,e){l+=i(n,n.localCapabilities,"offer",n.stream,t._dtlsRole),l+="a=rtcp-rsize\r\n",!n.iceGatherer||"new"===t.iceGatheringState||0!==e&&t.usingBundle||(n.iceGatherer.getLocalCandidates().forEach((function(n){n.component=1,l+="a="+r.writeCandidate(n)+"\r\n"})),"completed"===n.iceGatherer.state&&(l+="a=end-of-candidates\r\n"))}));var u=new n.RTCSessionDescription({type:"offer",sdp:l});return Promise.resolve(u)},u.prototype.createAnswer=function(){var t=this;if(t._isClosed)return Promise.reject(c("InvalidStateError","Can not call createAnswer after close"));if("have-remote-offer"!==t.signalingState&&"have-local-pranswer"!==t.signalingState)return Promise.reject(c("InvalidStateError","Can not call createAnswer in signalingState "+t.signalingState));var s=r.writeSessionBoilerplate(t._sdpSessionId,t._sdpSessionVersion++);t.usingBundle&&(s+="a=group:BUNDLE "+t.transceivers.map((function(n){return n.mid})).join(" ")+"\r\n"),s+="a=ice-options:trickle\r\n";var o=r.getMediaSections(t._remoteDescription.sdp).length;t.transceivers.forEach((function(n,r){if(!(r+1>o)){if(n.rejected)return"application"===n.kind?"DTLS/SCTP"===n.protocol?s+="m=application 0 DTLS/SCTP 5000\r\n":s+="m=application 0 "+n.protocol+" webrtc-datachannel\r\n":"audio"===n.kind?s+="m=audio 0 UDP/TLS/RTP/SAVPF 0\r\na=rtpmap:0 PCMU/8000\r\n":"video"===n.kind&&(s+="m=video 0 UDP/TLS/RTP/SAVPF 120\r\na=rtpmap:120 VP8/90000\r\n"),void(s+="c=IN IP4 0.0.0.0\r\na=inactive\r\na=mid:"+n.mid+"\r\n");var c;n.stream&&("audio"===n.kind?c=n.stream.getAudioTracks()[0]:"video"===n.kind&&(c=n.stream.getVideoTracks()[0]),c&&e>=15019&&"video"===n.kind&&!n.sendEncodingParameters[0].rtx&&(n.sendEncodingParameters[0].rtx={ssrc:n.sendEncodingParameters[0].ssrc+1}));var l=a(n.localCapabilities,n.remoteCapabilities);!l.codecs.filter((function(n){return"rtx"===n.name.toLowerCase()})).length&&n.sendEncodingParameters[0].rtx&&delete n.sendEncodingParameters[0].rtx,s+=i(n,l,"answer",n.stream,t._dtlsRole),n.rtcpParameters&&n.rtcpParameters.reducedSize&&(s+="a=rtcp-rsize\r\n")}}));var l=new n.RTCSessionDescription({type:"answer",sdp:s});return Promise.resolve(l)},u.prototype.addIceCandidate=function(n){var e,t=this;return n&&void 0===n.sdpMLineIndex&&!n.sdpMid?Promise.reject(new TypeError("sdpMLineIndex or sdpMid required")):new Promise((function(i,a){if(!t._remoteDescription)return a(c("InvalidStateError","Can not add ICE candidate without a remote description"));if(n&&""!==n.candidate){var s=n.sdpMLineIndex;if(n.sdpMid)for(var l=0;l<t.transceivers.length;l++)if(t.transceivers[l].mid===n.sdpMid){s=l;break}var u=t.transceivers[s];if(!u)return a(c("OperationError","Can not add ICE candidate"));if(u.rejected)return i();var d=Object.keys(n.candidate).length>0?r.parseCandidate(n.candidate):{};if("tcp"===d.protocol&&(0===d.port||9===d.port))return i();if(d.component&&1!==d.component)return i();if((0===s||s>0&&u.iceTransport!==t.transceivers[0].iceTransport)&&!o(u.iceTransport,d))return a(c("OperationError","Can not add ICE candidate"));var h=n.candidate.trim();0===h.indexOf("a=")&&(h=h.substr(2)),(e=r.getMediaSections(t._remoteDescription.sdp))[s]+="a="+(d.type?h:"end-of-candidates")+"\r\n",t._remoteDescription.sdp=r.getDescription(t._remoteDescription.sdp)+e.join("")}else for(var p=0;p<t.transceivers.length&&(t.transceivers[p].rejected||(t.transceivers[p].iceTransport.addRemoteCandidate({}),(e=r.getMediaSections(t._remoteDescription.sdp))[p]+="a=end-of-candidates\r\n",t._remoteDescription.sdp=r.getDescription(t._remoteDescription.sdp)+e.join(""),!t.usingBundle));p++);i()}))},u.prototype.getStats=function(e){if(e&&e instanceof n.MediaStreamTrack){var t=null;if(this.transceivers.forEach((function(n){n.rtpSender&&n.rtpSender.track===e?t=n.rtpSender:n.rtpReceiver&&n.rtpReceiver.track===e&&(t=n.rtpReceiver)})),!t)throw c("InvalidAccessError","Invalid selector.");return t.getStats()}var r=[];return this.transceivers.forEach((function(n){["rtpSender","rtpReceiver","iceGatherer","iceTransport","dtlsTransport"].forEach((function(e){n[e]&&r.push(n[e].getStats())}))})),Promise.all(r).then((function(n){var e=new Map;return n.forEach((function(n){n.forEach((function(n){e.set(n.id,n)}))})),e}))},["RTCRtpSender","RTCRtpReceiver","RTCIceGatherer","RTCIceTransport","RTCDtlsTransport"].forEach((function(e){var t=n[e];if(t&&t.prototype&&t.prototype.getStats){var r=t.prototype.getStats;t.prototype.getStats=function(){return r.apply(this).then((function(n){var e=new Map;return Object.keys(n).forEach((function(t){var r;n[t].type={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[(r=n[t]).type]||r.type,e.set(t,n[t])})),e}))}}}));var d=["createOffer","createAnswer"];return d.forEach((function(n){var e=u.prototype[n];u.prototype[n]=function(){var n=arguments;return"function"==typeof n[0]||"function"==typeof n[1]?e.apply(this,[arguments[2]]).then((function(e){"function"==typeof n[0]&&n[0].apply(null,[e])}),(function(e){"function"==typeof n[1]&&n[1].apply(null,[e])})):e.apply(this,arguments)}})),(d=["setLocalDescription","setRemoteDescription","addIceCandidate"]).forEach((function(n){var e=u.prototype[n];u.prototype[n]=function(){var n=arguments;return"function"==typeof n[1]||"function"==typeof n[2]?e.apply(this,arguments).then((function(){"function"==typeof n[1]&&n[1].apply(null)}),(function(e){"function"==typeof n[2]&&n[2].apply(null,[e])})):e.apply(this,arguments)}})),["getStats"].forEach((function(n){var e=u.prototype[n];u.prototype[n]=function(){var n=arguments;return"function"==typeof n[1]?e.apply(this,arguments).then((function(){"function"==typeof n[1]&&n[1].apply(null)})):e.apply(this,arguments)}})),u}},{sdp:39}],35:[function(n,e,t){var r=e.exports={v:[{name:"version",reg:/^(\d*)$/}],o:[{name:"origin",reg:/^(\S*) (\d*) (\d*) (\S*) IP(\d) (\S*)/,names:["username","sessionId","sessionVersion","netType","ipVer","address"],format:"%s %s %d %s IP%d %s"}],s:[{name:"name"}],i:[{name:"description"}],u:[{name:"uri"}],e:[{name:"email"}],p:[{name:"phone"}],z:[{name:"timezones"}],r:[{name:"repeats"}],t:[{name:"timing",reg:/^(\d*) (\d*)/,names:["start","stop"],format:"%d %d"}],c:[{name:"connection",reg:/^IN IP(\d) (\S*)/,names:["version","ip"],format:"IN IP%d %s"}],b:[{push:"bandwidth",reg:/^(TIAS|AS|CT|RR|RS):(\d*)/,names:["type","limit"],format:"%s:%s"}],m:[{reg:/^(\w*) (\d*) ([\w/]*)(?: (.*))?/,names:["type","port","protocol","payloads"],format:"%s %d %s %s"}],a:[{push:"rtp",reg:/^rtpmap:(\d*) ([\w\-.]*)(?:\s*\/(\d*)(?:\s*\/(\S*))?)?/,names:["payload","codec","rate","encoding"],format:function(n){return n.encoding?"rtpmap:%d %s/%s/%s":n.rate?"rtpmap:%d %s/%s":"rtpmap:%d %s"}},{push:"fmtp",reg:/^fmtp:(\d*) ([\S| ]*)/,names:["payload","config"],format:"fmtp:%d %s"},{name:"control",reg:/^control:(.*)/,format:"control:%s"},{name:"rtcp",reg:/^rtcp:(\d*)(?: (\S*) IP(\d) (\S*))?/,names:["port","netType","ipVer","address"],format:function(n){return null!=n.address?"rtcp:%d %s IP%d %s":"rtcp:%d"}},{push:"rtcpFbTrrInt",reg:/^rtcp-fb:(\*|\d*) trr-int (\d*)/,names:["payload","value"],format:"rtcp-fb:%s trr-int %d"},{push:"rtcpFb",reg:/^rtcp-fb:(\*|\d*) ([\w-_]*)(?: ([\w-_]*))?/,names:["payload","type","subtype"],format:function(n){return null!=n.subtype?"rtcp-fb:%s %s %s":"rtcp-fb:%s %s"}},{push:"ext",reg:/^extmap:(\d+)(?:\/(\w+))?(?: (urn:ietf:params:rtp-hdrext:encrypt))? (\S*)(?: (\S*))?/,names:["value","direction","encrypt-uri","uri","config"],format:function(n){return"extmap:%d"+(n.direction?"/%s":"%v")+(n["encrypt-uri"]?" %s":"%v")+" %s"+(n.config?" %s":"")}},{name:"extmapAllowMixed",reg:/^(extmap-allow-mixed)/},{push:"crypto",reg:/^crypto:(\d*) ([\w_]*) (\S*)(?: (\S*))?/,names:["id","suite","config","sessionConfig"],format:function(n){return null!=n.sessionConfig?"crypto:%d %s %s %s":"crypto:%d %s %s"}},{name:"setup",reg:/^setup:(\w*)/,format:"setup:%s"},{name:"connectionType",reg:/^connection:(new|existing)/,format:"connection:%s"},{name:"mid",reg:/^mid:([^\s]*)/,format:"mid:%s"},{name:"msid",reg:/^msid:(.*)/,format:"msid:%s"},{name:"ptime",reg:/^ptime:(\d*(?:\.\d*)*)/,format:"ptime:%d"},{name:"maxptime",reg:/^maxptime:(\d*(?:\.\d*)*)/,format:"maxptime:%d"},{name:"direction",reg:/^(sendrecv|recvonly|sendonly|inactive)/},{name:"icelite",reg:/^(ice-lite)/},{name:"iceUfrag",reg:/^ice-ufrag:(\S*)/,format:"ice-ufrag:%s"},{name:"icePwd",reg:/^ice-pwd:(\S*)/,format:"ice-pwd:%s"},{name:"fingerprint",reg:/^fingerprint:(\S*) (\S*)/,names:["type","hash"],format:"fingerprint:%s %s"},{push:"candidates",reg:/^candidate:(\S*) (\d*) (\S*) (\d*) (\S*) (\d*) typ (\S*)(?: raddr (\S*) rport (\d*))?(?: tcptype (\S*))?(?: generation (\d*))?(?: network-id (\d*))?(?: network-cost (\d*))?/,names:["foundation","component","transport","priority","ip","port","type","raddr","rport","tcptype","generation","network-id","network-cost"],format:function(n){var e="candidate:%s %d %s %d %s %d typ %s";return e+=null!=n.raddr?" raddr %s rport %d":"%v%v",e+=null!=n.tcptype?" tcptype %s":"%v",null!=n.generation&&(e+=" generation %d"),(e+=null!=n["network-id"]?" network-id %d":"%v")+(null!=n["network-cost"]?" network-cost %d":"%v")}},{name:"endOfCandidates",reg:/^(end-of-candidates)/},{name:"remoteCandidates",reg:/^remote-candidates:(.*)/,format:"remote-candidates:%s"},{name:"iceOptions",reg:/^ice-options:(\S*)/,format:"ice-options:%s"},{push:"ssrcs",reg:/^ssrc:(\d*) ([\w_-]*)(?::(.*))?/,names:["id","attribute","value"],format:function(n){var e="ssrc:%d";return null!=n.attribute&&(e+=" %s",null!=n.value&&(e+=":%s")),e}},{push:"ssrcGroups",reg:/^ssrc-group:([\x21\x23\x24\x25\x26\x27\x2A\x2B\x2D\x2E\w]*) (.*)/,names:["semantics","ssrcs"],format:"ssrc-group:%s %s"},{name:"msidSemantic",reg:/^msid-semantic:\s?(\w*) (\S*)/,names:["semantic","token"],format:"msid-semantic: %s %s"},{push:"groups",reg:/^group:(\w*) (.*)/,names:["type","mids"],format:"group:%s %s"},{name:"rtcpMux",reg:/^(rtcp-mux)/},{name:"rtcpRsize",reg:/^(rtcp-rsize)/},{name:"sctpmap",reg:/^sctpmap:([\w_/]*) (\S*)(?: (\S*))?/,names:["sctpmapNumber","app","maxMessageSize"],format:function(n){return null!=n.maxMessageSize?"sctpmap:%s %s %s":"sctpmap:%s %s"}},{name:"xGoogleFlag",reg:/^x-google-flag:([^\s]*)/,format:"x-google-flag:%s"},{push:"rids",reg:/^rid:([\d\w]+) (\w+)(?: ([\S| ]*))?/,names:["id","direction","params"],format:function(n){return n.params?"rid:%s %s %s":"rid:%s %s"}},{push:"imageattrs",reg:new RegExp("^imageattr:(\\d+|\\*)[\\s\\t]+(send|recv)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*)(?:[\\s\\t]+(recv|send)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*))?"),names:["pt","dir1","attrs1","dir2","attrs2"],format:function(n){return"imageattr:%s %s %s"+(n.dir2?" %s %s":"")}},{name:"simulcast",reg:new RegExp("^simulcast:(send|recv) ([a-zA-Z0-9\\-_~;,]+)(?:\\s?(send|recv) ([a-zA-Z0-9\\-_~;,]+))?$"),names:["dir1","list1","dir2","list2"],format:function(n){return"simulcast:%s %s"+(n.dir2?" %s %s":"")}},{name:"simulcast_03",reg:/^simulcast:[\s\t]+([\S+\s\t]+)$/,names:["value"],format:"simulcast: %s"},{name:"framerate",reg:/^framerate:(\d+(?:$|\.\d+))/,format:"framerate:%s"},{name:"sourceFilter",reg:/^source-filter: *(excl|incl) (\S*) (IP4|IP6|\*) (\S*) (.*)/,names:["filterMode","netType","addressTypes","destAddress","srcList"],format:"source-filter: %s %s %s %s %s"},{name:"bundleOnly",reg:/^(bundle-only)/},{name:"label",reg:/^label:(.+)/,format:"label:%s"},{name:"sctpPort",reg:/^sctp-port:(\d+)$/,format:"sctp-port:%s"},{name:"maxMessageSize",reg:/^max-message-size:(\d+)$/,format:"max-message-size:%s"},{push:"tsRefClocks",reg:/^ts-refclk:([^\s=]*)(?:=(\S*))?/,names:["clksrc","clksrcExt"],format:function(n){return"ts-refclk:%s"+(null!=n.clksrcExt?"=%s":"")}},{name:"mediaClk",reg:/^mediaclk:(?:id=(\S*))? *([^\s=]*)(?:=(\S*))?(?: *rate=(\d+)\/(\d+))?/,names:["id","mediaClockName","mediaClockValue","rateNumerator","rateDenominator"],format:function(n){var e="mediaclk:";return e+=null!=n.id?"id=%s %s":"%v%s",e+=null!=n.mediaClockValue?"=%s":"",(e+=null!=n.rateNumerator?" rate=%s":"")+(null!=n.rateDenominator?"/%s":"")}},{name:"keywords",reg:/^keywds:(.+)$/,format:"keywds:%s"},{name:"content",reg:/^content:(.+)/,format:"content:%s"},{name:"bfcpFloorCtrl",reg:/^floorctrl:(c-only|s-only|c-s)/,format:"floorctrl:%s"},{name:"bfcpConfId",reg:/^confid:(\d+)/,format:"confid:%s"},{name:"bfcpUserId",reg:/^userid:(\d+)/,format:"userid:%s"},{name:"bfcpFloorId",reg:/^floorid:(.+) (?:m-stream|mstrm):(.+)/,names:["id","mStream"],format:"floorid:%s mstrm:%s"},{push:"invalid",names:["value"]}]};Object.keys(r).forEach((function(n){r[n].forEach((function(n){n.reg||(n.reg=/(.*)/),n.format||(n.format="%s")}))}))},{}],36:[function(n,e,t){var r=n("./parser"),i=n("./writer");t.write=i,t.parse=r.parse,t.parseParams=r.parseParams,t.parseFmtpConfig=r.parseFmtpConfig,t.parsePayloads=r.parsePayloads,t.parseRemoteCandidates=r.parseRemoteCandidates,t.parseImageAttributes=r.parseImageAttributes,t.parseSimulcastStreamList=r.parseSimulcastStreamList},{"./parser":37,"./writer":38}],37:[function(n,e,t){var r=function(n){return String(Number(n))===n?Number(n):n},i=function(n,e,t){var i=n.name&&n.names;n.push&&!e[n.push]?e[n.push]=[]:i&&!e[n.name]&&(e[n.name]={});var a=n.push?{}:i?e[n.name]:e;!function(n,e,t,i){if(i&&!t)e[i]=r(n[1]);else for(var a=0;a<t.length;a+=1)null!=n[a+1]&&(e[t[a]]=r(n[a+1]))}(t.match(n.reg),a,n.names,n.name),n.push&&e[n.push].push(a)},a=n("./grammar"),s=RegExp.prototype.test.bind(/^([a-z])=(.*)/);t.parse=function(n){var e={},t=[],r=e;return n.split(/(\r\n|\r|\n)/).filter(s).forEach((function(n){var e=n[0],s=n.slice(2);"m"===e&&(t.push({rtp:[],fmtp:[]}),r=t[t.length-1]);for(var o=0;o<(a[e]||[]).length;o+=1){var c=a[e][o];if(c.reg.test(s))return i(c,r,s)}})),e.media=t,e};var o=function(n,e){var t=e.split(/=(.+)/,2);return 2===t.length?n[t[0]]=r(t[1]):1===t.length&&e.length>1&&(n[t[0]]=void 0),n};t.parseParams=function(n){return n.split(/;\s?/).reduce(o,{})},t.parseFmtpConfig=t.parseParams,t.parsePayloads=function(n){return n.toString().split(" ").map(Number)},t.parseRemoteCandidates=function(n){for(var e=[],t=n.split(" ").map(r),i=0;i<t.length;i+=3)e.push({component:t[i],ip:t[i+1],port:t[i+2]});return e},t.parseImageAttributes=function(n){return n.split(" ").map((function(n){return n.substring(1,n.length-1).split(",").reduce(o,{})}))},t.parseSimulcastStreamList=function(n){return n.split(";").map((function(n){return n.split(",").map((function(n){var e,t=!1;return"~"!==n[0]?e=r(n):(e=r(n.substring(1,n.length)),t=!0),{scid:e,paused:t}}))}))}},{"./grammar":35}],38:[function(n,e,t){var r=n("./grammar"),i=/%[sdv%]/g,a=function(n,e,t){var r=[n+"="+(e.format instanceof Function?e.format(e.push?t:t[e.name]):e.format)];if(e.names)for(var a=0;a<e.names.length;a+=1){var s=e.names[a];e.name?r.push(t[e.name][s]):r.push(t[e.names[a]])}else r.push(t[e.name]);return function(n){var e=1,t=arguments,r=t.length;return n.replace(i,(function(n){if(e>=r)return n;var i=t[e];switch(e+=1,n){case"%%":return"%";case"%s":return String(i);case"%d":return Number(i);case"%v":return""}}))}.apply(null,r)},s=["v","o","s","i","u","e","p","c","b","t","r","z","a"],o=["i","c","b","a"];e.exports=function(n,e){e=e||{},null==n.version&&(n.version=0),null==n.name&&(n.name=" "),n.media.forEach((function(n){null==n.payloads&&(n.payloads="")}));var t=e.outerOrder||s,i=e.innerOrder||o,c=[];return t.forEach((function(e){r[e].forEach((function(t){t.name in n&&null!=n[t.name]?c.push(a(e,t,n)):t.push in n&&null!=n[t.push]&&n[t.push].forEach((function(n){c.push(a(e,t,n))}))}))})),n.media.forEach((function(n){c.push(a("m",r.m[0],n)),i.forEach((function(e){r[e].forEach((function(t){t.name in n&&null!=n[t.name]?c.push(a(e,t,n)):t.push in n&&null!=n[t.push]&&n[t.push].forEach((function(n){c.push(a(e,t,n))}))}))}))})),c.join("\r\n")+"\r\n"}},{"./grammar":35}],39:[function(n,e,t){"use strict";var r={generateIdentifier:function(){return Math.random().toString(36).substr(2,10)}};r.localCName=r.generateIdentifier(),r.splitLines=function(n){return n.trim().split("\n").map((function(n){return n.trim()}))},r.splitSections=function(n){return n.split("\nm=").map((function(n,e){return(e>0?"m="+n:n).trim()+"\r\n"}))},r.getDescription=function(n){var e=r.splitSections(n);return e&&e[0]},r.getMediaSections=function(n){var e=r.splitSections(n);return e.shift(),e},r.matchPrefix=function(n,e){return r.splitLines(n).filter((function(n){return 0===n.indexOf(e)}))},r.parseCandidate=function(n){for(var e,t={foundation:(e=0===n.indexOf("a=candidate:")?n.substring(12).split(" "):n.substring(10).split(" "))[0],component:parseInt(e[1],10),protocol:e[2].toLowerCase(),priority:parseInt(e[3],10),ip:e[4],address:e[4],port:parseInt(e[5],10),type:e[7]},r=8;r<e.length;r+=2)switch(e[r]){case"raddr":t.relatedAddress=e[r+1];break;case"rport":t.relatedPort=parseInt(e[r+1],10);break;case"tcptype":t.tcpType=e[r+1];break;case"ufrag":t.ufrag=e[r+1],t.usernameFragment=e[r+1];break;default:t[e[r]]=e[r+1]}return t},r.writeCandidate=function(n){var e=[];e.push(n.foundation),e.push(n.component),e.push(n.protocol.toUpperCase()),e.push(n.priority),e.push(n.address||n.ip),e.push(n.port);var t=n.type;return e.push("typ"),e.push(t),"host"!==t&&n.relatedAddress&&n.relatedPort&&(e.push("raddr"),e.push(n.relatedAddress),e.push("rport"),e.push(n.relatedPort)),n.tcpType&&"tcp"===n.protocol.toLowerCase()&&(e.push("tcptype"),e.push(n.tcpType)),(n.usernameFragment||n.ufrag)&&(e.push("ufrag"),e.push(n.usernameFragment||n.ufrag)),"candidate:"+e.join(" ")},r.parseIceOptions=function(n){return n.substr(14).split(" ")},r.parseRtpMap=function(n){var e=n.substr(9).split(" "),t={payloadType:parseInt(e.shift(),10)};return e=e[0].split("/"),t.name=e[0],t.clockRate=parseInt(e[1],10),t.channels=3===e.length?parseInt(e[2],10):1,t.numChannels=t.channels,t},r.writeRtpMap=function(n){var e=n.payloadType;void 0!==n.preferredPayloadType&&(e=n.preferredPayloadType);var t=n.channels||n.numChannels||1;return"a=rtpmap:"+e+" "+n.name+"/"+n.clockRate+(1!==t?"/"+t:"")+"\r\n"},r.parseExtmap=function(n){var e=n.substr(9).split(" ");return{id:parseInt(e[0],10),direction:e[0].indexOf("/")>0?e[0].split("/")[1]:"sendrecv",uri:e[1]}},r.writeExtmap=function(n){return"a=extmap:"+(n.id||n.preferredId)+(n.direction&&"sendrecv"!==n.direction?"/"+n.direction:"")+" "+n.uri+"\r\n"},r.parseFmtp=function(n){for(var e,t={},r=n.substr(n.indexOf(" ")+1).split(";"),i=0;i<r.length;i++)t[(e=r[i].trim().split("="))[0].trim()]=e[1];return t},r.writeFmtp=function(n){var e="",t=n.payloadType;if(void 0!==n.preferredPayloadType&&(t=n.preferredPayloadType),n.parameters&&Object.keys(n.parameters).length){var r=[];Object.keys(n.parameters).forEach((function(e){n.parameters[e]?r.push(e+"="+n.parameters[e]):r.push(e)})),e+="a=fmtp:"+t+" "+r.join(";")+"\r\n"}return e},r.parseRtcpFb=function(n){var e=n.substr(n.indexOf(" ")+1).split(" ");return{type:e.shift(),parameter:e.join(" ")}},r.writeRtcpFb=function(n){var e="",t=n.payloadType;return void 0!==n.preferredPayloadType&&(t=n.preferredPayloadType),n.rtcpFeedback&&n.rtcpFeedback.length&&n.rtcpFeedback.forEach((function(n){e+="a=rtcp-fb:"+t+" "+n.type+(n.parameter&&n.parameter.length?" "+n.parameter:"")+"\r\n"})),e},r.parseSsrcMedia=function(n){var e=n.indexOf(" "),t={ssrc:parseInt(n.substr(7,e-7),10)},r=n.indexOf(":",e);return r>-1?(t.attribute=n.substr(e+1,r-e-1),t.value=n.substr(r+1)):t.attribute=n.substr(e+1),t},r.parseSsrcGroup=function(n){var e=n.substr(13).split(" ");return{semantics:e.shift(),ssrcs:e.map((function(n){return parseInt(n,10)}))}},r.getMid=function(n){var e=r.matchPrefix(n,"a=mid:")[0];if(e)return e.substr(6)},r.parseFingerprint=function(n){var e=n.substr(14).split(" ");return{algorithm:e[0].toLowerCase(),value:e[1]}},r.getDtlsParameters=function(n,e){return{role:"auto",fingerprints:r.matchPrefix(n+e,"a=fingerprint:").map(r.parseFingerprint)}},r.writeDtlsParameters=function(n,e){var t="a=setup:"+e+"\r\n";return n.fingerprints.forEach((function(n){t+="a=fingerprint:"+n.algorithm+" "+n.value+"\r\n"})),t},r.parseCryptoLine=function(n){var e=n.substr(9).split(" ");return{tag:parseInt(e[0],10),cryptoSuite:e[1],keyParams:e[2],sessionParams:e.slice(3)}},r.writeCryptoLine=function(n){return"a=crypto:"+n.tag+" "+n.cryptoSuite+" "+("object"==typeof n.keyParams?r.writeCryptoKeyParams(n.keyParams):n.keyParams)+(n.sessionParams?" "+n.sessionParams.join(" "):"")+"\r\n"},r.parseCryptoKeyParams=function(n){if(0!==n.indexOf("inline:"))return null;var e=n.substr(7).split("|");return{keyMethod:"inline",keySalt:e[0],lifeTime:e[1],mkiValue:e[2]?e[2].split(":")[0]:void 0,mkiLength:e[2]?e[2].split(":")[1]:void 0}},r.writeCryptoKeyParams=function(n){return n.keyMethod+":"+n.keySalt+(n.lifeTime?"|"+n.lifeTime:"")+(n.mkiValue&&n.mkiLength?"|"+n.mkiValue+":"+n.mkiLength:"")},r.getCryptoParameters=function(n,e){return r.matchPrefix(n+e,"a=crypto:").map(r.parseCryptoLine)},r.getIceParameters=function(n,e){var t=r.matchPrefix(n+e,"a=ice-ufrag:")[0],i=r.matchPrefix(n+e,"a=ice-pwd:")[0];return t&&i?{usernameFragment:t.substr(12),password:i.substr(10)}:null},r.writeIceParameters=function(n){return"a=ice-ufrag:"+n.usernameFragment+"\r\na=ice-pwd:"+n.password+"\r\n"},r.parseRtpParameters=function(n){for(var e={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},t=r.splitLines(n)[0].split(" "),i=3;i<t.length;i++){var a=t[i],s=r.matchPrefix(n,"a=rtpmap:"+a+" ")[0];if(s){var o=r.parseRtpMap(s),c=r.matchPrefix(n,"a=fmtp:"+a+" ");switch(o.parameters=c.length?r.parseFmtp(c[0]):{},o.rtcpFeedback=r.matchPrefix(n,"a=rtcp-fb:"+a+" ").map(r.parseRtcpFb),e.codecs.push(o),o.name.toUpperCase()){case"RED":case"ULPFEC":e.fecMechanisms.push(o.name.toUpperCase())}}}return r.matchPrefix(n,"a=extmap:").forEach((function(n){e.headerExtensions.push(r.parseExtmap(n))})),e},r.writeRtpDescription=function(n,e){var t="";t+="m="+n+" ",t+=e.codecs.length>0?"9":"0",t+=" UDP/TLS/RTP/SAVPF ",t+=e.codecs.map((function(n){return void 0!==n.preferredPayloadType?n.preferredPayloadType:n.payloadType})).join(" ")+"\r\n",t+="c=IN IP4 0.0.0.0\r\n",t+="a=rtcp:9 IN IP4 0.0.0.0\r\n",e.codecs.forEach((function(n){t+=r.writeRtpMap(n),t+=r.writeFmtp(n),t+=r.writeRtcpFb(n)}));var i=0;return e.codecs.forEach((function(n){n.maxptime>i&&(i=n.maxptime)})),i>0&&(t+="a=maxptime:"+i+"\r\n"),t+="a=rtcp-mux\r\n",e.headerExtensions&&e.headerExtensions.forEach((function(n){t+=r.writeExtmap(n)})),t},r.parseRtpEncodingParameters=function(n){var e,t=[],i=r.parseRtpParameters(n),a=-1!==i.fecMechanisms.indexOf("RED"),s=-1!==i.fecMechanisms.indexOf("ULPFEC"),o=r.matchPrefix(n,"a=ssrc:").map((function(n){return r.parseSsrcMedia(n)})).filter((function(n){return"cname"===n.attribute})),c=o.length>0&&o[0].ssrc,l=r.matchPrefix(n,"a=ssrc-group:FID").map((function(n){return n.substr(17).split(" ").map((function(n){return parseInt(n,10)}))}));l.length>0&&l[0].length>1&&l[0][0]===c&&(e=l[0][1]),i.codecs.forEach((function(n){if("RTX"===n.name.toUpperCase()&&n.parameters.apt){var r={ssrc:c,codecPayloadType:parseInt(n.parameters.apt,10)};c&&e&&(r.rtx={ssrc:e}),t.push(r),a&&((r=JSON.parse(JSON.stringify(r))).fec={ssrc:c,mechanism:s?"red+ulpfec":"red"},t.push(r))}})),0===t.length&&c&&t.push({ssrc:c});var u=r.matchPrefix(n,"b=");return u.length&&(u=0===u[0].indexOf("b=TIAS:")?parseInt(u[0].substr(7),10):0===u[0].indexOf("b=AS:")?1e3*parseInt(u[0].substr(5),10)*.95-16e3:void 0,t.forEach((function(n){n.maxBitrate=u}))),t},r.parseRtcpParameters=function(n){var e={},t=r.matchPrefix(n,"a=ssrc:").map((function(n){return r.parseSsrcMedia(n)})).filter((function(n){return"cname"===n.attribute}))[0];t&&(e.cname=t.value,e.ssrc=t.ssrc);var i=r.matchPrefix(n,"a=rtcp-rsize");e.reducedSize=i.length>0,e.compound=0===i.length;var a=r.matchPrefix(n,"a=rtcp-mux");return e.mux=a.length>0,e},r.parseMsid=function(n){var e,t=r.matchPrefix(n,"a=msid:");if(1===t.length)return{stream:(e=t[0].substr(7).split(" "))[0],track:e[1]};var i=r.matchPrefix(n,"a=ssrc:").map((function(n){return r.parseSsrcMedia(n)})).filter((function(n){return"msid"===n.attribute}));return i.length>0?{stream:(e=i[0].value.split(" "))[0],track:e[1]}:void 0},r.parseSctpDescription=function(n){var e,t=r.parseMLine(n),i=r.matchPrefix(n,"a=max-message-size:");i.length>0&&(e=parseInt(i[0].substr(19),10)),isNaN(e)&&(e=65536);var a=r.matchPrefix(n,"a=sctp-port:");if(a.length>0)return{port:parseInt(a[0].substr(12),10),protocol:t.fmt,maxMessageSize:e};if(r.matchPrefix(n,"a=sctpmap:").length>0){var s=r.matchPrefix(n,"a=sctpmap:")[0].substr(10).split(" ");return{port:parseInt(s[0],10),protocol:s[1],maxMessageSize:e}}},r.writeSctpDescription=function(n,e){var t=[];return t="DTLS/SCTP"!==n.protocol?["m="+n.kind+" 9 "+n.protocol+" "+e.protocol+"\r\n","c=IN IP4 0.0.0.0\r\n","a=sctp-port:"+e.port+"\r\n"]:["m="+n.kind+" 9 "+n.protocol+" "+e.port+"\r\n","c=IN IP4 0.0.0.0\r\n","a=sctpmap:"+e.port+" "+e.protocol+" 65535\r\n"],void 0!==e.maxMessageSize&&t.push("a=max-message-size:"+e.maxMessageSize+"\r\n"),t.join("")},r.generateSessionId=function(){return Math.random().toString().substr(2,21)},r.writeSessionBoilerplate=function(n,e,t){var i=void 0!==e?e:2;return"v=0\r\no="+(t||"thisisadapterortc")+" "+(n||r.generateSessionId())+" "+i+" IN IP4 127.0.0.1\r\ns=-\r\nt=0 0\r\n"},r.writeMediaSection=function(n,e,t,i){var a=r.writeRtpDescription(n.kind,e);if(a+=r.writeIceParameters(n.iceGatherer.getLocalParameters()),a+=r.writeDtlsParameters(n.dtlsTransport.getLocalParameters(),"offer"===t?"actpass":"active"),a+="a=mid:"+n.mid+"\r\n",n.direction?a+="a="+n.direction+"\r\n":n.rtpSender&&n.rtpReceiver?a+="a=sendrecv\r\n":n.rtpSender?a+="a=sendonly\r\n":n.rtpReceiver?a+="a=recvonly\r\n":a+="a=inactive\r\n",n.rtpSender){var s="msid:"+i.id+" "+n.rtpSender.track.id+"\r\n";a+="a="+s,a+="a=ssrc:"+n.sendEncodingParameters[0].ssrc+" "+s,n.sendEncodingParameters[0].rtx&&(a+="a=ssrc:"+n.sendEncodingParameters[0].rtx.ssrc+" "+s,a+="a=ssrc-group:FID "+n.sendEncodingParameters[0].ssrc+" "+n.sendEncodingParameters[0].rtx.ssrc+"\r\n")}return a+="a=ssrc:"+n.sendEncodingParameters[0].ssrc+" cname:"+r.localCName+"\r\n",n.rtpSender&&n.sendEncodingParameters[0].rtx&&(a+="a=ssrc:"+n.sendEncodingParameters[0].rtx.ssrc+" cname:"+r.localCName+"\r\n"),a},r.getDirection=function(n,e){for(var t=r.splitLines(n),i=0;i<t.length;i++)switch(t[i]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return t[i].substr(2)}return e?r.getDirection(e):"sendrecv"},r.getKind=function(n){return r.splitLines(n)[0].split(" ")[0].substr(2)},r.isRejected=function(n){return"0"===n.split(" ",2)[1]},r.parseMLine=function(n){var e=r.splitLines(n)[0].substr(2).split(" ");return{kind:e[0],port:parseInt(e[1],10),protocol:e[2],fmt:e.slice(3).join(" ")}},r.parseOLine=function(n){var e=r.matchPrefix(n,"o=")[0].substr(2).split(" ");return{username:e[0],sessionId:e[1],sessionVersion:parseInt(e[2],10),netType:e[3],addressType:e[4],address:e[5]}},r.isValidSDP=function(n){if("string"!=typeof n||0===n.length)return!1;for(var e=r.splitLines(n),t=0;t<e.length;t++)if(e[t].length<2||"="!==e[t].charAt(1))return!1;return!0},"object"==typeof e&&(e.exports=r)},{}],40:[function(n,e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=(0,n("./adapter_factory.js").adapterFactory)({window:"undefined"==typeof window?void 0:window});t.default=r},{"./adapter_factory.js":41}],41:[function(n,e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.adapterFactory=function(){var n=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).window,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{shimChrome:!0,shimFirefox:!0,shimEdge:!0,shimSafari:!0},t=r.log,l=r.detectBrowser(n),u={browserDetails:l,commonShim:c,extractVersion:r.extractVersion,disableLog:r.disableLog,disableWarnings:r.disableWarnings};switch(l.browser){case"chrome":if(!i||!i.shimPeerConnection||!e.shimChrome)return t("Chrome shim is not included in this adapter release."),u;if(null===l.version)return t("Chrome shim can not determine version, not shimming."),u;t("adapter.js shimming chrome."),u.browserShim=i,c.shimAddIceCandidateNullOrEmpty(n,l),i.shimGetUserMedia(n,l),i.shimMediaStream(n,l),i.shimPeerConnection(n,l),i.shimOnTrack(n,l),i.shimAddTrackRemoveTrack(n,l),i.shimGetSendersWithDtmf(n,l),i.shimGetStats(n,l),i.shimSenderReceiverGetStats(n,l),i.fixNegotiationNeeded(n,l),c.shimRTCIceCandidate(n,l),c.shimConnectionState(n,l),c.shimMaxMessageSize(n,l),c.shimSendThrowTypeError(n,l),c.removeExtmapAllowMixed(n,l);break;case"firefox":if(!s||!s.shimPeerConnection||!e.shimFirefox)return t("Firefox shim is not included in this adapter release."),u;t("adapter.js shimming firefox."),u.browserShim=s,c.shimAddIceCandidateNullOrEmpty(n,l),s.shimGetUserMedia(n,l),s.shimPeerConnection(n,l),s.shimOnTrack(n,l),s.shimRemoveStream(n,l),s.shimSenderGetStats(n,l),s.shimReceiverGetStats(n,l),s.shimRTCDataChannel(n,l),s.shimAddTransceiver(n,l),s.shimGetParameters(n,l),s.shimCreateOffer(n,l),s.shimCreateAnswer(n,l),c.shimRTCIceCandidate(n,l),c.shimConnectionState(n,l),c.shimMaxMessageSize(n,l),c.shimSendThrowTypeError(n,l);break;case"edge":if(!a||!a.shimPeerConnection||!e.shimEdge)return t("MS edge shim is not included in this adapter release."),u;t("adapter.js shimming edge."),u.browserShim=a,a.shimGetUserMedia(n,l),a.shimGetDisplayMedia(n,l),a.shimPeerConnection(n,l),a.shimReplaceTrack(n,l),c.shimMaxMessageSize(n,l),c.shimSendThrowTypeError(n,l);break;case"safari":if(!o||!e.shimSafari)return t("Safari shim is not included in this adapter release."),u;t("adapter.js shimming safari."),u.browserShim=o,c.shimAddIceCandidateNullOrEmpty(n,l),o.shimRTCIceServerUrls(n,l),o.shimCreateOfferLegacy(n,l),o.shimCallbacksAPI(n,l),o.shimLocalStreamsAPI(n,l),o.shimRemoteStreamsAPI(n,l),o.shimTrackEventTransceiver(n,l),o.shimGetUserMedia(n,l),o.shimAudioContext(n,l),c.shimRTCIceCandidate(n,l),c.shimMaxMessageSize(n,l),c.shimSendThrowTypeError(n,l),c.removeExtmapAllowMixed(n,l);break;default:t("Unsupported browser!")}return u};var r=l(n("./utils")),i=l(n("./chrome/chrome_shim")),a=l(n("./edge/edge_shim")),s=l(n("./firefox/firefox_shim")),o=l(n("./safari/safari_shim")),c=l(n("./common_shim"));function l(n){if(n&&n.__esModule)return n;var e={};if(null!=n)for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t]);return e.default=n,e}},{"./chrome/chrome_shim":42,"./common_shim":45,"./edge/edge_shim":46,"./firefox/firefox_shim":50,"./safari/safari_shim":53,"./utils":54}],42:[function(n,e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.shimGetDisplayMedia=t.shimGetUserMedia=void 0;var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(n){return typeof n}:function(n){return n&&"function"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},i=n("./getusermedia");Object.defineProperty(t,"shimGetUserMedia",{enumerable:!0,get:function(){return i.shimGetUserMedia}});var a=n("./getdisplaymedia");Object.defineProperty(t,"shimGetDisplayMedia",{enumerable:!0,get:function(){return a.shimGetDisplayMedia}}),t.shimMediaStream=function(n){n.MediaStream=n.MediaStream||n.webkitMediaStream},t.shimOnTrack=function(n){if("object"!==(void 0===n?"undefined":r(n))||!n.RTCPeerConnection||"ontrack"in n.RTCPeerConnection.prototype)s.wrapPeerConnectionEvent(n,"track",(function(n){return n.transceiver||Object.defineProperty(n,"transceiver",{value:{receiver:n.receiver}}),n}));else{Object.defineProperty(n.RTCPeerConnection.prototype,"ontrack",{get:function(){return this._ontrack},set:function(n){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=n)},enumerable:!0,configurable:!0});var e=n.RTCPeerConnection.prototype.setRemoteDescription;n.RTCPeerConnection.prototype.setRemoteDescription=function(){var t=this;return this._ontrackpoly||(this._ontrackpoly=function(e){e.stream.addEventListener("addtrack",(function(r){var i=void 0;i=n.RTCPeerConnection.prototype.getReceivers?t.getReceivers().find((function(n){return n.track&&n.track.id===r.track.id})):{track:r.track};var a=new Event("track");a.track=r.track,a.receiver=i,a.transceiver={receiver:i},a.streams=[e.stream],t.dispatchEvent(a)})),e.stream.getTracks().forEach((function(r){var i=void 0;i=n.RTCPeerConnection.prototype.getReceivers?t.getReceivers().find((function(n){return n.track&&n.track.id===r.id})):{track:r};var a=new Event("track");a.track=r,a.receiver=i,a.transceiver={receiver:i},a.streams=[e.stream],t.dispatchEvent(a)}))},this.addEventListener("addstream",this._ontrackpoly)),e.apply(this,arguments)}}},t.shimGetSendersWithDtmf=function(n){if("object"===(void 0===n?"undefined":r(n))&&n.RTCPeerConnection&&!("getSenders"in n.RTCPeerConnection.prototype)&&"createDTMFSender"in n.RTCPeerConnection.prototype){var e=function(n,e){return{track:e,get dtmf(){return void 0===this._dtmf&&("audio"===e.kind?this._dtmf=n.createDTMFSender(e):this._dtmf=null),this._dtmf},_pc:n}};if(!n.RTCPeerConnection.prototype.getSenders){n.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};var t=n.RTCPeerConnection.prototype.addTrack;n.RTCPeerConnection.prototype.addTrack=function(n,r){var i=t.apply(this,arguments);return i||(i=e(this,n),this._senders.push(i)),i};var i=n.RTCPeerConnection.prototype.removeTrack;n.RTCPeerConnection.prototype.removeTrack=function(n){i.apply(this,arguments);var e=this._senders.indexOf(n);-1!==e&&this._senders.splice(e,1)}}var a=n.RTCPeerConnection.prototype.addStream;n.RTCPeerConnection.prototype.addStream=function(n){var t=this;this._senders=this._senders||[],a.apply(this,[n]),n.getTracks().forEach((function(n){t._senders.push(e(t,n))}))};var s=n.RTCPeerConnection.prototype.removeStream;n.RTCPeerConnection.prototype.removeStream=function(n){var e=this;this._senders=this._senders||[],s.apply(this,[n]),n.getTracks().forEach((function(n){var t=e._senders.find((function(e){return e.track===n}));t&&e._senders.splice(e._senders.indexOf(t),1)}))}}else if("object"===(void 0===n?"undefined":r(n))&&n.RTCPeerConnection&&"getSenders"in n.RTCPeerConnection.prototype&&"createDTMFSender"in n.RTCPeerConnection.prototype&&n.RTCRtpSender&&!("dtmf"in n.RTCRtpSender.prototype)){var o=n.RTCPeerConnection.prototype.getSenders;n.RTCPeerConnection.prototype.getSenders=function(){var n=this,e=o.apply(this,[]);return e.forEach((function(e){return e._pc=n})),e},Object.defineProperty(n.RTCRtpSender.prototype,"dtmf",{get:function(){return void 0===this._dtmf&&("audio"===this.track.kind?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}},t.shimGetStats=function(n){if(n.RTCPeerConnection){var e=n.RTCPeerConnection.prototype.getStats;n.RTCPeerConnection.prototype.getStats=function(){var n=this,t=Array.prototype.slice.call(arguments),r=t[0],i=t[1],a=t[2];if(arguments.length>0&&"function"==typeof r)return e.apply(this,arguments);if(0===e.length&&(0===arguments.length||"function"!=typeof r))return e.apply(this,[]);var s=function(n){var e={};return n.result().forEach((function(n){var t={id:n.id,timestamp:n.timestamp,type:{localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[n.type]||n.type};n.names().forEach((function(e){t[e]=n.stat(e)})),e[t.id]=t})),e},o=function(n){return new Map(Object.keys(n).map((function(e){return[e,n[e]]})))};return arguments.length>=2?e.apply(this,[function(n){i(o(s(n)))},r]):new Promise((function(t,r){e.apply(n,[function(n){t(o(s(n)))},r])})).then(i,a)}}},t.shimSenderReceiverGetStats=function(n){if("object"===(void 0===n?"undefined":r(n))&&n.RTCPeerConnection&&n.RTCRtpSender&&n.RTCRtpReceiver){if(!("getStats"in n.RTCRtpSender.prototype)){var e=n.RTCPeerConnection.prototype.getSenders;e&&(n.RTCPeerConnection.prototype.getSenders=function(){var n=this,t=e.apply(this,[]);return t.forEach((function(e){return e._pc=n})),t});var t=n.RTCPeerConnection.prototype.addTrack;t&&(n.RTCPeerConnection.prototype.addTrack=function(){var n=t.apply(this,arguments);return n._pc=this,n}),n.RTCRtpSender.prototype.getStats=function(){var n=this;return this._pc.getStats().then((function(e){return s.filterStats(e,n.track,!0)}))}}if(!("getStats"in n.RTCRtpReceiver.prototype)){var i=n.RTCPeerConnection.prototype.getReceivers;i&&(n.RTCPeerConnection.prototype.getReceivers=function(){var n=this,e=i.apply(this,[]);return e.forEach((function(e){return e._pc=n})),e}),s.wrapPeerConnectionEvent(n,"track",(function(n){return n.receiver._pc=n.srcElement,n})),n.RTCRtpReceiver.prototype.getStats=function(){var n=this;return this._pc.getStats().then((function(e){return s.filterStats(e,n.track,!1)}))}}if("getStats"in n.RTCRtpSender.prototype&&"getStats"in n.RTCRtpReceiver.prototype){var a=n.RTCPeerConnection.prototype.getStats;n.RTCPeerConnection.prototype.getStats=function(){if(arguments.length>0&&arguments[0]instanceof n.MediaStreamTrack){var e=arguments[0],t=void 0,r=void 0,i=void 0;return this.getSenders().forEach((function(n){n.track===e&&(t?i=!0:t=n)})),this.getReceivers().forEach((function(n){return n.track===e&&(r?i=!0:r=n),n.track===e})),i||t&&r?Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):t?t.getStats():r?r.getStats():Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return a.apply(this,arguments)}}}},t.shimAddTrackRemoveTrackWithNative=c,t.shimAddTrackRemoveTrack=function(n,e){if(n.RTCPeerConnection){if(n.RTCPeerConnection.prototype.addTrack&&e.version>=65)return c(n);var t=n.RTCPeerConnection.prototype.getLocalStreams;n.RTCPeerConnection.prototype.getLocalStreams=function(){var n=this,e=t.apply(this);return this._reverseStreams=this._reverseStreams||{},e.map((function(e){return n._reverseStreams[e.id]}))};var r=n.RTCPeerConnection.prototype.addStream;n.RTCPeerConnection.prototype.addStream=function(e){var t=this;if(this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},e.getTracks().forEach((function(n){if(t.getSenders().find((function(e){return e.track===n})))throw new DOMException("Track already exists.","InvalidAccessError")})),!this._reverseStreams[e.id]){var i=new n.MediaStream(e.getTracks());this._streams[e.id]=i,this._reverseStreams[i.id]=e,e=i}r.apply(this,[e])};var i=n.RTCPeerConnection.prototype.removeStream;n.RTCPeerConnection.prototype.removeStream=function(n){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},i.apply(this,[this._streams[n.id]||n]),delete this._reverseStreams[this._streams[n.id]?this._streams[n.id].id:n.id],delete this._streams[n.id]},n.RTCPeerConnection.prototype.addTrack=function(e,t){var r=this;if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");var i=[].slice.call(arguments,1);if(1!==i.length||!i[0].getTracks().find((function(n){return n===e})))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");if(this.getSenders().find((function(n){return n.track===e})))throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};var a=this._streams[t.id];if(a)a.addTrack(e),Promise.resolve().then((function(){r.dispatchEvent(new Event("negotiationneeded"))}));else{var s=new n.MediaStream([e]);this._streams[t.id]=s,this._reverseStreams[s.id]=t,this.addStream(s)}return this.getSenders().find((function(n){return n.track===e}))},["createOffer","createAnswer"].forEach((function(e){var t=n.RTCPeerConnection.prototype[e],r=o({},e,(function(){var n=this,e=arguments;return arguments.length&&"function"==typeof arguments[0]?t.apply(this,[function(t){var r=l(n,t);e[0].apply(null,[r])},function(n){e[1]&&e[1].apply(null,n)},arguments[2]]):t.apply(this,arguments).then((function(e){return l(n,e)}))}));n.RTCPeerConnection.prototype[e]=r[e]}));var a=n.RTCPeerConnection.prototype.setLocalDescription;n.RTCPeerConnection.prototype.setLocalDescription=function(){return arguments.length&&arguments[0].type?(arguments[0]=(n=this,t=(e=arguments[0]).sdp,Object.keys(n._reverseStreams||[]).forEach((function(e){var r=n._reverseStreams[e],i=n._streams[r.id];t=t.replace(new RegExp(r.id,"g"),i.id)})),new RTCSessionDescription({type:e.type,sdp:t})),a.apply(this,arguments)):a.apply(this,arguments);var n,e,t};var s=Object.getOwnPropertyDescriptor(n.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(n.RTCPeerConnection.prototype,"localDescription",{get:function(){var n=s.get.apply(this);return""===n.type?n:l(this,n)}}),n.RTCPeerConnection.prototype.removeTrack=function(n){var e=this;if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!n._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(n._pc!==this)throw new DOMException("Sender was not created by this connection.","InvalidAccessError");this._streams=this._streams||{};var t=void 0;Object.keys(this._streams).forEach((function(r){e._streams[r].getTracks().find((function(e){return n.track===e}))&&(t=e._streams[r])})),t&&(1===t.getTracks().length?this.removeStream(this._reverseStreams[t.id]):t.removeTrack(n.track),this.dispatchEvent(new Event("negotiationneeded")))}}function l(n,e){var t=e.sdp;return Object.keys(n._reverseStreams||[]).forEach((function(e){var r=n._reverseStreams[e],i=n._streams[r.id];t=t.replace(new RegExp(i.id,"g"),r.id)})),new RTCSessionDescription({type:e.type,sdp:t})}},t.shimPeerConnection=function(n,e){!n.RTCPeerConnection&&n.webkitRTCPeerConnection&&(n.RTCPeerConnection=n.webkitRTCPeerConnection),n.RTCPeerConnection&&e.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach((function(e){var t=n.RTCPeerConnection.prototype[e],r=o({},e,(function(){return arguments[0]=new("addIceCandidate"===e?n.RTCIceCandidate:n.RTCSessionDescription)(arguments[0]),t.apply(this,arguments)}));n.RTCPeerConnection.prototype[e]=r[e]}))},t.fixNegotiationNeeded=function(n,e){s.wrapPeerConnectionEvent(n,"negotiationneeded",(function(n){var t=n.target;if(!(e.version<72||t.getConfiguration&&"plan-b"===t.getConfiguration().sdpSemantics)||"stable"===t.signalingState)return n}))};var s=function(n){if(n&&n.__esModule)return n;var e={};if(null!=n)for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t]);return e.default=n,e}(n("../utils.js"));function o(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function c(n){n.RTCPeerConnection.prototype.getLocalStreams=function(){var n=this;return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map((function(e){return n._shimmedLocalStreams[e][0]}))};var e=n.RTCPeerConnection.prototype.addTrack;n.RTCPeerConnection.prototype.addTrack=function(n,t){if(!t)return e.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};var r=e.apply(this,arguments);return this._shimmedLocalStreams[t.id]?-1===this._shimmedLocalStreams[t.id].indexOf(r)&&this._shimmedLocalStreams[t.id].push(r):this._shimmedLocalStreams[t.id]=[t,r],r};var t=n.RTCPeerConnection.prototype.addStream;n.RTCPeerConnection.prototype.addStream=function(n){var e=this;this._shimmedLocalStreams=this._shimmedLocalStreams||{},n.getTracks().forEach((function(n){if(e.getSenders().find((function(e){return e.track===n})))throw new DOMException("Track already exists.","InvalidAccessError")}));var r=this.getSenders();t.apply(this,arguments);var i=this.getSenders().filter((function(n){return-1===r.indexOf(n)}));this._shimmedLocalStreams[n.id]=[n].concat(i)};var r=n.RTCPeerConnection.prototype.removeStream;n.RTCPeerConnection.prototype.removeStream=function(n){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[n.id],r.apply(this,arguments)};var i=n.RTCPeerConnection.prototype.removeTrack;n.RTCPeerConnection.prototype.removeTrack=function(n){var e=this;return this._shimmedLocalStreams=this._shimmedLocalStreams||{},n&&Object.keys(this._shimmedLocalStreams).forEach((function(t){var r=e._shimmedLocalStreams[t].indexOf(n);-1!==r&&e._shimmedLocalStreams[t].splice(r,1),1===e._shimmedLocalStreams[t].length&&delete e._shimmedLocalStreams[t]})),i.apply(this,arguments)}}},{"../utils.js":54,"./getdisplaymedia":43,"./getusermedia":44}],43:[function(n,e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.shimGetDisplayMedia=function(n,e){n.navigator.mediaDevices&&"getDisplayMedia"in n.navigator.mediaDevices||n.navigator.mediaDevices&&("function"==typeof e?n.navigator.mediaDevices.getDisplayMedia=function(t){return e(t).then((function(e){var r=t.video&&t.video.width,i=t.video&&t.video.height,a=t.video&&t.video.frameRate;return t.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:e,maxFrameRate:a||3}},r&&(t.video.mandatory.maxWidth=r),i&&(t.video.mandatory.maxHeight=i),n.navigator.mediaDevices.getUserMedia(t)}))}:console.error("shimGetDisplayMedia: getSourceId argument is not a function"))}},{}],44:[function(n,e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(n){return typeof n}:function(n){return n&&"function"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n};t.shimGetUserMedia=function(n,e){var t=n&&n.navigator;if(t.mediaDevices){var a=function(n){if("object"!==(void 0===n?"undefined":r(n))||n.mandatory||n.optional)return n;var e={};return Object.keys(n).forEach((function(t){if("require"!==t&&"advanced"!==t&&"mediaSource"!==t){var i="object"===r(n[t])?n[t]:{ideal:n[t]};void 0!==i.exact&&"number"==typeof i.exact&&(i.min=i.max=i.exact);var a=function(n,e){return n?n+e.charAt(0).toUpperCase()+e.slice(1):"deviceId"===e?"sourceId":e};if(void 0!==i.ideal){e.optional=e.optional||[];var s={};"number"==typeof i.ideal?(s[a("min",t)]=i.ideal,e.optional.push(s),(s={})[a("max",t)]=i.ideal,e.optional.push(s)):(s[a("",t)]=i.ideal,e.optional.push(s))}void 0!==i.exact&&"number"!=typeof i.exact?(e.mandatory=e.mandatory||{},e.mandatory[a("",t)]=i.exact):["min","max"].forEach((function(n){void 0!==i[n]&&(e.mandatory=e.mandatory||{},e.mandatory[a(n,t)]=i[n])}))}})),n.advanced&&(e.optional=(e.optional||[]).concat(n.advanced)),e},s=function(n,s){if(e.version>=61)return s(n);if((n=JSON.parse(JSON.stringify(n)))&&"object"===r(n.audio)){var o=function(n,e,t){e in n&&!(t in n)&&(n[t]=n[e],delete n[e])};o((n=JSON.parse(JSON.stringify(n))).audio,"autoGainControl","googAutoGainControl"),o(n.audio,"noiseSuppression","googNoiseSuppression"),n.audio=a(n.audio)}if(n&&"object"===r(n.video)){var c=n.video.facingMode;c=c&&("object"===(void 0===c?"undefined":r(c))?c:{ideal:c});var l=e.version<66;if(c&&("user"===c.exact||"environment"===c.exact||"user"===c.ideal||"environment"===c.ideal)&&(!t.mediaDevices.getSupportedConstraints||!t.mediaDevices.getSupportedConstraints().facingMode||l)){delete n.video.facingMode;var u=void 0;if("environment"===c.exact||"environment"===c.ideal?u=["back","rear"]:"user"!==c.exact&&"user"!==c.ideal||(u=["front"]),u)return t.mediaDevices.enumerateDevices().then((function(e){var t=(e=e.filter((function(n){return"videoinput"===n.kind}))).find((function(n){return u.some((function(e){return n.label.toLowerCase().includes(e)}))}));return!t&&e.length&&u.includes("back")&&(t=e[e.length-1]),t&&(n.video.deviceId=c.exact?{exact:t.deviceId}:{ideal:t.deviceId}),n.video=a(n.video),i("chrome: "+JSON.stringify(n)),s(n)}))}n.video=a(n.video)}return i("chrome: "+JSON.stringify(n)),s(n)},o=function(n){return e.version>=64?n:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[n.name]||n.name,message:n.message,constraint:n.constraint||n.constraintName,toString:function(){return this.name+(this.message&&": ")+this.message}}};if(t.getUserMedia=function(n,e,r){s(n,(function(n){t.webkitGetUserMedia(n,e,(function(n){r&&r(o(n))}))}))}.bind(t),t.mediaDevices.getUserMedia){var c=t.mediaDevices.getUserMedia.bind(t.mediaDevices);t.mediaDevices.getUserMedia=function(n){return s(n,(function(n){return c(n).then((function(e){if(n.audio&&!e.getAudioTracks().length||n.video&&!e.getVideoTracks().length)throw e.getTracks().forEach((function(n){n.stop()})),new DOMException("","NotFoundError");return e}),(function(n){return Promise.reject(o(n))}))}))}}}};var i=function(n){if(n&&n.__esModule)return n;var e={};if(null!=n)for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t]);return e.default=n,e}(n("../utils.js")).log},{"../utils.js":54}],45:[function(n,e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(n){return typeof n}:function(n){return n&&"function"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n};t.shimRTCIceCandidate=function(n){if(!(!n.RTCIceCandidate||n.RTCIceCandidate&&"foundation"in n.RTCIceCandidate.prototype)){var e=n.RTCIceCandidate;n.RTCIceCandidate=function(n){if("object"===(void 0===n?"undefined":r(n))&&n.candidate&&0===n.candidate.indexOf("a=")&&((n=JSON.parse(JSON.stringify(n))).candidate=n.candidate.substr(2)),n.candidate&&n.candidate.length){var t=new e(n),i=a.default.parseCandidate(n.candidate),s=Object.assign(t,i);return s.toJSON=function(){return{candidate:s.candidate,sdpMid:s.sdpMid,sdpMLineIndex:s.sdpMLineIndex,usernameFragment:s.usernameFragment}},s}return new e(n)},n.RTCIceCandidate.prototype=e.prototype,s.wrapPeerConnectionEvent(n,"icecandidate",(function(e){return e.candidate&&Object.defineProperty(e,"candidate",{value:new n.RTCIceCandidate(e.candidate),writable:"false"}),e}))}},t.shimMaxMessageSize=function(n,e){if(n.RTCPeerConnection){"sctp"in n.RTCPeerConnection.prototype||Object.defineProperty(n.RTCPeerConnection.prototype,"sctp",{get:function(){return void 0===this._sctp?null:this._sctp}});var t=n.RTCPeerConnection.prototype.setRemoteDescription;n.RTCPeerConnection.prototype.setRemoteDescription=function(){if(this._sctp=null,"chrome"===e.browser&&e.version>=76&&"plan-b"===this.getConfiguration().sdpSemantics&&Object.defineProperty(this,"sctp",{get:function(){return void 0===this._sctp?null:this._sctp},enumerable:!0,configurable:!0}),function(n){if(!n||!n.sdp)return!1;var e=a.default.splitSections(n.sdp);return e.shift(),e.some((function(n){var e=a.default.parseMLine(n);return e&&"application"===e.kind&&-1!==e.protocol.indexOf("SCTP")}))}(arguments[0])){var n=function(n){var e=n.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(null===e||e.length<2)return-1;var t=parseInt(e[1],10);return t!=t?-1:t}(arguments[0]),r=function(n){var t=65536;return"firefox"===e.browser&&(t=e.version<57?-1===n?16384:2147483637:e.version<60?57===e.version?65535:65536:2147483637),t}(n),i=function(n,t){var r=65536;"firefox"===e.browser&&57===e.version&&(r=65535);var i=a.default.matchPrefix(n.sdp,"a=max-message-size:");return i.length>0?r=parseInt(i[0].substr(19),10):"firefox"===e.browser&&-1!==t&&(r=2147483637),r}(arguments[0],n),s=void 0;s=0===r&&0===i?Number.POSITIVE_INFINITY:0===r||0===i?Math.max(r,i):Math.min(r,i);var o={};Object.defineProperty(o,"maxMessageSize",{get:function(){return s}}),this._sctp=o}return t.apply(this,arguments)}}},t.shimSendThrowTypeError=function(n){if(n.RTCPeerConnection&&"createDataChannel"in n.RTCPeerConnection.prototype){var e=n.RTCPeerConnection.prototype.createDataChannel;n.RTCPeerConnection.prototype.createDataChannel=function(){var n=e.apply(this,arguments);return t(n,this),n},s.wrapPeerConnectionEvent(n,"datachannel",(function(n){return t(n.channel,n.target),n}))}function t(n,e){var t=n.send;n.send=function(){var r=arguments[0],i=r.length||r.size||r.byteLength;if("open"===n.readyState&&e.sctp&&i>e.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+e.sctp.maxMessageSize+" bytes)");return t.apply(n,arguments)}}},t.shimConnectionState=function(n){if(n.RTCPeerConnection&&!("connectionState"in n.RTCPeerConnection.prototype)){var e=n.RTCPeerConnection.prototype;Object.defineProperty(e,"connectionState",{get:function(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(e,"onconnectionstatechange",{get:function(){return this._onconnectionstatechange||null},set:function(n){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),n&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=n)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach((function(n){var t=e[n];e[n]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=function(n){var e=n.target;if(e._lastConnectionState!==e.connectionState){e._lastConnectionState=e.connectionState;var t=new Event("connectionstatechange",n);e.dispatchEvent(t)}return n},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),t.apply(this,arguments)}}))}},t.removeExtmapAllowMixed=function(n,e){if(n.RTCPeerConnection&&!("chrome"===e.browser&&e.version>=71)&&!("safari"===e.browser&&e.version>=605)){var t=n.RTCPeerConnection.prototype.setRemoteDescription;n.RTCPeerConnection.prototype.setRemoteDescription=function(e){if(e&&e.sdp&&-1!==e.sdp.indexOf("\na=extmap-allow-mixed")){var r=e.sdp.split("\n").filter((function(n){return"a=extmap-allow-mixed"!==n.trim()})).join("\n");n.RTCSessionDescription&&e instanceof n.RTCSessionDescription?arguments[0]=new n.RTCSessionDescription({type:e.type,sdp:r}):e.sdp=r}return t.apply(this,arguments)}}},t.shimAddIceCandidateNullOrEmpty=function(n,e){if(n.RTCPeerConnection&&n.RTCPeerConnection.prototype){var t=n.RTCPeerConnection.prototype.addIceCandidate;t&&0!==t.length&&(n.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?("chrome"===e.browser&&e.version<78||"firefox"===e.browser&&e.version<68||"safari"===e.browser)&&arguments[0]&&""===arguments[0].candidate?Promise.resolve():t.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())})}};var i,a=(i=n("sdp"))&&i.__esModule?i:{default:i},s=function(n){if(n&&n.__esModule)return n;var e={};if(null!=n)for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t]);return e.default=n,e}(n("./utils"))},{"./utils":54,sdp:39}],46:[function(n,e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.shimGetDisplayMedia=t.shimGetUserMedia=void 0;var r=n("./getusermedia");Object.defineProperty(t,"shimGetUserMedia",{enumerable:!0,get:function(){return r.shimGetUserMedia}});var i=n("./getdisplaymedia");Object.defineProperty(t,"shimGetDisplayMedia",{enumerable:!0,get:function(){return i.shimGetDisplayMedia}}),t.shimPeerConnection=function(n,e){if(n.RTCIceGatherer&&(n.RTCIceCandidate||(n.RTCIceCandidate=function(n){return n}),n.RTCSessionDescription||(n.RTCSessionDescription=function(n){return n}),e.version<15025)){var t=Object.getOwnPropertyDescriptor(n.MediaStreamTrack.prototype,"enabled");Object.defineProperty(n.MediaStreamTrack.prototype,"enabled",{set:function(n){t.set.call(this,n);var e=new Event("enabled");e.enabled=n,this.dispatchEvent(e)}})}!n.RTCRtpSender||"dtmf"in n.RTCRtpSender.prototype||Object.defineProperty(n.RTCRtpSender.prototype,"dtmf",{get:function(){return void 0===this._dtmf&&("audio"===this.track.kind?this._dtmf=new n.RTCDtmfSender(this):"video"===this.track.kind&&(this._dtmf=null)),this._dtmf}}),n.RTCDtmfSender&&!n.RTCDTMFSender&&(n.RTCDTMFSender=n.RTCDtmfSender);var r=(0,c.default)(n,e.version);n.RTCPeerConnection=function(n){return n&&n.iceServers&&(n.iceServers=(0,o.filterIceServers)(n.iceServers,e.version),s.log("ICE servers after filtering:",n.iceServers)),new r(n)},n.RTCPeerConnection.prototype=r.prototype},t.shimReplaceTrack=function(n){!n.RTCRtpSender||"replaceTrack"in n.RTCRtpSender.prototype||(n.RTCRtpSender.prototype.replaceTrack=n.RTCRtpSender.prototype.setTrack)};var a,s=function(n){if(n&&n.__esModule)return n;var e={};if(null!=n)for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t]);return e.default=n,e}(n("../utils")),o=n("./filtericeservers"),c=(a=n("rtcpeerconnection-shim"))&&a.__esModule?a:{default:a}},{"../utils":54,"./filtericeservers":47,"./getdisplaymedia":48,"./getusermedia":49,"rtcpeerconnection-shim":34}],47:[function(n,e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.filterIceServers=function(n,e){var t=!1;return(n=JSON.parse(JSON.stringify(n))).filter((function(n){if(n&&(n.urls||n.url)){var e=n.urls||n.url;n.url&&!n.urls&&r.deprecated("RTCIceServer.url","RTCIceServer.urls");var i="string"==typeof e;return i&&(e=[e]),e=e.filter((function(n){if(0===n.indexOf("stun:"))return!1;var e=n.startsWith("turn")&&!n.startsWith("turn:[")&&n.includes("transport=udp");return e&&!t?(t=!0,!0):e&&!t})),delete n.url,n.urls=i?e[0]:e,!!e.length}}))};var r=function(n){if(n&&n.__esModule)return n;var e={};if(null!=n)for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t]);return e.default=n,e}(n("../utils"))},{"../utils":54}],48:[function(n,e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.shimGetDisplayMedia=function(n){"getDisplayMedia"in n.navigator&&n.navigator.mediaDevices&&(n.navigator.mediaDevices&&"getDisplayMedia"in n.navigator.mediaDevices||(n.navigator.mediaDevices.getDisplayMedia=n.navigator.getDisplayMedia.bind(n.navigator)))}},{}],49:[function(n,e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.shimGetUserMedia=function(n){var e=n&&n.navigator,t=e.mediaDevices.getUserMedia.bind(e.mediaDevices);e.mediaDevices.getUserMedia=function(n){return t(n).catch((function(n){return Promise.reject(function(n){return{name:{PermissionDeniedError:"NotAllowedError"}[n.name]||n.name,message:n.message,constraint:n.constraint,toString:function(){return this.name}}}(n))}))}}},{}],50:[function(n,e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.shimGetDisplayMedia=t.shimGetUserMedia=void 0;var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(n){return typeof n}:function(n){return n&&"function"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},i=n("./getusermedia");Object.defineProperty(t,"shimGetUserMedia",{enumerable:!0,get:function(){return i.shimGetUserMedia}});var a=n("./getdisplaymedia");Object.defineProperty(t,"shimGetDisplayMedia",{enumerable:!0,get:function(){return a.shimGetDisplayMedia}}),t.shimOnTrack=function(n){"object"===(void 0===n?"undefined":r(n))&&n.RTCTrackEvent&&"receiver"in n.RTCTrackEvent.prototype&&!("transceiver"in n.RTCTrackEvent.prototype)&&Object.defineProperty(n.RTCTrackEvent.prototype,"transceiver",{get:function(){return{receiver:this.receiver}}})},t.shimPeerConnection=function(n,e){if("object"===(void 0===n?"undefined":r(n))&&(n.RTCPeerConnection||n.mozRTCPeerConnection)){!n.RTCPeerConnection&&n.mozRTCPeerConnection&&(n.RTCPeerConnection=n.mozRTCPeerConnection),e.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach((function(e){var t=n.RTCPeerConnection.prototype[e],r=function(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}({},e,(function(){return arguments[0]=new("addIceCandidate"===e?n.RTCIceCandidate:n.RTCSessionDescription)(arguments[0]),t.apply(this,arguments)}));n.RTCPeerConnection.prototype[e]=r[e]}));var t={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},i=n.RTCPeerConnection.prototype.getStats;n.RTCPeerConnection.prototype.getStats=function(){var n=Array.prototype.slice.call(arguments),r=n[0],a=n[1],s=n[2];return i.apply(this,[r||null]).then((function(n){if(e.version<53&&!a)try{n.forEach((function(n){n.type=t[n.type]||n.type}))}catch(e){if("TypeError"!==e.name)throw e;n.forEach((function(e,r){n.set(r,Object.assign({},e,{type:t[e.type]||e.type}))}))}return n})).then(a,s)}}},t.shimSenderGetStats=function(n){if("object"===(void 0===n?"undefined":r(n))&&n.RTCPeerConnection&&n.RTCRtpSender&&(!n.RTCRtpSender||!("getStats"in n.RTCRtpSender.prototype))){var e=n.RTCPeerConnection.prototype.getSenders;e&&(n.RTCPeerConnection.prototype.getSenders=function(){var n=this,t=e.apply(this,[]);return t.forEach((function(e){return e._pc=n})),t});var t=n.RTCPeerConnection.prototype.addTrack;t&&(n.RTCPeerConnection.prototype.addTrack=function(){var n=t.apply(this,arguments);return n._pc=this,n}),n.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map)}}},t.shimReceiverGetStats=function(n){if("object"===(void 0===n?"undefined":r(n))&&n.RTCPeerConnection&&n.RTCRtpSender&&(!n.RTCRtpSender||!("getStats"in n.RTCRtpReceiver.prototype))){var e=n.RTCPeerConnection.prototype.getReceivers;e&&(n.RTCPeerConnection.prototype.getReceivers=function(){var n=this,t=e.apply(this,[]);return t.forEach((function(e){return e._pc=n})),t}),s.wrapPeerConnectionEvent(n,"track",(function(n){return n.receiver._pc=n.srcElement,n})),n.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}},t.shimRemoveStream=function(n){n.RTCPeerConnection&&!("removeStream"in n.RTCPeerConnection.prototype)&&(n.RTCPeerConnection.prototype.removeStream=function(n){var e=this;s.deprecated("removeStream","removeTrack"),this.getSenders().forEach((function(t){t.track&&n.getTracks().includes(t.track)&&e.removeTrack(t)}))})},t.shimRTCDataChannel=function(n){n.DataChannel&&!n.RTCDataChannel&&(n.RTCDataChannel=n.DataChannel)},t.shimAddTransceiver=function(n){if("object"===(void 0===n?"undefined":r(n))&&n.RTCPeerConnection){var e=n.RTCPeerConnection.prototype.addTransceiver;e&&(n.RTCPeerConnection.prototype.addTransceiver=function(){this.setParametersPromises=[];var n=arguments[1],t=n&&"sendEncodings"in n;t&&n.sendEncodings.forEach((function(n){if("rid"in n&&!/^[a-z0-9]{0,16}$/i.test(n.rid))throw new TypeError("Invalid RID value provided.");if("scaleResolutionDownBy"in n&&!(parseFloat(n.scaleResolutionDownBy)>=1))throw new RangeError("scale_resolution_down_by must be >= 1.0");if("maxFramerate"in n&&!(parseFloat(n.maxFramerate)>=0))throw new RangeError("max_framerate must be >= 0.0")}));var r=e.apply(this,arguments);if(t){var i=r.sender,a=i.getParameters();"encodings"in a&&(1!==a.encodings.length||0!==Object.keys(a.encodings[0]).length)||(a.encodings=n.sendEncodings,i.sendEncodings=n.sendEncodings,this.setParametersPromises.push(i.setParameters(a).then((function(){delete i.sendEncodings})).catch((function(){delete i.sendEncodings}))))}return r})}},t.shimGetParameters=function(n){if("object"===(void 0===n?"undefined":r(n))&&n.RTCRtpSender){var e=n.RTCRtpSender.prototype.getParameters;e&&(n.RTCRtpSender.prototype.getParameters=function(){var n=e.apply(this,arguments);return"encodings"in n||(n.encodings=[].concat(this.sendEncodings||[{}])),n})}},t.shimCreateOffer=function(n){if("object"===(void 0===n?"undefined":r(n))&&n.RTCPeerConnection){var e=n.RTCPeerConnection.prototype.createOffer;n.RTCPeerConnection.prototype.createOffer=function(){var n=this,t=arguments;return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then((function(){return e.apply(n,t)})).finally((function(){n.setParametersPromises=[]})):e.apply(this,arguments)}}},t.shimCreateAnswer=function(n){if("object"===(void 0===n?"undefined":r(n))&&n.RTCPeerConnection){var e=n.RTCPeerConnection.prototype.createAnswer;n.RTCPeerConnection.prototype.createAnswer=function(){var n=this,t=arguments;return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then((function(){return e.apply(n,t)})).finally((function(){n.setParametersPromises=[]})):e.apply(this,arguments)}}};var s=function(n){if(n&&n.__esModule)return n;var e={};if(null!=n)for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t]);return e.default=n,e}(n("../utils"))},{"../utils":54,"./getdisplaymedia":51,"./getusermedia":52}],51:[function(n,e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.shimGetDisplayMedia=function(n,e){n.navigator.mediaDevices&&"getDisplayMedia"in n.navigator.mediaDevices||n.navigator.mediaDevices&&(n.navigator.mediaDevices.getDisplayMedia=function(t){if(!t||!t.video){var r=new DOMException("getDisplayMedia without video constraints is undefined");return r.name="NotFoundError",r.code=8,Promise.reject(r)}return!0===t.video?t.video={mediaSource:e}:t.video.mediaSource=e,n.navigator.mediaDevices.getUserMedia(t)})}},{}],52:[function(n,e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(n){return typeof n}:function(n){return n&&"function"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n};t.shimGetUserMedia=function(n,e){var t=n&&n.navigator,a=n&&n.MediaStreamTrack;if(t.getUserMedia=function(n,e,r){i.deprecated("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),t.mediaDevices.getUserMedia(n).then(e,r)},!(e.version>55&&"autoGainControl"in t.mediaDevices.getSupportedConstraints())){var s=function(n,e,t){e in n&&!(t in n)&&(n[t]=n[e],delete n[e])},o=t.mediaDevices.getUserMedia.bind(t.mediaDevices);if(t.mediaDevices.getUserMedia=function(n){return"object"===(void 0===n?"undefined":r(n))&&"object"===r(n.audio)&&(n=JSON.parse(JSON.stringify(n)),s(n.audio,"autoGainControl","mozAutoGainControl"),s(n.audio,"noiseSuppression","mozNoiseSuppression")),o(n)},a&&a.prototype.getSettings){var c=a.prototype.getSettings;a.prototype.getSettings=function(){var n=c.apply(this,arguments);return s(n,"mozAutoGainControl","autoGainControl"),s(n,"mozNoiseSuppression","noiseSuppression"),n}}if(a&&a.prototype.applyConstraints){var l=a.prototype.applyConstraints;a.prototype.applyConstraints=function(n){return"audio"===this.kind&&"object"===(void 0===n?"undefined":r(n))&&(n=JSON.parse(JSON.stringify(n)),s(n,"autoGainControl","mozAutoGainControl"),s(n,"noiseSuppression","mozNoiseSuppression")),l.apply(this,[n])}}}};var i=function(n){if(n&&n.__esModule)return n;var e={};if(null!=n)for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t]);return e.default=n,e}(n("../utils"))},{"../utils":54}],53:[function(n,e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(n){return typeof n}:function(n){return n&&"function"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n};t.shimLocalStreamsAPI=function(n){if("object"===(void 0===n?"undefined":r(n))&&n.RTCPeerConnection){if("getLocalStreams"in n.RTCPeerConnection.prototype||(n.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),!("addStream"in n.RTCPeerConnection.prototype)){var e=n.RTCPeerConnection.prototype.addTrack;n.RTCPeerConnection.prototype.addStream=function(n){var t=this;this._localStreams||(this._localStreams=[]),this._localStreams.includes(n)||this._localStreams.push(n),n.getAudioTracks().forEach((function(r){return e.call(t,r,n)})),n.getVideoTracks().forEach((function(r){return e.call(t,r,n)}))},n.RTCPeerConnection.prototype.addTrack=function(n){for(var t=this,r=arguments.length,i=Array(r>1?r-1:0),a=1;a<r;a++)i[a-1]=arguments[a];return i&&i.forEach((function(n){t._localStreams?t._localStreams.includes(n)||t._localStreams.push(n):t._localStreams=[n]})),e.apply(this,arguments)}}"removeStream"in n.RTCPeerConnection.prototype||(n.RTCPeerConnection.prototype.removeStream=function(n){var e=this;this._localStreams||(this._localStreams=[]);var t=this._localStreams.indexOf(n);if(-1!==t){this._localStreams.splice(t,1);var r=n.getTracks();this.getSenders().forEach((function(n){r.includes(n.track)&&e.removeTrack(n)}))}})}},t.shimRemoteStreamsAPI=function(n){if("object"===(void 0===n?"undefined":r(n))&&n.RTCPeerConnection&&("getRemoteStreams"in n.RTCPeerConnection.prototype||(n.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in n.RTCPeerConnection.prototype))){Object.defineProperty(n.RTCPeerConnection.prototype,"onaddstream",{get:function(){return this._onaddstream},set:function(n){var e=this;this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=n),this.addEventListener("track",this._onaddstreampoly=function(n){n.streams.forEach((function(n){if(e._remoteStreams||(e._remoteStreams=[]),!e._remoteStreams.includes(n)){e._remoteStreams.push(n);var t=new Event("addstream");t.stream=n,e.dispatchEvent(t)}}))})}});var e=n.RTCPeerConnection.prototype.setRemoteDescription;n.RTCPeerConnection.prototype.setRemoteDescription=function(){var n=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(e){e.streams.forEach((function(e){if(n._remoteStreams||(n._remoteStreams=[]),!(n._remoteStreams.indexOf(e)>=0)){n._remoteStreams.push(e);var t=new Event("addstream");t.stream=e,n.dispatchEvent(t)}}))}),e.apply(n,arguments)}}},t.shimCallbacksAPI=function(n){if("object"===(void 0===n?"undefined":r(n))&&n.RTCPeerConnection){var e=n.RTCPeerConnection.prototype,t=e.createOffer,i=e.createAnswer,a=e.setLocalDescription,s=e.setRemoteDescription,o=e.addIceCandidate;e.createOffer=function(n,e){var r=arguments.length>=2?arguments[2]:arguments[0],i=t.apply(this,[r]);return e?(i.then(n,e),Promise.resolve()):i},e.createAnswer=function(n,e){var t=arguments.length>=2?arguments[2]:arguments[0],r=i.apply(this,[t]);return e?(r.then(n,e),Promise.resolve()):r};var c=function(n,e,t){var r=a.apply(this,[n]);return t?(r.then(e,t),Promise.resolve()):r};e.setLocalDescription=c,c=function(n,e,t){var r=s.apply(this,[n]);return t?(r.then(e,t),Promise.resolve()):r},e.setRemoteDescription=c,c=function(n,e,t){var r=o.apply(this,[n]);return t?(r.then(e,t),Promise.resolve()):r},e.addIceCandidate=c}},t.shimGetUserMedia=function(n){var e=n&&n.navigator;if(e.mediaDevices&&e.mediaDevices.getUserMedia){var t=e.mediaDevices,r=t.getUserMedia.bind(t);e.mediaDevices.getUserMedia=function(n){return r(a(n))}}!e.getUserMedia&&e.mediaDevices&&e.mediaDevices.getUserMedia&&(e.getUserMedia=function(n,t,r){e.mediaDevices.getUserMedia(n).then(t,r)}.bind(e))},t.shimConstraints=a,t.shimRTCIceServerUrls=function(n){if(n.RTCPeerConnection){var e=n.RTCPeerConnection;n.RTCPeerConnection=function(n,t){if(n&&n.iceServers){for(var r=[],a=0;a<n.iceServers.length;a++){var s=n.iceServers[a];!s.hasOwnProperty("urls")&&s.hasOwnProperty("url")?(i.deprecated("RTCIceServer.url","RTCIceServer.urls"),(s=JSON.parse(JSON.stringify(s))).urls=s.url,delete s.url,r.push(s)):r.push(n.iceServers[a])}n.iceServers=r}return new e(n,t)},n.RTCPeerConnection.prototype=e.prototype,"generateCertificate"in e&&Object.defineProperty(n.RTCPeerConnection,"generateCertificate",{get:function(){return e.generateCertificate}})}},t.shimTrackEventTransceiver=function(n){"object"===(void 0===n?"undefined":r(n))&&n.RTCTrackEvent&&"receiver"in n.RTCTrackEvent.prototype&&!("transceiver"in n.RTCTrackEvent.prototype)&&Object.defineProperty(n.RTCTrackEvent.prototype,"transceiver",{get:function(){return{receiver:this.receiver}}})},t.shimCreateOfferLegacy=function(n){var e=n.RTCPeerConnection.prototype.createOffer;n.RTCPeerConnection.prototype.createOffer=function(n){if(n){void 0!==n.offerToReceiveAudio&&(n.offerToReceiveAudio=!!n.offerToReceiveAudio);var t=this.getTransceivers().find((function(n){return"audio"===n.receiver.track.kind}));!1===n.offerToReceiveAudio&&t?"sendrecv"===t.direction?t.setDirection?t.setDirection("sendonly"):t.direction="sendonly":"recvonly"===t.direction&&(t.setDirection?t.setDirection("inactive"):t.direction="inactive"):!0!==n.offerToReceiveAudio||t||this.addTransceiver("audio"),void 0!==n.offerToReceiveVideo&&(n.offerToReceiveVideo=!!n.offerToReceiveVideo);var r=this.getTransceivers().find((function(n){return"video"===n.receiver.track.kind}));!1===n.offerToReceiveVideo&&r?"sendrecv"===r.direction?r.setDirection?r.setDirection("sendonly"):r.direction="sendonly":"recvonly"===r.direction&&(r.setDirection?r.setDirection("inactive"):r.direction="inactive"):!0!==n.offerToReceiveVideo||r||this.addTransceiver("video")}return e.apply(this,arguments)}},t.shimAudioContext=function(n){"object"!==(void 0===n?"undefined":r(n))||n.AudioContext||(n.AudioContext=n.webkitAudioContext)};var i=function(n){if(n&&n.__esModule)return n;var e={};if(null!=n)for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t]);return e.default=n,e}(n("../utils"));function a(n){return n&&void 0!==n.video?Object.assign({},n,{video:i.compactObject(n.video)}):n}},{"../utils":54}],54:[function(n,e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(n){return typeof n}:function(n){return n&&"function"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n};t.extractVersion=s,t.wrapPeerConnectionEvent=function(n,e,t){if(n.RTCPeerConnection){var r=n.RTCPeerConnection.prototype,i=r.addEventListener;r.addEventListener=function(n,r){if(n!==e)return i.apply(this,arguments);var a=function(n){var e=t(n);e&&(r.handleEvent?r.handleEvent(e):r(e))};return this._eventMap=this._eventMap||{},this._eventMap[e]||(this._eventMap[e]=new Map),this._eventMap[e].set(r,a),i.apply(this,[n,a])};var a=r.removeEventListener;r.removeEventListener=function(n,t){if(n!==e||!this._eventMap||!this._eventMap[e])return a.apply(this,arguments);if(!this._eventMap[e].has(t))return a.apply(this,arguments);var r=this._eventMap[e].get(t);return this._eventMap[e].delete(t),0===this._eventMap[e].size&&delete this._eventMap[e],0===Object.keys(this._eventMap).length&&delete this._eventMap,a.apply(this,[n,r])},Object.defineProperty(r,"on"+e,{get:function(){return this["_on"+e]},set:function(n){this["_on"+e]&&(this.removeEventListener(e,this["_on"+e]),delete this["_on"+e]),n&&this.addEventListener(e,this["_on"+e]=n)},enumerable:!0,configurable:!0})}},t.disableLog=function(n){return"boolean"!=typeof n?new Error("Argument type: "+(void 0===n?"undefined":r(n))+". Please use a boolean."):(i=n,n?"adapter.js logging disabled":"adapter.js logging enabled")},t.disableWarnings=function(n){return"boolean"!=typeof n?new Error("Argument type: "+(void 0===n?"undefined":r(n))+". Please use a boolean."):(a=!n,"adapter.js deprecation warnings "+(n?"disabled":"enabled"))},t.log=function(){if("object"===("undefined"==typeof window?"undefined":r(window))){if(i)return;"undefined"!=typeof console&&"function"==typeof console.log&&console.log.apply(console,arguments)}},t.deprecated=function(n,e){a&&console.warn(n+" is deprecated, please use "+e+" instead.")},t.detectBrowser=function(n){var e={browser:null,version:null};if(void 0===n||!n.navigator)return e.browser="Not a browser.",e;var t=n.navigator;if(t.mozGetUserMedia)e.browser="firefox",e.version=s(t.userAgent,/Firefox\/(\d+)\./,1);else if(t.webkitGetUserMedia||!1===n.isSecureContext&&n.webkitRTCPeerConnection&&!n.RTCIceGatherer)e.browser="chrome",e.version=s(t.userAgent,/Chrom(e|ium)\/(\d+)\./,2);else if(t.mediaDevices&&t.userAgent.match(/Edge\/(\d+).(\d+)$/))e.browser="edge",e.version=s(t.userAgent,/Edge\/(\d+).(\d+)$/,2);else{if(!n.RTCPeerConnection||!t.userAgent.match(/AppleWebKit\/(\d+)\./))return e.browser="Not a supported browser.",e;e.browser="safari",e.version=s(t.userAgent,/AppleWebKit\/(\d+)\./,1),e.supportsUnifiedPlan=n.RTCRtpTransceiver&&"currentDirection"in n.RTCRtpTransceiver.prototype}return e},t.compactObject=function n(e){return o(e)?Object.keys(e).reduce((function(t,r){var i=o(e[r]),a=i?n(e[r]):e[r],s=i&&!Object.keys(a).length;return void 0===a||s?t:Object.assign(t,function(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}({},r,a))}),{}):e},t.walkStats=c,t.filterStats=function(n,e,t){var r=t?"outbound-rtp":"inbound-rtp",i=new Map;if(null===e)return i;var a=[];return n.forEach((function(n){"track"===n.type&&n.trackIdentifier===e.id&&a.push(n)})),a.forEach((function(e){n.forEach((function(t){t.type===r&&t.trackId===e.id&&c(n,t,i)}))})),i};var i=!0,a=!0;function s(n,e,t){var r=n.match(e);return r&&r.length>=t&&parseInt(r[t],10)}function o(n){return"[object Object]"===Object.prototype.toString.call(n)}function c(n,e,t){e&&!t.has(e.id)&&(t.set(e.id,e),Object.keys(e).forEach((function(r){r.endsWith("Id")?c(n,n.get(e[r]),t):r.endsWith("Ids")&&e[r].forEach((function(e){c(n,n.get(e),t)}))})))}},{}],55:[function(n,e,t){e.exports={name:"plivo-jssip",title:"plivo-jssip",description:"Plivo's Javascript SIP library",version:"1.0.5",homepage:"https://jssip.net",author:"Jos Luis Milln <jmillan@aliax.net> (https://github.com/jmillan)",contributors:["Iaki Baz Castillo <ibc@aliax.net> (https://github.com/ibc)"],types:"index.d.ts",main:"dist/plivo-jssip.min.js",keywords:["sip","websocket","webrtc","node","browser","library"],license:"MIT",repository:{type:"git",url:"git+https://github.com/versatica/JsSIP.git"},bugs:{url:"https://github.com/versatica/JsSIP/issues"},dependencies:{"@types/debug":"^4.1.5","@types/node":"^14.0.6",debug:"^4.1.1",events:"^3.1.0","sdp-transform":"^2.14.0","webrtc-adapter":"^7.7.0"},devDependencies:{"@babel/core":"^7.9.6","@babel/preset-env":"^7.9.6","ansi-colors":"^3.2.4",browserify:"^16.5.1",eslint:"^5.16.0","fancy-log":"^1.3.3",gulp:"^4.0.2","gulp-babel":"^8.0.0","gulp-eslint":"^5.0.0","gulp-expect-file":"^1.0.2","gulp-header":"^2.0.9","gulp-nodeunit-runner":"^0.2.2","gulp-plumber":"^1.2.1","gulp-rename":"^1.4.0","gulp-uglify-es":"^1.0.4",pegjs:"^0.7.0","pre-commit":"^1.2.2",typescript:"^4.0.3","vinyl-buffer":"^1.0.1","vinyl-source-stream":"^2.0.0"},peerDependencies:{"webrtc-adapter":"^7.7.0"},scripts:{lint:"gulp lint",test:"gulp test",build:"gulp","build:js":"gulp browserify"},"pre-commit":["build"],directories:{lib:"lib",test:"test"}}},{}]},{},[8])(8)},function(n,e,t){"use strict";var r=this&&this.__createBinding||(Object.create?function(n,e,t,r){void 0===r&&(r=t),Object.defineProperty(n,r,{enumerable:!0,get:function(){return e[t]}})}:function(n,e,t,r){void 0===r&&(r=t),n[r]=e[t]}),i=this&&this.__setModuleDefault||(Object.create?function(n,e){Object.defineProperty(n,"default",{enumerable:!0,value:e})}:function(n,e){n.default=e}),a=this&&this.__importStar||function(n){if(n&&n.__esModule)return n;var e={};if(null!=n)for(var t in n)"default"!==t&&Object.prototype.hasOwnProperty.call(n,t)&&r(e,n,t);return i(e,n),e},s=this&&this.__awaiter||function(n,e,t,r){return new(t||(t=Promise))((function(i,a){function s(n){try{c(r.next(n))}catch(n){a(n)}}function o(n){try{c(r.throw(n))}catch(n){a(n)}}function c(n){var e;n.done?i(n.value):(e=n.value,e instanceof t?e:new t((function(n){n(e)}))).then(s,o)}c((r=r.apply(n,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.resetPingPong=e.startPingPong=e.reconnectSocket=e.sendNetworkChangeEvent=e.sendInfoReInvite=e.getNetworkData=e.socketReconnectionRetry=e.restartStatSocket=e.ConnectionState=void 0;const o=a(t(11)),c=t(1),l=t(0),u=t(3),d=t(18);e.ConnectionState={CONNECTED:"connected",DISCONNECTED:"disconnected"};const h={log:l.Logger};let p=!0;e.restartStatSocket=n=>{h.log.info(`${c.LOGCAT.CALL} | Restarting websocket if callstatsKey present: ${n.callstatskey} and internet available: ${navigator.onLine}`),n.callstatskey&&navigator.onLine&&n._currentSession&&(n.statsSocket&&(n.statsSocket.disconnect(),n.statsSocket=null),d.createStatsSocket.call(n))};e.socketReconnectionRetry=n=>{let e=1;clearInterval(n.connectionRetryInterval),n.connectionRetryInterval=null,n.isConnected()?h.log.debug(`${c.LOGCAT.NETWORK_CHANGE} | Already connected: ${n.isConnected()}. Cannot start another connection attempt interval`):(h.log.debug(`${c.LOGCAT.NETWORK_CHANGE} | Starting the connection interval`),n.connectionRetryInterval=setInterval((()=>{h.log.debug(`${c.LOGCAT.NETWORK_CHANGE} | Checking WS connection status with count ${e}`),n.phone._transport.socket._ws&&0===n.phone._transport.socket._ws.readyState?(h.log.debug(`${c.LOGCAT.NETWORK_CHANGE} | WS is not ready state`),e>=c.WS_RECONNECT_RETRY_COUNT?(h.log.debug(`${c.LOGCAT.NETWORK_CHANGE} | Retry count exhausted. Changing domain`),n.phone._transport.disconnect(),e=1):(h.log.debug(`${c.LOGCAT.NETWORK_CHANGE} | Connection cannot be established. Increasing the reconnect count`),n.phone._transport.disconnect(!0),n.phone._transport.connect(),e+=1)):(h.log.debug(`${c.LOGCAT.NETWORK_CHANGE} | WS is in ready state or WS instance is available: ${!!n.phone._transport.socket._ws}. Clearing the connection check interval`),clearInterval(n.connectionRetryInterval),n.connectionRetryInterval=null)}),c.WS_RECONNECT_RETRY_INTERVAL))};e.getNetworkData=(n,e)=>({newNetworkInfo:{networkType:navigator.connection?navigator.connection.effectiveType:"unknown",ip:"string"===typeof e?e:""},previousNetworkInfo:{networkType:n.currentNetworkInfo.networkType,ip:n.currentNetworkInfo.ip}});e.sendInfoReInvite=(n,t)=>{if(n._currentSession){const r=e.getNetworkData(n,t);r.newNetworkInfo.ip===r.previousNetworkInfo.ip?(h.log.info(`${c.LOGCAT.CALL} | ip did not changed. Sending info`),n._currentSession.session.sendInfo("command/reconnect")):(h.log.info(`${c.LOGCAT.CALL} | Ip changed. Sending re-invite`),n._currentSession.session.renegotiate({rtcOfferConstraints:{iceRestart:!0},sendReinviteOnly:!0}))}else h.log.info(`${c.LOGCAT.CALL} | No Active Session to send info or re-invite`)};e.sendNetworkChangeEvent=(n,t)=>s(void 0,void 0,void 0,(function*(){const r=e.getNetworkData(n,t),i={msg:"NETWORK_CHANGE",previousNetworkInfo:r.previousNetworkInfo,newNetworkInfo:r.newNetworkInfo,reconnectionTimestamp:n.networkReconnectionTimestamp,disconnectionTimestamp:n.networkDisconnectedTimestamp};h.log.info(`${c.LOGCAT.CALL} | The network changed from ${JSON.stringify(i.previousNetworkInfo)} to ${JSON.stringify(i.newNetworkInfo)}`),n._currentSession&&-1!==n._currentSession.serverFeatureFlags.indexOf("ft_info")&&e.sendInfoReInvite(n,t),u.sendEvents.call(n,i,n._currentSession),n.currentNetworkInfo={networkType:r.newNetworkInfo.networkType,ip:"string"===typeof t?t:""},n.networkDisconnectedTimestamp=null,n.networkReconnectionTimestamp=null}));e.reconnectSocket=n=>{var t,r;if(navigator.onLine){h.log.debug(`${c.LOGCAT.NETWORK_CHANGE} | re-connecting websocket`);const i=null!==(t=n.lastIncomingCall)&&void 0!==t?t:n._currentSession;if(i&&i.state===i.STATE.RINGING)h.log.debug(`${c.LOGCAT.NETWORK_CHANGE} | Terminating ${i.direction} call with calluuid ${i.callUUID} due to network change in ringing state`),i.isCallTerminatedDuringRinging=!0,i.session.terminate();else if(n._currentSession&&-1===n._currentSession.serverFeatureFlags.indexOf("ft_info")){const e=!!n._currentSession&&(null===(r=n._currentSession)||void 0===r?void 0:r.session.renegotiate({rtcOfferConstraints:{iceRestart:!0}}));h.log.debug(`${c.LOGCAT.NETWORK_CHANGE} | Renegotiate Ice :: ${e}`)}else h.log.debug(`${c.LOGCAT.NETWORK_CHANGE} | Closing previous websocket connection. Starting a new one`),n.phone&&(n.phone._transport.disconnect(!0),n.phone._transport.connect(),e.socketReconnectionRetry(n));e.restartStatSocket(n)}};e.startPingPong=({client:n,networkChangeInterval:t,messageCheckTimeout:r})=>{null==n.networkChangeInterval&&(n.networkChangeInterval=setInterval((()=>{var t;if(p||h.log.debug(`${c.LOGCAT.NETWORK_CHANGE} |  Checking for network availablity`),!n.phone||n.phone.isConnected()&&n.phone.isRegistered()?n.phone||h.log.debug(`${c.LOGCAT.NETWORK_CHANGE} | Websocket instance is not available. Is Internet available ${navigator.onLine}`):h.log.debug(`${c.LOGCAT.NETWORK_CHANGE} | Websocket state is connecting: ${n.phone._transport.isConnecting()}, registering: ${n.phone.isRegistering()}, connected: ${n.phone.isConnected()} or registered: ${n.phone.isRegistered()}. Is Internet available ${navigator.onLine}`),navigator.onLine&&n.phone&&!n.phone._transport.isConnecting()&&!n.phone.isRegistering()){let t=!1,i=!1,a=null;if(n.networkDisconnectedTimestamp=(new Date).getTime(),!p)if(p=!0,i=!0,n._currentSession&&-1===n._currentSession.serverFeatureFlags.indexOf("ft_info")){const e=n._currentSession.session.renegotiate({rtcOfferConstraints:{iceRestart:!0}});h.log.debug(`${c.LOGCAT.NETWORK_CHANGE} | Restarting Connection and Renegotiate Ice :: ${e}`)}else h.log.debug(`${c.LOGCAT.NETWORK_CHANGE} | Restarting Connection`),n.phone._transport.connect(),e.socketReconnectionRetry(n);const s=setTimeout((()=>{h.log.debug(`${c.LOGCAT.NETWORK_CHANGE} | Ping request timed out in ${r}. Restarting the connection if options response not received: ${!t}`),t||(i=!0,n.connectionInfo={state:e.ConnectionState.DISCONNECTED,reason:"Ping Timed Out"},e.reconnectSocket(n),a=null),clearTimeout(s)}),r);a=new o.Message(n.phone),a.on("failed",(r=>{var o,l,u,d;t=!0,s&&clearTimeout(s),i||"Not Found"===r.cause&&(null===(o=n.phone)||void 0===o?void 0:o.isConnected())&&(null===(l=n.phone)||void 0===l?void 0:l.isRegistered())||(h.log.debug(`${c.LOGCAT.NETWORK_CHANGE} | Ping request failed with err: ${r.cause}, Client is connected: ${null===(u=n.phone)||void 0===u?void 0:u.isConnected()} and client is registered: ${null===(d=n.phone)||void 0===d?void 0:d.isRegistered()}. Restarting the connection`),n.connectionInfo={state:e.ConnectionState.DISCONNECTED,reason:`Ping failed with err ${r.cause}`},e.reconnectSocket(n),a=null),i=!1,n.emit("onOptionsMessage",r.cause)})),a.send("admin","pong","OPTIONS")}if(!navigator.onLine&&n.phone&&!n.phone._transport.isConnecting()&&!n.phone.isRegistering()&&p){const r=null!==(t=n.lastIncomingCall)&&void 0!==t?t:n._currentSession;r&&r.state===r.STATE.RINGING&&(r.isCallTerminatedDuringRinging=!0,"incoming"===r.direction&&r.session.terminate(),h.log.debug(`${c.LOGCAT.NETWORK_CHANGE} | Terminating ${r.direction} call with calluuid ${r.callUUID} due to network change in ringing state`)),h.log.debug(`${c.LOGCAT.NETWORK_CHANGE} | Websocket disconnected since internet is not available`),n.connectionInfo={state:e.ConnectionState.DISCONNECTED,reason:"No Internet"},n.phone._transport.disconnect(!0),p=!1}}),t))};e.resetPingPong=({client:n,networkChangeInterval:t,messageCheckTimeout:r})=>{clearInterval(n.networkChangeInterval),n.networkChangeInterval=null,h.log.debug(`${c.LOGCAT.NETWORK_CHANGE} | Re-Starting the ping-pong with interval: ${t} and timeout: ${r}`),e.startPingPong({client:n,messageCheckTimeout:r,networkChangeInterval:t})}},function(n,e){var t,r,i=n.exports={};function a(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}function o(n){if(t===setTimeout)return setTimeout(n,0);if((t===a||!t)&&setTimeout)return t=setTimeout,setTimeout(n,0);try{return t(n,0)}catch(e){try{return t.call(null,n,0)}catch(e){return t.call(this,n,0)}}}!function(){try{t="function"===typeof setTimeout?setTimeout:a}catch(n){t=a}try{r="function"===typeof clearTimeout?clearTimeout:s}catch(n){r=s}}();var c,l=[],u=!1,d=-1;function h(){u&&c&&(u=!1,c.length?l=c.concat(l):d=-1,l.length&&p())}function p(){if(!u){var n=o(h);u=!0;for(var e=l.length;e;){for(c=l,l=[];++d<e;)c&&c[d].run();d=-1,e=l.length}c=null,u=!1,function(n){if(r===clearTimeout)return clearTimeout(n);if((r===s||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(n);try{r(n)}catch(e){try{return r.call(null,n)}catch(e){return r.call(this,n)}}}(n)}}function f(n,e){this.fun=n,this.array=e}function g(){}i.nextTick=function(n){var e=new Array(arguments.length-1);if(arguments.length>1)for(var t=1;t<arguments.length;t++)e[t-1]=arguments[t];l.push(new f(n,e)),1!==l.length||u||o(p)},f.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=g,i.addListener=g,i.once=g,i.off=g,i.removeListener=g,i.removeAllListeners=g,i.emit=g,i.prependListener=g,i.prependOnceListener=g,i.listeners=function(n){return[]},i.binding=function(n){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(n){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},function(n,e,t){"use strict";var r=this&&this.__createBinding||(Object.create?function(n,e,t,r){void 0===r&&(r=t),Object.defineProperty(n,r,{enumerable:!0,get:function(){return e[t]}})}:function(n,e,t,r){void 0===r&&(r=t),n[r]=e[t]}),i=this&&this.__setModuleDefault||(Object.create?function(n,e){Object.defineProperty(n,"default",{enumerable:!0,value:e})}:function(n,e){n.default=e}),a=this&&this.__importStar||function(n){if(n&&n.__esModule)return n;var e={};if(null!=n)for(var t in n)"default"!==t&&Object.prototype.hasOwnProperty.call(n,t)&&r(e,n,t);return i(e,n),e};Object.defineProperty(e,"__esModule",{value:!0}),e.StatsSocket=void 0;const s=t(0),o=a(t(1));let c=o.SOCKET_SEND_STATS_RETRY_SECONDS_COUNT,l=o.SOCKET_SEND_STATS_RETRY_ATTEMPTS;const u={log:s.Logger};function d(){this.isConnecting=!1,u.log.debug(`stats socket ${this.url} connected`)}function h(n){u.log.debug("stats socket close()",n);const e=this;u.log.debug(`stats socket ${e.url} closed`),!1===n.wasClean&&(u.log.debug("stats socket abrupt disconnection,  reconnecting in ",o.STATSSOCKET_RECONNECT_SEC/1e3+" sec"),e.isConnected()||setTimeout((()=>{e.connect()}),o.STATSSOCKET_RECONNECT_SEC))}function p(n){u.log.info("received stats socket message: ",n.data)}function f(n){this.isConnecting=!1,u.log.debug(`stats socket ${this.url} error: ${n}`)}e.StatsSocket=class{constructor(){this.connect=()=>{if(!this.ws){u.log.debug(`${o.LOGCAT.CALL}| opening stats socket`);try{this.isConnecting=!0,this.ws=new WebSocket(this.url),this.ws.onopen=d.bind(this),this.ws.onclose=h.bind(this),this.ws.onmessage=p.bind(this),this.ws.onerror=f.bind(this)}catch(n){u.log.error("stats socket open error : ",n),f.call(this,n)}}},this.disconnect=()=>{u.log.debug("stats socket disconnect()"),this.ws?(this.ws.onopen=()=>{},this.ws.onclose=()=>{},this.ws.onmessage=()=>{},this.ws.onerror=()=>{},this.ws.close(),this.ws=null):u.log.debug(`${o.LOGCAT.LOGOUT}| webSocket instance not found`)},this.isConnected=()=>!(!this.ws||this.ws.readyState!==this.ws.OPEN),this.send=(n,e)=>{if(l===o.SOCKET_SEND_STATS_RETRY_ATTEMPTS&&this.messageBuffer.push(JSON.stringify(n)),this.isConnected()&&navigator.onLine){for(u.log.debug("stats : ",n);this.messageBuffer.length;)if(this.ws){const n=this.messageBuffer.shift();this.ws.send(n),u.log.debug("stats send success")}return null!=e.callSession||"CALL_SUMMARY"!==n.msg&&"FEEDBACK"!==n.msg||(this.disconnect(),e.statsSocket=null,e.networkChangeInCurrentSession=!1,e.deviceToggledInCurrentSession=!1),l!==o.SOCKET_SEND_STATS_RETRY_ATTEMPTS&&(l=o.SOCKET_SEND_STATS_RETRY_ATTEMPTS,c=o.SOCKET_SEND_STATS_RETRY_SECONDS_COUNT),!0}return"CALL_SUMMARY"===n.msg&&(u.log.debug("retrying to send call summary event"),l===o.SOCKET_SEND_STATS_RETRY_ATTEMPTS&&(l=o.SOCKET_SEND_STATS_RETRY_ATTEMPTS,c=o.SOCKET_SEND_STATS_RETRY_SECONDS_COUNT,u.log.error(`${o.LOGCAT.CALL} | Error in sending call summary event due to retry exhaustion`))),this.isConnecting||this.isConnected()||(setTimeout((()=>{c+=1,l-=1,this.send(n,e)}),900*c),u.log.warn(`${o.LOGCAT.CALL} | statsSocket is not open, retrying to connect`),this.reconnect()),!1},this.reconnect=()=>{navigator.onLine&&!this.isConnecting&&(this.ws=null,this.connect())},this.url=o.STATSSOCKET_URL,this.ws=null,this.messageBuffer=[],this.isConnecting=!1,this.connect()}heartbeat(n){if(this.isConnected()){const e=JSON.stringify({heartbeat:"healthy",username:n.userName});return this.ws&&this.ws.send(e),u.log.debug("sent heartbeat to stats socket :",e),!0}return u.log.error("unable to send heartbeat, statsSocket is not open"),this.reconnect(),!1}}},function(n,e,t){t(26)(t(27))},function(n,e,t){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.AudioLevel=void 0;const r=t(0);const i=new class{constructor(){this.getAudioContext=()=>{if(!this.audioContext){const n=window.AudioContext||window.webkitAudioContext;this.audioContext=new n}return this.audioContextCount+=1,this.audioContext},this.stop=()=>{this.audioContext&&(this.audioContextCount-=1,0===this.audioContextCount&&(this.audioContext.close(),this.audioContext=null,r.Logger.debug("AudioContext no longer needed so closed")))},this.audioContext=null,this.audioContextCount=0}};e.AudioLevel=class{constructor(n){this.getAudioLevel=()=>{let n=-100;const{fftBins:e}=this;if(e&&this.analyser&&this.analyser.getFloatFrequencyData(e),e)for(let t=4,r=e.length;t<r;t+=1)e[t]>n&&e[t]<0&&(n=e[t]);return n},this.stop=()=>{this.stopped||(this.stopped=!0,this.analyser&&this.analyser.disconnect(),this.sourceNode.disconnect(),i.stop())},this.volumeLevel=-100,this.fftBins=null,this.analyser=null,this.stopped=!1;const e=i.getAudioContext();this.analyser=e.createAnalyser(),this.analyser.fftSize=1024,this.analyser.minDecibels=-100,this.analyser.maxDecibels=0,this.analyser.smoothingTimeConstant=.1,this.fftBins=new Float32Array(this.analyser.frequencyBinCount),this.sourceNode=e.createMediaStreamSource(n),this.sourceNode.connect(this.analyser)}}},function(n,e,t){"use strict";var r=this&&this.__createBinding||(Object.create?function(n,e,t,r){void 0===r&&(r=t),Object.defineProperty(n,r,{enumerable:!0,get:function(){return e[t]}})}:function(n,e,t,r){void 0===r&&(r=t),n[r]=e[t]}),i=this&&this.__setModuleDefault||(Object.create?function(n,e){Object.defineProperty(n,"default",{enumerable:!0,value:e})}:function(n,e){n.default=e}),a=this&&this.__importStar||function(n){if(n&&n.__esModule)return n;var e={};if(null!=n)for(var t in n)"default"!==t&&Object.prototype.hasOwnProperty.call(n,t)&&r(e,n,t);return i(e,n),e};Object.defineProperty(e,"__esModule",{value:!0}),e.fetchIPAddress=e.uploadConsoleLogsToBucket=e.getPreSignedS3URL=e.validateCallStats=void 0;const s=a(t(11)),o=a(t(1)),c={log:t(0).Logger};e.validateCallStats=function(n,e,t){return new Promise(((r,i)=>{let a,s,l=n;n.toLowerCase().startsWith("sip:")&&(l=n.split(":")[1]),a=t?new URL(o.STATS_API_URL_ACCESS_TOKEN):new URL(o.STATS_API_URL),s=t?Object.assign({jwt:e},l.includes("puser")&&{from:l}):{username:l,password:e,domain:o.DOMAIN};const u={method:"POST",headers:new Headers({"Content-Type":"application/json"}),body:JSON.stringify(s)};fetch(a,u).then((n=>{n.ok?n.text().then((n=>{if(n){const e=JSON.parse(n);c.log.info(`${o.LOGCAT.LOGIN} | Call Stats key generated - `,e.data),r(e)}else c.log.info("Call insights is not enabled"),i("Call insights is not enabled")})):(c.log.info(`${o.LOGCAT.LOGIN} | Call Stats key generation failed - `,n),i("Incorrect response code"))})).catch((n=>{c.log.error(`${o.LOGCAT.LOGIN} | Error in getting token from call stats`,n.message),i(n)}))}))};e.getPreSignedS3URL=(n,e)=>{let t,r;e?(t=new URL(o.S3BUCKET_API_URL_JWT),r=Object.assign({jwt:n.accessToken,call_uuid:n.calluuid},n.username.includes("puser")&&{from:n.username})):(t=new URL(o.S3BUCKET_API_URL),r=n);const i={method:"POST",headers:new Headers({"Content-Type":"application/json"}),body:JSON.stringify(r)};return new Promise(((n,e)=>{fetch(t,i).then((t=>{t.ok?t.text().then((t=>{if(!t)return c.log.error("Response is not valid"),void e("Response is not valid");n(JSON.parse(t))})).catch((n=>{c.log.error("Did not get s3 url to upload",n),e("Did not get s3 url to upload")})):(c.log.error("WS API server did not return the presigned S3 Url for uploading call logs"),e("Bad response from server"))})).catch((n=>{c.log.error("WS API server did not return the presigned S3 Url for uploading call logs",n),e("API server did not return the presigned S3 Url for uploading call logs")}))}))};e.uploadConsoleLogsToBucket=function(n,e){return new Promise(((t,r)=>{const i=new URL(n.data),a=c.log.consolelogs(),s=[];e&&s.push(`${JSON.stringify(e)} \n`),s.push(a);const l=new Blob(s,{type:"text/plain;charset=utf-8"}),u=new Headers;u.append("Content-Type","text/plain"),fetch(i,{method:"PUT",headers:u,body:l}).then((()=>{c.log.info("Log file uploaded to server"),t("done")})).catch((n=>{c.log.error(`${o.LOGCAT.CALL_QUALITY} | Log file was not uploaded to server`,n.message),r("Log file was not uploaded to server")}))}))};e.fetchIPAddress=n=>new Promise((e=>{const t=new s.Message(n.phone);t.on("succeeded",(n=>{n.response&&n.response.body?e(n.response.body):e(new Error("couldn't retrieve ipaddress"))})),t.on("failed",(()=>{e(new Error("couldn't retrieve ipaddress"))})),t.send("admin","ipAddress","MESSAGE")}))},function(n,e,t){"use strict";var r=this&&this.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(e,"__esModule",{value:!0}),e.initCallStatsIO=e.createStatsSocket=void 0;const i=t(14),a=t(0),s=r(t(2)),o={log:a.Logger};e.createStatsSocket=function(){const n=this;!n.statsSocket&&n.callstatskey&&(n.statsSocket=new i.StatsSocket,n.statsSocket.connect())};let c=n=>{const{streams:e}=n;window._PlivoDevLogging&&o.log.info(e)};const l=(n,e)=>{o.log.debug(`Stats Initializing Status: err= ${n} msg= ${e}`)};e.initCallStatsIO=function(){const n=this;if(n.options.enableTracking&&!n.callStats){null!=n.options.appSecret||null!=n.options.appId?n.statsioused=!0:n.statsioused=!1,window.csioChromeLegacyGetStats=!0;const e={disableBeforeUnloadHandler:!1,applicationVersion:"2.2.21",disablePrecalltest:!0};if("chrome"!==s.default().browser&&(c=null),n.options.appId){n.callStats="undefined"===typeof window.callstats?t(15):new window.callstats;const r=n.options.appSecret;n.callStats.initialize(n.options.appId,r,n.userName,l,c,e)}o.log.debug("enableTracking initialized")}}},function(n,e,t){"use strict";var r=this&&this.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(e,"__esModule",{value:!0}),e.handleIgnoreState=e.answerIncomingCall=e.checkIncomingCallAction=e.createIncomingSession=e.createIncomingCallListeners=e.getCurrentIncomingCall=void 0;const i=t(11),a=t(1),s=t(20),o=t(21),c=t(7),l=r(t(22)),u=t(0),d=t(8),h=t(12),p={log:u.Logger};let f,g=!1,m=!1;document.addEventListener("visibilitychange",(()=>{"visible"===document.visibilityState?(m=!1,g&&d.mobileBrowserCheck()&&(p.log.debug(`${a.LOGCAT.CALL} | Move to foreground. playing audio`),c.playAudio(a.RINGTONE_ELEMENT_ID))):(m=!0,g&&d.mobileBrowserCheck()&&(p.log.debug(`${a.LOGCAT.CALL} | Move to background. stopping audio`),c.stopAudio(a.RINGTONE_ELEMENT_ID)))}));e.getCurrentIncomingCall=(n,e)=>{let t=null;if(n&&e.incomingInvites.has(n))t=e.incomingInvites.get(n);else if(e.lastIncomingCall&&(t=e.lastIncomingCall,n&&e.options.allowMultipleIncomingCalls))return p.log.error(`${a.LOGCAT.CALL} | No incomingCall with callUUID - ${n}`),null;return t};const b=n=>{p.log.debug(`${a.LOGCAT.CALL} | incoming ${n.originator} sdp prepared`),g=!1;try{n.sdp=l.default(f.options.codecs,n.sdp)}catch(n){p.log.debug("checkCodecPreference err - ",n)}n.sdp=n.sdp.replace("useinbandfec=1",`useinbandfec=1;maxaveragebitrate=${f.options.maxAverageBitrate}`),n.sdp=n.sdp.replace("0\r\r","0"),n.sdp=d.replaceMdnsIceCandidates(n.sdp),p.log.debug("Incoming call SDP processing done")},v=n=>e=>{p.log.debug(`${a.LOGCAT.CALL} | Incoming call failed: ${e.cause}`),((n,e)=>{p.log.info(`${a.LOGCAT.CALL} | Incoming call - ${n.cause}`);let t={protocol:"none",cause:-1,text:"none"};"local"===n.originator&&e.isCallTerminatedDuringRinging?(t={protocol:"none",cause:a.LOCAL_ERROR_CODES["Network switch while ringing"],text:"Network switch while ringing"},e.isCallTerminatedDuringRinging=!1):t=d.extractReason(n),n.cause===i.C.causes.CANCELED?(e.setState(e.STATE.CANCELED),p.log.info(`${a.LOGCAT.CALL} | Incoming call Canceled - ${""===t.text||"none"===t.text?n.cause:t.text}}`),g&&f.emit("onIncomingCallCanceled",e.getCallInfo(n.originator,t.protocol,t.text,t.cause))):(p.log.info(`${a.LOGCAT.CALL} | Incoming call failed - ${""===t.text||"none"===t.text?n.cause:t.text}`),"Rejected"===n.cause?e.setState(e.STATE.REJECTED):e.setState(e.STATE.FAILED),g&&f.emit("onCallFailed",n.cause,e.getCallInfo(n.originator,t.protocol,t.text,t.cause)))})(e,n),g=!1,n.onFailed(f,e),f.incomingInvites.size<2&&f.ringToneView&&!f.ringToneView.paused&&c.stopAudio(a.RINGTONE_ELEMENT_ID)},y=n=>e=>{g=!1,p.log.info(`${a.LOGCAT.CALL} | Incoming call - ${e.cause} - ${e.originator}`),p.log.debug(`Incoming call ended - ${n.callUUID}`),p.log.info(`${a.LOGCAT.CALL} | Incoming call Hangup`),n.onEnded(f,e),h.resetPingPong({client:f,messageCheckTimeout:a.MESSAGE_CHECK_TIMEOUT_IDLE_STATE,networkChangeInterval:a.NETWORK_CHANGE_INTERVAL_IDLE_STATE})},_=n=>{if(f._currentSession&&"remote"===n.originator){p.log.info(`${a.LOGCAT.CALL} | emitting onDtmfReceived with digit: `,n.dtmf.tone);const e={tone:n.dtmf.tone,duration:n.dtmf.duration};f.emit("onDtmfReceived",e)}},C=n=>{p.log.info(`${a.LOGCAT.CALL} | Incoming Call | ${n.originator} INFO packet with body : ${n.info.body}`),f._currentSession&&"remote-party-ringing"===n.info.body&&f.emit("onCallConnected",f._currentSession.getCallInfo(n.originator)),"no-remote-audio"===n.info.body&&f.emit("remoteAudioStatus",!1),"remote-audio"===n.info.body&&f.emit("remoteAudioStatus",!0)};e.createIncomingCallListeners=n=>{n.session.on("progress",(n=>()=>{n.onRinging(f),p.log.debug(`${a.LOGCAT.CALL} | Incoming call ringing`),n.addConnectionStage(`progress-180@${d.getCurrentTime()}`),n.updateSignallingInfo({call_progress_time:d.getCurrentTime()}),n.setState(n.STATE.RINGING),n.setPostDialDelayEndTime(d.getCurrentTime()),p.log.debug(`${a.LOGCAT.CALL} | call ringing with 180 code, incoming call in progress`);const t=n.session.remote_identity.uri.toString(),r=n.session.remote_identity.display_name;p.log.debug(`${a.LOGCAT.CALL} | ringtone enabled : ${f.ringToneFlag}`),p.log.debug(`${a.LOGCAT.CALL} | no session is active currently: ${!f._currentSession}`),!1===f.ringToneFlag||f._currentSession||(d.mobileBrowserCheck()?m||(p.log.debug(`${a.LOGCAT.CALL} | Not in background. Playing ring tone`),c.playAudio(a.RINGTONE_ELEMENT_ID)):(p.log.debug(`${a.LOGCAT.CALL} | Not a mobile browser. Playing ring tone`),c.playAudio(a.RINGTONE_ELEMENT_ID)),p.log.debug(`${a.LOGCAT.CALL} | incoming call ringtone started`));const i=`${t.substring(4,t.indexOf("@"))}@${a.DOMAIN}`,s=()=>{var t;p.log.debug(`${a.LOGCAT.CALL} | Emitting onIncomingCall`),e.getCurrentIncomingCall(null!==(t=n.callUUID)&&void 0!==t?t:"",f)?(g=!0,f.emit("onIncomingCall",i,n.extraHeaders,n.getCallInfo("local"),r)):p.log.error(`${a.LOGCAT.CALL} |Cannot emit onIncomingCall for callUUID: ${n.callUUID}. Incoming call does not exists`)};f.noiseSuppresion.setLocalMediaStream().then((()=>{s()})).catch((()=>{s()})),d.addCloseProtectionListeners.call(f),p.log.debug(`${a.LOGCAT.CALL} | Incoming Call Extra Headers : ${JSON.stringify(n.extraHeaders)}`)})(n)),n.session.on("sdp",b),n.session.on("accepted",(n=>()=>{g=!1,p.log.info(`${a.LOGCAT.CALL} | Incoming call Answered`),h.resetPingPong({client:f,messageCheckTimeout:a.MESSAGE_CHECK_TIMEOUT_ON_CALL_STATE,networkChangeInterval:a.NETWORK_CHANGE_INTERVAL_ON_CALL_STATE}),n.onAccepted(f);const e=n.session.connection||null;e&&(e.oniceconnectionstatechange=()=>d.onIceConnectionChange.call(f,e,n),e.onconnectionstatechange=()=>{p.log.debug(`${a.LOGCAT.CALL} | onconnectionstatechange is ${e.connectionState}`),"connected"===e.connectionState&&(f.timeTakenForStats.mediaSetup.end=(new Date).getTime())})})(n)),n.session.on("confirmed",(n=>()=>{p.log.debug(`Incoming call confirmed - ${n.callUUID}`),g=!1,n.onConfirmed(f);const e=n.session.connection?n.session.connection.getRemoteStreams()[0]:null;e||p.log.error(`${a.LOGCAT.CALL} | Incoming call: remote stream does not exist`),f.remoteView.srcObject=e,d.addCallstatsIOFabric.call(f,n,n.src,n.callUUID)})(n)),n.session.on("icetimeout",(e=>n.onIceTimeout(f,e))),n.session.on("failed",v(n)),n.session.on("ended",y(n)),n.session.on("noCall",y(n)),n.session.on("newDTMF",_),n.session.on("newInfo",C),n.session.on("icecandidate",(e=>n.onIceCandidate(f,e))),n.session.on("getusermediafailed",(e=>n.onGetUserMediaFailed(f,e))),n.session.on("peerconnection:createofferfailed",(e=>n.handlePeerConnectionFailures(f,"createofferfailed",f.callStats?f.callStats.webRTCFunctions.createOffer:null,e))),n.session.on("peerconnection:createanswerfailed",(e=>n.handlePeerConnectionFailures(f,"createanswerfailed",f.callStats?f.callStats.webRTCFunctions.createAnswer:null,e))),n.session.on("peerconnection:setlocaldescriptionfailed",(e=>n.handlePeerConnectionFailures(f,"setlocaldescriptionfailed",f.callStats?f.callStats.webRTCFunctions.setLocalDescription:null,e))),n.session.on("peerconnection:setremotedescriptionfailed",(e=>n.handlePeerConnectionFailures(f,"setremotedescriptionfailed",f.callStats?f.callStats.webRTCFunctions.setRemoteDescription:null,e)))};e.createIncomingSession=(n,t)=>{f=n;const r=t.request.getHeader("X-Calluuid"),i=t.request.getHeader("X-Plivo-Stir-Verification"),c=t.request.getHeader("Call-ID"),l=t.request.getHeader("From").match(/:(.*)@/i),u=null!==l?l[1]:"";f.loggerUtil.setSipCallID(c);const h=o.receiveExtraHeader(t.request,t.request.headers),g={call_uuid:r,sip_call_id:c};p.log.info(`${a.LOGCAT.CALL} | Incoming call initiated for ${f.userName} from ${u} with header:- `,JSON.stringify(g));const m=f.incomingCallsInitiationTime.get(r);m&&f.incomingCallsInitiationTime.delete(r);const b=new s.CallSession({callUUID:r,sipCallID:c,direction:"incoming",src:u,dest:f.userName,session:t.session,extraHeaders:h,call_initiation_time:m,client:f,stirShakenState:i});var v;t.request.getHeader("X-FeatureFlags")?(b.serverFeatureFlags=t.request.getHeader("X-FeatureFlags").split(","),b.serverFeatureFlags.forEach((n=>n.trim())),f.phone&&(-1!==b.serverFeatureFlags.indexOf("ft_info")?f.phone.sendReInviteOnTransportConnect=!1:f.phone.sendReInviteOnTransportConnect=!0)):f.phone&&(f.phone.sendReInviteOnTransportConnect=!0),(v=b).callUUID&&(f.incomingInvites.set(v.callUUID,v),f.lastIncomingCall=v,f.options.allowMultipleIncomingCalls||(f.callSession=v.session,f.callUUID=v.callUUID,f.direction=v.direction),v.addConnectionStage(`I-invite@${d.getCurrentTime()}`),v.updateSignallingInfo({invite_time:d.getCurrentTime()}),p.log.debug(`callSession - ${v.callUUID}`)),e.createIncomingCallListeners(b)};e.checkIncomingCallAction=n=>!(f.options.allowMultipleIncomingCalls&&n&&"string"!==typeof n||"string"===typeof n&&f.options.allowMultipleIncomingCalls&&-1===["reject","ignore","letring"].indexOf(n.toLowerCase()))||(p.log.error(`${a.LOGCAT.CALL} | Invalid actionOnOtherIncomingCalls value`),!1);e.answerIncomingCall=function(n,e){return new Promise((()=>{var t;((n,e)=>{f._currentSession&&(p.log.debug(`${a.LOGCAT.CALL} | hanging up current session before answer`),f.hangup()),f.incomingInvites.forEach((t=>{t!==n&&("string"===typeof e&&"ignore"===e.toLowerCase()?(g=!1,f.ignore(t.callUUID)):"string"===typeof e&&"reject"===e.toLowerCase()?(g=!1,f.reject(t.callUUID)):"string"===typeof e&&"letring"===e.toLowerCase()?p.log.info("Other incoming calls will keep ringing"):e||f.reject(t.callUUID))}))})(n,e),f.owaLastDetect.isOneWay=!1;try{f._currentSession=n,f.incomingInvites.delete(n.callUUID),n===f.lastIncomingCall&&(f.lastIncomingCall=null,f.incomingInvites.size&&(f.lastIncomingCall=f.incomingInvites.values().next().value)),f.loggerUtil.setSipCallID(null!==(t=f._currentSession.sipCallID)&&void 0!==t?t:""),f.callSession=f._currentSession.session,f.callUUID=f._currentSession.callUUID,p.log.debug(`${a.LOGCAT.CALL} | CallUUID is ${f.callUUID}`),f.callDirection=f._currentSession.direction,new Promise((n=>{var e;const t={};if(t.pcConfig={iceServers:[{urls:a.STUN_SERVERS}]},f.permOnClick){const n=f.options.audioConstraints||!0;t.mediaConstraints={audio:n,video:!1}}f.noiseSuppresion.startNoiseSuppression(null!==(e=window.localStream)&&void 0!==e?e:null).then((e=>{t.mediaStream=null!=e?e:window.localStream,t.sessionTimersExpires=a.SESSION_TIMERS_EXPIRES,n(t)}))})).then((e=>{n.session.answer(e)}))}catch(e){p.log.error(`${a.LOGCAT.CALL} | error in answering incoming call : `,e.message),n.setState(n.STATE.CANCELED),p.log.info(`${a.LOGCAT.CALL} | Incoming call Canceled - ${e.message}`),f.emit("onIncomingCallCanceled",n.getCallInfo("local","none","call answer fail",a.LOCAL_ERROR_CODES["call answer fail"]))}f.ringToneView&&!f.ringToneView.paused&&c.stopAudio(a.RINGTONE_ELEMENT_ID)}))};e.handleIgnoreState=n=>{n.setState(n.STATE.IGNORED),n.updateSignallingInfo({hangup_time:d.getCurrentTime(),hangup_party:"local",hangup_reason:"Ignored",signalling_errors:{timestamp:d.getCurrentTime(),error_code:"Ignored",error_description:"Ignored"}}),d.hangupClearance.call(f,n)}},function(n,e,t){"use strict";var r=this&&this.__createBinding||(Object.create?function(n,e,t,r){void 0===r&&(r=t),Object.defineProperty(n,r,{enumerable:!0,get:function(){return e[t]}})}:function(n,e,t,r){void 0===r&&(r=t),n[r]=e[t]}),i=this&&this.__setModuleDefault||(Object.create?function(n,e){Object.defineProperty(n,"default",{enumerable:!0,value:e})}:function(n,e){n.default=e}),a=this&&this.__importStar||function(n){if(n&&n.__esModule)return n;var e={};if(null!=n)for(var t in n)"default"!==t&&Object.prototype.hasOwnProperty.call(n,t)&&r(e,n,t);return i(e,n),e};Object.defineProperty(e,"__esModule",{value:!0}),e.CallSession=void 0;const s=t(3),o=t(4),c=t(6),l=t(38),u=a(t(1)),d=t(8),h=t(0),p=t(7),f=t(1),g={log:h.Logger,emitMetrics:o.emitMetrics};e.CallSession=class{constructor(n){this.candidateList=new Map,this.candidatePairsList=new Map,this.setCallUUID=n=>{this.callUUID=n},this.setState=n=>{this.state=n},this.setSpeechState=n=>{this.speech_state=n},this.addConnectionStage=n=>{this.connectionStages.push(n)},this.getConnectionStages=()=>this.connectionStages,this.setCallStats=n=>{this.stats=n},this.clearCallStats=()=>this._clearCallStats(),this.updateSignallingInfo=n=>{this.signallingInfo=Object.assign(Object.assign({},this.signallingInfo),n)},this.updateMediaConnectionInfo=n=>{this.mediaConnectionInfo=Object.assign(Object.assign({},this.mediaConnectionInfo),n)},this.getSignallingInfo=()=>Object.assign(Object.assign({},this.signallingInfo),{post_dial_delay:this.postDialDelayEndTime?this.postDialDelayEndTime:0-this.signallingInfo.call_initiation_time}),this.stopSpeechRecognition=n=>{var e,t,r;n.speechRecognition&&(null===(e=n._currentSession)||void 0===e?void 0:e.speech_state)===(null===(t=n._currentSession)||void 0===t?void 0:t.SPEECH_STATE.RUNNING)&&(null===(r=n._currentSession)||void 0===r||r.setSpeechState(n._currentSession.SPEECH_STATE.STOPPING),n.speechRecognition.stop())},this.startSpeechRecognition=n=>{var e,t,r,i;if("webkitSpeechRecognition"in window){if((null===(e=n._currentSession)||void 0===e?void 0:e.state)===(null===(t=n._currentSession)||void 0===t?void 0:t.STATE.ANSWERED)&&(null===(r=n._currentSession)||void 0===r?void 0:r.speech_state)===(null===(i=n._currentSession)||void 0===i?void 0:i.SPEECH_STATE.STOPPED))try{g.log.info(`${f.LOGCAT.CALL} | Recognizing speech Starting`),c.speechListeners.call(n)}catch(n){g.log.error(`${f.LOGCAT.CALL} | Error in starting recognizing speech, will be restarted :: ${n.message}`)}}else g.log.error(`${f.LOGCAT.CALL} | Speech Recognition not available in browser`)},this.getMediaConnectionInfo=()=>Object.assign({},this.mediaConnectionInfo),this.setPostDialDelayEndTime=n=>{this.postDialDelayEndTime||(this.postDialDelayEndTime=n)},this.getCallInfo=(n,e="none",t="none",r=-1)=>({callUUID:this.callUUID,direction:this.direction,src:this.src,dest:this.dest,state:this.state,extraHeaders:this.extraHeaders,stirShakenState:this.stirShakenState,originator:n,protocol:e,reason:t,code:r}),this.onAccepted=n=>this._onAccepted(n),this.onRinging=n=>this._onRinging(n),this.onConfirmed=n=>this._onConfirmed(n),this.onIceCandidate=(n,e)=>this._onIceCandidate(n,e),this.onIceTimeout=(n,e)=>this._onIceTimeout(n,e),this.onFailed=(n,e)=>this._onFailed(n,e),this.onEnded=(n,e)=>this._onEnded(n,e),this.onGetUserMediaFailed=(n,e)=>this._onGetUserMediaFailed(n,e),this.handlePeerConnectionFailures=(n,e,t,r)=>this._handlePeerConnectionFailures(n,e,t,r),this._clearCallStats=()=>{this.stats&&(g.log.debug(`${u.LOGCAT.CALL} | clearing out stats`),clearInterval(this.stats.statsTimer),clearInterval(this.stats.audioTimer),this.stats.stop(),this.stats=null)},this._onAccepted=n=>{d.addCloseProtectionListeners.call(n),c.getAudioDevicesInfo.call(n).then((e=>{s.sendCallAnsweredEvent.call(n,e,!0)})).catch((()=>{s.sendCallAnsweredEvent.call(n,null,!0)})),this.updateSignallingInfo({answer_time:d.getCurrentTime()}),d.callStart.call(n),c.startVolumeDataStreaming(n)},this._onRinging=n=>{const e=this.getSignallingInfo(),t=this.getMediaConnectionInfo();this.isAudioDeviceMismatch=!1,c.getAudioDevicesInfo.call(n).then((r=>{c.matchDevices(r.activeInputDeviceGroupId,r.activeOutputDeviceGroupId,r.activeInputAudioDevice,r.activeOutputAudioDevice)||(this.isAudioDeviceMismatch=!0,g.log.debug(`${f.LOGCAT.CALL} | Input and output device mismatch while ringing ${JSON.stringify(r)}`)),s.sendCallRingingEvent.call(n,r,e,t,this)})).catch((()=>{s.sendCallRingingEvent.call(n,null,e,t,this)}))},this._onConfirmed=n=>{this.addConnectionStage(`confirmed@${d.getCurrentTime()}`),this.setState(this.STATE.ANSWERED),this.updateSignallingInfo({call_confirmed_time:d.getCurrentTime()}),d.setEncodingParameters.call(n),n.options.disableRtpTimeOut&&(this.session.connection.disableRtpTimeOut=!0),d.statsCollector.call(n,this),n.ringToneView&&!n.ringToneView.paused&&p.stopAudio(u.RINGTONE_ELEMENT_ID),n.ringBackToneView&&!n.ringBackToneView.paused&&p.stopAudio(u.RINGBACK_ELEMENT_ID),n.emit("onCallAnswered",this.getCallInfo("local")),g.log.debug("Post-Answer detecting OWA"),setTimeout((()=>{l.owaNotification.bind(n)}),3e3,this.session.connection,n),n.isCallMuted&&this.startSpeechRecognition(n)},this._onIceCandidate=(n,e)=>{const{candidate:t}=e;t&&-1!==t.candidate.search("srflx")?e.ready():this.gotInitalIce||(this.gotInitalIce=!0,setTimeout((()=>{if(!this.session)return;const{connection:t}=this.session;t&&"complete"!==t.iceGatheringState&&(e.ready(),g.log.debug(`${u.LOGCAT.CALL} | ice gathering taking more than ${u.ICE_GATHERING_TIMEOUT/1e3} sec ${t.iceGatheringState}`),g.emitMetrics.call(n,"network","warning","ice_timeout",u.ICE_GATHERING_TIMEOUT,!0,"Possible NAT/Firewall issue","None"))}),u.ICE_GATHERING_TIMEOUT))},this._onIceTimeout=(n,e)=>{g.log.debug(`${u.LOGCAT.CALL} | ice gathering timed out`),g.emitMetrics.call(n,"network","warning","ice_timeout",e,!0,"Possible NAT/Firewall issue","None"),s.onIceFailure.call(n,this,new Error("ice_timeout"))},this._onFailed=(n,e)=>{d.logCandidatePairs(n._currentSession),this.addConnectionStage(`failed@${d.getCurrentTime()}`),this.updateSignallingInfo({hangup_time:d.getCurrentTime(),hangup_party:e.originator,hangup_reason:e.cause}),d.handleMediaError(e,this),d.hangupClearance.call(n,this),c.stopVolumeDataStreaming(),g.log.send(n),n.loggerUtil.setSipCallID("")},this._onEnded=(n,e)=>{if(d.logCandidatePairs(n._currentSession),this.addConnectionStage(`ended@${d.getCurrentTime()}`),this.setState(this.STATE.ENDED),this.updateSignallingInfo({hangup_time:d.getCurrentTime(),hangup_party:e.originator,hangup_reason:e.cause}),n.callStats&&n.callStats.sendFabricEvent(this.session.connection,n.callStats.fabricEvent.fabricTerminated,this.callUUID),n._currentSession){const t=d.extractReason(e);g.log.info(`${u.LOGCAT.CALL} | onCallTerminated - ${e.cause}`),n.emit("onCallTerminated",{originator:e.originator,reason:e.cause},n._currentSession.getCallInfo(e.originator,t.protocol,t.text,t.cause)),d.hangupClearance.call(n,n._currentSession),c.stopVolumeDataStreaming(),this.stopSpeechRecognition(n)}g.log.send(n),n.loggerUtil.setSipCallID("")},this._onGetUserMediaFailed=(n,e)=>{g.log.error(`${u.LOGCAT.CALL} | UserMedia:failed ${e.message}`),n.userName&&n.callStats&&(e.message="getusermediafailed",n.callStats.reportError(null,n.userName,n.callStats.webRTCFunctions.getUserMedia,e)),n.emit("onMediaPermission",{status:"failure",error:e.message}),s.onMediaFailure.call(n,this,e)},this._handlePeerConnectionFailures=(n,e,t,r)=>{n.userName&&n.callStats&&t&&(r.message=`peerconnection:${e}`,n.callStats.reportError(null,n.userName,t,r)),s.onSDPfailure.call(n,this,r)},this.STATE={INITIALIZED:"initialized",RINGING:"ringing",ANSWERED:"answered",REJECTED:"rejected",IGNORED:"ignored",CANCELED:"canceled",FAILED:"failed",ENDED:"ended"},this.SPEECH_STATE={STOPPED:"stopped",STARTING:"starting",RUNNING:"running",STOPPING:"stopping",STOPPED_AFTER_DETECTION:"stopped_after_detecting",STOPPED_DUE_TO_NETWORK_ERROR:"stopped_due_to_network_error"},this.callUUID=n.callUUID?n.callUUID:null,this.sipCallID=n.sipCallID,this.stirShakenState=n.stirShakenState,this.direction=n.direction,this.src=n.src,this.dest=n.dest,this.serverFeatureFlags=[],this.state=this.STATE.INITIALIZED,this.speech_state=this.SPEECH_STATE.STOPPED,this.extraHeaders=n.extraHeaders,this.session=n.session,this.connectionStages=[],this.gotInitalIce=!1,this.isCallTerminatedDuringRinging=!1,this.stats=null,this.signallingInfo={},this.mediaConnectionInfo={},n.call_initiation_time&&(this.signallingInfo.call_initiation_time=n.call_initiation_time),this.postDialDelayEndTime=null}}},function(n,e,t){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.receiveExtraHeader=e.checkExtraHeaderJWTVal=e.checkExtraHeaderVal=e.checkExtraHeaderKey=void 0;e.checkExtraHeaderKey=function(n){const e=n.toUpperCase();if(e.startsWith("X-PH")||"X-PLIVO-JWT"===e){return!1!==/^([a-z0-9A-Z-]){1,19}$/.test(n.substr(5))}return!1};e.checkExtraHeaderVal=function(n){return!1!==/^([a-z0-9A-Z_\-+()%.]){1,120}$/.test(n)};e.checkExtraHeaderJWTVal=function(n){return!1!==/^([a-z0-9A-Z_\-+()%.]){1,500}$/.test(n)};e.receiveExtraHeader=function(n,t){const r={};return Object.keys(t).forEach((t=>{const i=n.getHeader(t),a=e.checkExtraHeaderKey,s="X-PLIVO-JWT"===t.toUpperCase()?e.checkExtraHeaderJWTVal:e.checkExtraHeaderVal;a(t)&&s(i)&&(r[t]=i)})),r}},function(n,e,t){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=function(n,e){const t=new RegExp(`a=rtpmap:.* ${n}(.*)`,"ig");if(e.match(t)){const n=e.match(t)?e.match(t):null;let r=[""];return n&&(r=n[0].split(" ")),r[0].match(/\d+/)}return!1};e.default=function(n,e){if(n.length>0){const t=["OPUS","G722","PCMA","PCMU","ISAC","CN"];let i="";n.forEach((n=>{const a=t.indexOf(n);a>-1&&t.splice(a,1);const s=r(n,e);s&&(i+=`${s} `)})),i=i.slice(0,-1);const a=e.match(/m=audio .*[a-z] (.*)/i);e=a?e.replace(a[1],i):e,e=function(n,e){let t;return n.forEach((n=>{const i=r(n,e);t=new RegExp(`\na=rtpmap:.*${n}/.*`,"ig"),e=e.replace(t,""),t=new RegExp(`\na=fmtp:${i} (.*)`,"ig"),e=e.replace(t,""),t=new RegExp(`\na=rtcp-fb:${i} (.*)`,"ig"),e=e.replace(t,"")})),e}(t,e)}return e}},function(n,e,t){"use strict";var r=this&&this.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(e,"__esModule",{value:!0}),e.createOutgoingSession=e.makeCall=void 0;const i=t(1),a=t(20),s=t(21),o=t(7),c=r(t(22)),l=t(3),u=t(4),d=t(0),h=t(8),p=t(12),f={log:d.Logger,emitMetrics:u.emitMetrics,sendEvents:l.sendEvents,AppError:l.AppError};let g,m,b,v;const y=n=>{f.log.debug("Outgoing remote Audio stream received"),g._currentSession&&(g._currentSession.addConnectionStage(`addStream-success@${h.getCurrentTime()}`),g._currentSession.updateMediaConnectionInfo({stream_success:h.getCurrentTime()}),n.streams[0]?(setTimeout((()=>{g.remoteView.srcObject=n.streams[0]}),100),g.ringToneBackFlag&&!h.isSessionConfirmed(g._currentSession.session)?setTimeout((()=>{g._currentSession&&!h.isSessionConfirmed(g._currentSession.session)&&(f.log.debug("playAudio - session confirmed"),g.remoteView.pause())}),100):g.ringToneBackFlag||h.isSessionConfirmed(g._currentSession.session)||f.log.debug("playAudio - MediaServer")):(f.log.error(`${i.LOGCAT.CALL} | Outgoing call add stream failure`),g._currentSession.addConnectionStage(`addStream-failure@${h.getCurrentTime()}`),g._currentSession.updateMediaConnectionInfo({stream_failure:h.getCurrentTime()})))},_=()=>{f.log.debug(`${i.LOGCAT.CALL} | Outgoing call sending`),g._currentSession&&(g._currentSession.addConnectionStage(`O-invite@${h.getCurrentTime()}`),g._currentSession.updateSignallingInfo({call_initiation_time:h.getCurrentTime()})),f.log.debug("call initiation time, sending invite");const n=g._currentSession&&g._currentSession.session.connection||null;!1!==g.connectToneFlag&&o.playAudio(i.CONNECT_TONE_ELEMENT_ID),n&&(n.ontrack=y,n.oniceconnectionstatechange=()=>{g._currentSession&&h.onIceConnectionChange.call(g,n,g._currentSession)},n.onconnectionstatechange=()=>{f.log.debug(`${i.LOGCAT.CALL} | onconnectionstatechange is ${n.connectionState}`),"connected"===n.connectionState&&(g.timeTakenForStats.mediaSetup.end=(new Date).getTime())})},C=n=>{f.log.debug(`${i.LOGCAT.CALL} | ${n.originator} SDP found`);try{n.sdp=c.default(g.options.codecs,n.sdp),n.sdp=n.sdp.replace("useinbandfec=1",`useinbandfec=1;maxaveragebitrate=${g.options.maxAverageBitrate}`),n.sdp=h.replaceMdnsIceCandidates(n.sdp)}catch(n){f.log.debug(`${i.LOGCAT.CALL} checkCodecPreference err - `,n)}},S=n=>{if(g.timeTakenForStats.pdd.end=(new Date).getTime(),g._currentSession&&n.response){g._currentSession.onRinging(g);const e=n.response.getHeader("X-Calluuid");g._currentSession.setCallUUID(e),g._currentSession.setState(g._currentSession.STATE.RINGING),g.callUUID=e,f.log.info(`${i.LOGCAT.CALL} | Outgoing call Ringing, CallUUID: ${g.callUUID}`),g.emit("onCallRemoteRinging",g._currentSession.getCallInfo("local")),h.addCloseProtectionListeners.call(g),h.addMidAttribute.call(g,n),h.addCallstatsIOFabric.call(g,g._currentSession,n.response.headers.To[0].parsed.uri.user,g._currentSession.callUUID),g._currentSession.addConnectionStage(`progress-${n.response.status_code}@${h.getCurrentTime()}`),f.log.debug(`progress-${n.response.status_code}@${h.getCurrentTime()}`),g._currentSession.updateSignallingInfo({ring_start_time:h.getCurrentTime()}),g._currentSession.setPostDialDelayEndTime(h.getCurrentTime()),f.log.debug("Outgoing call progress",n.response.status_code),(n=>{f.log.debug(`${i.LOGCAT.CALL} | ringback tone enabled : ${g.ringToneBackFlag} audioPaused: ${g.connectToneView.paused}`),g.connectToneView.paused||o.stopAudio(i.CONNECT_TONE_ELEMENT_ID),g.ringToneBackFlag&&o.playAudio(i.RINGBACK_ELEMENT_ID),n.response&&183===n.response.status_code&&n.response.body&&g._currentSession&&(f.log.debug(`callSession - ${g._currentSession.callUUID}`),g._currentSession.setPostDialDelayEndTime(h.getCurrentTime()),g.ringToneBackFlag||g.ringBackToneView&&!g.ringBackToneView.paused&&o.stopAudio(i.RINGBACK_ELEMENT_ID))})(n),g.shouldMuteCall&&g.mute()}else f.log.debug(`${i.LOGCAT.CALL} | inavlid response received, while call in progress`)},T=n=>{if(n.response&&g._currentSession){const e=n.response.getHeader("X-Calluuid");g._currentSession.setCallUUID(e),f.log.info(`${i.LOGCAT.CALL} | Outgoing call Answered`),n.response.getHeader("X-FeatureFlags")?(g._currentSession.serverFeatureFlags=n.response.getHeader("X-FeatureFlags").split(","),g._currentSession.serverFeatureFlags.forEach((n=>n.trim())),g.phone&&(-1!==g._currentSession.serverFeatureFlags.indexOf("ft_info")?g.phone.sendReInviteOnTransportConnect=!1:g.phone.sendReInviteOnTransportConnect=!0)):g.phone&&(g.phone.sendReInviteOnTransportConnect=!0),g._currentSession.onAccepted(g),g._currentSession.setPostDialDelayEndTime(h.getCurrentTime()),h.addCallstatsIOFabric.call(g,g._currentSession,n.response.headers.To[0].parsed.uri.user,g._currentSession.callUUID),p.resetPingPong({client:g,messageCheckTimeout:i.MESSAGE_CHECK_TIMEOUT_ON_CALL_STATE,networkChangeInterval:i.NETWORK_CHANGE_INTERVAL_ON_CALL_STATE})}},E=()=>{g._currentSession&&(f.log.debug(`Outgoing call confirmed - ${g._currentSession.callUUID}`),g._currentSession.onConfirmed(g),g.remoteView.paused&&g.remoteView.play().catch((()=>{})),g.connectToneView.paused||o.stopAudio(i.CONNECT_TONE_ELEMENT_ID))},w=n=>{if(f.log.error(`${i.LOGCAT.CALL} | Outgoing call failed: ${n.cause}`),!g._currentSession)return;n.message&&g._currentSession.setCallUUID(n.message.getHeader("X-CallUUID")||null),(n=>{f.log.info(`${i.LOGCAT.CALL} | Outgoing call - ${n.cause}`),g._currentSession&&("Rejected"===n.cause?g._currentSession.setState(g._currentSession.STATE.REJECTED):"Canceled"===n.cause?g._currentSession.setState(g._currentSession.STATE.CANCELED):g._currentSession.setState(g._currentSession.STATE.FAILED))})(n);let e={protocol:"none",cause:-1,text:"none"};"local"===n.originator&&g._currentSession.isCallTerminatedDuringRinging?(e={protocol:"none",cause:i.LOCAL_ERROR_CODES["Network switch while ringing"],text:"Network switch while ringing"},g._currentSession.isCallTerminatedDuringRinging=!1):e=h.extractReason(n),f.log.info(`${i.LOGCAT.CALL} | Outgoing call failed - ${""===e.text||"none"===e.text?n.cause:e.text}`),g.emit("onCallFailed",n.cause,g._currentSession.getCallInfo(n.originator,e.protocol,e.text,e.cause)),g._currentSession.onFailed(g,n),g.ringBackToneView&&!g.ringBackToneView.paused&&o.stopAudio(i.RINGBACK_ELEMENT_ID),g.connectToneView.paused||o.stopAudio(i.CONNECT_TONE_ELEMENT_ID),g.shouldMuteCall=!1},k=n=>{g._currentSession&&(f.log.info(`${i.LOGCAT.CALL} | Outgoing call - ${n.cause} - ${n.originator}`),f.log.debug(`Outgoing call ended - ${g._currentSession.callUUID}`),f.log.info("Outgoing call ended"),g._currentSession.onEnded(g,n),p.resetPingPong({client:g,messageCheckTimeout:i.MESSAGE_CHECK_TIMEOUT_IDLE_STATE,networkChangeInterval:i.NETWORK_CHANGE_INTERVAL_IDLE_STATE}),f.AppError.call(g,{name:"onCallTerminated",originator:n.originator,reason:n.cause}),g.shouldMuteCall=!1)},R=n=>{if(g._currentSession&&"remote"===n.originator){f.log.info(`${i.LOGCAT.CALL} | Outgoing Call | emitting onDtmfReceived with digit: `,n.dtmf.tone);const e={tone:n.dtmf.tone,duration:n.dtmf.duration};g.emit("onDtmfReceived",e)}},I=n=>{f.log.info(`${i.LOGCAT.CALL} | Outgoing Call | ${n.originator} INFO packet with body : ${n.info.body}`),g._currentSession&&"remote-party-ringing"===n.info.body&&g.emit("onCallConnected",g._currentSession.getCallInfo(n.originator)),"no-remote-audio"===n.info.body&&g.emit("remoteAudioStatus",!1),"remote-audio"===n.info.body&&g.emit("remoteAudioStatus",!0)},A=function(n,e){const t={};return t.sessionTimersExpires=i.SESSION_TIMERS_EXPIRES,t.pcConfig={iceServers:[{urls:i.STUN_SERVERS}]},t.mediaConstraints={audio:g.options.audioConstraints||!0,video:!1},t.extraHeaders=((n={})=>{const e=[];return b={},Object.keys(n).forEach((t=>{const r=n[t],i="X-PLIVO-JWT"===t.toUpperCase()?s.checkExtraHeaderJWTVal:s.checkExtraHeaderVal;s.checkExtraHeaderKey(t)&&i(r)?(e.push(`${t}: ${r}`),b[t]=r,f.log.debug(`valid hdr = ${t} -> ${r}`)):f.log.debug(`invalid hdr = ${t} -> ${r}`)})),g.options.clientRegion&&e.push(`X-ClientRegion: ${g.options.clientRegion}`),e})(n),t.mediaStream=null!=e?e:window.localStream,t.eventHandlers={sending:_,sdp:C,progress:S,accepted:T,confirmed:E,noCall:k,newDTMF:R,newInfo:I,icecandidate:n=>g._currentSession&&g._currentSession.onIceCandidate(g,n),icetimeout:n=>g._currentSession&&g._currentSession.onIceTimeout(g,n),failed:w,ended:k,getusermediafailed:n=>g._currentSession&&g._currentSession.onGetUserMediaFailed(g,n),"peerconnection:createofferfailed":n=>g._currentSession&&g._currentSession.handlePeerConnectionFailures(g,"createofferfailed",g.callStats?g.callStats.webRTCFunctions.createOffer:null,n),"peerconnection:createanswerfailed":n=>g._currentSession&&g._currentSession.handlePeerConnectionFailures(g,"createanswerfailed",g.callStats?g.callStats.webRTCFunctions.createAnswer:null,n),"peerconnection:setlocaldescriptionfailed":n=>g._currentSession&&g._currentSession.handlePeerConnectionFailures(g,"setlocaldescriptionfailed",g.callStats?g.callStats.webRTCFunctions.setLocalDescription:null,n),"peerconnection:setremotedescriptionfailed":n=>g._currentSession&&g._currentSession.handlePeerConnectionFailures(g,"setremotedescriptionfailed",g.callStats?g.callStats.webRTCFunctions.setRemoteDescription:null,n)},t};e.makeCall=(n,e,t)=>{f.log.debug(`${i.LOGCAT.CALL} | Outgoing call initiating to ${t} with headers ${JSON.stringify(e)}`),g=n,v=[],v.push(`call()@${h.getCurrentTime()}`);let r="";return t&&(r=h.removeSpaces(String(t))),g.noiseSuppresion.startNoiseSuppression().then((n=>{const t=A(e,n);if(!(n=>"undefined"===typeof n||null===n||n.length<=0?(f.log.warn(`${i.LOGCAT.CALL} | Destination address cannot be null and the length must be > 0`),!1):g._currentSession?(f.log.warn(`${i.LOGCAT.CALL} | Cannot make another call while in call`),!1):g.incomingInvites.size?(f.log.warn(`${i.LOGCAT.CALL} | Cannot make a call while there is an incoming call`),!1):(m=n,!0))(r))return!1;((n,e)=>{try{g.phone?g.phone.call(e,n):f.log.debug(`${i.LOGCAT.CALL} | phone instance is null`),f.log.debug("Outgoing call options : ",JSON.stringify(n.mediaConstraints))}catch(n){f.log.error("Failed to execute plivo.onCalling event handler",n),f.AppError.call(g,{name:n.name,message:n.message,method:"call()"}),f.sendEvents.call(g,{msg:"ERROR_EVENT",name:n.name,info:n.message,method:"call()"},g._currentSession)}})(t,(n=>"sip:"!==n.substring(0,4)?`sip:${n}`:n)(r))})),!0};e.createOutgoingSession=n=>{const e=n.request.getHeader("Call-ID")||null,t={sip_call_id:e,extra_headers:b};g.loggerUtil.setSipCallID(null!==e&&void 0!==e?e:""),f.log.info(`${i.LOGCAT.CALL} | Outgoing call initiated to ${m} with header:- `,JSON.stringify(t)),g._currentSession=new a.CallSession({sipCallID:e,direction:"outgoing",src:g.userName,dest:m,session:n.session,extraHeaders:b,client:g,stirShakenState:"Not_applicable"}),g.callSession=g._currentSession.session,g.callUUID=g._currentSession.callUUID,g.callDirection=g._currentSession.direction,v.forEach((n=>{g._currentSession.addConnectionStage(n)})),v=[],f.log.debug(`${i.LOGCAT.CALL} | outgoing session created`),g.emit("onCalling")}},function(n,e,t){"use strict";var r=t(5);function i(n,e,t,i,a){var s=r.writeRtpDescription(n.kind,e);if(s+=r.writeIceParameters(n.iceGatherer.getLocalParameters()),s+=r.writeDtlsParameters(n.dtlsTransport.getLocalParameters(),"offer"===t?"actpass":a||"active"),s+="a=mid:"+n.mid+"\r\n",n.rtpSender&&n.rtpReceiver?s+="a=sendrecv\r\n":n.rtpSender?s+="a=sendonly\r\n":n.rtpReceiver?s+="a=recvonly\r\n":s+="a=inactive\r\n",n.rtpSender){var o=n.rtpSender._initialTrackId||n.rtpSender.track.id;n.rtpSender._initialTrackId=o;var c="msid:"+(i?i.id:"-")+" "+o+"\r\n";s+="a="+c,s+="a=ssrc:"+n.sendEncodingParameters[0].ssrc+" "+c,n.sendEncodingParameters[0].rtx&&(s+="a=ssrc:"+n.sendEncodingParameters[0].rtx.ssrc+" "+c,s+="a=ssrc-group:FID "+n.sendEncodingParameters[0].ssrc+" "+n.sendEncodingParameters[0].rtx.ssrc+"\r\n")}return s+="a=ssrc:"+n.sendEncodingParameters[0].ssrc+" cname:"+r.localCName+"\r\n",n.rtpSender&&n.sendEncodingParameters[0].rtx&&(s+="a=ssrc:"+n.sendEncodingParameters[0].rtx.ssrc+" cname:"+r.localCName+"\r\n"),s}function a(n,e){var t={codecs:[],headerExtensions:[],fecMechanisms:[]},r=function(n,e){n=parseInt(n,10);for(var t=0;t<e.length;t++)if(e[t].payloadType===n||e[t].preferredPayloadType===n)return e[t]},i=function(n,e,t,i){var a=r(n.parameters.apt,t),s=r(e.parameters.apt,i);return a&&s&&a.name.toLowerCase()===s.name.toLowerCase()};return n.codecs.forEach((function(r){for(var a=0;a<e.codecs.length;a++){var s=e.codecs[a];if(r.name.toLowerCase()===s.name.toLowerCase()&&r.clockRate===s.clockRate){if("rtx"===r.name.toLowerCase()&&r.parameters&&s.parameters.apt&&!i(r,s,n.codecs,e.codecs))continue;(s=JSON.parse(JSON.stringify(s))).numChannels=Math.min(r.numChannels,s.numChannels),t.codecs.push(s),s.rtcpFeedback=s.rtcpFeedback.filter((function(n){for(var e=0;e<r.rtcpFeedback.length;e++)if(r.rtcpFeedback[e].type===n.type&&r.rtcpFeedback[e].parameter===n.parameter)return!0;return!1}));break}}})),n.headerExtensions.forEach((function(n){for(var r=0;r<e.headerExtensions.length;r++){var i=e.headerExtensions[r];if(n.uri===i.uri){t.headerExtensions.push(i);break}}})),t}function s(n,e,t){return-1!=={offer:{setLocalDescription:["stable","have-local-offer"],setRemoteDescription:["stable","have-remote-offer"]},answer:{setLocalDescription:["have-remote-offer","have-local-pranswer"],setRemoteDescription:["have-local-offer","have-remote-pranswer"]}}[e][n].indexOf(t)}function o(n,e){var t=n.getRemoteCandidates().find((function(n){return e.foundation===n.foundation&&e.ip===n.ip&&e.port===n.port&&e.priority===n.priority&&e.protocol===n.protocol&&e.type===n.type}));return t||n.addRemoteCandidate(e),!t}function c(n,e){var t=new Error(e);return t.name=n,t.code={NotSupportedError:9,InvalidStateError:11,InvalidAccessError:15,TypeError:void 0,OperationError:void 0}[n],t}n.exports=function(n,e){function t(e,t){t.addTrack(e),t.dispatchEvent(new n.MediaStreamTrackEvent("addtrack",{track:e}))}function l(e,t,r,i){var a=new Event("track");a.track=t,a.receiver=r,a.transceiver={receiver:r},a.streams=i,n.setTimeout((function(){e._dispatchEvent("track",a)}))}var u=function(t){var i=this,a=document.createDocumentFragment();if(["addEventListener","removeEventListener","dispatchEvent"].forEach((function(n){i[n]=a[n].bind(a)})),this.canTrickleIceCandidates=null,this.needNegotiation=!1,this.localStreams=[],this.remoteStreams=[],this._localDescription=null,this._remoteDescription=null,this.signalingState="stable",this.iceConnectionState="new",this.connectionState="new",this.iceGatheringState="new",t=JSON.parse(JSON.stringify(t||{})),this.usingBundle="max-bundle"===t.bundlePolicy,"negotiate"===t.rtcpMuxPolicy)throw c("NotSupportedError","rtcpMuxPolicy 'negotiate' is not supported");switch(t.rtcpMuxPolicy||(t.rtcpMuxPolicy="require"),t.iceTransportPolicy){case"all":case"relay":break;default:t.iceTransportPolicy="all"}switch(t.bundlePolicy){case"balanced":case"max-compat":case"max-bundle":break;default:t.bundlePolicy="balanced"}if(t.iceServers=function(n,e){var t=!1;return(n=JSON.parse(JSON.stringify(n))).filter((function(n){if(n&&(n.urls||n.url)){var r=n.urls||n.url;n.url&&!n.urls&&console.warn("RTCIceServer.url is deprecated! Use urls instead.");var i="string"===typeof r;return i&&(r=[r]),r=r.filter((function(n){return 0!==n.indexOf("turn:")||-1===n.indexOf("transport=udp")||-1!==n.indexOf("turn:[")||t?0===n.indexOf("stun:")&&e>=14393&&-1===n.indexOf("?transport=udp"):(t=!0,!0)})),delete n.url,n.urls=i?r[0]:r,!!r.length}}))}(t.iceServers||[],e),this._iceGatherers=[],t.iceCandidatePoolSize)for(var s=t.iceCandidatePoolSize;s>0;s--)this._iceGatherers.push(new n.RTCIceGatherer({iceServers:t.iceServers,gatherPolicy:t.iceTransportPolicy}));else t.iceCandidatePoolSize=0;this._config=t,this.transceivers=[],this._sdpSessionId=r.generateSessionId(),this._sdpSessionVersion=0,this._dtlsRole=void 0,this._isClosed=!1};Object.defineProperty(u.prototype,"localDescription",{configurable:!0,get:function(){return this._localDescription}}),Object.defineProperty(u.prototype,"remoteDescription",{configurable:!0,get:function(){return this._remoteDescription}}),u.prototype.onicecandidate=null,u.prototype.onaddstream=null,u.prototype.ontrack=null,u.prototype.onremovestream=null,u.prototype.onsignalingstatechange=null,u.prototype.oniceconnectionstatechange=null,u.prototype.onconnectionstatechange=null,u.prototype.onicegatheringstatechange=null,u.prototype.onnegotiationneeded=null,u.prototype.ondatachannel=null,u.prototype._dispatchEvent=function(n,e){this._isClosed||(this.dispatchEvent(e),"function"===typeof this["on"+n]&&this["on"+n](e))},u.prototype._emitGatheringStateChange=function(){var n=new Event("icegatheringstatechange");this._dispatchEvent("icegatheringstatechange",n)},u.prototype.getConfiguration=function(){return this._config},u.prototype.getLocalStreams=function(){return this.localStreams},u.prototype.getRemoteStreams=function(){return this.remoteStreams},u.prototype._createTransceiver=function(n,e){var t=this.transceivers.length>0,r={track:null,iceGatherer:null,iceTransport:null,dtlsTransport:null,localCapabilities:null,remoteCapabilities:null,rtpSender:null,rtpReceiver:null,kind:n,mid:null,sendEncodingParameters:null,recvEncodingParameters:null,stream:null,associatedRemoteMediaStreams:[],wantReceive:!0};if(this.usingBundle&&t)r.iceTransport=this.transceivers[0].iceTransport,r.dtlsTransport=this.transceivers[0].dtlsTransport;else{var i=this._createIceAndDtlsTransports();r.iceTransport=i.iceTransport,r.dtlsTransport=i.dtlsTransport}return e||this.transceivers.push(r),r},u.prototype.addTrack=function(e,t){if(this._isClosed)throw c("InvalidStateError","Attempted to call addTrack on a closed peerconnection.");var r;if(this.transceivers.find((function(n){return n.track===e})))throw c("InvalidAccessError","Track already exists.");for(var i=0;i<this.transceivers.length;i++)this.transceivers[i].track||this.transceivers[i].kind!==e.kind||(r=this.transceivers[i]);return r||(r=this._createTransceiver(e.kind)),this._maybeFireNegotiationNeeded(),-1===this.localStreams.indexOf(t)&&this.localStreams.push(t),r.track=e,r.stream=t,r.rtpSender=new n.RTCRtpSender(e,r.dtlsTransport),r.rtpSender},u.prototype.addStream=function(n){var t=this;if(e>=15025)n.getTracks().forEach((function(e){t.addTrack(e,n)}));else{var r=n.clone();n.getTracks().forEach((function(n,e){var t=r.getTracks()[e];n.addEventListener("enabled",(function(n){t.enabled=n.enabled}))})),r.getTracks().forEach((function(n){t.addTrack(n,r)}))}},u.prototype.removeTrack=function(e){if(this._isClosed)throw c("InvalidStateError","Attempted to call removeTrack on a closed peerconnection.");if(!(e instanceof n.RTCRtpSender))throw new TypeError("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.");var t=this.transceivers.find((function(n){return n.rtpSender===e}));if(!t)throw c("InvalidAccessError","Sender was not created by this connection.");var r=t.stream;t.rtpSender.stop(),t.rtpSender=null,t.track=null,t.stream=null,-1===this.transceivers.map((function(n){return n.stream})).indexOf(r)&&this.localStreams.indexOf(r)>-1&&this.localStreams.splice(this.localStreams.indexOf(r),1),this._maybeFireNegotiationNeeded()},u.prototype.removeStream=function(n){var e=this;n.getTracks().forEach((function(n){var t=e.getSenders().find((function(e){return e.track===n}));t&&e.removeTrack(t)}))},u.prototype.getSenders=function(){return this.transceivers.filter((function(n){return!!n.rtpSender})).map((function(n){return n.rtpSender}))},u.prototype.getReceivers=function(){return this.transceivers.filter((function(n){return!!n.rtpReceiver})).map((function(n){return n.rtpReceiver}))},u.prototype._createIceGatherer=function(e,t){var r=this;if(t&&e>0)return this.transceivers[0].iceGatherer;if(this._iceGatherers.length)return this._iceGatherers.shift();var i=new n.RTCIceGatherer({iceServers:this._config.iceServers,gatherPolicy:this._config.iceTransportPolicy});return Object.defineProperty(i,"state",{value:"new",writable:!0}),this.transceivers[e].bufferedCandidateEvents=[],this.transceivers[e].bufferCandidates=function(n){var t=!n.candidate||0===Object.keys(n.candidate).length;i.state=t?"completed":"gathering",null!==r.transceivers[e].bufferedCandidateEvents&&r.transceivers[e].bufferedCandidateEvents.push(n)},i.addEventListener("localcandidate",this.transceivers[e].bufferCandidates),i},u.prototype._gather=function(e,t){var i=this,a=this.transceivers[t].iceGatherer;if(!a.onlocalcandidate){var s=this.transceivers[t].bufferedCandidateEvents;this.transceivers[t].bufferedCandidateEvents=null,a.removeEventListener("localcandidate",this.transceivers[t].bufferCandidates),a.onlocalcandidate=function(n){if(!(i.usingBundle&&t>0)){var s=new Event("icecandidate");s.candidate={sdpMid:e,sdpMLineIndex:t};var o=n.candidate,c=!o||0===Object.keys(o).length;if(c)"new"!==a.state&&"gathering"!==a.state||(a.state="completed");else{"new"===a.state&&(a.state="gathering"),o.component=1,o.ufrag=a.getLocalParameters().usernameFragment;var l=r.writeCandidate(o);s.candidate=Object.assign(s.candidate,r.parseCandidate(l)),s.candidate.candidate=l,s.candidate.toJSON=function(){return{candidate:s.candidate.candidate,sdpMid:s.candidate.sdpMid,sdpMLineIndex:s.candidate.sdpMLineIndex,usernameFragment:s.candidate.usernameFragment}}}var u=r.getMediaSections(i._localDescription.sdp);u[s.candidate.sdpMLineIndex]+=c?"a=end-of-candidates\r\n":"a="+s.candidate.candidate+"\r\n",i._localDescription.sdp=r.getDescription(i._localDescription.sdp)+u.join("");var d=i.transceivers.every((function(n){return n.iceGatherer&&"completed"===n.iceGatherer.state}));"gathering"!==i.iceGatheringState&&(i.iceGatheringState="gathering",i._emitGatheringStateChange()),c||i._dispatchEvent("icecandidate",s),d&&(i._dispatchEvent("icecandidate",new Event("icecandidate")),i.iceGatheringState="complete",i._emitGatheringStateChange())}},n.setTimeout((function(){s.forEach((function(n){a.onlocalcandidate(n)}))}),0)}},u.prototype._createIceAndDtlsTransports=function(){var e=this,t=new n.RTCIceTransport(null);t.onicestatechange=function(){e._updateIceConnectionState(),e._updateConnectionState()};var r=new n.RTCDtlsTransport(t);return r.ondtlsstatechange=function(){e._updateConnectionState()},r.onerror=function(){Object.defineProperty(r,"state",{value:"failed",writable:!0}),e._updateConnectionState()},{iceTransport:t,dtlsTransport:r}},u.prototype._disposeIceAndDtlsTransports=function(n){var e=this.transceivers[n].iceGatherer;e&&(delete e.onlocalcandidate,delete this.transceivers[n].iceGatherer);var t=this.transceivers[n].iceTransport;t&&(delete t.onicestatechange,delete this.transceivers[n].iceTransport);var r=this.transceivers[n].dtlsTransport;r&&(delete r.ondtlsstatechange,delete r.onerror,delete this.transceivers[n].dtlsTransport)},u.prototype._transceive=function(n,t,i){var s=a(n.localCapabilities,n.remoteCapabilities);t&&n.rtpSender&&(s.encodings=n.sendEncodingParameters,s.rtcp={cname:r.localCName,compound:n.rtcpParameters.compound},n.recvEncodingParameters.length&&(s.rtcp.ssrc=n.recvEncodingParameters[0].ssrc),n.rtpSender.send(s)),i&&n.rtpReceiver&&s.codecs.length>0&&("video"===n.kind&&n.recvEncodingParameters&&e<15019&&n.recvEncodingParameters.forEach((function(n){delete n.rtx})),n.recvEncodingParameters.length?s.encodings=n.recvEncodingParameters:s.encodings=[{}],s.rtcp={compound:n.rtcpParameters.compound},n.rtcpParameters.cname&&(s.rtcp.cname=n.rtcpParameters.cname),n.sendEncodingParameters.length&&(s.rtcp.ssrc=n.sendEncodingParameters[0].ssrc),n.rtpReceiver.receive(s))},u.prototype.setLocalDescription=function(n){var e,t,i=this;if(-1===["offer","answer"].indexOf(n.type))return Promise.reject(c("TypeError",'Unsupported type "'+n.type+'"'));if(!s("setLocalDescription",n.type,i.signalingState)||i._isClosed)return Promise.reject(c("InvalidStateError","Can not set local "+n.type+" in state "+i.signalingState));if("offer"===n.type)e=r.splitSections(n.sdp),t=e.shift(),e.forEach((function(n,e){var t=r.parseRtpParameters(n);i.transceivers[e].localCapabilities=t})),i.transceivers.forEach((function(n,e){i._gather(n.mid,e)}));else if("answer"===n.type){e=r.splitSections(i._remoteDescription.sdp),t=e.shift();var o=r.matchPrefix(t,"a=ice-lite").length>0;e.forEach((function(n,e){var s=i.transceivers[e],c=s.iceGatherer,l=s.iceTransport,u=s.dtlsTransport,d=s.localCapabilities,h=s.remoteCapabilities;if(!(r.isRejected(n)&&0===r.matchPrefix(n,"a=bundle-only").length)&&!s.rejected){var p=r.getIceParameters(n,t),f=r.getDtlsParameters(n,t);o&&(f.role="server"),i.usingBundle&&0!==e||(i._gather(s.mid,e),"new"===l.state&&l.start(c,p,o?"controlling":"controlled"),"new"===u.state&&u.start(f));var g=a(d,h);i._transceive(s,g.codecs.length>0,!1)}}))}return i._localDescription={type:n.type,sdp:n.sdp},"offer"===n.type?i._updateSignalingState("have-local-offer"):i._updateSignalingState("stable"),Promise.resolve()},u.prototype.setRemoteDescription=function(i){var u=this;if(-1===["offer","answer"].indexOf(i.type))return Promise.reject(c("TypeError",'Unsupported type "'+i.type+'"'));if(!s("setRemoteDescription",i.type,u.signalingState)||u._isClosed)return Promise.reject(c("InvalidStateError","Can not set remote "+i.type+" in state "+u.signalingState));var d={};u.remoteStreams.forEach((function(n){d[n.id]=n}));var h=[],p=r.splitSections(i.sdp),f=p.shift(),g=r.matchPrefix(f,"a=ice-lite").length>0,m=r.matchPrefix(f,"a=group:BUNDLE ").length>0;u.usingBundle=m;var b=r.matchPrefix(f,"a=ice-options:")[0];return u.canTrickleIceCandidates=!!b&&b.substr(14).split(" ").indexOf("trickle")>=0,p.forEach((function(s,c){var l=r.splitLines(s),p=r.getKind(s),b=r.isRejected(s)&&0===r.matchPrefix(s,"a=bundle-only").length,v=l[0].substr(2).split(" ")[2],y=r.getDirection(s,f),_=r.parseMsid(s),C=r.getMid(s)||r.generateIdentifier();if(b||"application"===p&&("DTLS/SCTP"===v||"UDP/DTLS/SCTP"===v))u.transceivers[c]={mid:C,kind:p,protocol:v,rejected:!0};else{var S,T,E,w,k,R,I,A,O;!b&&u.transceivers[c]&&u.transceivers[c].rejected&&(u.transceivers[c]=u._createTransceiver(p,!0));var P,L,D=r.parseRtpParameters(s);b||(P=r.getIceParameters(s,f),(L=r.getDtlsParameters(s,f)).role="client"),I=r.parseRtpEncodingParameters(s);var N=r.parseRtcpParameters(s),M=r.matchPrefix(s,"a=end-of-candidates",f).length>0,j=r.matchPrefix(s,"a=candidate:").map((function(n){return r.parseCandidate(n)})).filter((function(n){return 1===n.component}));if(("offer"===i.type||"answer"===i.type)&&!b&&m&&c>0&&u.transceivers[c]&&(u._disposeIceAndDtlsTransports(c),u.transceivers[c].iceGatherer=u.transceivers[0].iceGatherer,u.transceivers[c].iceTransport=u.transceivers[0].iceTransport,u.transceivers[c].dtlsTransport=u.transceivers[0].dtlsTransport,u.transceivers[c].rtpSender&&u.transceivers[c].rtpSender.setTransport(u.transceivers[0].dtlsTransport),u.transceivers[c].rtpReceiver&&u.transceivers[c].rtpReceiver.setTransport(u.transceivers[0].dtlsTransport)),"offer"!==i.type||b){if("answer"===i.type&&!b){T=(S=u.transceivers[c]).iceGatherer,E=S.iceTransport,w=S.dtlsTransport,k=S.rtpReceiver,R=S.sendEncodingParameters,A=S.localCapabilities,u.transceivers[c].recvEncodingParameters=I,u.transceivers[c].remoteCapabilities=D,u.transceivers[c].rtcpParameters=N,j.length&&"new"===E.state&&(!g&&!M||m&&0!==c?j.forEach((function(n){o(S.iceTransport,n)})):E.setRemoteCandidates(j)),m&&0!==c||("new"===E.state&&E.start(T,P,"controlling"),"new"===w.state&&w.start(L)),!a(S.localCapabilities,S.remoteCapabilities).codecs.filter((function(n){return"rtx"===n.name.toLowerCase()})).length&&S.sendEncodingParameters[0].rtx&&delete S.sendEncodingParameters[0].rtx,u._transceive(S,"sendrecv"===y||"recvonly"===y,"sendrecv"===y||"sendonly"===y),!k||"sendrecv"!==y&&"sendonly"!==y?delete S.rtpReceiver:(O=k.track,_?(d[_.stream]||(d[_.stream]=new n.MediaStream),t(O,d[_.stream]),h.push([O,k,d[_.stream]])):(d.default||(d.default=new n.MediaStream),t(O,d.default),h.push([O,k,d.default])))}}else{(S=u.transceivers[c]||u._createTransceiver(p)).mid=C,S.iceGatherer||(S.iceGatherer=u._createIceGatherer(c,m)),j.length&&"new"===S.iceTransport.state&&(!M||m&&0!==c?j.forEach((function(n){o(S.iceTransport,n)})):S.iceTransport.setRemoteCandidates(j)),A=n.RTCRtpReceiver.getCapabilities(p),e<15019&&(A.codecs=A.codecs.filter((function(n){return"rtx"!==n.name}))),R=S.sendEncodingParameters||[{ssrc:1001*(2*c+2)}];var x,U=!1;if("sendrecv"===y||"sendonly"===y){if(U=!S.rtpReceiver,k=S.rtpReceiver||new n.RTCRtpReceiver(S.dtlsTransport,p),U)O=k.track,_&&"-"===_.stream||(_?(d[_.stream]||(d[_.stream]=new n.MediaStream,Object.defineProperty(d[_.stream],"id",{get:function(){return _.stream}})),Object.defineProperty(O,"id",{get:function(){return _.track}}),x=d[_.stream]):(d.default||(d.default=new n.MediaStream),x=d.default)),x&&(t(O,x),S.associatedRemoteMediaStreams.push(x)),h.push([O,k,x])}else S.rtpReceiver&&S.rtpReceiver.track&&(S.associatedRemoteMediaStreams.forEach((function(e){var t=e.getTracks().find((function(n){return n.id===S.rtpReceiver.track.id}));t&&function(e,t){t.removeTrack(e),t.dispatchEvent(new n.MediaStreamTrackEvent("removetrack",{track:e}))}(t,e)})),S.associatedRemoteMediaStreams=[]);S.localCapabilities=A,S.remoteCapabilities=D,S.rtpReceiver=k,S.rtcpParameters=N,S.sendEncodingParameters=R,S.recvEncodingParameters=I,u._transceive(u.transceivers[c],!1,U)}}})),void 0===u._dtlsRole&&(u._dtlsRole="offer"===i.type?"active":"passive"),u._remoteDescription={type:i.type,sdp:i.sdp},"offer"===i.type?u._updateSignalingState("have-remote-offer"):u._updateSignalingState("stable"),Object.keys(d).forEach((function(e){var t=d[e];if(t.getTracks().length){if(-1===u.remoteStreams.indexOf(t)){u.remoteStreams.push(t);var r=new Event("addstream");r.stream=t,n.setTimeout((function(){u._dispatchEvent("addstream",r)}))}h.forEach((function(n){var e=n[0],r=n[1];t.id===n[2].id&&l(u,e,r,[t])}))}})),h.forEach((function(n){n[2]||l(u,n[0],n[1],[])})),n.setTimeout((function(){u&&u.transceivers&&u.transceivers.forEach((function(n){n.iceTransport&&"new"===n.iceTransport.state&&n.iceTransport.getRemoteCandidates().length>0&&(console.warn("Timeout for addRemoteCandidate. Consider sending an end-of-candidates notification"),n.iceTransport.addRemoteCandidate({}))}))}),4e3),Promise.resolve()},u.prototype.close=function(){this.transceivers.forEach((function(n){n.iceTransport&&n.iceTransport.stop(),n.dtlsTransport&&n.dtlsTransport.stop(),n.rtpSender&&n.rtpSender.stop(),n.rtpReceiver&&n.rtpReceiver.stop()})),this._isClosed=!0,this._updateSignalingState("closed")},u.prototype._updateSignalingState=function(n){this.signalingState=n;var e=new Event("signalingstatechange");this._dispatchEvent("signalingstatechange",e)},u.prototype._maybeFireNegotiationNeeded=function(){var e=this;"stable"===this.signalingState&&!0!==this.needNegotiation&&(this.needNegotiation=!0,n.setTimeout((function(){if(e.needNegotiation){e.needNegotiation=!1;var n=new Event("negotiationneeded");e._dispatchEvent("negotiationneeded",n)}}),0))},u.prototype._updateIceConnectionState=function(){var n,e={new:0,closed:0,checking:0,connected:0,completed:0,disconnected:0,failed:0};if(this.transceivers.forEach((function(n){n.iceTransport&&!n.rejected&&e[n.iceTransport.state]++})),n="new",e.failed>0?n="failed":e.checking>0?n="checking":e.disconnected>0?n="disconnected":e.new>0?n="new":e.connected>0?n="connected":e.completed>0&&(n="completed"),n!==this.iceConnectionState){this.iceConnectionState=n;var t=new Event("iceconnectionstatechange");this._dispatchEvent("iceconnectionstatechange",t)}},u.prototype._updateConnectionState=function(){var n,e={new:0,closed:0,connecting:0,connected:0,completed:0,disconnected:0,failed:0};if(this.transceivers.forEach((function(n){n.iceTransport&&n.dtlsTransport&&!n.rejected&&(e[n.iceTransport.state]++,e[n.dtlsTransport.state]++)})),e.connected+=e.completed,n="new",e.failed>0?n="failed":e.connecting>0?n="connecting":e.disconnected>0?n="disconnected":e.new>0?n="new":e.connected>0&&(n="connected"),n!==this.connectionState){this.connectionState=n;var t=new Event("connectionstatechange");this._dispatchEvent("connectionstatechange",t)}},u.prototype.createOffer=function(){var t=this;if(t._isClosed)return Promise.reject(c("InvalidStateError","Can not call createOffer after close"));var a=t.transceivers.filter((function(n){return"audio"===n.kind})).length,s=t.transceivers.filter((function(n){return"video"===n.kind})).length,o=arguments[0];if(o){if(o.mandatory||o.optional)throw new TypeError("Legacy mandatory/optional constraints not supported.");void 0!==o.offerToReceiveAudio&&(a=!0===o.offerToReceiveAudio?1:!1===o.offerToReceiveAudio?0:o.offerToReceiveAudio),void 0!==o.offerToReceiveVideo&&(s=!0===o.offerToReceiveVideo?1:!1===o.offerToReceiveVideo?0:o.offerToReceiveVideo)}for(t.transceivers.forEach((function(n){"audio"===n.kind?--a<0&&(n.wantReceive=!1):"video"===n.kind&&--s<0&&(n.wantReceive=!1)}));a>0||s>0;)a>0&&(t._createTransceiver("audio"),a--),s>0&&(t._createTransceiver("video"),s--);var l=r.writeSessionBoilerplate(t._sdpSessionId,t._sdpSessionVersion++);t.transceivers.forEach((function(i,a){var s=i.track,o=i.kind,c=i.mid||r.generateIdentifier();i.mid=c,i.iceGatherer||(i.iceGatherer=t._createIceGatherer(a,t.usingBundle));var l=n.RTCRtpSender.getCapabilities(o);e<15019&&(l.codecs=l.codecs.filter((function(n){return"rtx"!==n.name}))),l.codecs.forEach((function(n){"H264"===n.name&&void 0===n.parameters["level-asymmetry-allowed"]&&(n.parameters["level-asymmetry-allowed"]="1"),i.remoteCapabilities&&i.remoteCapabilities.codecs&&i.remoteCapabilities.codecs.forEach((function(e){n.name.toLowerCase()===e.name.toLowerCase()&&n.clockRate===e.clockRate&&(n.preferredPayloadType=e.payloadType)}))})),l.headerExtensions.forEach((function(n){(i.remoteCapabilities&&i.remoteCapabilities.headerExtensions||[]).forEach((function(e){n.uri===e.uri&&(n.id=e.id)}))}));var u=i.sendEncodingParameters||[{ssrc:1001*(2*a+1)}];s&&e>=15019&&"video"===o&&!u[0].rtx&&(u[0].rtx={ssrc:u[0].ssrc+1}),i.wantReceive&&(i.rtpReceiver=new n.RTCRtpReceiver(i.dtlsTransport,o)),i.localCapabilities=l,i.sendEncodingParameters=u})),"max-compat"!==t._config.bundlePolicy&&(l+="a=group:BUNDLE "+t.transceivers.map((function(n){return n.mid})).join(" ")+"\r\n"),l+="a=ice-options:trickle\r\n",t.transceivers.forEach((function(n,e){l+=i(n,n.localCapabilities,"offer",n.stream,t._dtlsRole),l+="a=rtcp-rsize\r\n",!n.iceGatherer||"new"===t.iceGatheringState||0!==e&&t.usingBundle||(n.iceGatherer.getLocalCandidates().forEach((function(n){n.component=1,l+="a="+r.writeCandidate(n)+"\r\n"})),"completed"===n.iceGatherer.state&&(l+="a=end-of-candidates\r\n"))}));var u=new n.RTCSessionDescription({type:"offer",sdp:l});return Promise.resolve(u)},u.prototype.createAnswer=function(){var t=this;if(t._isClosed)return Promise.reject(c("InvalidStateError","Can not call createAnswer after close"));if("have-remote-offer"!==t.signalingState&&"have-local-pranswer"!==t.signalingState)return Promise.reject(c("InvalidStateError","Can not call createAnswer in signalingState "+t.signalingState));var s=r.writeSessionBoilerplate(t._sdpSessionId,t._sdpSessionVersion++);t.usingBundle&&(s+="a=group:BUNDLE "+t.transceivers.map((function(n){return n.mid})).join(" ")+"\r\n"),s+="a=ice-options:trickle\r\n";var o=r.getMediaSections(t._remoteDescription.sdp).length;t.transceivers.forEach((function(n,r){if(!(r+1>o)){if(n.rejected)return"application"===n.kind?"DTLS/SCTP"===n.protocol?s+="m=application 0 DTLS/SCTP 5000\r\n":s+="m=application 0 "+n.protocol+" webrtc-datachannel\r\n":"audio"===n.kind?s+="m=audio 0 UDP/TLS/RTP/SAVPF 0\r\na=rtpmap:0 PCMU/8000\r\n":"video"===n.kind&&(s+="m=video 0 UDP/TLS/RTP/SAVPF 120\r\na=rtpmap:120 VP8/90000\r\n"),void(s+="c=IN IP4 0.0.0.0\r\na=inactive\r\na=mid:"+n.mid+"\r\n");var c;if(n.stream)"audio"===n.kind?c=n.stream.getAudioTracks()[0]:"video"===n.kind&&(c=n.stream.getVideoTracks()[0]),c&&e>=15019&&"video"===n.kind&&!n.sendEncodingParameters[0].rtx&&(n.sendEncodingParameters[0].rtx={ssrc:n.sendEncodingParameters[0].ssrc+1});var l=a(n.localCapabilities,n.remoteCapabilities);!l.codecs.filter((function(n){return"rtx"===n.name.toLowerCase()})).length&&n.sendEncodingParameters[0].rtx&&delete n.sendEncodingParameters[0].rtx,s+=i(n,l,"answer",n.stream,t._dtlsRole),n.rtcpParameters&&n.rtcpParameters.reducedSize&&(s+="a=rtcp-rsize\r\n")}}));var l=new n.RTCSessionDescription({type:"answer",sdp:s});return Promise.resolve(l)},u.prototype.addIceCandidate=function(n){var e,t=this;return n&&void 0===n.sdpMLineIndex&&!n.sdpMid?Promise.reject(new TypeError("sdpMLineIndex or sdpMid required")):new Promise((function(i,a){if(!t._remoteDescription)return a(c("InvalidStateError","Can not add ICE candidate without a remote description"));if(n&&""!==n.candidate){var s=n.sdpMLineIndex;if(n.sdpMid)for(var l=0;l<t.transceivers.length;l++)if(t.transceivers[l].mid===n.sdpMid){s=l;break}var u=t.transceivers[s];if(!u)return a(c("OperationError","Can not add ICE candidate"));if(u.rejected)return i();var d=Object.keys(n.candidate).length>0?r.parseCandidate(n.candidate):{};if("tcp"===d.protocol&&(0===d.port||9===d.port))return i();if(d.component&&1!==d.component)return i();if((0===s||s>0&&u.iceTransport!==t.transceivers[0].iceTransport)&&!o(u.iceTransport,d))return a(c("OperationError","Can not add ICE candidate"));var h=n.candidate.trim();0===h.indexOf("a=")&&(h=h.substr(2)),(e=r.getMediaSections(t._remoteDescription.sdp))[s]+="a="+(d.type?h:"end-of-candidates")+"\r\n",t._remoteDescription.sdp=r.getDescription(t._remoteDescription.sdp)+e.join("")}else for(var p=0;p<t.transceivers.length&&(t.transceivers[p].rejected||(t.transceivers[p].iceTransport.addRemoteCandidate({}),(e=r.getMediaSections(t._remoteDescription.sdp))[p]+="a=end-of-candidates\r\n",t._remoteDescription.sdp=r.getDescription(t._remoteDescription.sdp)+e.join(""),!t.usingBundle));p++);i()}))},u.prototype.getStats=function(e){if(e&&e instanceof n.MediaStreamTrack){var t=null;if(this.transceivers.forEach((function(n){n.rtpSender&&n.rtpSender.track===e?t=n.rtpSender:n.rtpReceiver&&n.rtpReceiver.track===e&&(t=n.rtpReceiver)})),!t)throw c("InvalidAccessError","Invalid selector.");return t.getStats()}var r=[];return this.transceivers.forEach((function(n){["rtpSender","rtpReceiver","iceGatherer","iceTransport","dtlsTransport"].forEach((function(e){n[e]&&r.push(n[e].getStats())}))})),Promise.all(r).then((function(n){var e=new Map;return n.forEach((function(n){n.forEach((function(n){e.set(n.id,n)}))})),e}))};["RTCRtpSender","RTCRtpReceiver","RTCIceGatherer","RTCIceTransport","RTCDtlsTransport"].forEach((function(e){var t=n[e];if(t&&t.prototype&&t.prototype.getStats){var r=t.prototype.getStats;t.prototype.getStats=function(){return r.apply(this).then((function(n){var e=new Map;return Object.keys(n).forEach((function(t){var r;n[t].type={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[(r=n[t]).type]||r.type,e.set(t,n[t])})),e}))}}}));var d=["createOffer","createAnswer"];return d.forEach((function(n){var e=u.prototype[n];u.prototype[n]=function(){var n=arguments;return"function"===typeof n[0]||"function"===typeof n[1]?e.apply(this,[arguments[2]]).then((function(e){"function"===typeof n[0]&&n[0].apply(null,[e])}),(function(e){"function"===typeof n[1]&&n[1].apply(null,[e])})):e.apply(this,arguments)}})),(d=["setLocalDescription","setRemoteDescription","addIceCandidate"]).forEach((function(n){var e=u.prototype[n];u.prototype[n]=function(){var n=arguments;return"function"===typeof n[1]||"function"===typeof n[2]?e.apply(this,arguments).then((function(){"function"===typeof n[1]&&n[1].apply(null)}),(function(e){"function"===typeof n[2]&&n[2].apply(null,[e])})):e.apply(this,arguments)}})),["getStats"].forEach((function(n){var e=u.prototype[n];u.prototype[n]=function(){var n=arguments;return"function"===typeof n[1]?e.apply(this,arguments).then((function(){"function"===typeof n[1]&&n[1].apply(null)})):e.apply(this,arguments)}})),u}},function(n,e,t){t(15),n.exports=t(28)},function(n,e){n.exports=function(n){function e(n){"undefined"!==typeof console&&(console.error||console.log)("[Script Loader]",n)}try{"undefined"!==typeof execScript&&"undefined"!==typeof attachEvent&&"undefined"===typeof addEventListener?execScript(n):"undefined"!==typeof eval?eval.call(null,n):e("EvalError: No eval function available")}catch(n){e(n)}}},function(n,e){n.exports='/***\nCopyright (c) 2013-2018, callstats.io\nAll rights reserved.\n\nTHIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"\nAND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE\nIMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE\nARE DISCLAIMED.  IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE\nLIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\nCONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF\nSUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS\nINTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN\nCONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)\nARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE\nPOSSIBILITY OF SUCH DAMAGE.\n***/\n\n/*! callstats  version = 3.53.1 2018-08-07 11-35-59 */\n\n!(function () {\n  function a(b, c, d) {\n    function e(g, h) {\n      if (!c[g]) {\n        if (!b[g]) {\n          var i = "function" == typeof require && require;\n          if (!h && i) return i(g, !0);\n          if (f) return f(g, !0);\n          var j = new Error("Cannot find module \'" + g + "\'");\n          throw ((j.code = "MODULE_NOT_FOUND"), j);\n        }\n        var k = (c[g] = {\n          exports: {},\n        });\n        b[g][0].call(\n          k.exports,\n          function (a) {\n            return e(b[g][1][a] || a);\n          },\n          k,\n          k.exports,\n          a,\n          b,\n          c,\n          d\n        );\n      }\n      return c[g].exports;\n    }\n    for (\n      var f = "function" == typeof require && require, g = 0;\n      g < d.length;\n      g++\n    )\n      e(d[g]);\n    return e;\n  }\n  return a;\n})()(\n  {\n    1: [\n      function (a, b, c) {\n        (function (a, d, e) {\n          !(function (a) {\n            if ("object" == typeof c && void 0 !== b) b.exports = a();\n            else if ("function" == typeof define && define.amd) define([], a);\n            else {\n              var e;\n              "undefined" != typeof window\n                ? (e = window)\n                : void 0 !== d\n                ? (e = d)\n                : "undefined" != typeof self && (e = self),\n                (e.Promise = a());\n            }\n          })(function () {\n            var b, c, f;\n            return (function a(b, c, d) {\n              function e(g, h) {\n                if (!c[g]) {\n                  if (!b[g]) {\n                    var i = "function" == typeof _dereq_ && _dereq_;\n                    if (!h && i) return i(g, !0);\n                    if (f) return f(g, !0);\n                    var j = new Error("Cannot find module \'" + g + "\'");\n                    throw ((j.code = "MODULE_NOT_FOUND"), j);\n                  }\n                  var k = (c[g] = {\n                    exports: {},\n                  });\n                  b[g][0].call(\n                    k.exports,\n                    function (a) {\n                      var c = b[g][1][a];\n                      return e(c || a);\n                    },\n                    k,\n                    k.exports,\n                    a,\n                    b,\n                    c,\n                    d\n                  );\n                }\n                return c[g].exports;\n              }\n              for (\n                var f = "function" == typeof _dereq_ && _dereq_, g = 0;\n                g < d.length;\n                g++\n              )\n                e(d[g]);\n              return e;\n            })(\n              {\n                1: [\n                  function (a, b, c) {\n                    "use strict";\n                    b.exports = function (a) {\n                      function b(a) {\n                        var b = new c(a),\n                          d = b.promise();\n                        return b.setHowMany(1), b.setUnwrap(), b.init(), d;\n                      }\n                      var c = a._SomePromiseArray;\n                      (a.any = function (a) {\n                        return b(a);\n                      }),\n                        (a.prototype.any = function () {\n                          return b(this);\n                        });\n                    };\n                  },\n                  {},\n                ],\n                2: [\n                  function (b, c, d) {\n                    "use strict";\n                    function e() {\n                      (this._customScheduler = !1),\n                        (this._isTickUsed = !1),\n                        (this._lateQueue = new k(16)),\n                        (this._normalQueue = new k(16)),\n                        (this._haveDrainedQueues = !1),\n                        (this._trampolineEnabled = !0);\n                      var a = this;\n                      (this.drainQueues = function () {\n                        a._drainQueues();\n                      }),\n                        (this._schedule = j);\n                    }\n                    function f(a, b, c) {\n                      this._lateQueue.push(a, b, c), this._queueTick();\n                    }\n                    function g(a, b, c) {\n                      this._normalQueue.push(a, b, c), this._queueTick();\n                    }\n                    function h(a) {\n                      this._normalQueue._pushOne(a), this._queueTick();\n                    }\n                    var i;\n                    try {\n                      throw new Error();\n                    } catch (a) {\n                      i = a;\n                    }\n                    var j = b("./schedule"),\n                      k = b("./queue"),\n                      l = b("./util");\n                    (e.prototype.setScheduler = function (a) {\n                      var b = this._schedule;\n                      return (\n                        (this._schedule = a), (this._customScheduler = !0), b\n                      );\n                    }),\n                      (e.prototype.hasCustomScheduler = function () {\n                        return this._customScheduler;\n                      }),\n                      (e.prototype.enableTrampoline = function () {\n                        this._trampolineEnabled = !0;\n                      }),\n                      (e.prototype.disableTrampolineIfNecessary = function () {\n                        l.hasDevTools && (this._trampolineEnabled = !1);\n                      }),\n                      (e.prototype.haveItemsQueued = function () {\n                        return this._isTickUsed || this._haveDrainedQueues;\n                      }),\n                      (e.prototype.fatalError = function (b, c) {\n                        c\n                          ? (a.stderr.write(\n                              "Fatal " +\n                                (b instanceof Error ? b.stack : b) +\n                                "\\n"\n                            ),\n                            a.exit(2))\n                          : this.throwLater(b);\n                      }),\n                      (e.prototype.throwLater = function (a, b) {\n                        if (\n                          (1 === arguments.length &&\n                            ((b = a),\n                            (a = function () {\n                              throw b;\n                            })),\n                          "undefined" != typeof setTimeout)\n                        )\n                          setTimeout(function () {\n                            a(b);\n                          }, 0);\n                        else\n                          try {\n                            this._schedule(function () {\n                              a(b);\n                            });\n                          } catch (a) {\n                            throw new Error(\n                              "No async scheduler available\\n\\n    See http://goo.gl/MqrFmX\\n"\n                            );\n                          }\n                      }),\n                      l.hasDevTools\n                        ? ((e.prototype.invokeLater = function (a, b, c) {\n                            this._trampolineEnabled\n                              ? f.call(this, a, b, c)\n                              : this._schedule(function () {\n                                  setTimeout(function () {\n                                    a.call(b, c);\n                                  }, 100);\n                                });\n                          }),\n                          (e.prototype.invoke = function (a, b, c) {\n                            this._trampolineEnabled\n                              ? g.call(this, a, b, c)\n                              : this._schedule(function () {\n                                  a.call(b, c);\n                                });\n                          }),\n                          (e.prototype.settlePromises = function (a) {\n                            this._trampolineEnabled\n                              ? h.call(this, a)\n                              : this._schedule(function () {\n                                  a._settlePromises();\n                                });\n                          }))\n                        : ((e.prototype.invokeLater = f),\n                          (e.prototype.invoke = g),\n                          (e.prototype.settlePromises = h)),\n                      (e.prototype._drainQueue = function (a) {\n                        for (; a.length() > 0; ) {\n                          var b = a.shift();\n                          if ("function" == typeof b) {\n                            var c = a.shift(),\n                              d = a.shift();\n                            b.call(c, d);\n                          } else b._settlePromises();\n                        }\n                      }),\n                      (e.prototype._drainQueues = function () {\n                        this._drainQueue(this._normalQueue),\n                          this._reset(),\n                          (this._haveDrainedQueues = !0),\n                          this._drainQueue(this._lateQueue);\n                      }),\n                      (e.prototype._queueTick = function () {\n                        this._isTickUsed ||\n                          ((this._isTickUsed = !0),\n                          this._schedule(this.drainQueues));\n                      }),\n                      (e.prototype._reset = function () {\n                        this._isTickUsed = !1;\n                      }),\n                      (c.exports = e),\n                      (c.exports.firstLineError = i);\n                  },\n                  {\n                    "./queue": 26,\n                    "./schedule": 29,\n                    "./util": 36,\n                  },\n                ],\n                3: [\n                  function (a, b, c) {\n                    "use strict";\n                    b.exports = function (a, b, c, d) {\n                      var e = !1,\n                        f = function (a, b) {\n                          this._reject(b);\n                        },\n                        g = function (a, b) {\n                          (b.promiseRejectionQueued = !0),\n                            b.bindingPromise._then(f, f, null, this, a);\n                        },\n                        h = function (a, b) {\n                          0 == (50397184 & this._bitField) &&\n                            this._resolveCallback(b.target);\n                        },\n                        i = function (a, b) {\n                          b.promiseRejectionQueued || this._reject(a);\n                        };\n                      (a.prototype.bind = function (f) {\n                        e ||\n                          ((e = !0),\n                          (a.prototype._propagateFrom = d.propagateFromFunction()),\n                          (a.prototype._boundValue = d.boundValueFunction()));\n                        var j = c(f),\n                          k = new a(b);\n                        k._propagateFrom(this, 1);\n                        var l = this._target();\n                        if ((k._setBoundTo(j), j instanceof a)) {\n                          var m = {\n                            promiseRejectionQueued: !1,\n                            promise: k,\n                            target: l,\n                            bindingPromise: j,\n                          };\n                          l._then(b, g, void 0, k, m),\n                            j._then(h, i, void 0, k, m),\n                            k._setOnCancel(j);\n                        } else k._resolveCallback(l);\n                        return k;\n                      }),\n                        (a.prototype._setBoundTo = function (a) {\n                          void 0 !== a\n                            ? ((this._bitField = 2097152 | this._bitField),\n                              (this._boundTo = a))\n                            : (this._bitField = -2097153 & this._bitField);\n                        }),\n                        (a.prototype._isBound = function () {\n                          return 2097152 == (2097152 & this._bitField);\n                        }),\n                        (a.bind = function (b, c) {\n                          return a.resolve(c).bind(b);\n                        });\n                    };\n                  },\n                  {},\n                ],\n                4: [\n                  function (a, b, c) {\n                    "use strict";\n                    function d() {\n                      try {\n                        Promise === f && (Promise = e);\n                      } catch (a) {}\n                      return f;\n                    }\n                    var e;\n                    "undefined" != typeof Promise && (e = Promise);\n                    var f = a("./promise")();\n                    (f.noConflict = d), (b.exports = f);\n                  },\n                  {\n                    "./promise": 22,\n                  },\n                ],\n                5: [\n                  function (a, b, c) {\n                    "use strict";\n                    var d = Object.create;\n                    if (d) {\n                      var e = d(null),\n                        f = d(null);\n                      e[" size"] = f[" size"] = 0;\n                    }\n                    b.exports = function (b) {\n                      function c(a, c) {\n                        var d;\n                        if ((null != a && (d = a[c]), "function" != typeof d)) {\n                          var e =\n                            "Object " +\n                            h.classString(a) +\n                            " has no method \'" +\n                            h.toString(c) +\n                            "\'";\n                          throw new b.TypeError(e);\n                        }\n                        return d;\n                      }\n                      function d(a) {\n                        return c(a, this.pop()).apply(a, this);\n                      }\n                      function e(a) {\n                        return a[this];\n                      }\n                      function f(a) {\n                        var b = +this;\n                        return b < 0 && (b = Math.max(0, b + a.length)), a[b];\n                      }\n                      var g,\n                        h = a("./util"),\n                        i = h.canEvaluate;\n                      h.isIdentifier;\n                      (b.prototype.call = function (a) {\n                        var b = [].slice.call(arguments, 1);\n                        return (\n                          b.push(a), this._then(d, void 0, void 0, b, void 0)\n                        );\n                      }),\n                        (b.prototype.get = function (a) {\n                          var b,\n                            c = "number" == typeof a;\n                          if (c) b = f;\n                          else if (i) {\n                            var d = g(a);\n                            b = null !== d ? d : e;\n                          } else b = e;\n                          return this._then(b, void 0, void 0, a, void 0);\n                        });\n                    };\n                  },\n                  {\n                    "./util": 36,\n                  },\n                ],\n                6: [\n                  function (a, b, c) {\n                    "use strict";\n                    b.exports = function (b, c, d, e) {\n                      var f = a("./util"),\n                        g = f.tryCatch,\n                        h = f.errorObj,\n                        i = b._async;\n                      (b.prototype.break = b.prototype.cancel = function () {\n                        if (!e.cancellation())\n                          return this._warn("cancellation is disabled");\n                        for (var a = this, b = a; a._isCancellable(); ) {\n                          if (!a._cancelBy(b)) {\n                            b._isFollowing()\n                              ? b._followee().cancel()\n                              : b._cancelBranched();\n                            break;\n                          }\n                          var c = a._cancellationParent;\n                          if (null == c || !c._isCancellable()) {\n                            a._isFollowing()\n                              ? a._followee().cancel()\n                              : a._cancelBranched();\n                            break;\n                          }\n                          a._isFollowing() && a._followee().cancel(),\n                            a._setWillBeCancelled(),\n                            (b = a),\n                            (a = c);\n                        }\n                      }),\n                        (b.prototype._branchHasCancelled = function () {\n                          this._branchesRemainingToCancel--;\n                        }),\n                        (b.prototype._enoughBranchesHaveCancelled = function () {\n                          return (\n                            void 0 === this._branchesRemainingToCancel ||\n                            this._branchesRemainingToCancel <= 0\n                          );\n                        }),\n                        (b.prototype._cancelBy = function (a) {\n                          return a === this\n                            ? ((this._branchesRemainingToCancel = 0),\n                              this._invokeOnCancel(),\n                              !0)\n                            : (this._branchHasCancelled(),\n                              !!this._enoughBranchesHaveCancelled() &&\n                                (this._invokeOnCancel(), !0));\n                        }),\n                        (b.prototype._cancelBranched = function () {\n                          this._enoughBranchesHaveCancelled() && this._cancel();\n                        }),\n                        (b.prototype._cancel = function () {\n                          this._isCancellable() &&\n                            (this._setCancelled(),\n                            i.invoke(this._cancelPromises, this, void 0));\n                        }),\n                        (b.prototype._cancelPromises = function () {\n                          this._length() > 0 && this._settlePromises();\n                        }),\n                        (b.prototype._unsetOnCancel = function () {\n                          this._onCancelField = void 0;\n                        }),\n                        (b.prototype._isCancellable = function () {\n                          return this.isPending() && !this._isCancelled();\n                        }),\n                        (b.prototype.isCancellable = function () {\n                          return this.isPending() && !this.isCancelled();\n                        }),\n                        (b.prototype._doInvokeOnCancel = function (a, b) {\n                          if (f.isArray(a))\n                            for (var c = 0; c < a.length; ++c)\n                              this._doInvokeOnCancel(a[c], b);\n                          else if (void 0 !== a)\n                            if ("function" == typeof a) {\n                              if (!b) {\n                                var d = g(a).call(this._boundValue());\n                                d === h &&\n                                  (this._attachExtraTrace(d.e),\n                                  i.throwLater(d.e));\n                              }\n                            } else a._resultCancelled(this);\n                        }),\n                        (b.prototype._invokeOnCancel = function () {\n                          var a = this._onCancel();\n                          this._unsetOnCancel(),\n                            i.invoke(this._doInvokeOnCancel, this, a);\n                        }),\n                        (b.prototype._invokeInternalOnCancel = function () {\n                          this._isCancellable() &&\n                            (this._doInvokeOnCancel(this._onCancel(), !0),\n                            this._unsetOnCancel());\n                        }),\n                        (b.prototype._resultCancelled = function () {\n                          this.cancel();\n                        });\n                    };\n                  },\n                  {\n                    "./util": 36,\n                  },\n                ],\n                7: [\n                  function (a, b, c) {\n                    "use strict";\n                    b.exports = function (b) {\n                      function c(a, c, h) {\n                        return function (i) {\n                          var j = h._boundValue();\n                          a: for (var k = 0; k < a.length; ++k) {\n                            var l = a[k];\n                            if (\n                              l === Error ||\n                              (null != l && l.prototype instanceof Error)\n                            ) {\n                              if (i instanceof l) return f(c).call(j, i);\n                            } else if ("function" == typeof l) {\n                              var m = f(l).call(j, i);\n                              if (m === g) return m;\n                              if (m) return f(c).call(j, i);\n                            } else if (d.isObject(i)) {\n                              for (var n = e(l), o = 0; o < n.length; ++o) {\n                                var p = n[o];\n                                if (l[p] != i[p]) continue a;\n                              }\n                              return f(c).call(j, i);\n                            }\n                          }\n                          return b;\n                        };\n                      }\n                      var d = a("./util"),\n                        e = a("./es5").keys,\n                        f = d.tryCatch,\n                        g = d.errorObj;\n                      return c;\n                    };\n                  },\n                  {\n                    "./es5": 13,\n                    "./util": 36,\n                  },\n                ],\n                8: [\n                  function (a, b, c) {\n                    "use strict";\n                    b.exports = function (a) {\n                      function b() {\n                        this._trace = new b.CapturedTrace(d());\n                      }\n                      function c() {\n                        if (e) return new b();\n                      }\n                      function d() {\n                        var a = f.length - 1;\n                        if (a >= 0) return f[a];\n                      }\n                      var e = !1,\n                        f = [];\n                      return (\n                        (a.prototype._promiseCreated = function () {}),\n                        (a.prototype._pushContext = function () {}),\n                        (a.prototype._popContext = function () {\n                          return null;\n                        }),\n                        (a._peekContext = a.prototype._peekContext = function () {}),\n                        (b.prototype._pushContext = function () {\n                          void 0 !== this._trace &&\n                            ((this._trace._promiseCreated = null),\n                            f.push(this._trace));\n                        }),\n                        (b.prototype._popContext = function () {\n                          if (void 0 !== this._trace) {\n                            var a = f.pop(),\n                              b = a._promiseCreated;\n                            return (a._promiseCreated = null), b;\n                          }\n                          return null;\n                        }),\n                        (b.CapturedTrace = null),\n                        (b.create = c),\n                        (b.deactivateLongStackTraces = function () {}),\n                        (b.activateLongStackTraces = function () {\n                          var c = a.prototype._pushContext,\n                            f = a.prototype._popContext,\n                            g = a._peekContext,\n                            h = a.prototype._peekContext,\n                            i = a.prototype._promiseCreated;\n                          (b.deactivateLongStackTraces = function () {\n                            (a.prototype._pushContext = c),\n                              (a.prototype._popContext = f),\n                              (a._peekContext = g),\n                              (a.prototype._peekContext = h),\n                              (a.prototype._promiseCreated = i),\n                              (e = !1);\n                          }),\n                            (e = !0),\n                            (a.prototype._pushContext =\n                              b.prototype._pushContext),\n                            (a.prototype._popContext = b.prototype._popContext),\n                            (a._peekContext = a.prototype._peekContext = d),\n                            (a.prototype._promiseCreated = function () {\n                              var a = this._peekContext();\n                              a &&\n                                null == a._promiseCreated &&\n                                (a._promiseCreated = this);\n                            });\n                        }),\n                        b\n                      );\n                    };\n                  },\n                  {},\n                ],\n                9: [\n                  function (b, c, d) {\n                    "use strict";\n                    c.exports = function (c, d) {\n                      function e(a, b) {\n                        return {\n                          promise: b,\n                        };\n                      }\n                      function f() {\n                        return !1;\n                      }\n                      function g(a, b, c) {\n                        var d = this;\n                        try {\n                          a(b, c, function (a) {\n                            if ("function" != typeof a)\n                              throw new TypeError(\n                                "onCancel must be a function, got: " +\n                                  N.toString(a)\n                              );\n                            d._attachCancellationCallback(a);\n                          });\n                        } catch (a) {\n                          return a;\n                        }\n                      }\n                      function h(a) {\n                        if (!this._isCancellable()) return this;\n                        var b = this._onCancel();\n                        void 0 !== b\n                          ? N.isArray(b)\n                            ? b.push(a)\n                            : this._setOnCancel([b, a])\n                          : this._setOnCancel(a);\n                      }\n                      function i() {\n                        return this._onCancelField;\n                      }\n                      function j(a) {\n                        this._onCancelField = a;\n                      }\n                      function k() {\n                        (this._cancellationParent = void 0),\n                          (this._onCancelField = void 0);\n                      }\n                      function l(a, b) {\n                        if (0 != (1 & b)) {\n                          this._cancellationParent = a;\n                          var c = a._branchesRemainingToCancel;\n                          void 0 === c && (c = 0),\n                            (a._branchesRemainingToCancel = c + 1);\n                        }\n                        0 != (2 & b) &&\n                          a._isBound() &&\n                          this._setBoundTo(a._boundTo);\n                      }\n                      function m(a, b) {\n                        0 != (2 & b) &&\n                          a._isBound() &&\n                          this._setBoundTo(a._boundTo);\n                      }\n                      function n() {\n                        var a = this._boundTo;\n                        return void 0 !== a && a instanceof c\n                          ? a.isFulfilled()\n                            ? a.value()\n                            : void 0\n                          : a;\n                      }\n                      function o() {\n                        this._trace = new G(this._peekContext());\n                      }\n                      function p(a, b) {\n                        if (O(a)) {\n                          var c = this._trace;\n                          if (\n                            (void 0 !== c && b && (c = c._parent), void 0 !== c)\n                          )\n                            c.attachExtraTrace(a);\n                          else if (!a.__stackCleaned__) {\n                            var d = y(a);\n                            N.notEnumerableProp(\n                              a,\n                              "stack",\n                              d.message + "\\n" + d.stack.join("\\n")\n                            ),\n                              N.notEnumerableProp(a, "__stackCleaned__", !0);\n                          }\n                        }\n                      }\n                      function q(a, b, c, d, e) {\n                        if (void 0 === a && null !== b && Y) {\n                          if (void 0 !== e && e._returnedNonUndefined()) return;\n                          if (0 == (65535 & d._bitField)) return;\n                          c && (c += " ");\n                          var f = "",\n                            g = "";\n                          if (b._trace) {\n                            for (\n                              var h = b._trace.stack.split("\\n"),\n                                i = w(h),\n                                j = i.length - 1;\n                              j >= 0;\n                              --j\n                            ) {\n                              var k = i[j];\n                              if (!Q.test(k)) {\n                                var l = k.match(R);\n                                l &&\n                                  (f =\n                                    "at " +\n                                    l[1] +\n                                    ":" +\n                                    l[2] +\n                                    ":" +\n                                    l[3] +\n                                    " ");\n                                break;\n                              }\n                            }\n                            if (i.length > 0)\n                              for (var m = i[0], j = 0; j < h.length; ++j)\n                                if (h[j] === m) {\n                                  j > 0 && (g = "\\n" + h[j - 1]);\n                                  break;\n                                }\n                          }\n                          var n =\n                            "a promise was created in a " +\n                            c +\n                            "handler " +\n                            f +\n                            "but was not returned from it, see http://goo.gl/rRqMUw" +\n                            g;\n                          d._warn(n, !0, b);\n                        }\n                      }\n                      function r(a, b) {\n                        var c =\n                          a +\n                          " is deprecated and will be removed in a future version.";\n                        return b && (c += " Use " + b + " instead."), s(c);\n                      }\n                      function s(a, b, d) {\n                        if (ga.warnings) {\n                          var e,\n                            f = new M(a);\n                          if (b) d._attachExtraTrace(f);\n                          else if (ga.longStackTraces && (e = c._peekContext()))\n                            e.attachExtraTrace(f);\n                          else {\n                            var g = y(f);\n                            f.stack = g.message + "\\n" + g.stack.join("\\n");\n                          }\n                          ba("warning", f) || z(f, "", !0);\n                        }\n                      }\n                      function t(a, b) {\n                        for (var c = 0; c < b.length - 1; ++c)\n                          b[c].push("From previous event:"),\n                            (b[c] = b[c].join("\\n"));\n                        return (\n                          c < b.length && (b[c] = b[c].join("\\n")),\n                          a + "\\n" + b.join("\\n")\n                        );\n                      }\n                      function u(a) {\n                        for (var b = 0; b < a.length; ++b)\n                          (0 === a[b].length ||\n                            (b + 1 < a.length && a[b][0] === a[b + 1][0])) &&\n                            (a.splice(b, 1), b--);\n                      }\n                      function v(a) {\n                        for (var b = a[0], c = 1; c < a.length; ++c) {\n                          for (\n                            var d = a[c],\n                              e = b.length - 1,\n                              f = b[e],\n                              g = -1,\n                              h = d.length - 1;\n                            h >= 0;\n                            --h\n                          )\n                            if (d[h] === f) {\n                              g = h;\n                              break;\n                            }\n                          for (var h = g; h >= 0; --h) {\n                            var i = d[h];\n                            if (b[e] !== i) break;\n                            b.pop(), e--;\n                          }\n                          b = d;\n                        }\n                      }\n                      function w(a) {\n                        for (var b = [], c = 0; c < a.length; ++c) {\n                          var d = a[c],\n                            e = "    (No stack trace)" === d || S.test(d),\n                            f = e && da(d);\n                          e &&\n                            !f &&\n                            (U && " " !== d.charAt(0) && (d = "    " + d),\n                            b.push(d));\n                        }\n                        return b;\n                      }\n                      function x(a) {\n                        for (\n                          var b = a.stack.replace(/\\s+$/g, "").split("\\n"),\n                            c = 0;\n                          c < b.length;\n                          ++c\n                        ) {\n                          var d = b[c];\n                          if ("    (No stack trace)" === d || S.test(d)) break;\n                        }\n                        return (\n                          c > 0 && "SyntaxError" != a.name && (b = b.slice(c)),\n                          b\n                        );\n                      }\n                      function y(a) {\n                        var b = a.stack,\n                          c = a.toString();\n                        return (\n                          (b =\n                            "string" == typeof b && b.length > 0\n                              ? x(a)\n                              : ["    (No stack trace)"]),\n                          {\n                            message: c,\n                            stack: "SyntaxError" == a.name ? b : w(b),\n                          }\n                        );\n                      }\n                      function z(a, b, c) {\n                        if ("undefined" != typeof console) {\n                          var d;\n                          if (N.isObject(a)) {\n                            var e = a.stack;\n                            d = b + T(e, a);\n                          } else d = b + String(a);\n                          "function" == typeof J\n                            ? J(d, c)\n                            : ("function" != typeof console.log &&\n                                "object" != typeof console.log) ||\n                              console.log(d);\n                        }\n                      }\n                      function A(a, b, c, d) {\n                        var e = !1;\n                        try {\n                          "function" == typeof b &&\n                            ((e = !0),\n                            "rejectionHandled" === a ? b(d) : b(c, d));\n                        } catch (a) {\n                          L.throwLater(a);\n                        }\n                        "unhandledRejection" === a\n                          ? ba(a, c, d) || e || z(c, "Unhandled rejection ")\n                          : ba(a, d);\n                      }\n                      function B(a) {\n                        var b;\n                        if ("function" == typeof a)\n                          b = "[function " + (a.name || "anonymous") + "]";\n                        else {\n                          b =\n                            a && "function" == typeof a.toString\n                              ? a.toString()\n                              : N.toString(a);\n                          if (/\\[object [a-zA-Z0-9$_]+\\]/.test(b))\n                            try {\n                              b = JSON.stringify(a);\n                            } catch (a) {}\n                          0 === b.length && (b = "(empty array)");\n                        }\n                        return "(<" + C(b) + ">, no stack trace)";\n                      }\n                      function C(a) {\n                        return a.length < 41 ? a : a.substr(0, 38) + "...";\n                      }\n                      function D() {\n                        return "function" == typeof fa;\n                      }\n                      function E(a) {\n                        var b = a.match(ea);\n                        if (b)\n                          return {\n                            fileName: b[1],\n                            line: parseInt(b[2], 10),\n                          };\n                      }\n                      function F(a, b) {\n                        if (D()) {\n                          for (\n                            var c,\n                              d,\n                              e = a.stack.split("\\n"),\n                              f = b.stack.split("\\n"),\n                              g = -1,\n                              h = -1,\n                              i = 0;\n                            i < e.length;\n                            ++i\n                          ) {\n                            var j = E(e[i]);\n                            if (j) {\n                              (c = j.fileName), (g = j.line);\n                              break;\n                            }\n                          }\n                          for (var i = 0; i < f.length; ++i) {\n                            var j = E(f[i]);\n                            if (j) {\n                              (d = j.fileName), (h = j.line);\n                              break;\n                            }\n                          }\n                          g < 0 ||\n                            h < 0 ||\n                            !c ||\n                            !d ||\n                            c !== d ||\n                            g >= h ||\n                            (da = function (a) {\n                              if (P.test(a)) return !0;\n                              var b = E(a);\n                              return !!(\n                                b &&\n                                b.fileName === c &&\n                                g <= b.line &&\n                                b.line <= h\n                              );\n                            });\n                        }\n                      }\n                      function G(a) {\n                        (this._parent = a), (this._promisesCreated = 0);\n                        var b = (this._length =\n                          1 + (void 0 === a ? 0 : a._length));\n                        fa(this, G), b > 32 && this.uncycle();\n                      }\n                      var H,\n                        I,\n                        J,\n                        K = c._getDomain,\n                        L = c._async,\n                        M = b("./errors").Warning,\n                        N = b("./util"),\n                        O = N.canAttachTrace,\n                        P = /[\\\\\\/]bluebird[\\\\\\/]js[\\\\\\/](release|debug|instrumented)/,\n                        Q = /\\((?:timers\\.js):\\d+:\\d+\\)/,\n                        R = /[\\/<\\(](.+?):(\\d+):(\\d+)\\)?\\s*$/,\n                        S = null,\n                        T = null,\n                        U = !1,\n                        V = !(0 == N.env("BLUEBIRD_DEBUG")),\n                        W = !(\n                          0 == N.env("BLUEBIRD_WARNINGS") ||\n                          (!V && !N.env("BLUEBIRD_WARNINGS"))\n                        ),\n                        X = !(\n                          0 == N.env("BLUEBIRD_LONG_STACK_TRACES") ||\n                          (!V && !N.env("BLUEBIRD_LONG_STACK_TRACES"))\n                        ),\n                        Y =\n                          0 != N.env("BLUEBIRD_W_FORGOTTEN_RETURN") &&\n                          (W || !!N.env("BLUEBIRD_W_FORGOTTEN_RETURN"));\n                      (c.prototype.suppressUnhandledRejections = function () {\n                        var a = this._target();\n                        a._bitField = (-1048577 & a._bitField) | 524288;\n                      }),\n                        (c.prototype._ensurePossibleRejectionHandled = function () {\n                          if (0 == (524288 & this._bitField)) {\n                            this._setRejectionIsUnhandled();\n                            var a = this;\n                            setTimeout(function () {\n                              a._notifyUnhandledRejection();\n                            }, 1);\n                          }\n                        }),\n                        (c.prototype._notifyUnhandledRejectionIsHandled = function () {\n                          A("rejectionHandled", H, void 0, this);\n                        }),\n                        (c.prototype._setReturnedNonUndefined = function () {\n                          this._bitField = 268435456 | this._bitField;\n                        }),\n                        (c.prototype._returnedNonUndefined = function () {\n                          return 0 != (268435456 & this._bitField);\n                        }),\n                        (c.prototype._notifyUnhandledRejection = function () {\n                          if (this._isRejectionUnhandled()) {\n                            var a = this._settledValue();\n                            this._setUnhandledRejectionIsNotified(),\n                              A("unhandledRejection", I, a, this);\n                          }\n                        }),\n                        (c.prototype._setUnhandledRejectionIsNotified = function () {\n                          this._bitField = 262144 | this._bitField;\n                        }),\n                        (c.prototype._unsetUnhandledRejectionIsNotified = function () {\n                          this._bitField = -262145 & this._bitField;\n                        }),\n                        (c.prototype._isUnhandledRejectionNotified = function () {\n                          return (262144 & this._bitField) > 0;\n                        }),\n                        (c.prototype._setRejectionIsUnhandled = function () {\n                          this._bitField = 1048576 | this._bitField;\n                        }),\n                        (c.prototype._unsetRejectionIsUnhandled = function () {\n                          (this._bitField = -1048577 & this._bitField),\n                            this._isUnhandledRejectionNotified() &&\n                              (this._unsetUnhandledRejectionIsNotified(),\n                              this._notifyUnhandledRejectionIsHandled());\n                        }),\n                        (c.prototype._isRejectionUnhandled = function () {\n                          return (1048576 & this._bitField) > 0;\n                        }),\n                        (c.prototype._warn = function (a, b, c) {\n                          return s(a, b, c || this);\n                        }),\n                        (c.onPossiblyUnhandledRejection = function (a) {\n                          var b = K();\n                          I =\n                            "function" == typeof a\n                              ? null === b\n                                ? a\n                                : N.domainBind(b, a)\n                              : void 0;\n                        }),\n                        (c.onUnhandledRejectionHandled = function (a) {\n                          var b = K();\n                          H =\n                            "function" == typeof a\n                              ? null === b\n                                ? a\n                                : N.domainBind(b, a)\n                              : void 0;\n                        });\n                      var Z = function () {};\n                      (c.longStackTraces = function () {\n                        if (L.haveItemsQueued() && !ga.longStackTraces)\n                          throw new Error(\n                            "cannot enable long stack traces after promises have been created\\n\\n    See http://goo.gl/MqrFmX\\n"\n                          );\n                        if (!ga.longStackTraces && D()) {\n                          var a = c.prototype._captureStackTrace,\n                            b = c.prototype._attachExtraTrace;\n                          (ga.longStackTraces = !0),\n                            (Z = function () {\n                              if (L.haveItemsQueued() && !ga.longStackTraces)\n                                throw new Error(\n                                  "cannot enable long stack traces after promises have been created\\n\\n    See http://goo.gl/MqrFmX\\n"\n                                );\n                              (c.prototype._captureStackTrace = a),\n                                (c.prototype._attachExtraTrace = b),\n                                d.deactivateLongStackTraces(),\n                                L.enableTrampoline(),\n                                (ga.longStackTraces = !1);\n                            }),\n                            (c.prototype._captureStackTrace = o),\n                            (c.prototype._attachExtraTrace = p),\n                            d.activateLongStackTraces(),\n                            L.disableTrampolineIfNecessary();\n                        }\n                      }),\n                        (c.hasLongStackTraces = function () {\n                          return ga.longStackTraces && D();\n                        });\n                      var $ = (function () {\n                          try {\n                            if ("function" == typeof CustomEvent) {\n                              var a = new CustomEvent("CustomEvent");\n                              return (\n                                N.global.dispatchEvent(a),\n                                function (a, b) {\n                                  var c = new CustomEvent(a.toLowerCase(), {\n                                    detail: b,\n                                    cancelable: !0,\n                                  });\n                                  return !N.global.dispatchEvent(c);\n                                }\n                              );\n                            }\n                            if ("function" == typeof Event) {\n                              var a = new Event("CustomEvent");\n                              return (\n                                N.global.dispatchEvent(a),\n                                function (a, b) {\n                                  var c = new Event(a.toLowerCase(), {\n                                    cancelable: !0,\n                                  });\n                                  return (\n                                    (c.detail = b), !N.global.dispatchEvent(c)\n                                  );\n                                }\n                              );\n                            }\n                            var a = document.createEvent("CustomEvent");\n                            return (\n                              a.initCustomEvent("testingtheevent", !1, !0, {}),\n                              N.global.dispatchEvent(a),\n                              function (a, b) {\n                                var c = document.createEvent("CustomEvent");\n                                return (\n                                  c.initCustomEvent(a.toLowerCase(), !1, !0, b),\n                                  !N.global.dispatchEvent(c)\n                                );\n                              }\n                            );\n                          } catch (a) {}\n                          return function () {\n                            return !1;\n                          };\n                        })(),\n                        _ = (function () {\n                          return N.isNode\n                            ? function () {\n                                return a.emit.apply(a, arguments);\n                              }\n                            : N.global\n                            ? function (a) {\n                                var b = "on" + a.toLowerCase(),\n                                  c = N.global[b];\n                                return (\n                                  !!c &&\n                                  (c.apply(\n                                    N.global,\n                                    [].slice.call(arguments, 1)\n                                  ),\n                                  !0)\n                                );\n                              }\n                            : function () {\n                                return !1;\n                              };\n                        })(),\n                        aa = {\n                          promiseCreated: e,\n                          promiseFulfilled: e,\n                          promiseRejected: e,\n                          promiseResolved: e,\n                          promiseCancelled: e,\n                          promiseChained: function (a, b, c) {\n                            return {\n                              promise: b,\n                              child: c,\n                            };\n                          },\n                          warning: function (a, b) {\n                            return {\n                              warning: b,\n                            };\n                          },\n                          unhandledRejection: function (a, b, c) {\n                            return {\n                              reason: b,\n                              promise: c,\n                            };\n                          },\n                          rejectionHandled: e,\n                        },\n                        ba = function (a) {\n                          var b = !1;\n                          try {\n                            b = _.apply(null, arguments);\n                          } catch (a) {\n                            L.throwLater(a), (b = !0);\n                          }\n                          var c = !1;\n                          try {\n                            c = $(a, aa[a].apply(null, arguments));\n                          } catch (a) {\n                            L.throwLater(a), (c = !0);\n                          }\n                          return c || b;\n                        };\n                      (c.config = function (a) {\n                        if (\n                          ((a = Object(a)),\n                          "longStackTraces" in a &&\n                            (a.longStackTraces\n                              ? c.longStackTraces()\n                              : !a.longStackTraces &&\n                                c.hasLongStackTraces() &&\n                                Z()),\n                          "warnings" in a)\n                        ) {\n                          var b = a.warnings;\n                          (ga.warnings = !!b),\n                            (Y = ga.warnings),\n                            N.isObject(b) &&\n                              "wForgottenReturn" in b &&\n                              (Y = !!b.wForgottenReturn);\n                        }\n                        if (\n                          "cancellation" in a &&\n                          a.cancellation &&\n                          !ga.cancellation\n                        ) {\n                          if (L.haveItemsQueued())\n                            throw new Error(\n                              "cannot enable cancellation after promises are in use"\n                            );\n                          (c.prototype._clearCancellationData = k),\n                            (c.prototype._propagateFrom = l),\n                            (c.prototype._onCancel = i),\n                            (c.prototype._setOnCancel = j),\n                            (c.prototype._attachCancellationCallback = h),\n                            (c.prototype._execute = g),\n                            (ca = l),\n                            (ga.cancellation = !0);\n                        }\n                        return (\n                          "monitoring" in a &&\n                            (a.monitoring && !ga.monitoring\n                              ? ((ga.monitoring = !0),\n                                (c.prototype._fireEvent = ba))\n                              : !a.monitoring &&\n                                ga.monitoring &&\n                                ((ga.monitoring = !1),\n                                (c.prototype._fireEvent = f))),\n                          c\n                        );\n                      }),\n                        (c.prototype._fireEvent = f),\n                        (c.prototype._execute = function (a, b, c) {\n                          try {\n                            a(b, c);\n                          } catch (a) {\n                            return a;\n                          }\n                        }),\n                        (c.prototype._onCancel = function () {}),\n                        (c.prototype._setOnCancel = function (a) {}),\n                        (c.prototype._attachCancellationCallback = function (\n                          a\n                        ) {}),\n                        (c.prototype._captureStackTrace = function () {}),\n                        (c.prototype._attachExtraTrace = function () {}),\n                        (c.prototype._clearCancellationData = function () {}),\n                        (c.prototype._propagateFrom = function (a, b) {});\n                      var ca = m,\n                        da = function () {\n                          return !1;\n                        },\n                        ea = /[\\/<\\(]([^:\\/]+):(\\d+):(?:\\d+)\\)?\\s*$/;\n                      N.inherits(G, Error),\n                        (d.CapturedTrace = G),\n                        (G.prototype.uncycle = function () {\n                          var a = this._length;\n                          if (!(a < 2)) {\n                            for (\n                              var b = [], c = {}, d = 0, e = this;\n                              void 0 !== e;\n                              ++d\n                            )\n                              b.push(e), (e = e._parent);\n                            a = this._length = d;\n                            for (var d = a - 1; d >= 0; --d) {\n                              var f = b[d].stack;\n                              void 0 === c[f] && (c[f] = d);\n                            }\n                            for (var d = 0; d < a; ++d) {\n                              var g = b[d].stack,\n                                h = c[g];\n                              if (void 0 !== h && h !== d) {\n                                h > 0 &&\n                                  ((b[h - 1]._parent = void 0),\n                                  (b[h - 1]._length = 1)),\n                                  (b[d]._parent = void 0),\n                                  (b[d]._length = 1);\n                                var i = d > 0 ? b[d - 1] : this;\n                                h < a - 1\n                                  ? ((i._parent = b[h + 1]),\n                                    i._parent.uncycle(),\n                                    (i._length = i._parent._length + 1))\n                                  : ((i._parent = void 0), (i._length = 1));\n                                for (\n                                  var j = i._length + 1, k = d - 2;\n                                  k >= 0;\n                                  --k\n                                )\n                                  (b[k]._length = j), j++;\n                                return;\n                              }\n                            }\n                          }\n                        }),\n                        (G.prototype.attachExtraTrace = function (a) {\n                          if (!a.__stackCleaned__) {\n                            this.uncycle();\n                            for (\n                              var b = y(a),\n                                c = b.message,\n                                d = [b.stack],\n                                e = this;\n                              void 0 !== e;\n\n                            )\n                              d.push(w(e.stack.split("\\n"))), (e = e._parent);\n                            v(d),\n                              u(d),\n                              N.notEnumerableProp(a, "stack", t(c, d)),\n                              N.notEnumerableProp(a, "__stackCleaned__", !0);\n                          }\n                        });\n                      var fa = (function () {\n                        var a = /^\\s*at\\s*/,\n                          b = function (a, b) {\n                            return "string" == typeof a\n                              ? a\n                              : void 0 !== b.name && void 0 !== b.message\n                              ? b.toString()\n                              : B(b);\n                          };\n                        if (\n                          "number" == typeof Error.stackTraceLimit &&\n                          "function" == typeof Error.captureStackTrace\n                        ) {\n                          (Error.stackTraceLimit += 6), (S = a), (T = b);\n                          var c = Error.captureStackTrace;\n                          return (\n                            (da = function (a) {\n                              return P.test(a);\n                            }),\n                            function (a, b) {\n                              (Error.stackTraceLimit += 6),\n                                c(a, b),\n                                (Error.stackTraceLimit -= 6);\n                            }\n                          );\n                        }\n                        var d = new Error();\n                        if (\n                          "string" == typeof d.stack &&\n                          d.stack.split("\\n")[0].indexOf("stackDetection@") >= 0\n                        )\n                          return (\n                            (S = /@/),\n                            (T = b),\n                            (U = !0),\n                            function (a) {\n                              a.stack = new Error().stack;\n                            }\n                          );\n                        var e;\n                        try {\n                          throw new Error();\n                        } catch (a) {\n                          e = "stack" in a;\n                        }\n                        return "stack" in d ||\n                          !e ||\n                          "number" != typeof Error.stackTraceLimit\n                          ? ((T = function (a, b) {\n                              return "string" == typeof a\n                                ? a\n                                : ("object" != typeof b &&\n                                    "function" != typeof b) ||\n                                  void 0 === b.name ||\n                                  void 0 === b.message\n                                ? B(b)\n                                : b.toString();\n                            }),\n                            null)\n                          : ((S = a),\n                            (T = b),\n                            function (a) {\n                              Error.stackTraceLimit += 6;\n                              try {\n                                throw new Error();\n                              } catch (b) {\n                                a.stack = b.stack;\n                              }\n                              Error.stackTraceLimit -= 6;\n                            });\n                      })();\n                      "undefined" != typeof console &&\n                        void 0 !== console.warn &&\n                        ((J = function (a) {\n                          console.warn(a);\n                        }),\n                        N.isNode && a.stderr.isTTY\n                          ? (J = function (a, b) {\n                              var c = b ? "[33m" : "[31m";\n                              console.warn(c + a + "[0m\\n");\n                            })\n                          : N.isNode ||\n                            "string" != typeof new Error().stack ||\n                            (J = function (a, b) {\n                              console.warn(\n                                "%c" + a,\n                                b ? "color: darkorange" : "color: red"\n                              );\n                            }));\n                      var ga = {\n                        warnings: W,\n                        longStackTraces: !1,\n                        cancellation: !1,\n                        monitoring: !1,\n                      };\n                      return (\n                        X && c.longStackTraces(),\n                        {\n                          longStackTraces: function () {\n                            return ga.longStackTraces;\n                          },\n                          warnings: function () {\n                            return ga.warnings;\n                          },\n                          cancellation: function () {\n                            return ga.cancellation;\n                          },\n                          monitoring: function () {\n                            return ga.monitoring;\n                          },\n                          propagateFromFunction: function () {\n                            return ca;\n                          },\n                          boundValueFunction: function () {\n                            return n;\n                          },\n                          checkForgottenReturns: q,\n                          setBounds: F,\n                          warn: s,\n                          deprecated: r,\n                          CapturedTrace: G,\n                          fireDomEvent: $,\n                          fireGlobalEvent: _,\n                        }\n                      );\n                    };\n                  },\n                  {\n                    "./errors": 12,\n                    "./util": 36,\n                  },\n                ],\n                10: [\n                  function (a, b, c) {\n                    "use strict";\n                    b.exports = function (a) {\n                      function b() {\n                        return this.value;\n                      }\n                      function c() {\n                        throw this.reason;\n                      }\n                      (a.prototype.return = a.prototype.thenReturn = function (\n                        c\n                      ) {\n                        return (\n                          c instanceof a && c.suppressUnhandledRejections(),\n                          this._then(\n                            b,\n                            void 0,\n                            void 0,\n                            {\n                              value: c,\n                            },\n                            void 0\n                          )\n                        );\n                      }),\n                        (a.prototype.throw = a.prototype.thenThrow = function (\n                          a\n                        ) {\n                          return this._then(\n                            c,\n                            void 0,\n                            void 0,\n                            {\n                              reason: a,\n                            },\n                            void 0\n                          );\n                        }),\n                        (a.prototype.catchThrow = function (a) {\n                          if (arguments.length <= 1)\n                            return this._then(\n                              void 0,\n                              c,\n                              void 0,\n                              {\n                                reason: a,\n                              },\n                              void 0\n                            );\n                          var b = arguments[1],\n                            d = function () {\n                              throw b;\n                            };\n                          return this.caught(a, d);\n                        }),\n                        (a.prototype.catchReturn = function (c) {\n                          if (arguments.length <= 1)\n                            return (\n                              c instanceof a && c.suppressUnhandledRejections(),\n                              this._then(\n                                void 0,\n                                b,\n                                void 0,\n                                {\n                                  value: c,\n                                },\n                                void 0\n                              )\n                            );\n                          var d = arguments[1];\n                          d instanceof a && d.suppressUnhandledRejections();\n                          var e = function () {\n                            return d;\n                          };\n                          return this.caught(c, e);\n                        });\n                    };\n                  },\n                  {},\n                ],\n                11: [\n                  function (a, b, c) {\n                    "use strict";\n                    b.exports = function (a, b) {\n                      function c() {\n                        return f(this);\n                      }\n                      function d(a, c) {\n                        return e(a, c, b, b);\n                      }\n                      var e = a.reduce,\n                        f = a.all;\n                      (a.prototype.each = function (a) {\n                        return e(this, a, b, 0)._then(\n                          c,\n                          void 0,\n                          void 0,\n                          this,\n                          void 0\n                        );\n                      }),\n                        (a.prototype.mapSeries = function (a) {\n                          return e(this, a, b, b);\n                        }),\n                        (a.each = function (a, d) {\n                          return e(a, d, b, 0)._then(\n                            c,\n                            void 0,\n                            void 0,\n                            a,\n                            void 0\n                          );\n                        }),\n                        (a.mapSeries = d);\n                    };\n                  },\n                  {},\n                ],\n                12: [\n                  function (a, b, c) {\n                    "use strict";\n                    function d(a, b) {\n                      function c(d) {\n                        if (!(this instanceof c)) return new c(d);\n                        l(this, "message", "string" == typeof d ? d : b),\n                          l(this, "name", a),\n                          Error.captureStackTrace\n                            ? Error.captureStackTrace(this, this.constructor)\n                            : Error.call(this);\n                      }\n                      return k(c, Error), c;\n                    }\n                    function e(a) {\n                      if (!(this instanceof e)) return new e(a);\n                      l(this, "name", "OperationalError"),\n                        l(this, "message", a),\n                        (this.cause = a),\n                        (this.isOperational = !0),\n                        a instanceof Error\n                          ? (l(this, "message", a.message),\n                            l(this, "stack", a.stack))\n                          : Error.captureStackTrace &&\n                            Error.captureStackTrace(this, this.constructor);\n                    }\n                    var f,\n                      g,\n                      h = a("./es5"),\n                      i = h.freeze,\n                      j = a("./util"),\n                      k = j.inherits,\n                      l = j.notEnumerableProp,\n                      m = d("Warning", "warning"),\n                      n = d("CancellationError", "cancellation error"),\n                      o = d("TimeoutError", "timeout error"),\n                      p = d("AggregateError", "aggregate error");\n                    try {\n                      (f = TypeError), (g = RangeError);\n                    } catch (a) {\n                      (f = d("TypeError", "type error")),\n                        (g = d("RangeError", "range error"));\n                    }\n                    for (\n                      var q = "join pop push shift unshift slice filter forEach some every map indexOf lastIndexOf reduce reduceRight sort reverse".split(\n                          " "\n                        ),\n                        r = 0;\n                      r < q.length;\n                      ++r\n                    )\n                      "function" == typeof Array.prototype[q[r]] &&\n                        (p.prototype[q[r]] = Array.prototype[q[r]]);\n                    h.defineProperty(p.prototype, "length", {\n                      value: 0,\n                      configurable: !1,\n                      writable: !0,\n                      enumerable: !0,\n                    }),\n                      (p.prototype.isOperational = !0);\n                    var s = 0;\n                    (p.prototype.toString = function () {\n                      var a = Array(4 * s + 1).join(" "),\n                        b = "\\n" + a + "AggregateError of:\\n";\n                      s++, (a = Array(4 * s + 1).join(" "));\n                      for (var c = 0; c < this.length; ++c) {\n                        for (\n                          var d =\n                              this[c] === this\n                                ? "[Circular AggregateError]"\n                                : this[c] + "",\n                            e = d.split("\\n"),\n                            f = 0;\n                          f < e.length;\n                          ++f\n                        )\n                          e[f] = a + e[f];\n                        (d = e.join("\\n")), (b += d + "\\n");\n                      }\n                      return s--, b;\n                    }),\n                      k(e, Error);\n                    var t = Error.__BluebirdErrorTypes__;\n                    t ||\n                      ((t = i({\n                        CancellationError: n,\n                        TimeoutError: o,\n                        OperationalError: e,\n                        RejectionError: e,\n                        AggregateError: p,\n                      })),\n                      h.defineProperty(Error, "__BluebirdErrorTypes__", {\n                        value: t,\n                        writable: !1,\n                        enumerable: !1,\n                        configurable: !1,\n                      })),\n                      (b.exports = {\n                        Error: Error,\n                        TypeError: f,\n                        RangeError: g,\n                        CancellationError: t.CancellationError,\n                        OperationalError: t.OperationalError,\n                        TimeoutError: t.TimeoutError,\n                        AggregateError: t.AggregateError,\n                        Warning: m,\n                      });\n                  },\n                  {\n                    "./es5": 13,\n                    "./util": 36,\n                  },\n                ],\n                13: [\n                  function (a, b, c) {\n                    var d = (function () {\n                      "use strict";\n                      return void 0 === this;\n                    })();\n                    if (d)\n                      b.exports = {\n                        freeze: Object.freeze,\n                        defineProperty: Object.defineProperty,\n                        getDescriptor: Object.getOwnPropertyDescriptor,\n                        keys: Object.keys,\n                        names: Object.getOwnPropertyNames,\n                        getPrototypeOf: Object.getPrototypeOf,\n                        isArray: Array.isArray,\n                        isES5: d,\n                        propertyIsWritable: function (a, b) {\n                          var c = Object.getOwnPropertyDescriptor(a, b);\n                          return !(c && !c.writable && !c.set);\n                        },\n                      };\n                    else {\n                      var e = {}.hasOwnProperty,\n                        f = {}.toString,\n                        g = {}.constructor.prototype,\n                        h = function (a) {\n                          var b = [];\n                          for (var c in a) e.call(a, c) && b.push(c);\n                          return b;\n                        },\n                        i = function (a, b) {\n                          return {\n                            value: a[b],\n                          };\n                        },\n                        j = function (a, b, c) {\n                          return (a[b] = c.value), a;\n                        },\n                        k = function (a) {\n                          return a;\n                        },\n                        l = function (a) {\n                          try {\n                            return Object(a).constructor.prototype;\n                          } catch (a) {\n                            return g;\n                          }\n                        },\n                        m = function (a) {\n                          try {\n                            return "[object Array]" === f.call(a);\n                          } catch (a) {\n                            return !1;\n                          }\n                        };\n                      b.exports = {\n                        isArray: m,\n                        keys: h,\n                        names: h,\n                        defineProperty: j,\n                        getDescriptor: i,\n                        freeze: k,\n                        getPrototypeOf: l,\n                        isES5: d,\n                        propertyIsWritable: function () {\n                          return !0;\n                        },\n                      };\n                    }\n                  },\n                  {},\n                ],\n                14: [\n                  function (a, b, c) {\n                    "use strict";\n                    b.exports = function (a, b) {\n                      var c = a.map;\n                      (a.prototype.filter = function (a, d) {\n                        return c(this, a, d, b);\n                      }),\n                        (a.filter = function (a, d, e) {\n                          return c(a, d, e, b);\n                        });\n                    };\n                  },\n                  {},\n                ],\n                15: [\n                  function (a, b, c) {\n                    "use strict";\n                    b.exports = function (b, c, d) {\n                      function e(a, b, c) {\n                        (this.promise = a),\n                          (this.type = b),\n                          (this.handler = c),\n                          (this.called = !1),\n                          (this.cancelPromise = null);\n                      }\n                      function f(a) {\n                        this.finallyHandler = a;\n                      }\n                      function g(a, b) {\n                        return (\n                          null != a.cancelPromise &&\n                          (arguments.length > 1\n                            ? a.cancelPromise._reject(b)\n                            : a.cancelPromise._cancel(),\n                          (a.cancelPromise = null),\n                          !0)\n                        );\n                      }\n                      function h() {\n                        return j.call(\n                          this,\n                          this.promise._target()._settledValue()\n                        );\n                      }\n                      function i(a) {\n                        if (!g(this, a)) return (m.e = a), m;\n                      }\n                      function j(a) {\n                        var e = this.promise,\n                          j = this.handler;\n                        if (!this.called) {\n                          this.called = !0;\n                          var k = this.isFinallyHandler()\n                            ? j.call(e._boundValue())\n                            : j.call(e._boundValue(), a);\n                          if (k === d) return k;\n                          if (void 0 !== k) {\n                            e._setReturnedNonUndefined();\n                            var n = c(k, e);\n                            if (n instanceof b) {\n                              if (null != this.cancelPromise) {\n                                if (n._isCancelled()) {\n                                  var o = new l("late cancellation observer");\n                                  return e._attachExtraTrace(o), (m.e = o), m;\n                                }\n                                n.isPending() &&\n                                  n._attachCancellationCallback(new f(this));\n                              }\n                              return n._then(h, i, void 0, this, void 0);\n                            }\n                          }\n                        }\n                        return e.isRejected()\n                          ? (g(this), (m.e = a), m)\n                          : (g(this), a);\n                      }\n                      var k = a("./util"),\n                        l = b.CancellationError,\n                        m = k.errorObj,\n                        n = a("./catch_filter")(d);\n                      return (\n                        (e.prototype.isFinallyHandler = function () {\n                          return 0 === this.type;\n                        }),\n                        (f.prototype._resultCancelled = function () {\n                          g(this.finallyHandler);\n                        }),\n                        (b.prototype._passThrough = function (a, b, c, d) {\n                          return "function" != typeof a\n                            ? this.then()\n                            : this._then(\n                                c,\n                                d,\n                                void 0,\n                                new e(this, b, a),\n                                void 0\n                              );\n                        }),\n                        (b.prototype.lastly = b.prototype.finally = function (\n                          a\n                        ) {\n                          return this._passThrough(a, 0, j, j);\n                        }),\n                        (b.prototype.tap = function (a) {\n                          return this._passThrough(a, 1, j);\n                        }),\n                        (b.prototype.tapCatch = function (a) {\n                          var c = arguments.length;\n                          if (1 === c)\n                            return this._passThrough(a, 1, void 0, j);\n                          var d,\n                            e = new Array(c - 1),\n                            f = 0;\n                          for (d = 0; d < c - 1; ++d) {\n                            var g = arguments[d];\n                            if (!k.isObject(g))\n                              return b.reject(\n                                new TypeError(\n                                  "tapCatch statement predicate: expecting an object but got " +\n                                    k.classString(g)\n                                )\n                              );\n                            e[f++] = g;\n                          }\n                          e.length = f;\n                          var h = arguments[d];\n                          return this._passThrough(n(e, h, this), 1, void 0, j);\n                        }),\n                        e\n                      );\n                    };\n                  },\n                  {\n                    "./catch_filter": 7,\n                    "./util": 36,\n                  },\n                ],\n                16: [\n                  function (a, b, c) {\n                    "use strict";\n                    b.exports = function (b, c, d, e, f, g) {\n                      function h(a, c, d) {\n                        for (var f = 0; f < c.length; ++f) {\n                          d._pushContext();\n                          var g = n(c[f])(a);\n                          if ((d._popContext(), g === m)) {\n                            d._pushContext();\n                            var h = b.reject(m.e);\n                            return d._popContext(), h;\n                          }\n                          var i = e(g, d);\n                          if (i instanceof b) return i;\n                        }\n                        return null;\n                      }\n                      function i(a, c, e, f) {\n                        if (g.cancellation()) {\n                          var h = new b(d),\n                            i = (this._finallyPromise = new b(d));\n                          (this._promise = h.lastly(function () {\n                            return i;\n                          })),\n                            h._captureStackTrace(),\n                            h._setOnCancel(this);\n                        } else {\n                          (this._promise = new b(d))._captureStackTrace();\n                        }\n                        (this._stack = f),\n                          (this._generatorFunction = a),\n                          (this._receiver = c),\n                          (this._generator = void 0),\n                          (this._yieldHandlers =\n                            "function" == typeof e ? [e].concat(o) : o),\n                          (this._yieldedPromise = null),\n                          (this._cancellationPhase = !1);\n                      }\n                      var j = a("./errors"),\n                        k = j.TypeError,\n                        l = a("./util"),\n                        m = l.errorObj,\n                        n = l.tryCatch,\n                        o = [];\n                      l.inherits(i, f),\n                        (i.prototype._isResolved = function () {\n                          return null === this._promise;\n                        }),\n                        (i.prototype._cleanup = function () {\n                          (this._promise = this._generator = null),\n                            g.cancellation() &&\n                              null !== this._finallyPromise &&\n                              (this._finallyPromise._fulfill(),\n                              (this._finallyPromise = null));\n                        }),\n                        (i.prototype._promiseCancelled = function () {\n                          if (!this._isResolved()) {\n                            var a,\n                              c = void 0 !== this._generator.return;\n                            if (c)\n                              this._promise._pushContext(),\n                                (a = n(this._generator.return).call(\n                                  this._generator,\n                                  void 0\n                                )),\n                                this._promise._popContext();\n                            else {\n                              var d = new b.CancellationError(\n                                "generator .return() sentinel"\n                              );\n                              (b.coroutine.returnSentinel = d),\n                                this._promise._attachExtraTrace(d),\n                                this._promise._pushContext(),\n                                (a = n(this._generator.throw).call(\n                                  this._generator,\n                                  d\n                                )),\n                                this._promise._popContext();\n                            }\n                            (this._cancellationPhase = !0),\n                              (this._yieldedPromise = null),\n                              this._continue(a);\n                          }\n                        }),\n                        (i.prototype._promiseFulfilled = function (a) {\n                          (this._yieldedPromise = null),\n                            this._promise._pushContext();\n                          var b = n(this._generator.next).call(\n                            this._generator,\n                            a\n                          );\n                          this._promise._popContext(), this._continue(b);\n                        }),\n                        (i.prototype._promiseRejected = function (a) {\n                          (this._yieldedPromise = null),\n                            this._promise._attachExtraTrace(a),\n                            this._promise._pushContext();\n                          var b = n(this._generator.throw).call(\n                            this._generator,\n                            a\n                          );\n                          this._promise._popContext(), this._continue(b);\n                        }),\n                        (i.prototype._resultCancelled = function () {\n                          if (this._yieldedPromise instanceof b) {\n                            var a = this._yieldedPromise;\n                            (this._yieldedPromise = null), a.cancel();\n                          }\n                        }),\n                        (i.prototype.promise = function () {\n                          return this._promise;\n                        }),\n                        (i.prototype._run = function () {\n                          (this._generator = this._generatorFunction.call(\n                            this._receiver\n                          )),\n                            (this._receiver = this._generatorFunction = void 0),\n                            this._promiseFulfilled(void 0);\n                        }),\n                        (i.prototype._continue = function (a) {\n                          var c = this._promise;\n                          if (a === m)\n                            return (\n                              this._cleanup(),\n                              this._cancellationPhase\n                                ? c.cancel()\n                                : c._rejectCallback(a.e, !1)\n                            );\n                          var d = a.value;\n                          if (!0 === a.done)\n                            return (\n                              this._cleanup(),\n                              this._cancellationPhase\n                                ? c.cancel()\n                                : c._resolveCallback(d)\n                            );\n                          var f = e(d, this._promise);\n                          if (\n                            !(f instanceof b) &&\n                            null ===\n                              (f = h(f, this._yieldHandlers, this._promise))\n                          )\n                            return void this._promiseRejected(\n                              new k(\n                                "A value %s was yielded that could not be treated as a promise\\n\\n    See http://goo.gl/MqrFmX\\n\\n".replace(\n                                  "%s",\n                                  String(d)\n                                ) +\n                                  "From coroutine:\\n" +\n                                  this._stack\n                                    .split("\\n")\n                                    .slice(1, -7)\n                                    .join("\\n")\n                              )\n                            );\n                          f = f._target();\n                          var g = f._bitField;\n                          0 == (50397184 & g)\n                            ? ((this._yieldedPromise = f), f._proxy(this, null))\n                            : 0 != (33554432 & g)\n                            ? b._async.invoke(\n                                this._promiseFulfilled,\n                                this,\n                                f._value()\n                              )\n                            : 0 != (16777216 & g)\n                            ? b._async.invoke(\n                                this._promiseRejected,\n                                this,\n                                f._reason()\n                              )\n                            : this._promiseCancelled();\n                        }),\n                        (b.coroutine = function (a, b) {\n                          if ("function" != typeof a)\n                            throw new k(\n                              "generatorFunction must be a function\\n\\n    See http://goo.gl/MqrFmX\\n"\n                            );\n                          var c = Object(b).yieldHandler,\n                            d = i,\n                            e = new Error().stack;\n                          return function () {\n                            var b = a.apply(this, arguments),\n                              f = new d(void 0, void 0, c, e),\n                              g = f.promise();\n                            return (\n                              (f._generator = b), f._promiseFulfilled(void 0), g\n                            );\n                          };\n                        }),\n                        (b.coroutine.addYieldHandler = function (a) {\n                          if ("function" != typeof a)\n                            throw new k(\n                              "expecting a function but got " + l.classString(a)\n                            );\n                          o.push(a);\n                        }),\n                        (b.spawn = function (a) {\n                          if (\n                            (g.deprecated(\n                              "Promise.spawn()",\n                              "Promise.coroutine()"\n                            ),\n                            "function" != typeof a)\n                          )\n                            return c(\n                              "generatorFunction must be a function\\n\\n    See http://goo.gl/MqrFmX\\n"\n                            );\n                          var d = new i(a, this),\n                            e = d.promise();\n                          return d._run(b.spawn), e;\n                        });\n                    };\n                  },\n                  {\n                    "./errors": 12,\n                    "./util": 36,\n                  },\n                ],\n                17: [\n                  function (a, b, c) {\n                    "use strict";\n                    b.exports = function (b, c, d, e, f, g) {\n                      var h = a("./util");\n                      h.canEvaluate, h.tryCatch, h.errorObj;\n                      b.join = function () {\n                        var a,\n                          b = arguments.length - 1;\n                        if (b > 0 && "function" == typeof arguments[b]) {\n                          a = arguments[b];\n                          var d;\n                        }\n                        var e = [].slice.call(arguments);\n                        a && e.pop();\n                        var d = new c(e).promise();\n                        return void 0 !== a ? d.spread(a) : d;\n                      };\n                    };\n                  },\n                  {\n                    "./util": 36,\n                  },\n                ],\n                18: [\n                  function (a, b, c) {\n                    "use strict";\n                    b.exports = function (b, c, d, e, f, g) {\n                      function h(a, b, c, d) {\n                        this.constructor$(a),\n                          this._promise._captureStackTrace();\n                        var e = j();\n                        (this._callback = null === e ? b : k.domainBind(e, b)),\n                          (this._preservedValues =\n                            d === f ? new Array(this.length()) : null),\n                          (this._limit = c),\n                          (this._inFlight = 0),\n                          (this._queue = []),\n                          n.invoke(this._asyncInit, this, void 0);\n                      }\n                      function i(a, c, e, f) {\n                        if ("function" != typeof c)\n                          return d(\n                            "expecting a function but got " + k.classString(c)\n                          );\n                        var g = 0;\n                        if (void 0 !== e) {\n                          if ("object" != typeof e || null === e)\n                            return b.reject(\n                              new TypeError(\n                                "options argument must be an object but it is " +\n                                  k.classString(e)\n                              )\n                            );\n                          if ("number" != typeof e.concurrency)\n                            return b.reject(\n                              new TypeError(\n                                "\'concurrency\' must be a number but it is " +\n                                  k.classString(e.concurrency)\n                              )\n                            );\n                          g = e.concurrency;\n                        }\n                        return (\n                          (g =\n                            "number" == typeof g && isFinite(g) && g >= 1\n                              ? g\n                              : 0),\n                          new h(a, c, g, f).promise()\n                        );\n                      }\n                      var j = b._getDomain,\n                        k = a("./util"),\n                        l = k.tryCatch,\n                        m = k.errorObj,\n                        n = b._async;\n                      k.inherits(h, c),\n                        (h.prototype._asyncInit = function () {\n                          this._init$(void 0, -2);\n                        }),\n                        (h.prototype._init = function () {}),\n                        (h.prototype._promiseFulfilled = function (a, c) {\n                          var d = this._values,\n                            f = this.length(),\n                            h = this._preservedValues,\n                            i = this._limit;\n                          if (c < 0) {\n                            if (\n                              ((c = -1 * c - 1),\n                              (d[c] = a),\n                              i >= 1 &&\n                                (this._inFlight--,\n                                this._drainQueue(),\n                                this._isResolved()))\n                            )\n                              return !0;\n                          } else {\n                            if (i >= 1 && this._inFlight >= i)\n                              return (d[c] = a), this._queue.push(c), !1;\n                            null !== h && (h[c] = a);\n                            var j = this._promise,\n                              k = this._callback,\n                              n = j._boundValue();\n                            j._pushContext();\n                            var o = l(k).call(n, a, c, f),\n                              p = j._popContext();\n                            if (\n                              (g.checkForgottenReturns(\n                                o,\n                                p,\n                                null !== h ? "Promise.filter" : "Promise.map",\n                                j\n                              ),\n                              o === m)\n                            )\n                              return this._reject(o.e), !0;\n                            var q = e(o, this._promise);\n                            if (q instanceof b) {\n                              q = q._target();\n                              var r = q._bitField;\n                              if (0 == (50397184 & r))\n                                return (\n                                  i >= 1 && this._inFlight++,\n                                  (d[c] = q),\n                                  q._proxy(this, -1 * (c + 1)),\n                                  !1\n                                );\n                              if (0 == (33554432 & r))\n                                return 0 != (16777216 & r)\n                                  ? (this._reject(q._reason()), !0)\n                                  : (this._cancel(), !0);\n                              o = q._value();\n                            }\n                            d[c] = o;\n                          }\n                          return (\n                            ++this._totalResolved >= f &&\n                            (null !== h ? this._filter(d, h) : this._resolve(d),\n                            !0)\n                          );\n                        }),\n                        (h.prototype._drainQueue = function () {\n                          for (\n                            var a = this._queue,\n                              b = this._limit,\n                              c = this._values;\n                            a.length > 0 && this._inFlight < b;\n\n                          ) {\n                            if (this._isResolved()) return;\n                            var d = a.pop();\n                            this._promiseFulfilled(c[d], d);\n                          }\n                        }),\n                        (h.prototype._filter = function (a, b) {\n                          for (\n                            var c = b.length, d = new Array(c), e = 0, f = 0;\n                            f < c;\n                            ++f\n                          )\n                            a[f] && (d[e++] = b[f]);\n                          (d.length = e), this._resolve(d);\n                        }),\n                        (h.prototype.preservedValues = function () {\n                          return this._preservedValues;\n                        }),\n                        (b.prototype.map = function (a, b) {\n                          return i(this, a, b, null);\n                        }),\n                        (b.map = function (a, b, c, d) {\n                          return i(a, b, c, d);\n                        });\n                    };\n                  },\n                  {\n                    "./util": 36,\n                  },\n                ],\n                19: [\n                  function (a, b, c) {\n                    "use strict";\n                    b.exports = function (b, c, d, e, f) {\n                      var g = a("./util"),\n                        h = g.tryCatch;\n                      (b.method = function (a) {\n                        if ("function" != typeof a)\n                          throw new b.TypeError(\n                            "expecting a function but got " + g.classString(a)\n                          );\n                        return function () {\n                          var d = new b(c);\n                          d._captureStackTrace(), d._pushContext();\n                          var e = h(a).apply(this, arguments),\n                            g = d._popContext();\n                          return (\n                            f.checkForgottenReturns(e, g, "Promise.method", d),\n                            d._resolveFromSyncValue(e),\n                            d\n                          );\n                        };\n                      }),\n                        (b.attempt = b.try = function (a) {\n                          if ("function" != typeof a)\n                            return e(\n                              "expecting a function but got " + g.classString(a)\n                            );\n                          var d = new b(c);\n                          d._captureStackTrace(), d._pushContext();\n                          var i;\n                          if (arguments.length > 1) {\n                            f.deprecated(\n                              "calling Promise.try with more than 1 argument"\n                            );\n                            var j = arguments[1],\n                              k = arguments[2];\n                            i = g.isArray(j)\n                              ? h(a).apply(k, j)\n                              : h(a).call(k, j);\n                          } else i = h(a)();\n                          var l = d._popContext();\n                          return (\n                            f.checkForgottenReturns(i, l, "Promise.try", d),\n                            d._resolveFromSyncValue(i),\n                            d\n                          );\n                        }),\n                        (b.prototype._resolveFromSyncValue = function (a) {\n                          a === g.errorObj\n                            ? this._rejectCallback(a.e, !1)\n                            : this._resolveCallback(a, !0);\n                        });\n                    };\n                  },\n                  {\n                    "./util": 36,\n                  },\n                ],\n                20: [\n                  function (a, b, c) {\n                    "use strict";\n                    function d(a) {\n                      return (\n                        a instanceof Error &&\n                        k.getPrototypeOf(a) === Error.prototype\n                      );\n                    }\n                    function e(a) {\n                      var b;\n                      if (d(a)) {\n                        (b = new j(a)),\n                          (b.name = a.name),\n                          (b.message = a.message),\n                          (b.stack = a.stack);\n                        for (var c = k.keys(a), e = 0; e < c.length; ++e) {\n                          var f = c[e];\n                          l.test(f) || (b[f] = a[f]);\n                        }\n                        return b;\n                      }\n                      return g.markAsOriginatingFromRejection(a), a;\n                    }\n                    function f(a, b) {\n                      return function (c, d) {\n                        if (null !== a) {\n                          if (c) {\n                            var f = e(h(c));\n                            a._attachExtraTrace(f), a._reject(f);\n                          } else if (b) {\n                            var g = [].slice.call(arguments, 1);\n                            a._fulfill(g);\n                          } else a._fulfill(d);\n                          a = null;\n                        }\n                      };\n                    }\n                    var g = a("./util"),\n                      h = g.maybeWrapAsError,\n                      i = a("./errors"),\n                      j = i.OperationalError,\n                      k = a("./es5"),\n                      l = /^(?:name|message|stack|cause)$/;\n                    b.exports = f;\n                  },\n                  {\n                    "./errors": 12,\n                    "./es5": 13,\n                    "./util": 36,\n                  },\n                ],\n                21: [\n                  function (a, b, c) {\n                    "use strict";\n                    b.exports = function (b) {\n                      function c(a, b) {\n                        var c = this;\n                        if (!f.isArray(a)) return d.call(c, a, b);\n                        var e = h(b).apply(c._boundValue(), [null].concat(a));\n                        e === i && g.throwLater(e.e);\n                      }\n                      function d(a, b) {\n                        var c = this,\n                          d = c._boundValue(),\n                          e =\n                            void 0 === a\n                              ? h(b).call(d, null)\n                              : h(b).call(d, null, a);\n                        e === i && g.throwLater(e.e);\n                      }\n                      function e(a, b) {\n                        var c = this;\n                        if (!a) {\n                          var d = new Error(a + "");\n                          (d.cause = a), (a = d);\n                        }\n                        var e = h(b).call(c._boundValue(), a);\n                        e === i && g.throwLater(e.e);\n                      }\n                      var f = a("./util"),\n                        g = b._async,\n                        h = f.tryCatch,\n                        i = f.errorObj;\n                      b.prototype.asCallback = b.prototype.nodeify = function (\n                        a,\n                        b\n                      ) {\n                        if ("function" == typeof a) {\n                          var f = d;\n                          void 0 !== b && Object(b).spread && (f = c),\n                            this._then(f, e, void 0, this, a);\n                        }\n                        return this;\n                      };\n                    };\n                  },\n                  {\n                    "./util": 36,\n                  },\n                ],\n                22: [\n                  function (b, c, d) {\n                    "use strict";\n                    c.exports = function () {\n                      function d() {}\n                      function e(a, b) {\n                        if (null == a || a.constructor !== f)\n                          throw new t(\n                            "the promise constructor cannot be invoked directly\\n\\n    See http://goo.gl/MqrFmX\\n"\n                          );\n                        if ("function" != typeof b)\n                          throw new t(\n                            "expecting a function but got " + o.classString(b)\n                          );\n                      }\n                      function f(a) {\n                        a !== v && e(this, a),\n                          (this._bitField = 0),\n                          (this._fulfillmentHandler0 = void 0),\n                          (this._rejectionHandler0 = void 0),\n                          (this._promise0 = void 0),\n                          (this._receiver0 = void 0),\n                          this._resolveFromExecutor(a),\n                          this._promiseCreated(),\n                          this._fireEvent("promiseCreated", this);\n                      }\n                      function g(a) {\n                        this.promise._resolveCallback(a);\n                      }\n                      function h(a) {\n                        this.promise._rejectCallback(a, !1);\n                      }\n                      function i(a) {\n                        var b = new f(v);\n                        (b._fulfillmentHandler0 = a),\n                          (b._rejectionHandler0 = a),\n                          (b._promise0 = a),\n                          (b._receiver0 = a);\n                      }\n                      var j,\n                        k = function () {\n                          return new t(\n                            "circular promise resolution chain\\n\\n    See http://goo.gl/MqrFmX\\n"\n                          );\n                        },\n                        l = function () {\n                          return new f.PromiseInspection(this._target());\n                        },\n                        m = function (a) {\n                          return f.reject(new t(a));\n                        },\n                        n = {},\n                        o = b("./util");\n                      (j = o.isNode\n                        ? function () {\n                            var b = a.domain;\n                            return void 0 === b && (b = null), b;\n                          }\n                        : function () {\n                            return null;\n                          }),\n                        o.notEnumerableProp(f, "_getDomain", j);\n                      var p = b("./es5"),\n                        q = b("./async"),\n                        r = new q();\n                      p.defineProperty(f, "_async", {\n                        value: r,\n                      });\n                      var s = b("./errors"),\n                        t = (f.TypeError = s.TypeError);\n                      f.RangeError = s.RangeError;\n                      var u = (f.CancellationError = s.CancellationError);\n                      (f.TimeoutError = s.TimeoutError),\n                        (f.OperationalError = s.OperationalError),\n                        (f.RejectionError = s.OperationalError),\n                        (f.AggregateError = s.AggregateError);\n                      var v = function () {},\n                        w = {},\n                        x = {},\n                        y = b("./thenables")(f, v),\n                        z = b("./promise_array")(f, v, y, m, d),\n                        A = b("./context")(f),\n                        B = A.create,\n                        C = b("./debuggability")(f, A),\n                        D = (C.CapturedTrace, b("./finally")(f, y, x)),\n                        E = b("./catch_filter")(x),\n                        F = b("./nodeback"),\n                        G = o.errorObj,\n                        H = o.tryCatch;\n                      return (\n                        (f.prototype.toString = function () {\n                          return "[object Promise]";\n                        }),\n                        (f.prototype.caught = f.prototype.catch = function (a) {\n                          var b = arguments.length;\n                          if (b > 1) {\n                            var c,\n                              d = new Array(b - 1),\n                              e = 0;\n                            for (c = 0; c < b - 1; ++c) {\n                              var f = arguments[c];\n                              if (!o.isObject(f))\n                                return m(\n                                  "Catch statement predicate: expecting an object but got " +\n                                    o.classString(f)\n                                );\n                              d[e++] = f;\n                            }\n                            return (\n                              (d.length = e),\n                              (a = arguments[c]),\n                              this.then(void 0, E(d, a, this))\n                            );\n                          }\n                          return this.then(void 0, a);\n                        }),\n                        (f.prototype.reflect = function () {\n                          return this._then(l, l, void 0, this, void 0);\n                        }),\n                        (f.prototype.then = function (a, b) {\n                          if (\n                            C.warnings() &&\n                            arguments.length > 0 &&\n                            "function" != typeof a &&\n                            "function" != typeof b\n                          ) {\n                            var c =\n                              ".then() only accepts functions but was passed: " +\n                              o.classString(a);\n                            arguments.length > 1 &&\n                              (c += ", " + o.classString(b)),\n                              this._warn(c);\n                          }\n                          return this._then(a, b, void 0, void 0, void 0);\n                        }),\n                        (f.prototype.done = function (a, b) {\n                          this._then(\n                            a,\n                            b,\n                            void 0,\n                            void 0,\n                            void 0\n                          )._setIsFinal();\n                        }),\n                        (f.prototype.spread = function (a) {\n                          return "function" != typeof a\n                            ? m(\n                                "expecting a function but got " +\n                                  o.classString(a)\n                              )\n                            : this.all()._then(a, void 0, void 0, w, void 0);\n                        }),\n                        (f.prototype.toJSON = function () {\n                          var a = {\n                            isFulfilled: !1,\n                            isRejected: !1,\n                            fulfillmentValue: void 0,\n                            rejectionReason: void 0,\n                          };\n                          return (\n                            this.isFulfilled()\n                              ? ((a.fulfillmentValue = this.value()),\n                                (a.isFulfilled = !0))\n                              : this.isRejected() &&\n                                ((a.rejectionReason = this.reason()),\n                                (a.isRejected = !0)),\n                            a\n                          );\n                        }),\n                        (f.prototype.all = function () {\n                          return (\n                            arguments.length > 0 &&\n                              this._warn(\n                                ".all() was passed arguments but it does not take any"\n                              ),\n                            new z(this).promise()\n                          );\n                        }),\n                        (f.prototype.error = function (a) {\n                          return this.caught(o.originatesFromRejection, a);\n                        }),\n                        (f.getNewLibraryCopy = c.exports),\n                        (f.is = function (a) {\n                          return a instanceof f;\n                        }),\n                        (f.fromNode = f.fromCallback = function (a) {\n                          var b = new f(v);\n                          b._captureStackTrace();\n                          var c =\n                              arguments.length > 1 &&\n                              !!Object(arguments[1]).multiArgs,\n                            d = H(a)(F(b, c));\n                          return (\n                            d === G && b._rejectCallback(d.e, !0),\n                            b._isFateSealed() || b._setAsyncGuaranteed(),\n                            b\n                          );\n                        }),\n                        (f.all = function (a) {\n                          return new z(a).promise();\n                        }),\n                        (f.cast = function (a) {\n                          var b = y(a);\n                          return (\n                            b instanceof f ||\n                              ((b = new f(v)),\n                              b._captureStackTrace(),\n                              b._setFulfilled(),\n                              (b._rejectionHandler0 = a)),\n                            b\n                          );\n                        }),\n                        (f.resolve = f.fulfilled = f.cast),\n                        (f.reject = f.rejected = function (a) {\n                          var b = new f(v);\n                          return (\n                            b._captureStackTrace(), b._rejectCallback(a, !0), b\n                          );\n                        }),\n                        (f.setScheduler = function (a) {\n                          if ("function" != typeof a)\n                            throw new t(\n                              "expecting a function but got " + o.classString(a)\n                            );\n                          return r.setScheduler(a);\n                        }),\n                        (f.prototype._then = function (a, b, c, d, e) {\n                          var g = void 0 !== e,\n                            h = g ? e : new f(v),\n                            i = this._target(),\n                            k = i._bitField;\n                          g ||\n                            (h._propagateFrom(this, 3),\n                            h._captureStackTrace(),\n                            void 0 === d &&\n                              0 != (2097152 & this._bitField) &&\n                              (d =\n                                0 != (50397184 & k)\n                                  ? this._boundValue()\n                                  : i === this\n                                  ? void 0\n                                  : this._boundTo),\n                            this._fireEvent("promiseChained", this, h));\n                          var l = j();\n                          if (0 != (50397184 & k)) {\n                            var m,\n                              n,\n                              p = i._settlePromiseCtx;\n                            0 != (33554432 & k)\n                              ? ((n = i._rejectionHandler0), (m = a))\n                              : 0 != (16777216 & k)\n                              ? ((n = i._fulfillmentHandler0),\n                                (m = b),\n                                i._unsetRejectionIsUnhandled())\n                              : ((p = i._settlePromiseLateCancellationObserver),\n                                (n = new u("late cancellation observer")),\n                                i._attachExtraTrace(n),\n                                (m = b)),\n                              r.invoke(p, i, {\n                                handler:\n                                  null === l\n                                    ? m\n                                    : "function" == typeof m &&\n                                      o.domainBind(l, m),\n                                promise: h,\n                                receiver: d,\n                                value: n,\n                              });\n                          } else i._addCallbacks(a, b, h, d, l);\n                          return h;\n                        }),\n                        (f.prototype._length = function () {\n                          return 65535 & this._bitField;\n                        }),\n                        (f.prototype._isFateSealed = function () {\n                          return 0 != (117506048 & this._bitField);\n                        }),\n                        (f.prototype._isFollowing = function () {\n                          return 67108864 == (67108864 & this._bitField);\n                        }),\n                        (f.prototype._setLength = function (a) {\n                          this._bitField =\n                            (-65536 & this._bitField) | (65535 & a);\n                        }),\n                        (f.prototype._setFulfilled = function () {\n                          (this._bitField = 33554432 | this._bitField),\n                            this._fireEvent("promiseFulfilled", this);\n                        }),\n                        (f.prototype._setRejected = function () {\n                          (this._bitField = 16777216 | this._bitField),\n                            this._fireEvent("promiseRejected", this);\n                        }),\n                        (f.prototype._setFollowing = function () {\n                          (this._bitField = 67108864 | this._bitField),\n                            this._fireEvent("promiseResolved", this);\n                        }),\n                        (f.prototype._setIsFinal = function () {\n                          this._bitField = 4194304 | this._bitField;\n                        }),\n                        (f.prototype._isFinal = function () {\n                          return (4194304 & this._bitField) > 0;\n                        }),\n                        (f.prototype._unsetCancelled = function () {\n                          this._bitField = -65537 & this._bitField;\n                        }),\n                        (f.prototype._setCancelled = function () {\n                          (this._bitField = 65536 | this._bitField),\n                            this._fireEvent("promiseCancelled", this);\n                        }),\n                        (f.prototype._setWillBeCancelled = function () {\n                          this._bitField = 8388608 | this._bitField;\n                        }),\n                        (f.prototype._setAsyncGuaranteed = function () {\n                          r.hasCustomScheduler() ||\n                            (this._bitField = 134217728 | this._bitField);\n                        }),\n                        (f.prototype._receiverAt = function (a) {\n                          var b =\n                            0 === a ? this._receiver0 : this[4 * a - 4 + 3];\n                          if (b !== n)\n                            return void 0 === b && this._isBound()\n                              ? this._boundValue()\n                              : b;\n                        }),\n                        (f.prototype._promiseAt = function (a) {\n                          return this[4 * a - 4 + 2];\n                        }),\n                        (f.prototype._fulfillmentHandlerAt = function (a) {\n                          return this[4 * a - 4 + 0];\n                        }),\n                        (f.prototype._rejectionHandlerAt = function (a) {\n                          return this[4 * a - 4 + 1];\n                        }),\n                        (f.prototype._boundValue = function () {}),\n                        (f.prototype._migrateCallback0 = function (a) {\n                          var b = (a._bitField, a._fulfillmentHandler0),\n                            c = a._rejectionHandler0,\n                            d = a._promise0,\n                            e = a._receiverAt(0);\n                          void 0 === e && (e = n),\n                            this._addCallbacks(b, c, d, e, null);\n                        }),\n                        (f.prototype._migrateCallbackAt = function (a, b) {\n                          var c = a._fulfillmentHandlerAt(b),\n                            d = a._rejectionHandlerAt(b),\n                            e = a._promiseAt(b),\n                            f = a._receiverAt(b);\n                          void 0 === f && (f = n),\n                            this._addCallbacks(c, d, e, f, null);\n                        }),\n                        (f.prototype._addCallbacks = function (a, b, c, d, e) {\n                          var f = this._length();\n                          if (\n                            (f >= 65531 && ((f = 0), this._setLength(0)),\n                            0 === f)\n                          )\n                            (this._promise0 = c),\n                              (this._receiver0 = d),\n                              "function" == typeof a &&\n                                (this._fulfillmentHandler0 =\n                                  null === e ? a : o.domainBind(e, a)),\n                              "function" == typeof b &&\n                                (this._rejectionHandler0 =\n                                  null === e ? b : o.domainBind(e, b));\n                          else {\n                            var g = 4 * f - 4;\n                            (this[g + 2] = c),\n                              (this[g + 3] = d),\n                              "function" == typeof a &&\n                                (this[g + 0] =\n                                  null === e ? a : o.domainBind(e, a)),\n                              "function" == typeof b &&\n                                (this[g + 1] =\n                                  null === e ? b : o.domainBind(e, b));\n                          }\n                          return this._setLength(f + 1), f;\n                        }),\n                        (f.prototype._proxy = function (a, b) {\n                          this._addCallbacks(void 0, void 0, b, a, null);\n                        }),\n                        (f.prototype._resolveCallback = function (a, b) {\n                          if (0 == (117506048 & this._bitField)) {\n                            if (a === this)\n                              return this._rejectCallback(k(), !1);\n                            var c = y(a, this);\n                            if (!(c instanceof f)) return this._fulfill(a);\n                            b && this._propagateFrom(c, 2);\n                            var d = c._target();\n                            if (d === this) return void this._reject(k());\n                            var e = d._bitField;\n                            if (0 == (50397184 & e)) {\n                              var g = this._length();\n                              g > 0 && d._migrateCallback0(this);\n                              for (var h = 1; h < g; ++h)\n                                d._migrateCallbackAt(this, h);\n                              this._setFollowing(),\n                                this._setLength(0),\n                                this._setFollowee(d);\n                            } else if (0 != (33554432 & e))\n                              this._fulfill(d._value());\n                            else if (0 != (16777216 & e))\n                              this._reject(d._reason());\n                            else {\n                              var i = new u("late cancellation observer");\n                              d._attachExtraTrace(i), this._reject(i);\n                            }\n                          }\n                        }),\n                        (f.prototype._rejectCallback = function (a, b, c) {\n                          var d = o.ensureErrorObject(a),\n                            e = d === a;\n                          if (!e && !c && C.warnings()) {\n                            var f =\n                              "a promise was rejected with a non-error: " +\n                              o.classString(a);\n                            this._warn(f, !0);\n                          }\n                          this._attachExtraTrace(d, !!b && e), this._reject(a);\n                        }),\n                        (f.prototype._resolveFromExecutor = function (a) {\n                          if (a !== v) {\n                            var b = this;\n                            this._captureStackTrace(), this._pushContext();\n                            var c = !0,\n                              d = this._execute(\n                                a,\n                                function (a) {\n                                  b._resolveCallback(a);\n                                },\n                                function (a) {\n                                  b._rejectCallback(a, c);\n                                }\n                              );\n                            (c = !1),\n                              this._popContext(),\n                              void 0 !== d && b._rejectCallback(d, !0);\n                          }\n                        }),\n                        (f.prototype._settlePromiseFromHandler = function (\n                          a,\n                          b,\n                          c,\n                          d\n                        ) {\n                          var e = d._bitField;\n                          if (0 == (65536 & e)) {\n                            d._pushContext();\n                            var f;\n                            b === w\n                              ? c && "number" == typeof c.length\n                                ? (f = H(a).apply(this._boundValue(), c))\n                                : ((f = G),\n                                  (f.e = new t(\n                                    "cannot .spread() a non-array: " +\n                                      o.classString(c)\n                                  )))\n                              : (f = H(a).call(b, c));\n                            var g = d._popContext();\n                            (e = d._bitField),\n                              0 == (65536 & e) &&\n                                (f === x\n                                  ? d._reject(c)\n                                  : f === G\n                                  ? d._rejectCallback(f.e, !1)\n                                  : (C.checkForgottenReturns(f, g, "", d, this),\n                                    d._resolveCallback(f)));\n                          }\n                        }),\n                        (f.prototype._target = function () {\n                          for (var a = this; a._isFollowing(); )\n                            a = a._followee();\n                          return a;\n                        }),\n                        (f.prototype._followee = function () {\n                          return this._rejectionHandler0;\n                        }),\n                        (f.prototype._setFollowee = function (a) {\n                          this._rejectionHandler0 = a;\n                        }),\n                        (f.prototype._settlePromise = function (a, b, c, e) {\n                          var g = a instanceof f,\n                            h = this._bitField,\n                            i = 0 != (134217728 & h);\n                          0 != (65536 & h)\n                            ? (g && a._invokeInternalOnCancel(),\n                              c instanceof D && c.isFinallyHandler()\n                                ? ((c.cancelPromise = a),\n                                  H(b).call(c, e) === G && a._reject(G.e))\n                                : b === l\n                                ? a._fulfill(l.call(c))\n                                : c instanceof d\n                                ? c._promiseCancelled(a)\n                                : g || a instanceof z\n                                ? a._cancel()\n                                : c.cancel())\n                            : "function" == typeof b\n                            ? g\n                              ? (i && a._setAsyncGuaranteed(),\n                                this._settlePromiseFromHandler(b, c, e, a))\n                              : b.call(c, e, a)\n                            : c instanceof d\n                            ? c._isResolved() ||\n                              (0 != (33554432 & h)\n                                ? c._promiseFulfilled(e, a)\n                                : c._promiseRejected(e, a))\n                            : g &&\n                              (i && a._setAsyncGuaranteed(),\n                              0 != (33554432 & h)\n                                ? a._fulfill(e)\n                                : a._reject(e));\n                        }),\n                        (f.prototype._settlePromiseLateCancellationObserver = function (\n                          a\n                        ) {\n                          var b = a.handler,\n                            c = a.promise,\n                            d = a.receiver,\n                            e = a.value;\n                          "function" == typeof b\n                            ? c instanceof f\n                              ? this._settlePromiseFromHandler(b, d, e, c)\n                              : b.call(d, e, c)\n                            : c instanceof f && c._reject(e);\n                        }),\n                        (f.prototype._settlePromiseCtx = function (a) {\n                          this._settlePromise(\n                            a.promise,\n                            a.handler,\n                            a.receiver,\n                            a.value\n                          );\n                        }),\n                        (f.prototype._settlePromise0 = function (a, b, c) {\n                          var d = this._promise0,\n                            e = this._receiverAt(0);\n                          (this._promise0 = void 0),\n                            (this._receiver0 = void 0),\n                            this._settlePromise(d, a, e, b);\n                        }),\n                        (f.prototype._clearCallbackDataAtIndex = function (a) {\n                          var b = 4 * a - 4;\n                          this[b + 2] = this[b + 3] = this[b + 0] = this[\n                            b + 1\n                          ] = void 0;\n                        }),\n                        (f.prototype._fulfill = function (a) {\n                          var b = this._bitField;\n                          if (!((117506048 & b) >>> 16)) {\n                            if (a === this) {\n                              var c = k();\n                              return this._attachExtraTrace(c), this._reject(c);\n                            }\n                            this._setFulfilled(),\n                              (this._rejectionHandler0 = a),\n                              (65535 & b) > 0 &&\n                                (0 != (134217728 & b)\n                                  ? this._settlePromises()\n                                  : r.settlePromises(this));\n                          }\n                        }),\n                        (f.prototype._reject = function (a) {\n                          var b = this._bitField;\n                          if (!((117506048 & b) >>> 16)) {\n                            if (\n                              (this._setRejected(),\n                              (this._fulfillmentHandler0 = a),\n                              this._isFinal())\n                            )\n                              return r.fatalError(a, o.isNode);\n                            (65535 & b) > 0\n                              ? r.settlePromises(this)\n                              : this._ensurePossibleRejectionHandled();\n                          }\n                        }),\n                        (f.prototype._fulfillPromises = function (a, b) {\n                          for (var c = 1; c < a; c++) {\n                            var d = this._fulfillmentHandlerAt(c),\n                              e = this._promiseAt(c),\n                              f = this._receiverAt(c);\n                            this._clearCallbackDataAtIndex(c),\n                              this._settlePromise(e, d, f, b);\n                          }\n                        }),\n                        (f.prototype._rejectPromises = function (a, b) {\n                          for (var c = 1; c < a; c++) {\n                            var d = this._rejectionHandlerAt(c),\n                              e = this._promiseAt(c),\n                              f = this._receiverAt(c);\n                            this._clearCallbackDataAtIndex(c),\n                              this._settlePromise(e, d, f, b);\n                          }\n                        }),\n                        (f.prototype._settlePromises = function () {\n                          var a = this._bitField,\n                            b = 65535 & a;\n                          if (b > 0) {\n                            if (0 != (16842752 & a)) {\n                              var c = this._fulfillmentHandler0;\n                              this._settlePromise0(\n                                this._rejectionHandler0,\n                                c,\n                                a\n                              ),\n                                this._rejectPromises(b, c);\n                            } else {\n                              var d = this._rejectionHandler0;\n                              this._settlePromise0(\n                                this._fulfillmentHandler0,\n                                d,\n                                a\n                              ),\n                                this._fulfillPromises(b, d);\n                            }\n                            this._setLength(0);\n                          }\n                          this._clearCancellationData();\n                        }),\n                        (f.prototype._settledValue = function () {\n                          var a = this._bitField;\n                          return 0 != (33554432 & a)\n                            ? this._rejectionHandler0\n                            : 0 != (16777216 & a)\n                            ? this._fulfillmentHandler0\n                            : void 0;\n                        }),\n                        (f.defer = f.pending = function () {\n                          return (\n                            C.deprecated("Promise.defer", "new Promise"),\n                            {\n                              promise: new f(v),\n                              resolve: g,\n                              reject: h,\n                            }\n                          );\n                        }),\n                        o.notEnumerableProp(f, "_makeSelfResolutionError", k),\n                        b("./method")(f, v, y, m, C),\n                        b("./bind")(f, v, y, C),\n                        b("./cancel")(f, z, m, C),\n                        b("./direct_resolve")(f),\n                        b("./synchronous_inspection")(f),\n                        b("./join")(f, z, y, v, r, j),\n                        (f.Promise = f),\n                        (f.version = "3.5.1"),\n                        b("./map.js")(f, z, m, y, v, C),\n                        b("./call_get.js")(f),\n                        b("./using.js")(f, m, y, B, v, C),\n                        b("./timers.js")(f, v, C),\n                        b("./generators.js")(f, m, v, y, d, C),\n                        b("./nodeify.js")(f),\n                        b("./promisify.js")(f, v),\n                        b("./props.js")(f, z, y, m),\n                        b("./race.js")(f, v, y, m),\n                        b("./reduce.js")(f, z, m, y, v, C),\n                        b("./settle.js")(f, z, C),\n                        b("./some.js")(f, z, m),\n                        b("./filter.js")(f, v),\n                        b("./each.js")(f, v),\n                        b("./any.js")(f),\n                        o.toFastProperties(f),\n                        o.toFastProperties(f.prototype),\n                        i({\n                          a: 1,\n                        }),\n                        i({\n                          b: 2,\n                        }),\n                        i({\n                          c: 3,\n                        }),\n                        i(1),\n                        i(function () {}),\n                        i(void 0),\n                        i(!1),\n                        i(new f(v)),\n                        C.setBounds(q.firstLineError, o.lastLineError),\n                        f\n                      );\n                    };\n                  },\n                  {\n                    "./any.js": 1,\n                    "./async": 2,\n                    "./bind": 3,\n                    "./call_get.js": 5,\n                    "./cancel": 6,\n                    "./catch_filter": 7,\n                    "./context": 8,\n                    "./debuggability": 9,\n                    "./direct_resolve": 10,\n                    "./each.js": 11,\n                    "./errors": 12,\n                    "./es5": 13,\n                    "./filter.js": 14,\n                    "./finally": 15,\n                    "./generators.js": 16,\n                    "./join": 17,\n                    "./map.js": 18,\n                    "./method": 19,\n                    "./nodeback": 20,\n                    "./nodeify.js": 21,\n                    "./promise_array": 23,\n                    "./promisify.js": 24,\n                    "./props.js": 25,\n                    "./race.js": 27,\n                    "./reduce.js": 28,\n                    "./settle.js": 30,\n                    "./some.js": 31,\n                    "./synchronous_inspection": 32,\n                    "./thenables": 33,\n                    "./timers.js": 34,\n                    "./using.js": 35,\n                    "./util": 36,\n                  },\n                ],\n                23: [\n                  function (a, b, c) {\n                    "use strict";\n                    b.exports = function (b, c, d, e, f) {\n                      function g(a) {\n                        switch (a) {\n                          case -2:\n                            return [];\n\n                          case -3:\n                            return {};\n\n                          case -6:\n                            return new Map();\n                        }\n                      }\n                      function h(a) {\n                        var d = (this._promise = new b(c));\n                        a instanceof b && d._propagateFrom(a, 3),\n                          d._setOnCancel(this),\n                          (this._values = a),\n                          (this._length = 0),\n                          (this._totalResolved = 0),\n                          this._init(void 0, -2);\n                      }\n                      var i = a("./util");\n                      i.isArray;\n                      return (\n                        i.inherits(h, f),\n                        (h.prototype.length = function () {\n                          return this._length;\n                        }),\n                        (h.prototype.promise = function () {\n                          return this._promise;\n                        }),\n                        (h.prototype._init = function a(c, f) {\n                          var h = d(this._values, this._promise);\n                          if (h instanceof b) {\n                            h = h._target();\n                            var j = h._bitField;\n                            if (((this._values = h), 0 == (50397184 & j)))\n                              return (\n                                this._promise._setAsyncGuaranteed(),\n                                h._then(a, this._reject, void 0, this, f)\n                              );\n                            if (0 == (33554432 & j))\n                              return 0 != (16777216 & j)\n                                ? this._reject(h._reason())\n                                : this._cancel();\n                            h = h._value();\n                          }\n                          if (null === (h = i.asArray(h))) {\n                            var k = e(\n                              "expecting an array or an iterable object but got " +\n                                i.classString(h)\n                            ).reason();\n                            return void this._promise._rejectCallback(k, !1);\n                          }\n                          if (0 === h.length)\n                            return void (-5 === f\n                              ? this._resolveEmptyArray()\n                              : this._resolve(g(f)));\n                          this._iterate(h);\n                        }),\n                        (h.prototype._iterate = function (a) {\n                          var c = this.getActualLength(a.length);\n                          (this._length = c),\n                            (this._values = this.shouldCopyValues()\n                              ? new Array(c)\n                              : this._values);\n                          for (\n                            var e = this._promise, f = !1, g = null, h = 0;\n                            h < c;\n                            ++h\n                          ) {\n                            var i = d(a[h], e);\n                            i instanceof b\n                              ? ((i = i._target()), (g = i._bitField))\n                              : (g = null),\n                              f\n                                ? null !== g && i.suppressUnhandledRejections()\n                                : null !== g\n                                ? 0 == (50397184 & g)\n                                  ? (i._proxy(this, h), (this._values[h] = i))\n                                  : (f =\n                                      0 != (33554432 & g)\n                                        ? this._promiseFulfilled(i._value(), h)\n                                        : 0 != (16777216 & g)\n                                        ? this._promiseRejected(i._reason(), h)\n                                        : this._promiseCancelled(h))\n                                : (f = this._promiseFulfilled(i, h));\n                          }\n                          f || e._setAsyncGuaranteed();\n                        }),\n                        (h.prototype._isResolved = function () {\n                          return null === this._values;\n                        }),\n                        (h.prototype._resolve = function (a) {\n                          (this._values = null), this._promise._fulfill(a);\n                        }),\n                        (h.prototype._cancel = function () {\n                          !this._isResolved() &&\n                            this._promise._isCancellable() &&\n                            ((this._values = null), this._promise._cancel());\n                        }),\n                        (h.prototype._reject = function (a) {\n                          (this._values = null),\n                            this._promise._rejectCallback(a, !1);\n                        }),\n                        (h.prototype._promiseFulfilled = function (a, b) {\n                          return (\n                            (this._values[b] = a),\n                            ++this._totalResolved >= this._length &&\n                              (this._resolve(this._values), !0)\n                          );\n                        }),\n                        (h.prototype._promiseCancelled = function () {\n                          return this._cancel(), !0;\n                        }),\n                        (h.prototype._promiseRejected = function (a) {\n                          return this._totalResolved++, this._reject(a), !0;\n                        }),\n                        (h.prototype._resultCancelled = function () {\n                          if (!this._isResolved()) {\n                            var a = this._values;\n                            if ((this._cancel(), a instanceof b)) a.cancel();\n                            else\n                              for (var c = 0; c < a.length; ++c)\n                                a[c] instanceof b && a[c].cancel();\n                          }\n                        }),\n                        (h.prototype.shouldCopyValues = function () {\n                          return !0;\n                        }),\n                        (h.prototype.getActualLength = function (a) {\n                          return a;\n                        }),\n                        h\n                      );\n                    };\n                  },\n                  {\n                    "./util": 36,\n                  },\n                ],\n                24: [\n                  function (a, b, c) {\n                    "use strict";\n                    b.exports = function (b, c) {\n                      function d(a) {\n                        return !v.test(a);\n                      }\n                      function e(a) {\n                        try {\n                          return !0 === a.__isPromisified__;\n                        } catch (a) {\n                          return !1;\n                        }\n                      }\n                      function f(a, b, c) {\n                        var d = n.getDataPropertyOrDefault(a, b + c, t);\n                        return !!d && e(d);\n                      }\n                      function g(a, b, c) {\n                        for (var d = 0; d < a.length; d += 2) {\n                          var e = a[d];\n                          if (c.test(e))\n                            for (\n                              var f = e.replace(c, ""), g = 0;\n                              g < a.length;\n                              g += 2\n                            )\n                              if (a[g] === f)\n                                throw new s(\n                                  "Cannot promisify an API that has normal methods with \'%s\'-suffix\\n\\n    See http://goo.gl/MqrFmX\\n".replace(\n                                    "%s",\n                                    b\n                                  )\n                                );\n                        }\n                      }\n                      function h(a, b, c, d) {\n                        for (\n                          var h = n.inheritedDataKeys(a), i = [], j = 0;\n                          j < h.length;\n                          ++j\n                        ) {\n                          var k = h[j],\n                            l = a[k],\n                            m = d === w || w(k, l, a);\n                          "function" != typeof l ||\n                            e(l) ||\n                            f(a, k, b) ||\n                            !d(k, l, a, m) ||\n                            i.push(k, l);\n                        }\n                        return g(i, b, c), i;\n                      }\n                      function i(a, d, e, f, g, h) {\n                        function i() {\n                          var e = d;\n                          d === m && (e = this);\n                          var f = new b(c);\n                          f._captureStackTrace();\n                          var g =\n                              "string" == typeof k && this !== j ? this[k] : a,\n                            i = o(f, h);\n                          try {\n                            g.apply(e, p(arguments, i));\n                          } catch (a) {\n                            f._rejectCallback(q(a), !0, !0);\n                          }\n                          return (\n                            f._isFateSealed() || f._setAsyncGuaranteed(), f\n                          );\n                        }\n                        var j = (function () {\n                            return this;\n                          })(),\n                          k = a;\n                        return (\n                          "string" == typeof k && (a = f),\n                          n.notEnumerableProp(i, "__isPromisified__", !0),\n                          i\n                        );\n                      }\n                      function j(a, b, c, d, e) {\n                        for (\n                          var f = new RegExp(x(b) + "$"),\n                            g = h(a, b, f, c),\n                            i = 0,\n                            j = g.length;\n                          i < j;\n                          i += 2\n                        ) {\n                          var k = g[i],\n                            l = g[i + 1],\n                            o = k + b;\n                          if (d === y) a[o] = y(k, m, k, l, b, e);\n                          else {\n                            var p = d(l, function () {\n                              return y(k, m, k, l, b, e);\n                            });\n                            n.notEnumerableProp(p, "__isPromisified__", !0),\n                              (a[o] = p);\n                          }\n                        }\n                        return n.toFastProperties(a), a;\n                      }\n                      function k(a, b, c) {\n                        return y(a, b, void 0, a, null, c);\n                      }\n                      var l,\n                        m = {},\n                        n = a("./util"),\n                        o = a("./nodeback"),\n                        p = n.withAppended,\n                        q = n.maybeWrapAsError,\n                        r = n.canEvaluate,\n                        s = a("./errors").TypeError,\n                        t = {\n                          __isPromisified__: !0,\n                        },\n                        u = [\n                          "arity",\n                          "length",\n                          "name",\n                          "arguments",\n                          "caller",\n                          "callee",\n                          "prototype",\n                          "__isPromisified__",\n                        ],\n                        v = new RegExp("^(?:" + u.join("|") + ")$"),\n                        w = function (a) {\n                          return (\n                            n.isIdentifier(a) &&\n                            "_" !== a.charAt(0) &&\n                            "constructor" !== a\n                          );\n                        },\n                        x = function (a) {\n                          return a.replace(/([$])/, "\\\\$");\n                        },\n                        y = r ? l : i;\n                      (b.promisify = function (a, b) {\n                        if ("function" != typeof a)\n                          throw new s(\n                            "expecting a function but got " + n.classString(a)\n                          );\n                        if (e(a)) return a;\n                        b = Object(b);\n                        var c = void 0 === b.context ? m : b.context,\n                          f = !!b.multiArgs,\n                          g = k(a, c, f);\n                        return n.copyDescriptors(a, g, d), g;\n                      }),\n                        (b.promisifyAll = function (a, b) {\n                          if ("function" != typeof a && "object" != typeof a)\n                            throw new s(\n                              "the target of promisifyAll must be an object or a function\\n\\n    See http://goo.gl/MqrFmX\\n"\n                            );\n                          b = Object(b);\n                          var c = !!b.multiArgs,\n                            d = b.suffix;\n                          "string" != typeof d && (d = "Async");\n                          var e = b.filter;\n                          "function" != typeof e && (e = w);\n                          var f = b.promisifier;\n                          if (\n                            ("function" != typeof f && (f = y),\n                            !n.isIdentifier(d))\n                          )\n                            throw new RangeError(\n                              "suffix must be a valid identifier\\n\\n    See http://goo.gl/MqrFmX\\n"\n                            );\n                          for (\n                            var g = n.inheritedDataKeys(a), h = 0;\n                            h < g.length;\n                            ++h\n                          ) {\n                            var i = a[g[h]];\n                            "constructor" !== g[h] &&\n                              n.isClass(i) &&\n                              (j(i.prototype, d, e, f, c), j(i, d, e, f, c));\n                          }\n                          return j(a, d, e, f, c);\n                        });\n                    };\n                  },\n                  {\n                    "./errors": 12,\n                    "./nodeback": 20,\n                    "./util": 36,\n                  },\n                ],\n                25: [\n                  function (a, b, c) {\n                    "use strict";\n                    b.exports = function (b, c, d, e) {\n                      function f(a) {\n                        var b,\n                          c = !1;\n                        if (void 0 !== h && a instanceof h)\n                          (b = l(a)), (c = !0);\n                        else {\n                          var d = k.keys(a),\n                            e = d.length;\n                          b = new Array(2 * e);\n                          for (var f = 0; f < e; ++f) {\n                            var g = d[f];\n                            (b[f] = a[g]), (b[f + e] = g);\n                          }\n                        }\n                        this.constructor$(b),\n                          (this._isMap = c),\n                          this._init$(void 0, c ? -6 : -3);\n                      }\n                      function g(a) {\n                        var c,\n                          g = d(a);\n                        return j(g)\n                          ? ((c =\n                              g instanceof b\n                                ? g._then(\n                                    b.props,\n                                    void 0,\n                                    void 0,\n                                    void 0,\n                                    void 0\n                                  )\n                                : new f(g).promise()),\n                            g instanceof b && c._propagateFrom(g, 2),\n                            c)\n                          : e(\n                              "cannot await properties of a non-object\\n\\n    See http://goo.gl/MqrFmX\\n"\n                            );\n                      }\n                      var h,\n                        i = a("./util"),\n                        j = i.isObject,\n                        k = a("./es5");\n                      "function" == typeof Map && (h = Map);\n                      var l = (function () {\n                          function a(a, d) {\n                            (this[b] = a), (this[b + c] = d), b++;\n                          }\n                          var b = 0,\n                            c = 0;\n                          return function (d) {\n                            (c = d.size), (b = 0);\n                            var e = new Array(2 * d.size);\n                            return d.forEach(a, e), e;\n                          };\n                        })(),\n                        m = function (a) {\n                          for (\n                            var b = new h(), c = (a.length / 2) | 0, d = 0;\n                            d < c;\n                            ++d\n                          ) {\n                            var e = a[c + d],\n                              f = a[d];\n                            b.set(e, f);\n                          }\n                          return b;\n                        };\n                      i.inherits(f, c),\n                        (f.prototype._init = function () {}),\n                        (f.prototype._promiseFulfilled = function (a, b) {\n                          if (\n                            ((this._values[b] = a),\n                            ++this._totalResolved >= this._length)\n                          ) {\n                            var c;\n                            if (this._isMap) c = m(this._values);\n                            else {\n                              c = {};\n                              for (\n                                var d = this.length(), e = 0, f = this.length();\n                                e < f;\n                                ++e\n                              )\n                                c[this._values[e + d]] = this._values[e];\n                            }\n                            return this._resolve(c), !0;\n                          }\n                          return !1;\n                        }),\n                        (f.prototype.shouldCopyValues = function () {\n                          return !1;\n                        }),\n                        (f.prototype.getActualLength = function (a) {\n                          return a >> 1;\n                        }),\n                        (b.prototype.props = function () {\n                          return g(this);\n                        }),\n                        (b.props = function (a) {\n                          return g(a);\n                        });\n                    };\n                  },\n                  {\n                    "./es5": 13,\n                    "./util": 36,\n                  },\n                ],\n                26: [\n                  function (a, b, c) {\n                    "use strict";\n                    function d(a, b, c, d, e) {\n                      for (var f = 0; f < e; ++f)\n                        (c[f + d] = a[f + b]), (a[f + b] = void 0);\n                    }\n                    function e(a) {\n                      (this._capacity = a),\n                        (this._length = 0),\n                        (this._front = 0);\n                    }\n                    (e.prototype._willBeOverCapacity = function (a) {\n                      return this._capacity < a;\n                    }),\n                      (e.prototype._pushOne = function (a) {\n                        var b = this.length();\n                        this._checkCapacity(b + 1),\n                          (this[(this._front + b) & (this._capacity - 1)] = a),\n                          (this._length = b + 1);\n                      }),\n                      (e.prototype.push = function (a, b, c) {\n                        var d = this.length() + 3;\n                        if (this._willBeOverCapacity(d))\n                          return (\n                            this._pushOne(a),\n                            this._pushOne(b),\n                            void this._pushOne(c)\n                          );\n                        var e = this._front + d - 3;\n                        this._checkCapacity(d);\n                        var f = this._capacity - 1;\n                        (this[(e + 0) & f] = a),\n                          (this[(e + 1) & f] = b),\n                          (this[(e + 2) & f] = c),\n                          (this._length = d);\n                      }),\n                      (e.prototype.shift = function () {\n                        var a = this._front,\n                          b = this[a];\n                        return (\n                          (this[a] = void 0),\n                          (this._front = (a + 1) & (this._capacity - 1)),\n                          this._length--,\n                          b\n                        );\n                      }),\n                      (e.prototype.length = function () {\n                        return this._length;\n                      }),\n                      (e.prototype._checkCapacity = function (a) {\n                        this._capacity < a &&\n                          this._resizeTo(this._capacity << 1);\n                      }),\n                      (e.prototype._resizeTo = function (a) {\n                        var b = this._capacity;\n                        (this._capacity = a),\n                          d(\n                            this,\n                            0,\n                            this,\n                            b,\n                            (this._front + this._length) & (b - 1)\n                          );\n                      }),\n                      (b.exports = e);\n                  },\n                  {},\n                ],\n                27: [\n                  function (a, b, c) {\n                    "use strict";\n                    b.exports = function (b, c, d, e) {\n                      function f(a, f) {\n                        var i = d(a);\n                        if (i instanceof b) return h(i);\n                        if (null === (a = g.asArray(a)))\n                          return e(\n                            "expecting an array or an iterable object but got " +\n                              g.classString(a)\n                          );\n                        var j = new b(c);\n                        void 0 !== f && j._propagateFrom(f, 3);\n                        for (\n                          var k = j._fulfill,\n                            l = j._reject,\n                            m = 0,\n                            n = a.length;\n                          m < n;\n                          ++m\n                        ) {\n                          var o = a[m];\n                          (void 0 !== o || m in a) &&\n                            b.cast(o)._then(k, l, void 0, j, null);\n                        }\n                        return j;\n                      }\n                      var g = a("./util"),\n                        h = function (a) {\n                          return a.then(function (b) {\n                            return f(b, a);\n                          });\n                        };\n                      (b.race = function (a) {\n                        return f(a, void 0);\n                      }),\n                        (b.prototype.race = function () {\n                          return f(this, void 0);\n                        });\n                    };\n                  },\n                  {\n                    "./util": 36,\n                  },\n                ],\n                28: [\n                  function (a, b, c) {\n                    "use strict";\n                    b.exports = function (b, c, d, e, f, g) {\n                      function h(a, c, d, e) {\n                        this.constructor$(a);\n                        var g = m();\n                        (this._fn = null === g ? c : n.domainBind(g, c)),\n                          void 0 !== d &&\n                            ((d = b.resolve(d)),\n                            d._attachCancellationCallback(this)),\n                          (this._initialValue = d),\n                          (this._currentCancellable = null),\n                          (this._eachValues =\n                            e === f\n                              ? Array(this._length)\n                              : 0 === e\n                              ? null\n                              : void 0),\n                          this._promise._captureStackTrace(),\n                          this._init$(void 0, -5);\n                      }\n                      function i(a, b) {\n                        this.isFulfilled() ? b._resolve(a) : b._reject(a);\n                      }\n                      function j(a, b, c, e) {\n                        return "function" != typeof b\n                          ? d(\n                              "expecting a function but got " + n.classString(b)\n                            )\n                          : new h(a, b, c, e).promise();\n                      }\n                      function k(a) {\n                        (this.accum = a), this.array._gotAccum(a);\n                        var c = e(this.value, this.array._promise);\n                        return c instanceof b\n                          ? ((this.array._currentCancellable = c),\n                            c._then(l, void 0, void 0, this, void 0))\n                          : l.call(this, c);\n                      }\n                      function l(a) {\n                        var c = this.array,\n                          d = c._promise,\n                          e = o(c._fn);\n                        d._pushContext();\n                        var f;\n                        (f =\n                          void 0 !== c._eachValues\n                            ? e.call(\n                                d._boundValue(),\n                                a,\n                                this.index,\n                                this.length\n                              )\n                            : e.call(\n                                d._boundValue(),\n                                this.accum,\n                                a,\n                                this.index,\n                                this.length\n                              )) instanceof b && (c._currentCancellable = f);\n                        var h = d._popContext();\n                        return (\n                          g.checkForgottenReturns(\n                            f,\n                            h,\n                            void 0 !== c._eachValues\n                              ? "Promise.each"\n                              : "Promise.reduce",\n                            d\n                          ),\n                          f\n                        );\n                      }\n                      var m = b._getDomain,\n                        n = a("./util"),\n                        o = n.tryCatch;\n                      n.inherits(h, c),\n                        (h.prototype._gotAccum = function (a) {\n                          void 0 !== this._eachValues &&\n                            null !== this._eachValues &&\n                            a !== f &&\n                            this._eachValues.push(a);\n                        }),\n                        (h.prototype._eachComplete = function (a) {\n                          return (\n                            null !== this._eachValues &&\n                              this._eachValues.push(a),\n                            this._eachValues\n                          );\n                        }),\n                        (h.prototype._init = function () {}),\n                        (h.prototype._resolveEmptyArray = function () {\n                          this._resolve(\n                            void 0 !== this._eachValues\n                              ? this._eachValues\n                              : this._initialValue\n                          );\n                        }),\n                        (h.prototype.shouldCopyValues = function () {\n                          return !1;\n                        }),\n                        (h.prototype._resolve = function (a) {\n                          this._promise._resolveCallback(a),\n                            (this._values = null);\n                        }),\n                        (h.prototype._resultCancelled = function (a) {\n                          if (a === this._initialValue) return this._cancel();\n                          this._isResolved() ||\n                            (this._resultCancelled$(),\n                            this._currentCancellable instanceof b &&\n                              this._currentCancellable.cancel(),\n                            this._initialValue instanceof b &&\n                              this._initialValue.cancel());\n                        }),\n                        (h.prototype._iterate = function (a) {\n                          this._values = a;\n                          var c,\n                            d,\n                            e = a.length;\n                          if (\n                            (void 0 !== this._initialValue\n                              ? ((c = this._initialValue), (d = 0))\n                              : ((c = b.resolve(a[0])), (d = 1)),\n                            (this._currentCancellable = c),\n                            !c.isRejected())\n                          )\n                            for (; d < e; ++d) {\n                              var f = {\n                                accum: null,\n                                value: a[d],\n                                index: d,\n                                length: e,\n                                array: this,\n                              };\n                              c = c._then(k, void 0, void 0, f, void 0);\n                            }\n                          void 0 !== this._eachValues &&\n                            (c = c._then(\n                              this._eachComplete,\n                              void 0,\n                              void 0,\n                              this,\n                              void 0\n                            )),\n                            c._then(i, i, void 0, c, this);\n                        }),\n                        (b.prototype.reduce = function (a, b) {\n                          return j(this, a, b, null);\n                        }),\n                        (b.reduce = function (a, b, c, d) {\n                          return j(a, b, c, d);\n                        });\n                    };\n                  },\n                  {\n                    "./util": 36,\n                  },\n                ],\n                29: [\n                  function (b, c, f) {\n                    "use strict";\n                    var g,\n                      h = b("./util"),\n                      i = function () {\n                        throw new Error(\n                          "No async scheduler available\\n\\n    See http://goo.gl/MqrFmX\\n"\n                        );\n                      },\n                      j = h.getNativePromise();\n                    if (h.isNode && "undefined" == typeof MutationObserver) {\n                      var k = d.setImmediate,\n                        l = a.nextTick;\n                      g = h.isRecentNode\n                        ? function (a) {\n                            k.call(d, a);\n                          }\n                        : function (b) {\n                            l.call(a, b);\n                          };\n                    } else if (\n                      "function" == typeof j &&\n                      "function" == typeof j.resolve\n                    ) {\n                      var m = j.resolve();\n                      g = function (a) {\n                        m.then(a);\n                      };\n                    } else\n                      g =\n                        "undefined" == typeof MutationObserver ||\n                        ("undefined" != typeof window &&\n                          window.navigator &&\n                          (window.navigator.standalone || window.cordova))\n                          ? void 0 !== e\n                            ? function (a) {\n                                e(a);\n                              }\n                            : "undefined" != typeof setTimeout\n                            ? function (a) {\n                                setTimeout(a, 0);\n                              }\n                            : i\n                          : (function () {\n                              var a = document.createElement("div"),\n                                b = {\n                                  attributes: !0,\n                                },\n                                c = !1,\n                                d = document.createElement("div");\n                              new MutationObserver(function () {\n                                a.classList.toggle("foo"), (c = !1);\n                              }).observe(d, b);\n                              var e = function () {\n                                c || ((c = !0), d.classList.toggle("foo"));\n                              };\n                              return function (c) {\n                                var d = new MutationObserver(function () {\n                                  d.disconnect(), c();\n                                });\n                                d.observe(a, b), e();\n                              };\n                            })();\n                    c.exports = g;\n                  },\n                  {\n                    "./util": 36,\n                  },\n                ],\n                30: [\n                  function (a, b, c) {\n                    "use strict";\n                    b.exports = function (b, c, d) {\n                      function e(a) {\n                        this.constructor$(a);\n                      }\n                      var f = b.PromiseInspection;\n                      a("./util").inherits(e, c),\n                        (e.prototype._promiseResolved = function (a, b) {\n                          return (\n                            (this._values[a] = b),\n                            ++this._totalResolved >= this._length &&\n                              (this._resolve(this._values), !0)\n                          );\n                        }),\n                        (e.prototype._promiseFulfilled = function (a, b) {\n                          var c = new f();\n                          return (\n                            (c._bitField = 33554432),\n                            (c._settledValueField = a),\n                            this._promiseResolved(b, c)\n                          );\n                        }),\n                        (e.prototype._promiseRejected = function (a, b) {\n                          var c = new f();\n                          return (\n                            (c._bitField = 16777216),\n                            (c._settledValueField = a),\n                            this._promiseResolved(b, c)\n                          );\n                        }),\n                        (b.settle = function (a) {\n                          return (\n                            d.deprecated(".settle()", ".reflect()"),\n                            new e(a).promise()\n                          );\n                        }),\n                        (b.prototype.settle = function () {\n                          return b.settle(this);\n                        });\n                    };\n                  },\n                  {\n                    "./util": 36,\n                  },\n                ],\n                31: [\n                  function (a, b, c) {\n                    "use strict";\n                    b.exports = function (b, c, d) {\n                      function e(a) {\n                        this.constructor$(a),\n                          (this._howMany = 0),\n                          (this._unwrap = !1),\n                          (this._initialized = !1);\n                      }\n                      function f(a, b) {\n                        if ((0 | b) !== b || b < 0)\n                          return d(\n                            "expecting a positive integer\\n\\n    See http://goo.gl/MqrFmX\\n"\n                          );\n                        var c = new e(a),\n                          f = c.promise();\n                        return c.setHowMany(b), c.init(), f;\n                      }\n                      var g = a("./util"),\n                        h = a("./errors").RangeError,\n                        i = a("./errors").AggregateError,\n                        j = g.isArray,\n                        k = {};\n                      g.inherits(e, c),\n                        (e.prototype._init = function () {\n                          if (this._initialized) {\n                            if (0 === this._howMany)\n                              return void this._resolve([]);\n                            this._init$(void 0, -5);\n                            var a = j(this._values);\n                            !this._isResolved() &&\n                              a &&\n                              this._howMany > this._canPossiblyFulfill() &&\n                              this._reject(this._getRangeError(this.length()));\n                          }\n                        }),\n                        (e.prototype.init = function () {\n                          (this._initialized = !0), this._init();\n                        }),\n                        (e.prototype.setUnwrap = function () {\n                          this._unwrap = !0;\n                        }),\n                        (e.prototype.howMany = function () {\n                          return this._howMany;\n                        }),\n                        (e.prototype.setHowMany = function (a) {\n                          this._howMany = a;\n                        }),\n                        (e.prototype._promiseFulfilled = function (a) {\n                          return (\n                            this._addFulfilled(a),\n                            this._fulfilled() === this.howMany() &&\n                              ((this._values.length = this.howMany()),\n                              1 === this.howMany() && this._unwrap\n                                ? this._resolve(this._values[0])\n                                : this._resolve(this._values),\n                              !0)\n                          );\n                        }),\n                        (e.prototype._promiseRejected = function (a) {\n                          return this._addRejected(a), this._checkOutcome();\n                        }),\n                        (e.prototype._promiseCancelled = function () {\n                          return this._values instanceof b ||\n                            null == this._values\n                            ? this._cancel()\n                            : (this._addRejected(k), this._checkOutcome());\n                        }),\n                        (e.prototype._checkOutcome = function () {\n                          if (this.howMany() > this._canPossiblyFulfill()) {\n                            for (\n                              var a = new i(), b = this.length();\n                              b < this._values.length;\n                              ++b\n                            )\n                              this._values[b] !== k && a.push(this._values[b]);\n                            return (\n                              a.length > 0 ? this._reject(a) : this._cancel(),\n                              !0\n                            );\n                          }\n                          return !1;\n                        }),\n                        (e.prototype._fulfilled = function () {\n                          return this._totalResolved;\n                        }),\n                        (e.prototype._rejected = function () {\n                          return this._values.length - this.length();\n                        }),\n                        (e.prototype._addRejected = function (a) {\n                          this._values.push(a);\n                        }),\n                        (e.prototype._addFulfilled = function (a) {\n                          this._values[this._totalResolved++] = a;\n                        }),\n                        (e.prototype._canPossiblyFulfill = function () {\n                          return this.length() - this._rejected();\n                        }),\n                        (e.prototype._getRangeError = function (a) {\n                          var b =\n                            "Input array must contain at least " +\n                            this._howMany +\n                            " items but contains only " +\n                            a +\n                            " items";\n                          return new h(b);\n                        }),\n                        (e.prototype._resolveEmptyArray = function () {\n                          this._reject(this._getRangeError(0));\n                        }),\n                        (b.some = function (a, b) {\n                          return f(a, b);\n                        }),\n                        (b.prototype.some = function (a) {\n                          return f(this, a);\n                        }),\n                        (b._SomePromiseArray = e);\n                    };\n                  },\n                  {\n                    "./errors": 12,\n                    "./util": 36,\n                  },\n                ],\n                32: [\n                  function (a, b, c) {\n                    "use strict";\n                    b.exports = function (a) {\n                      function b(a) {\n                        void 0 !== a\n                          ? ((a = a._target()),\n                            (this._bitField = a._bitField),\n                            (this._settledValueField = a._isFateSealed()\n                              ? a._settledValue()\n                              : void 0))\n                          : ((this._bitField = 0),\n                            (this._settledValueField = void 0));\n                      }\n                      b.prototype._settledValue = function () {\n                        return this._settledValueField;\n                      };\n                      var c = (b.prototype.value = function () {\n                          if (!this.isFulfilled())\n                            throw new TypeError(\n                              "cannot get fulfillment value of a non-fulfilled promise\\n\\n    See http://goo.gl/MqrFmX\\n"\n                            );\n                          return this._settledValue();\n                        }),\n                        d = (b.prototype.error = b.prototype.reason = function () {\n                          if (!this.isRejected())\n                            throw new TypeError(\n                              "cannot get rejection reason of a non-rejected promise\\n\\n    See http://goo.gl/MqrFmX\\n"\n                            );\n                          return this._settledValue();\n                        }),\n                        e = (b.prototype.isFulfilled = function () {\n                          return 0 != (33554432 & this._bitField);\n                        }),\n                        f = (b.prototype.isRejected = function () {\n                          return 0 != (16777216 & this._bitField);\n                        }),\n                        g = (b.prototype.isPending = function () {\n                          return 0 == (50397184 & this._bitField);\n                        }),\n                        h = (b.prototype.isResolved = function () {\n                          return 0 != (50331648 & this._bitField);\n                        });\n                      (b.prototype.isCancelled = function () {\n                        return 0 != (8454144 & this._bitField);\n                      }),\n                        (a.prototype.__isCancelled = function () {\n                          return 65536 == (65536 & this._bitField);\n                        }),\n                        (a.prototype._isCancelled = function () {\n                          return this._target().__isCancelled();\n                        }),\n                        (a.prototype.isCancelled = function () {\n                          return 0 != (8454144 & this._target()._bitField);\n                        }),\n                        (a.prototype.isPending = function () {\n                          return g.call(this._target());\n                        }),\n                        (a.prototype.isRejected = function () {\n                          return f.call(this._target());\n                        }),\n                        (a.prototype.isFulfilled = function () {\n                          return e.call(this._target());\n                        }),\n                        (a.prototype.isResolved = function () {\n                          return h.call(this._target());\n                        }),\n                        (a.prototype.value = function () {\n                          return c.call(this._target());\n                        }),\n                        (a.prototype.reason = function () {\n                          var a = this._target();\n                          return a._unsetRejectionIsUnhandled(), d.call(a);\n                        }),\n                        (a.prototype._value = function () {\n                          return this._settledValue();\n                        }),\n                        (a.prototype._reason = function () {\n                          return (\n                            this._unsetRejectionIsUnhandled(),\n                            this._settledValue()\n                          );\n                        }),\n                        (a.PromiseInspection = b);\n                    };\n                  },\n                  {},\n                ],\n                33: [\n                  function (a, b, c) {\n                    "use strict";\n                    b.exports = function (b, c) {\n                      function d(a, d) {\n                        if (k(a)) {\n                          if (a instanceof b) return a;\n                          var e = f(a);\n                          if (e === j) {\n                            d && d._pushContext();\n                            var i = b.reject(e.e);\n                            return d && d._popContext(), i;\n                          }\n                          if ("function" == typeof e) {\n                            if (g(a)) {\n                              var i = new b(c);\n                              return (\n                                a._then(i._fulfill, i._reject, void 0, i, null),\n                                i\n                              );\n                            }\n                            return h(a, e, d);\n                          }\n                        }\n                        return a;\n                      }\n                      function e(a) {\n                        return a.then;\n                      }\n                      function f(a) {\n                        try {\n                          return e(a);\n                        } catch (a) {\n                          return (j.e = a), j;\n                        }\n                      }\n                      function g(a) {\n                        try {\n                          return l.call(a, "_promise0");\n                        } catch (a) {\n                          return !1;\n                        }\n                      }\n                      function h(a, d, e) {\n                        function f(a) {\n                          h && (h._resolveCallback(a), (h = null));\n                        }\n                        function g(a) {\n                          h && (h._rejectCallback(a, l, !0), (h = null));\n                        }\n                        var h = new b(c),\n                          k = h;\n                        e && e._pushContext(),\n                          h._captureStackTrace(),\n                          e && e._popContext();\n                        var l = !0,\n                          m = i.tryCatch(d).call(a, f, g);\n                        return (\n                          (l = !1),\n                          h &&\n                            m === j &&\n                            (h._rejectCallback(m.e, !0, !0), (h = null)),\n                          k\n                        );\n                      }\n                      var i = a("./util"),\n                        j = i.errorObj,\n                        k = i.isObject,\n                        l = {}.hasOwnProperty;\n                      return d;\n                    };\n                  },\n                  {\n                    "./util": 36,\n                  },\n                ],\n                34: [\n                  function (a, b, c) {\n                    "use strict";\n                    b.exports = function (b, c, d) {\n                      function e(a) {\n                        this.handle = a;\n                      }\n                      function f(a) {\n                        return clearTimeout(this.handle), a;\n                      }\n                      function g(a) {\n                        throw (clearTimeout(this.handle), a);\n                      }\n                      var h = a("./util"),\n                        i = b.TimeoutError;\n                      e.prototype._resultCancelled = function () {\n                        clearTimeout(this.handle);\n                      };\n                      var j = function (a) {\n                          return k(+this).thenReturn(a);\n                        },\n                        k = (b.delay = function (a, f) {\n                          var g, h;\n                          return (\n                            void 0 !== f\n                              ? ((g = b\n                                  .resolve(f)\n                                  ._then(j, null, null, a, void 0)),\n                                d.cancellation() &&\n                                  f instanceof b &&\n                                  g._setOnCancel(f))\n                              : ((g = new b(c)),\n                                (h = setTimeout(function () {\n                                  g._fulfill();\n                                }, +a)),\n                                d.cancellation() && g._setOnCancel(new e(h)),\n                                g._captureStackTrace()),\n                            g._setAsyncGuaranteed(),\n                            g\n                          );\n                        });\n                      b.prototype.delay = function (a) {\n                        return k(a, this);\n                      };\n                      var l = function (a, b, c) {\n                        var d;\n                        (d =\n                          "string" != typeof b\n                            ? b instanceof Error\n                              ? b\n                              : new i("operation timed out")\n                            : new i(b)),\n                          h.markAsOriginatingFromRejection(d),\n                          a._attachExtraTrace(d),\n                          a._reject(d),\n                          null != c && c.cancel();\n                      };\n                      b.prototype.timeout = function (a, b) {\n                        a = +a;\n                        var c,\n                          h,\n                          i = new e(\n                            setTimeout(function () {\n                              c.isPending() && l(c, b, h);\n                            }, a)\n                          );\n                        return (\n                          d.cancellation()\n                            ? ((h = this.then()),\n                              (c = h._then(f, g, void 0, i, void 0)),\n                              c._setOnCancel(i))\n                            : (c = this._then(f, g, void 0, i, void 0)),\n                          c\n                        );\n                      };\n                    };\n                  },\n                  {\n                    "./util": 36,\n                  },\n                ],\n                35: [\n                  function (a, b, c) {\n                    "use strict";\n                    b.exports = function (b, c, d, e, f, g) {\n                      function h(a) {\n                        setTimeout(function () {\n                          throw a;\n                        }, 0);\n                      }\n                      function i(a) {\n                        var b = d(a);\n                        return (\n                          b !== a &&\n                            "function" == typeof a._isDisposable &&\n                            "function" == typeof a._getDisposer &&\n                            a._isDisposable() &&\n                            b._setDisposable(a._getDisposer()),\n                          b\n                        );\n                      }\n                      function j(a, c) {\n                        function e() {\n                          if (g >= j) return k._fulfill();\n                          var f = i(a[g++]);\n                          if (f instanceof b && f._isDisposable()) {\n                            try {\n                              f = d(f._getDisposer().tryDispose(c), a.promise);\n                            } catch (a) {\n                              return h(a);\n                            }\n                            if (f instanceof b)\n                              return f._then(e, h, null, null, null);\n                          }\n                          e();\n                        }\n                        var g = 0,\n                          j = a.length,\n                          k = new b(f);\n                        return e(), k;\n                      }\n                      function k(a, b, c) {\n                        (this._data = a),\n                          (this._promise = b),\n                          (this._context = c);\n                      }\n                      function l(a, b, c) {\n                        this.constructor$(a, b, c);\n                      }\n                      function m(a) {\n                        return k.isDisposer(a)\n                          ? (this.resources[this.index]._setDisposable(a),\n                            a.promise())\n                          : a;\n                      }\n                      function n(a) {\n                        (this.length = a),\n                          (this.promise = null),\n                          (this[a - 1] = null);\n                      }\n                      var o = a("./util"),\n                        p = a("./errors").TypeError,\n                        q = a("./util").inherits,\n                        r = o.errorObj,\n                        s = o.tryCatch,\n                        t = {};\n                      (k.prototype.data = function () {\n                        return this._data;\n                      }),\n                        (k.prototype.promise = function () {\n                          return this._promise;\n                        }),\n                        (k.prototype.resource = function () {\n                          return this.promise().isFulfilled()\n                            ? this.promise().value()\n                            : t;\n                        }),\n                        (k.prototype.tryDispose = function (a) {\n                          var b = this.resource(),\n                            c = this._context;\n                          void 0 !== c && c._pushContext();\n                          var d = b !== t ? this.doDispose(b, a) : null;\n                          return (\n                            void 0 !== c && c._popContext(),\n                            this._promise._unsetDisposable(),\n                            (this._data = null),\n                            d\n                          );\n                        }),\n                        (k.isDisposer = function (a) {\n                          return (\n                            null != a &&\n                            "function" == typeof a.resource &&\n                            "function" == typeof a.tryDispose\n                          );\n                        }),\n                        q(l, k),\n                        (l.prototype.doDispose = function (a, b) {\n                          return this.data().call(a, a, b);\n                        }),\n                        (n.prototype._resultCancelled = function () {\n                          for (var a = this.length, c = 0; c < a; ++c) {\n                            var d = this[c];\n                            d instanceof b && d.cancel();\n                          }\n                        }),\n                        (b.using = function () {\n                          var a = arguments.length;\n                          if (a < 2)\n                            return c(\n                              "you must pass at least 2 arguments to Promise.using"\n                            );\n                          var e = arguments[a - 1];\n                          if ("function" != typeof e)\n                            return c(\n                              "expecting a function but got " + o.classString(e)\n                            );\n                          var f,\n                            h = !0;\n                          2 === a && Array.isArray(arguments[0])\n                            ? ((f = arguments[0]), (a = f.length), (h = !1))\n                            : ((f = arguments), a--);\n                          for (var i = new n(a), l = 0; l < a; ++l) {\n                            var p = f[l];\n                            if (k.isDisposer(p)) {\n                              var q = p;\n                              (p = p.promise()), p._setDisposable(q);\n                            } else {\n                              var t = d(p);\n                              t instanceof b &&\n                                (p = t._then(\n                                  m,\n                                  null,\n                                  null,\n                                  {\n                                    resources: i,\n                                    index: l,\n                                  },\n                                  void 0\n                                ));\n                            }\n                            i[l] = p;\n                          }\n                          for (\n                            var u = new Array(i.length), l = 0;\n                            l < u.length;\n                            ++l\n                          )\n                            u[l] = b.resolve(i[l]).reflect();\n                          var v = b.all(u).then(function (a) {\n                              for (var b = 0; b < a.length; ++b) {\n                                var c = a[b];\n                                if (c.isRejected()) return (r.e = c.error()), r;\n                                if (!c.isFulfilled()) return void v.cancel();\n                                a[b] = c.value();\n                              }\n                              w._pushContext(), (e = s(e));\n                              var d = h ? e.apply(void 0, a) : e(a),\n                                f = w._popContext();\n                              return (\n                                g.checkForgottenReturns(\n                                  d,\n                                  f,\n                                  "Promise.using",\n                                  w\n                                ),\n                                d\n                              );\n                            }),\n                            w = v.lastly(function () {\n                              var a = new b.PromiseInspection(v);\n                              return j(i, a);\n                            });\n                          return (i.promise = w), w._setOnCancel(i), w;\n                        }),\n                        (b.prototype._setDisposable = function (a) {\n                          (this._bitField = 131072 | this._bitField),\n                            (this._disposer = a);\n                        }),\n                        (b.prototype._isDisposable = function () {\n                          return (131072 & this._bitField) > 0;\n                        }),\n                        (b.prototype._getDisposer = function () {\n                          return this._disposer;\n                        }),\n                        (b.prototype._unsetDisposable = function () {\n                          (this._bitField = -131073 & this._bitField),\n                            (this._disposer = void 0);\n                        }),\n                        (b.prototype.disposer = function (a) {\n                          if ("function" == typeof a)\n                            return new l(a, this, e());\n                          throw new p();\n                        });\n                    };\n                  },\n                  {\n                    "./errors": 12,\n                    "./util": 36,\n                  },\n                ],\n                36: [\n                  function (b, c, e) {\n                    "use strict";\n                    function f() {\n                      try {\n                        var a = F;\n                        return (F = null), a.apply(this, arguments);\n                      } catch (a) {\n                        return (E.e = a), E;\n                      }\n                    }\n                    function g(a) {\n                      return (F = a), f;\n                    }\n                    function h(a) {\n                      return (\n                        null == a ||\n                        !0 === a ||\n                        !1 === a ||\n                        "string" == typeof a ||\n                        "number" == typeof a\n                      );\n                    }\n                    function i(a) {\n                      return (\n                        "function" == typeof a ||\n                        ("object" == typeof a && null !== a)\n                      );\n                    }\n                    function j(a) {\n                      return h(a) ? new Error(s(a)) : a;\n                    }\n                    function k(a, b) {\n                      var c,\n                        d = a.length,\n                        e = new Array(d + 1);\n                      for (c = 0; c < d; ++c) e[c] = a[c];\n                      return (e[c] = b), e;\n                    }\n                    function l(a, b, c) {\n                      if (!C.isES5)\n                        return {}.hasOwnProperty.call(a, b) ? a[b] : void 0;\n                      var d = Object.getOwnPropertyDescriptor(a, b);\n                      return null != d\n                        ? null == d.get && null == d.set\n                          ? d.value\n                          : c\n                        : void 0;\n                    }\n                    function m(a, b, c) {\n                      if (h(a)) return a;\n                      var d = {\n                        value: c,\n                        configurable: !0,\n                        enumerable: !1,\n                        writable: !0,\n                      };\n                      return C.defineProperty(a, b, d), a;\n                    }\n                    function n(a) {\n                      throw a;\n                    }\n                    function o(a) {\n                      try {\n                        if ("function" == typeof a) {\n                          var b = C.names(a.prototype),\n                            c = C.isES5 && b.length > 1,\n                            d =\n                              b.length > 0 &&\n                              !(1 === b.length && "constructor" === b[0]),\n                            e = J.test(a + "") && C.names(a).length > 0;\n                          if (c || d || e) return !0;\n                        }\n                        return !1;\n                      } catch (a) {\n                        return !1;\n                      }\n                    }\n                    function p(a) {\n                      function b() {}\n                      b.prototype = a;\n                      for (var c = 8; c--; ) new b();\n                      return a;\n                    }\n                    function q(a) {\n                      return K.test(a);\n                    }\n                    function r(a, b, c) {\n                      for (var d = new Array(a), e = 0; e < a; ++e)\n                        d[e] = b + e + c;\n                      return d;\n                    }\n                    function s(a) {\n                      try {\n                        return a + "";\n                      } catch (a) {\n                        return "[no string representation]";\n                      }\n                    }\n                    function t(a) {\n                      return (\n                        a instanceof Error ||\n                        (null !== a &&\n                          "object" == typeof a &&\n                          "string" == typeof a.message &&\n                          "string" == typeof a.name)\n                      );\n                    }\n                    function u(a) {\n                      try {\n                        m(a, "isOperational", !0);\n                      } catch (a) {}\n                    }\n                    function v(a) {\n                      return (\n                        null != a &&\n                        (a instanceof\n                          Error.__BluebirdErrorTypes__.OperationalError ||\n                          !0 === a.isOperational)\n                      );\n                    }\n                    function w(a) {\n                      return t(a) && C.propertyIsWritable(a, "stack");\n                    }\n                    function x(a) {\n                      return {}.toString.call(a);\n                    }\n                    function y(a, b, c) {\n                      for (var d = C.names(a), e = 0; e < d.length; ++e) {\n                        var f = d[e];\n                        if (c(f))\n                          try {\n                            C.defineProperty(b, f, C.getDescriptor(a, f));\n                          } catch (a) {}\n                      }\n                    }\n                    function z(b) {\n                      return P ? a.env[b] : void 0;\n                    }\n                    function A() {\n                      if ("function" == typeof Promise)\n                        try {\n                          var a = new Promise(function () {});\n                          if ("[object Promise]" === {}.toString.call(a))\n                            return Promise;\n                        } catch (a) {}\n                    }\n                    function B(a, b) {\n                      return a.bind(b);\n                    }\n                    var C = b("./es5"),\n                      D = "undefined" == typeof navigator,\n                      E = {\n                        e: {},\n                      },\n                      F,\n                      G =\n                        "undefined" != typeof self\n                          ? self\n                          : "undefined" != typeof window\n                          ? window\n                          : void 0 !== d\n                          ? d\n                          : void 0 !== this\n                          ? this\n                          : null,\n                      H = function (a, b) {\n                        function c() {\n                          (this.constructor = a), (this.constructor$ = b);\n                          for (var c in b.prototype)\n                            d.call(b.prototype, c) &&\n                              "$" !== c.charAt(c.length - 1) &&\n                              (this[c + "$"] = b.prototype[c]);\n                        }\n                        var d = {}.hasOwnProperty;\n                        return (\n                          (c.prototype = b.prototype),\n                          (a.prototype = new c()),\n                          a.prototype\n                        );\n                      },\n                      I = (function () {\n                        var a = [\n                            Array.prototype,\n                            Object.prototype,\n                            Function.prototype,\n                          ],\n                          b = function (b) {\n                            for (var c = 0; c < a.length; ++c)\n                              if (a[c] === b) return !0;\n                            return !1;\n                          };\n                        if (C.isES5) {\n                          var c = Object.getOwnPropertyNames;\n                          return function (a) {\n                            for (\n                              var d = [], e = Object.create(null);\n                              null != a && !b(a);\n\n                            ) {\n                              var f;\n                              try {\n                                f = c(a);\n                              } catch (a) {\n                                return d;\n                              }\n                              for (var g = 0; g < f.length; ++g) {\n                                var h = f[g];\n                                if (!e[h]) {\n                                  e[h] = !0;\n                                  var i = Object.getOwnPropertyDescriptor(a, h);\n                                  null != i &&\n                                    null == i.get &&\n                                    null == i.set &&\n                                    d.push(h);\n                                }\n                              }\n                              a = C.getPrototypeOf(a);\n                            }\n                            return d;\n                          };\n                        }\n                        var d = {}.hasOwnProperty;\n                        return function (c) {\n                          if (b(c)) return [];\n                          var e = [];\n                          a: for (var f in c)\n                            if (d.call(c, f)) e.push(f);\n                            else {\n                              for (var g = 0; g < a.length; ++g)\n                                if (d.call(a[g], f)) continue a;\n                              e.push(f);\n                            }\n                          return e;\n                        };\n                      })(),\n                      J = /this\\s*\\.\\s*\\S+\\s*=/,\n                      K = /^[a-z$_][a-z$_0-9]*$/i,\n                      L = (function () {\n                        return "stack" in new Error()\n                          ? function (a) {\n                              return w(a) ? a : new Error(s(a));\n                            }\n                          : function (a) {\n                              if (w(a)) return a;\n                              try {\n                                throw new Error(s(a));\n                              } catch (a) {\n                                return a;\n                              }\n                            };\n                      })(),\n                      M = function (a) {\n                        return C.isArray(a) ? a : null;\n                      };\n                    if ("undefined" != typeof Symbol && Symbol.iterator) {\n                      var N =\n                        "function" == typeof Array.from\n                          ? function (a) {\n                              return Array.from(a);\n                            }\n                          : function (a) {\n                              for (\n                                var b, c = [], d = a[Symbol.iterator]();\n                                !(b = d.next()).done;\n\n                              )\n                                c.push(b.value);\n                              return c;\n                            };\n                      M = function (a) {\n                        return C.isArray(a)\n                          ? a\n                          : null != a && "function" == typeof a[Symbol.iterator]\n                          ? N(a)\n                          : null;\n                      };\n                    }\n                    var O =\n                        void 0 !== a &&\n                        "[object process]" === x(a).toLowerCase(),\n                      P = void 0 !== a && void 0 !== a.env,\n                      Q = {\n                        isClass: o,\n                        isIdentifier: q,\n                        inheritedDataKeys: I,\n                        getDataPropertyOrDefault: l,\n                        thrower: n,\n                        isArray: C.isArray,\n                        asArray: M,\n                        notEnumerableProp: m,\n                        isPrimitive: h,\n                        isObject: i,\n                        isError: t,\n                        canEvaluate: D,\n                        errorObj: E,\n                        tryCatch: g,\n                        inherits: H,\n                        withAppended: k,\n                        maybeWrapAsError: j,\n                        toFastProperties: p,\n                        filledRange: r,\n                        toString: s,\n                        canAttachTrace: w,\n                        ensureErrorObject: L,\n                        originatesFromRejection: v,\n                        markAsOriginatingFromRejection: u,\n                        classString: x,\n                        copyDescriptors: y,\n                        hasDevTools:\n                          "undefined" != typeof chrome &&\n                          chrome &&\n                          "function" == typeof chrome.loadTimes,\n                        isNode: O,\n                        hasEnvVariables: P,\n                        env: z,\n                        global: G,\n                        getNativePromise: A,\n                        domainBind: B,\n                      };\n                    (Q.isRecentNode =\n                      Q.isNode &&\n                      (function () {\n                        var b = a.versions.node.split(".").map(Number);\n                        return (0 === b[0] && b[1] > 10) || b[0] > 0;\n                      })()),\n                      Q.isNode && Q.toFastProperties(a);\n                    try {\n                      throw new Error();\n                    } catch (a) {\n                      Q.lastLineError = a;\n                    }\n                    c.exports = Q;\n                  },\n                  {\n                    "./es5": 13,\n                  },\n                ],\n              },\n              {},\n              [4]\n            )(4);\n          }),\n            "undefined" != typeof window && null !== window\n              ? (window.P = window.Promise)\n              : "undefined" != typeof self &&\n                null !== self &&\n                (self.P = self.Promise);\n        }.call(\n          this,\n          a("_process"),\n          "undefined" != typeof global\n            ? global\n            : "undefined" != typeof self\n            ? self\n            : "undefined" != typeof window\n            ? window\n            : {},\n          a("timers").setImmediate\n        ));\n      },\n      {\n        _process: 15,\n        timers: 16,\n      },\n    ],\n    2: [\n      function (a, b, c) {\n        "use strict";\n        function d(a, b) {\n          if (!(a instanceof b))\n            throw new TypeError("Cannot call a class as a function");\n        }\n        Object.defineProperty(c, "__esModule", {\n          value: !0,\n        }),\n          (c.PreCallTest = void 0);\n        var e = (function () {\n            function a(a, b) {\n              for (var c = 0; c < b.length; c++) {\n                var d = b[c];\n                (d.enumerable = d.enumerable || !1),\n                  (d.configurable = !0),\n                  "value" in d && (d.writable = !0),\n                  Object.defineProperty(a, d.key, d);\n              }\n            }\n            return function (b, c, d) {\n              return c && a(b.prototype, c), d && a(b, d), b;\n            };\n          })(),\n          f = a("./turnConnection"),\n          g = a("./tests/rttTest"),\n          h = a("./tests/throughputTest"),\n          i = a("./utility/resultsHandler"),\n          j = a("./utility/onlineCheck"),\n          k = a("./utility/stats/detectbrowser"),\n          l = a("bluebird"),\n          m = {\n            RTT: "rtt",\n            THROUGHPUT: "throughput",\n          },\n          n = (function () {\n            function a() {\n              d(this, a),\n                (this.browserInfo = (0, k.detect)()),\n                (this.onlineCheck = new j.OnlineCheck()),\n                (this.callsInProgress = 0),\n                (this.turnTests = [m.RTT, m.THROUGHPUT]),\n                (this.active = !1),\n                (this.rtt = null),\n                (this.resultsHandler = null);\n            }\n            return (\n              e(a, [\n                {\n                  key: "start",\n                  value: function (a, b, c) {\n                    if (\n                      this.browserInfo.browserName !==\n                      k.Constants.browserName.msie\n                    )\n                      if (\n                        ((this.iceServers = a),\n                        (this.callback = c),\n                        this.active)\n                      )\n                        this.callback &&\n                          this.callback(\n                            null,\n                            "Not started: already in progress"\n                          );\n                      else if (0 < this.callsInProgress)\n                        this.callback &&\n                          this.callback(null, "Not started: call in progress");\n                      else if (a) {\n                        (this.turnTestCounter = 0),\n                          (this.resultsHandler = new i.ResultsHandler()),\n                          this.resultsHandler.setProvider(b);\n                        var d = {\n                          type: "browser",\n                          os: this.browserInfo.os,\n                          osVersion: this.browserInfo.osVersion,\n                          buildName: this.browserInfo.browserName,\n                          buildVersion: this.browserInfo.browserVersion,\n                        };\n                        this.resultsHandler.add("endpointInfo", d),\n                          this.onlineCheck.start(),\n                          (this.active = !0),\n                          this._start();\n                      } else\n                        this.callback &&\n                          this.callback(\n                            null,\n                            "Not started: no ICE servers given"\n                          );\n                    else\n                      this.callback &&\n                        this.callback(null, "Not started: disabled for IE");\n                  },\n                },\n                {\n                  key: "_start",\n                  value: function () {\n                    var a = this;\n                    this.active &&\n                      ((this.turnConnection = new f.TurnConnection(\n                        this.browserInfo\n                      )),\n                      this.turnConnection.connect(this.iceServers).then(\n                        function () {\n                          a.active\n                            ? a.startTurnTests().then(\n                                function () {\n                                  a.stop();\n                                },\n                                function (b) {\n                                  a.stop();\n                                }\n                              )\n                            : a.stop();\n                        },\n                        function (b) {\n                          var c = b.continueFlag;\n                          if ((a.resultsHandler.failure(b), !c)) {\n                            a.turnConnection.disconnect(), (a.active = !1);\n                            var d = "";\n                            try {\n                              d = b.stack;\n                            } catch (c) {\n                              d = b.toString();\n                            }\n                            return (\n                              (d && "" !== d) || (d = b.toString()),\n                              void a.callback(null, d)\n                            );\n                          }\n                          a.resultsHandler.getFailureNumber() >= 10\n                            ? a.stop()\n                            : (a.turnConnection.disconnect(),\n                              setTimeout(function () {\n                                a._start();\n                              }, 0));\n                        }\n                      ));\n                  },\n                },\n                {\n                  key: "stop",\n                  value: function () {\n                    var a = this;\n                    if (\n                      this.browserInfo.browserName !==\n                        k.Constants.browserName.msie &&\n                      this.active\n                    ) {\n                      (this.active = !1),\n                        this.activeTurnTest && this.activeTurnTest.forceStop();\n                      var b = this.onlineCheck.stop();\n                      this.resultsHandler &&\n                        this.resultsHandler.add("onlineStatus", b),\n                        this.turnConnection.getIceResults().then(\n                          function (b) {\n                            a.resultsHandler && a.resultsHandler.add("ice", b),\n                              a.turnConnection.disconnect(),\n                              a.sendResults();\n                          },\n                          function (b) {\n                            a.resultsHandler && a.resultsHandler.failure(b),\n                              a.turnConnection.disconnect(),\n                              a.sendResults();\n                          }\n                        );\n                    }\n                  },\n                },\n                {\n                  key: "sendResults",\n                  value: function () {\n                    if (this.resultsHandler) {\n                      var a = this.resultsHandler.getResults();\n                      (this.resultsHandler = null),\n                        this.callback && this.callback(a, null);\n                    } else\n                      this.callback &&\n                        this.callback(null, "No results present");\n                  },\n                },\n                {\n                  key: "callStarts",\n                  value: function () {\n                    (this.callsInProgress += 1), this.stop();\n                  },\n                },\n                {\n                  key: "callFinished",\n                  value: function () {\n                    this.callsInProgress -= 1;\n                  },\n                },\n                {\n                  key: "getId",\n                  value: function () {\n                    return this.resultsHandler\n                      ? this.resultsHandler.getId()\n                      : null;\n                  },\n                },\n                {\n                  key: "crashDisconnect",\n                  value: function () {\n                    try {\n                      this.turnConnection.disconnect();\n                    } catch (a) {}\n                  },\n                },\n                {\n                  key: "startTurnTests",\n                  value: function () {\n                    var a = this;\n                    if (this.turnTestCounter >= this.turnTests.length)\n                      return new l(function (a, b) {\n                        a();\n                      });\n                    var b = this.turnTests[this.turnTestCounter],\n                      c = null;\n                    switch (b) {\n                      case m.RTT:\n                        c = new g.RttTest(this.turnConnection);\n                        break;\n\n                      case m.THROUGHPUT:\n                        c = new h.ThroughputTest(this.turnConnection, this.rtt);\n                        break;\n\n                      default:\n                        return new l(function (a, c) {\n                          c(new Error("Unknown test: " + b));\n                        });\n                    }\n                    return (\n                      (this.activeTurnTest = c),\n                      this.active\n                        ? c.start().then(\n                            function () {\n                              return (\n                                a.handleTestResults(b, c.getResults()),\n                                (a.turnTestCounter += 1),\n                                (a.activeTurnTest = null),\n                                a.startTurnTests()\n                              );\n                            },\n                            function (d) {\n                              return (\n                                a.handleTestResults(b, c.getResults(), d),\n                                (a.turnTestCounter += 1),\n                                (a.activeTurnTest = null),\n                                a.startTurnTests()\n                              );\n                            }\n                          )\n                        : new l(function (a, b) {\n                            b(\n                              new Error(\n                                "Test trying to start while testing is not active"\n                              )\n                            );\n                          })\n                    );\n                  },\n                },\n                {\n                  key: "handleTestResults",\n                  value: function (a, b) {\n                    null ==\n                      (2 < arguments.length && void 0 !== arguments[2]\n                        ? arguments[2]\n                        : null) &&\n                      a == m.RTT &&\n                      (this.rtt = b.median),\n                      this.resultsHandler && this.resultsHandler.add(a, b);\n                  },\n                },\n              ]),\n              a\n            );\n          })();\n        c.PreCallTest = n;\n      },\n      {\n        "./tests/rttTest": 3,\n        "./tests/throughputTest": 4,\n        "./turnConnection": 6,\n        "./utility/onlineCheck": 8,\n        "./utility/resultsHandler": 10,\n        "./utility/stats/detectbrowser": 11,\n        bluebird: 1,\n      },\n    ],\n    3: [\n      function (a, b, c) {\n        "use strict";\n        function d(a, b) {\n          if (!(a instanceof b))\n            throw new TypeError("Cannot call a class as a function");\n        }\n        function e(a, b) {\n          if (!a)\n            throw new ReferenceError(\n              "this hasn\'t been initialised - super() hasn\'t been called"\n            );\n          return !b || ("object" != typeof b && "function" != typeof b) ? a : b;\n        }\n        function f(a, b) {\n          if ("function" != typeof b && null !== b)\n            throw new TypeError(\n              "Super expression must either be null or a function, not " +\n                typeof b\n            );\n          (a.prototype = Object.create(b && b.prototype, {\n            constructor: {\n              value: a,\n              enumerable: !1,\n              writable: !0,\n              configurable: !0,\n            },\n          })),\n            b &&\n              (Object.setPrototypeOf\n                ? Object.setPrototypeOf(a, b)\n                : (a.__proto__ = b));\n        }\n        Object.defineProperty(c, "__esModule", {\n          value: !0,\n        }),\n          (c.RttTest = void 0);\n        var g = (function () {\n            function a(a, b) {\n              for (var c = 0; c < b.length; c++) {\n                var d = b[c];\n                (d.enumerable = d.enumerable || !1),\n                  (d.configurable = !0),\n                  "value" in d && (d.writable = !0),\n                  Object.defineProperty(a, d.key, d);\n              }\n            }\n            return function (b, c, d) {\n              return c && a(b.prototype, c), d && a(b, d), b;\n            };\n          })(),\n          h = function a(b, c, d) {\n            null === b && (b = Function.prototype);\n            var e = Object.getOwnPropertyDescriptor(b, c);\n            if (void 0 === e) {\n              var f = Object.getPrototypeOf(b);\n              return null === f ? void 0 : a(f, c, d);\n            }\n            if ("value" in e) return e.value;\n            var g = e.get;\n            return void 0 !== g ? g.call(d) : void 0;\n          },\n          i = a("../utility/timestamps"),\n          j = (function (a) {\n            if (a && a.__esModule) return a;\n            var b = {};\n            if (null != a)\n              for (var c in a)\n                Object.prototype.hasOwnProperty.call(a, c) && (b[c] = a[c]);\n            return (b.default = a), b;\n          })(i),\n          k = a("./turnTest"),\n          l = (function (a) {\n            function b(a) {\n              d(this, b);\n              var c = e(\n                this,\n                (b.__proto__ || Object.getPrototypeOf(b)).call(this, a)\n              );\n              return (c.sendTimer = null), (c.countSent = 0), (c.rtts = []), c;\n            }\n            return (\n              f(b, k.TurnTest),\n              g(b, [\n                {\n                  key: "initiate",\n                  value: function () {\n                    (this.results.startTimestamp = j.getCurrent()),\n                      this.sendPing();\n                  },\n                },\n                {\n                  key: "handleMessage",\n                  value: function (a) {\n                    if (this.isActive()) {\n                      var b = parseInt(a, 10),\n                        c = this.calculateRtt(b);\n                      this.rtts.push(c),\n                        this.countSent < 10\n                          ? this.sendPing()\n                          : this.calculateMetrics();\n                    }\n                  },\n                },\n                {\n                  key: "handleError",\n                  value: function (a) {\n                    this.fillResults(), this.failed(a);\n                  },\n                },\n                {\n                  key: "sendPing",\n                  value: function () {\n                    if (this.isActive()) {\n                      var a = j.getCurrent();\n                      this.send(a.toString()),\n                        (this.countSent += 1),\n                        this.sendTimer &&\n                          (clearTimeout(this.sendTimer),\n                          (this.sendTimer = null)),\n                        this.countSent < 10\n                          ? (this.sendTimer = setTimeout(\n                              this.sendPing.bind(this),\n                              100\n                            ))\n                          : (this.sendTimer = setTimeout(\n                              this.calculateMetrics.bind(this),\n                              500\n                            ));\n                    }\n                  },\n                },\n                {\n                  key: "calculateRtt",\n                  value: function (a) {\n                    return j.getCurrent() - a;\n                  },\n                },\n                {\n                  key: "calculateMetrics",\n                  value: function () {\n                    this.sendTimer &&\n                      (clearTimeout(this.sendTimer), (this.sendTimer = null)),\n                      this.fillResults(),\n                      this.finished();\n                  },\n                },\n                {\n                  key: "fillResults",\n                  value: function () {\n                    (this.results.sentMessages = this.countSent),\n                      (this.results.unAckedMessages =\n                        this.countSent - this.rtts.length),\n                      (this.results.maxMessages = 10),\n                      (this.results.forceStopped = this.forceStopped),\n                      (this.results.median = this.median()),\n                      (this.results.average = this.average()),\n                      (this.results.variance = this.variance()),\n                      (this.results.endTimestamp = j.getCurrent());\n                  },\n                },\n                {\n                  key: "median",\n                  value: function () {\n                    if (0 == this.rtts.length) return null;\n                    this.rtts.sort();\n                    var a = Math.floor(this.rtts.length / 2);\n                    return this.rtts[a];\n                  },\n                },\n                {\n                  key: "average",\n                  value: function () {\n                    if (0 == this.rtts.length) return null;\n                    for (var a = 0, b = 0; b < this.rtts.length; b++)\n                      a += this.rtts[b];\n                    return a / this.rtts.length;\n                  },\n                },\n                {\n                  key: "variance",\n                  value: function () {\n                    if (0 == this.rtts.length) return null;\n                    for (\n                      var a = 0, b = this.average(), c = 0;\n                      c < this.rtts.length;\n                      c++\n                    ) {\n                      var d = this.rtts[c];\n                      a += Math.pow(d - b, 2);\n                    }\n                    return (a /= this.rtts.length);\n                  },\n                },\n                {\n                  key: "stop",\n                  value: function () {\n                    this.isActive() &&\n                      (h(\n                        b.prototype.__proto__ ||\n                          Object.getPrototypeOf(b.prototype),\n                        "stop",\n                        this\n                      ).call(this),\n                      this.fillResults());\n                  },\n                },\n              ]),\n              b\n            );\n          })();\n        c.RttTest = l;\n      },\n      {\n        "../utility/timestamps": 14,\n        "./turnTest": 5,\n      },\n    ],\n    4: [\n      function (a, b, c) {\n        "use strict";\n        function d(a, b) {\n          if (!(a instanceof b))\n            throw new TypeError("Cannot call a class as a function");\n        }\n        function e(a, b) {\n          if (!a)\n            throw new ReferenceError(\n              "this hasn\'t been initialised - super() hasn\'t been called"\n            );\n          return !b || ("object" != typeof b && "function" != typeof b) ? a : b;\n        }\n        function f(a, b) {\n          if ("function" != typeof b && null !== b)\n            throw new TypeError(\n              "Super expression must either be null or a function, not " +\n                typeof b\n            );\n          (a.prototype = Object.create(b && b.prototype, {\n            constructor: {\n              value: a,\n              enumerable: !1,\n              writable: !0,\n              configurable: !0,\n            },\n          })),\n            b &&\n              (Object.setPrototypeOf\n                ? Object.setPrototypeOf(a, b)\n                : (a.__proto__ = b));\n        }\n        Object.defineProperty(c, "__esModule", {\n          value: !0,\n        }),\n          (c.ThroughputTest = void 0);\n        var g = (function () {\n            function a(a, b) {\n              for (var c = 0; c < b.length; c++) {\n                var d = b[c];\n                (d.enumerable = d.enumerable || !1),\n                  (d.configurable = !0),\n                  "value" in d && (d.writable = !0),\n                  Object.defineProperty(a, d.key, d);\n              }\n            }\n            return function (b, c, d) {\n              return c && a(b.prototype, c), d && a(b, d), b;\n            };\n          })(),\n          h = function a(b, c, d) {\n            null === b && (b = Function.prototype);\n            var e = Object.getOwnPropertyDescriptor(b, c);\n            if (void 0 === e) {\n              var f = Object.getPrototypeOf(b);\n              return null === f ? void 0 : a(f, c, d);\n            }\n            if ("value" in e) return e.value;\n            var g = e.get;\n            return void 0 !== g ? g.call(d) : void 0;\n          },\n          i = a("../utility/timestamps"),\n          j = (function (a) {\n            if (a && a.__esModule) return a;\n            var b = {};\n            if (null != a)\n              for (var c in a)\n                Object.prototype.hasOwnProperty.call(a, c) && (b[c] = a[c]);\n            return (b.default = a), b;\n          })(i),\n          k = a("../utility/messageMaker"),\n          l = a("./turnTest"),\n          m = (function (a) {\n            function b(a, c) {\n              d(this, b);\n              var f = e(\n                this,\n                (b.__proto__ || Object.getPrototypeOf(b)).call(this, a)\n              );\n              if (\n                ((f.sentBytes = 0),\n                (f.receivedBytes = 0),\n                (f.secondHalfBytes = 0),\n                (f.secondHalfStart = null),\n                (f.bufferEmpty = 0),\n                (f.chunkSize = 1200),\n                (f.messageMaker = new k.MessageMaker(f.chunkSize)),\n                (f.duration = 5e3),\n                null != c)\n              ) {\n                var g = 50 * c;\n                f.duration = Math.max(Math.min(g, 1e4), 1e3);\n              }\n              return (\n                (f.sendTimer = null),\n                (f.lastMessage = null),\n                (f.intervals = []),\n                (f.intervalStart = 0),\n                (f.intervalLength = 100),\n                (f.intervalBytes = 0),\n                f\n              );\n            }\n            return (\n              f(b, l.TurnTest),\n              g(b, [\n                {\n                  key: "initiate",\n                  value: function () {\n                    if (window && window.csioReactNative) {\n                      this.handleError(\n                        new Error(\n                          "Not running throughput test for react-native"\n                        )\n                      );\n                    } else this.startSend();\n                  },\n                },\n                {\n                  key: "handleMessage",\n                  value: function (a) {\n                    var b = this;\n                    if (this.isActive()) {\n                      (this.lastMessage = a), (this.receivedBytes += a.length);\n                      var c = j.getCurrent();\n                      if (\n                        (this.sendTimer ||\n                          ((this.results.startTimestamp = c),\n                          (this.sendTimer = setTimeout(function () {\n                            b.stop(), b.finished();\n                          }, this.duration))),\n                        0 == this.intervalStart && (this.intervalStart = c),\n                        (this.intervalBytes += a.length),\n                        c - this.intervalStart >= this.intervalLength)\n                      ) {\n                        var d = c - this.intervalStart,\n                          e = this.averageThroughput(this.intervalBytes, d),\n                          f = null;\n                        try {\n                          f = c - JSON.parse(this.lastMessage).timestamp;\n                        } catch (a) {}\n                        this.intervals.push({\n                          startTimestamp: this.intervalStart,\n                          endTimestamp: c,\n                          bytesReceived: this.intervalBytes,\n                          average: e,\n                          rtt: f,\n                        }),\n                          (this.intervalStart = c),\n                          (this.intervalBytes = 0);\n                      }\n                      this.results.startTimestamp &&\n                        c - this.results.startTimestamp > this.duration / 2 &&\n                        (this.secondHalfStart || (this.secondHalfStart = c),\n                        (this.secondHalfBytes += a.length));\n                    }\n                  },\n                },\n                {\n                  key: "handleError",\n                  value: function (a) {\n                    this.stop(), this.failed(a);\n                  },\n                },\n                {\n                  key: "averageThroughput",\n                  value: function (a, b) {\n                    return ((a / (b / 1e3)) * 8) / 1024;\n                  },\n                },\n                {\n                  key: "bufferListener",\n                  value: function () {\n                    this.sendChannel.removeEventListener(\n                      "bufferedamountlow",\n                      this.bufferListener.bind(this)\n                    ),\n                      this.fillBuffer();\n                  },\n                },\n                {\n                  key: "fillBuffer",\n                  value: function () {\n                    for (\n                      0 == this.sendChannel.bufferedAmount &&\n                      (this.bufferEmpty += 1);\n                      this.isActive();\n\n                    ) {\n                      if (\n                        this.sendChannel.bufferedAmount >\n                        this.bufferFullThreshold\n                      )\n                        return void (this.usePolling\n                          ? setTimeout(this.fillBuffer.bind(this), 250)\n                          : this.sendChannel.addEventListener(\n                              "bufferedamountlow",\n                              this.bufferListener.bind(this)\n                            ));\n                      var a = this.messageMaker.make(this.sentBytes);\n                      (this.sentBytes += a.length), this.send(a);\n                    }\n                    this.sendChannel.removeEventListener(\n                      "bufferedamountlow",\n                      this.bufferListener.bind(this)\n                    );\n                  },\n                },\n                {\n                  key: "startSend",\n                  value: function () {\n                    this.isActive() &&\n                      ((this.bufferFullThreshold = 1e3 * this.chunkSize),\n                      (this.sendChannel = this.connection.sendChannel),\n                      (this.usePolling = !0),\n                      "number" ==\n                        typeof this.sendChannel.bufferedAmountLowThreshold &&\n                        ((this.usePolling = !1),\n                        (this.sendChannel.bufferedAmountLowThreshold =\n                          this.bufferFullThreshold / 10)),\n                      setTimeout(this.fillBuffer.bind(this), 0));\n                  },\n                },\n                {\n                  key: "fillResults",\n                  value: function () {\n                    (this.results.endTimestamp = j.getCurrent()),\n                      (this.results.maxDuration = this.duration),\n                      (this.results.forceStopped = this.forceStopped),\n                      (this.results.bufferEmpty = this.bufferEmpty),\n                      (this.results.intervals = this.intervals),\n                      (this.results.bytesPrepared = this.sentBytes),\n                      (this.results.bytesReceived = this.receivedBytes);\n                    var a = 0,\n                      b = 0;\n                    this.secondHalfStart &&\n                      ((a = this.results.endTimestamp - this.secondHalfStart),\n                      (b = this.averageThroughput(this.secondHalfBytes, a)));\n                    var c =\n                        this.results.endTimestamp - this.results.startTimestamp,\n                      d = this.averageThroughput(this.receivedBytes, c);\n                    b < d && (b = d), (this.results.average = b);\n                    var e = null;\n                    try {\n                      e = JSON.parse(this.lastMessage);\n                    } catch (a) {\n                      return;\n                    }\n                    if (e) {\n                      var f = e.sentBytes + this.lastMessage.length;\n                      (this.results.bytesSent = f),\n                        (this.results.fractionLostBytes =\n                          1 - this.receivedBytes / f);\n                    } else\n                      (this.results.bytesSent = -1),\n                        (this.results.fractionLostBytes = -1);\n                  },\n                },\n                {\n                  key: "stop",\n                  value: function () {\n                    this.isActive() &&\n                      (clearTimeout(this.sendTimer),\n                      (this.sendTimer = null),\n                      h(\n                        b.prototype.__proto__ ||\n                          Object.getPrototypeOf(b.prototype),\n                        "stop",\n                        this\n                      ).call(this),\n                      this.fillResults());\n                  },\n                },\n              ]),\n              b\n            );\n          })();\n        c.ThroughputTest = m;\n      },\n      {\n        "../utility/messageMaker": 7,\n        "../utility/timestamps": 14,\n        "./turnTest": 5,\n      },\n    ],\n    5: [\n      function (a, b, c) {\n        "use strict";\n        function d(a, b) {\n          if (!(a instanceof b))\n            throw new TypeError("Cannot call a class as a function");\n        }\n        Object.defineProperty(c, "__esModule", {\n          value: !0,\n        });\n        var e = (function () {\n            function a(a, b) {\n              for (var c = 0; c < b.length; c++) {\n                var d = b[c];\n                (d.enumerable = d.enumerable || !1),\n                  (d.configurable = !0),\n                  "value" in d && (d.writable = !0),\n                  Object.defineProperty(a, d.key, d);\n              }\n            }\n            return function (b, c, d) {\n              return c && a(b.prototype, c), d && a(b, d), b;\n            };\n          })(),\n          f = a("bluebird"),\n          g = (function () {\n            function a(b) {\n              d(this, a),\n                (this.connection = b),\n                (this.active = !1),\n                (this.results = {});\n            }\n            return (\n              e(a, [\n                {\n                  key: "getResults",\n                  value: function () {\n                    return this.results;\n                  },\n                },\n                {\n                  key: "start",\n                  value: function () {\n                    var a = this,\n                      b = new f(function (b, c) {\n                        (a.resolveCb = b), (a.rejectCb = c);\n                      });\n                    return (\n                      this.connection.setMessageCallback(\n                        this.handleMessage.bind(this)\n                      ),\n                      this.connection.setErrorCallback(\n                        this.handleError.bind(this)\n                      ),\n                      (this.active = !0),\n                      (this.forceStopped = !1),\n                      this.initiate(),\n                      b\n                    );\n                  },\n                },\n                {\n                  key: "stop",\n                  value: function () {\n                    this.active = !1;\n                  },\n                },\n                {\n                  key: "forceStop",\n                  value: function () {\n                    (this.forceStopped = !0), this.stop(), this.finished();\n                  },\n                },\n                {\n                  key: "isActive",\n                  value: function () {\n                    return this.active;\n                  },\n                },\n                {\n                  key: "initiate",\n                  value: function () {},\n                },\n                {\n                  key: "handleMessage",\n                  value: function (a) {},\n                },\n                {\n                  key: "handleError",\n                  value: function (a) {},\n                },\n                {\n                  key: "send",\n                  value: function (a) {\n                    this.connection.send(a);\n                  },\n                },\n                {\n                  key: "finished",\n                  value: function () {\n                    (this.active = !1),\n                      this.resolveCb &&\n                        (this.resolveCb(), (this.resolveCb = null));\n                  },\n                },\n                {\n                  key: "failed",\n                  value: function (a) {\n                    (this.active = !1),\n                      this.rejectCb &&\n                        (this.rejectCb(a), (this.rejectCb = null));\n                  },\n                },\n              ]),\n              a\n            );\n          })();\n        c.TurnTest = g;\n      },\n      {\n        bluebird: 1,\n      },\n    ],\n    6: [\n      function (a, b, c) {\n        "use strict";\n        function d(a, b) {\n          if (!(a instanceof b))\n            throw new TypeError("Cannot call a class as a function");\n        }\n        Object.defineProperty(c, "__esModule", {\n          value: !0,\n        }),\n          (c.TurnConnection = void 0);\n        var e = (function () {\n            function a(a, b) {\n              for (var c = 0; c < b.length; c++) {\n                var d = b[c];\n                (d.enumerable = d.enumerable || !1),\n                  (d.configurable = !0),\n                  "value" in d && (d.writable = !0),\n                  Object.defineProperty(a, d.key, d);\n              }\n            }\n            return function (b, c, d) {\n              return c && a(b.prototype, c), d && a(b, d), b;\n            };\n          })(),\n          f = a("./utility/parsedIceCandidate"),\n          g = a("./utility/stats/getstatshandler"),\n          h = a("./utility/stats/detectbrowser"),\n          i = a("bluebird"),\n          j = (function () {\n            function a(b) {\n              d(this, a),\n                this.reset(),\n                (this.statshandler = new g.GetStatsHandler(b));\n            }\n            return (\n              e(a, [\n                {\n                  key: "reset",\n                  value: function () {\n                    this.disconnect(),\n                      (this.iceServers = null),\n                      (this.pctpc1 = null),\n                      (this.pctpc2 = null),\n                      (this.sendChannel = null),\n                      (this.messageCallback = null),\n                      (this.errorCallback = null),\n                      (this.parsedIceResults = {}),\n                      (this.resolveCb = null),\n                      (this.rejectCb = null);\n                  },\n                },\n                {\n                  key: "setMessageCallback",\n                  value: function (a) {\n                    this.messageCallback = a;\n                  },\n                },\n                {\n                  key: "setErrorCallback",\n                  value: function (a) {\n                    this.errorCallback = a;\n                  },\n                },\n                {\n                  key: "send",\n                  value: function (a) {\n                    if (this.sendChannel)\n                      try {\n                        this.sendChannel.send(a);\n                      } catch (a) {\n                        this.raiseSendError(a);\n                      }\n                    else this.raiseSendError(new Error("No send channel"));\n                  },\n                },\n                {\n                  key: "raiseSendError",\n                  value: function (a) {\n                    this.errorCallback && this.errorCallback(a);\n                  },\n                },\n                {\n                  key: "assignEvent",\n                  value: function (a, b, c) {\n                    a.addEventListener\n                      ? a.addEventListener(b, c.bind(this), !1)\n                      : a.attachEvent &&\n                        ((b = "on" + b), a.attachEvent(b, c.bind(this)));\n                  },\n                },\n                {\n                  key: "connect",\n                  value: function (a) {\n                    var b = this;\n                    this.reset();\n                    var c = new i(function (a, c) {\n                      (b.resolveCb = a), (b.rejectCb = c);\n                    });\n                    this.iceServers = a;\n                    var d = null;\n                    try {\n                      if (\n                        (RTCPeerConnection\n                          ? (d = RTCPeerConnection)\n                          : webkitRTCPeerConnection\n                          ? (d = webkitRTCPeerConnection)\n                          : mozRTCPeerConnection\n                          ? (d = mozRTCPeerConnection)\n                          : window &&\n                            window.RTCPeerConnection &&\n                            (d = window.RTCPeerConnection),\n                        !d)\n                      ) {\n                        var e = new Error("RTCPeerConnection not found");\n                        return (e.continueFlag = !1), this.rejectCb(e), c;\n                      }\n                    } catch (e) {\n                      return (e.continueFlag = !1), this.rejectCb(e), c;\n                    }\n                    var f = {\n                      iceTransportPolicy: "all",\n                      iceServers: this.iceServers,\n                    };\n                    try {\n                      (this.pctpc1 = new d(f)), (this.pctpc2 = new d(f));\n                    } catch (e) {\n                      return this.rejectDisconnect(!1, e), c;\n                    }\n                    this.connectionTimer = setTimeout(function () {\n                      delete b.connectionTimer,\n                        b.rejectDisconnect(!1, new Error("Connection timeout"));\n                    }, 3e4);\n                    try {\n                      (this.sendChannel = this.pctpc1.createDataChannel(\n                        "precalltest",\n                        {\n                          ordered: !1,\n                          maxRetransmits: 0,\n                        }\n                      )),\n                        (this.sendChannel.binaryType = "arraybuffer"),\n                        this.assignEvent(\n                          this.sendChannel,\n                          "error",\n                          function (a) {\n                            b.raiseSendError(a), b.rejectDisconnect(!0, a);\n                          }\n                        ),\n                        this.assignEvent(\n                          this.pctpc2,\n                          "datachannel",\n                          function (a) {\n                            var c = a.channel;\n                            b.assignEvent(c, "open", function (a) {\n                              b.resolveCb &&\n                                (b.resolveCb(), (b.resolveCb = null));\n                            }),\n                              b.assignEvent(c, "close", function (a) {\n                                b && b.disconnect && b.disconnect();\n                              }),\n                              b.assignEvent(c, "message", function (a) {\n                                b.messageCallback && b.messageCallback(a.data);\n                              }),\n                              b.assignEvent(c, "error", function (a) {\n                                b.errorCallback && b.errorCallback(a),\n                                  b.rejectDisconnect(!0, a);\n                              });\n                          }\n                        );\n                    } catch (e) {\n                      return this.rejectDisconnect(!1, e), c;\n                    }\n                    try {\n                      this.assignEvent(\n                        this.pctpc1,\n                        "icecandidate",\n                        function (a) {\n                          b.onIceCandidate(b.pctpc1, a);\n                        }\n                      ),\n                        this.assignEvent(\n                          this.pctpc1,\n                          "iceconnectionstatechange",\n                          function (a) {\n                            b.onIceStateChange(b.pctpc1, a);\n                          }\n                        ),\n                        this.assignEvent(\n                          this.pctpc2,\n                          "icecandidate",\n                          function (a) {\n                            b.onIceCandidate(b.pctpc2, a);\n                          }\n                        ),\n                        this.assignEvent(\n                          this.pctpc2,\n                          "iceconnectionstatechange",\n                          function (a) {\n                            b.onIceStateChange(b.pctpc2, a);\n                          }\n                        ),\n                        this.pctpc1.createOffer().then(\n                          function (a, c) {\n                            b.onCreateOfferSuccess(a);\n                          },\n                          function (a) {\n                            b.onCreateOfferError(b.pctpc1, a);\n                          }\n                        );\n                    } catch (e) {\n                      return this.rejectDisconnect(!1, e), c;\n                    }\n                    return c;\n                  },\n                },\n                {\n                  key: "rejectDisconnect",\n                  value: function (a, b) {\n                    this.disconnect(),\n                      this.rejectCb && ((b.continueFlag = a), this.rejectCb(b)),\n                      (this.resolveCb = null),\n                      (this.rejectCb = null);\n                  },\n                },\n                {\n                  key: "disconnect",\n                  value: function () {\n                    if (\n                      (clearTimeout(this.connectionTimer),\n                      clearTimeout(this.iceTimer),\n                      this.pctpc1)\n                    )\n                      try {\n                        this.pctpc1.close();\n                      } catch (a) {}\n                    if (((this.pctpc1 = null), this.pctpc2))\n                      try {\n                        this.pctpc2.close();\n                      } catch (a) {}\n                    this.pctpc2 = null;\n                  },\n                },\n                {\n                  key: "getName",\n                  value: function (a) {\n                    return a === this.pctpc1 ? "pctpc1" : "pctpc2";\n                  },\n                },\n                {\n                  key: "getOtherPc",\n                  value: function (a) {\n                    return a === this.pctpc1 ? this.pctpc2 : this.pctpc1;\n                  },\n                },\n                {\n                  key: "onCreateOfferError",\n                  value: function (a, b) {\n                    this.rejectDisconnect(!1, b);\n                  },\n                },\n                {\n                  key: "onCreateAnswerError",\n                  value: function (a, b) {\n                    this.rejectDisconnect(!1, b);\n                  },\n                },\n                {\n                  key: "onCreateOfferSuccess",\n                  value: function (a) {\n                    var b = this;\n                    try {\n                      this.pctpc1.setLocalDescription(a).then(\n                        function () {\n                          b.onSetLocalSuccess(b.pctpc1);\n                        },\n                        function (a) {\n                          b.onSetSessionDescriptionError(b.pctpc1, a);\n                        }\n                      ),\n                        this.pctpc2.setRemoteDescription(a).then(\n                          function () {\n                            b.onSetRemoteSuccess(b.pctpc2);\n                          },\n                          function (a) {\n                            b.onSetRemoteSessionDescriptionError(b.pctpc2, a);\n                          }\n                        ),\n                        this.pctpc2.createAnswer().then(\n                          function (a) {\n                            b.onCreateAnswerSuccess(a);\n                          },\n                          function (a) {\n                            b.onCreateAnswerError(b.pctpc2, a);\n                          }\n                        );\n                    } catch (a) {\n                      this.rejectDisconnect(!1, a);\n                    }\n                  },\n                },\n                {\n                  key: "onSetLocalSuccess",\n                  value: function (a) {},\n                },\n                {\n                  key: "onSetRemoteSuccess",\n                  value: function (a) {},\n                },\n                {\n                  key: "onSetSessionDescriptionError",\n                  value: function (a, b) {\n                    this.rejectDisconnect(!1, b);\n                  },\n                },\n                {\n                  key: "onSetRemoteSessionDescriptionError",\n                  value: function (a, b) {\n                    this.rejectDisconnect(!1, b);\n                  },\n                },\n                {\n                  key: "onCreateAnswerSuccess",\n                  value: function (a) {\n                    var b = this;\n                    try {\n                      this.pctpc2.setLocalDescription(a).then(\n                        function () {\n                          b.onSetLocalSuccess(b.pctpc2);\n                        },\n                        function (a) {\n                          b.onSetSessionDescriptionError(b.pctpc2, a);\n                        }\n                      ),\n                        this.pctpc1.setRemoteDescription(a).then(\n                          function () {\n                            b.onSetRemoteSuccess(b.pctpc1);\n                          },\n                          function (a) {\n                            b.onSetRemoteSessionDescriptionError(b.pctpc1, a);\n                          }\n                        );\n                    } catch (a) {\n                      this.rejectDisconnect(!1, a);\n                    }\n                  },\n                },\n                {\n                  key: "onIceCandidate",\n                  value: function (a, b) {\n                    var c = this;\n                    try {\n                      if (!b.candidate) return;\n                      var d = new f.ParsedIceCandidate(b.candidate);\n                      if (\n                        (a == this.pctpc1 &&\n                          this.statshandler.codeBase ==\n                            h.Constants.codeBaseType.chrome &&\n                          (d.isRelay() &&\n                            (d.isTypeTransportUdp() &&\n                              (this.parsedIceResults.relayUdpGathered = !0),\n                            d.isTypeTransportTcp() &&\n                              (this.parsedIceResults.relayTcpGathered = !0),\n                            d.isTypeTransportTls() &&\n                              (this.parsedIceResults.relayTlsGathered = !0)),\n                          d.isServerReflexive() &&\n                            (this.parsedIceResults.srflxGathered = !0)),\n                        !d.isRelay())\n                      )\n                        return;\n                      this.getOtherPc(a)\n                        .addIceCandidate(b.candidate)\n                        .then(\n                          function () {\n                            c.onAddIceCandidateSuccess(a);\n                          },\n                          function (b) {\n                            c.onAddIceCandidateError(a, b, d.isRelay());\n                          }\n                        );\n                    } catch (b) {\n                      this.rejectDisconnect(!1, b);\n                    }\n                  },\n                },\n                {\n                  key: "onAddIceCandidateSuccess",\n                  value: function (a) {},\n                },\n                {\n                  key: "onAddIceCandidateError",\n                  value: function (a, b, c) {\n                    c && this.rejectDisconnect(!1, b);\n                  },\n                },\n                {\n                  key: "onIceStateChange",\n                  value: function (a, b) {\n                    var c = this;\n                    try {\n                      var d = "(?)";\n                      a && (d = a.iceConnectionState),\n                        "failed" === d &&\n                          this.rejectDisconnect(!0, new Error("ICE failure")),\n                        "checking" !== d ||\n                          this.iceTimer ||\n                          (this.iceTimer = setTimeout(function () {\n                            delete c.iceTimer,\n                              c.rejectDisconnect(!0, new Error("ICE timeout"));\n                          }, 1e4)),\n                        ("completed" !== d && "connected" !== d) ||\n                          (clearTimeout(this.iceTimer), delete this.iceTimer);\n                    } catch (a) {\n                      this.rejectDisconnect(!1, a);\n                    }\n                  },\n                },\n                {\n                  key: "getIceResults",\n                  value: function () {\n                    var a = this;\n                    return new i(\n                      function (b, c) {\n                        for (\n                          var d = JSON.parse(JSON.stringify(a.iceServers)),\n                            e = 0;\n                          e < d.length;\n                          e++\n                        ) {\n                          var f = d[e];\n                          d.hasOwnProperty(f) || delete f.credential;\n                        }\n                        var g = {\n                          turnIpAddress: "",\n                          turnIpVersion: "",\n                          turnTransport: "",\n                          iceServers: d,\n                          ipv6Supported: !1,\n                          ipv4Supported: !1,\n                          relayTlsGathered: !1,\n                          relayTcpGathered: !1,\n                          relayUdpGathered: !1,\n                          srflxGathered: !1,\n                          relayTlsSuccess: !1,\n                          relayTcpSuccess: !1,\n                          relayUdpSuccess: !1,\n                          srflxSuccess: !1,\n                        };\n                        for (var h in a.parsedIceResults)\n                          a.parsedIceResults.hasOwnProperty(h) &&\n                            (g[h] = a.parsedIceResults[h]);\n                        a.pctpc1\n                          ? a.statshandler.getIceCandidates(a.pctpc1).then(\n                              function (a) {\n                                for (\n                                  var c = 0;\n                                  c < a.iceCandidatePairs.length;\n                                  c++\n                                ) {\n                                  var d = a.iceCandidatePairs[c];\n                                  if (d.googActiveConnection || d.selected)\n                                    for (\n                                      var e = 0;\n                                      e < a.localCandidates.length;\n                                      e++\n                                    ) {\n                                      var f = a.localCandidates[e],\n                                        h = null;\n                                      if (\n                                        ((h = f.ip ? f.ip : f.ipAddress),\n                                        f.id == d.localCandidateId)\n                                      ) {\n                                        var i =\n                                          -1 !==\n                                          (g.turnIpAddress = h).indexOf(":");\n                                        (g.turnIpVersion = i ? "ipv6" : "ipv4"),\n                                          (g.turnTransport =\n                                            f.mozLocalTransport);\n                                      }\n                                      ("relay" !== f.candidateType &&\n                                        "relayed" !== f.candidateType) ||\n                                        ("udp" === f.mozLocalTransport &&\n                                          (g.relayUdpSuccess = !0),\n                                        "tcp" === f.mozLocalTransport &&\n                                          (g.relayTcpSuccess = !0),\n                                        "tls" === f.mozLocalTransport &&\n                                          (g.relayTlsSuccess = !0)),\n                                        -1 !== h.indexOf(":")\n                                          ? (g.ipv6Supported = !0)\n                                          : (g.ipv4Supported = !0);\n                                    }\n                                }\n                                for (\n                                  var j = 0;\n                                  j < a.localCandidates.length;\n                                  j++\n                                ) {\n                                  var k = a.localCandidates[j];\n                                  ("relay" !== k.candidateType &&\n                                    "relayed" !== k.candidateType) ||\n                                    ("udp" === k.mozLocalTransport &&\n                                      (g.relayUdpGathered = !0),\n                                    "tcp" === k.mozLocalTransport &&\n                                      (g.relayTcpGathered = !0),\n                                    "tls" === k.mozLocalTransport &&\n                                      (g.relayTlsGathered = !0)),\n                                    ("srflx" !== k.candidateType &&\n                                      "serverreflexive" !== k.candidateType) ||\n                                      (g.srflxGathered = !0);\n                                }\n                                for (\n                                  var l = 0;\n                                  l < a.iceCandidatePairs.length;\n                                  l++\n                                ) {\n                                  var m = a.iceCandidatePairs[l];\n                                  if ("succeeded" === m.state)\n                                    for (\n                                      var n = 0;\n                                      n < a.localCandidates.length;\n                                      n++\n                                    ) {\n                                      var o = a.localCandidates[n];\n                                      o.id == m.localCandidateId &&\n                                        (("relay" !== o.candidateType &&\n                                          "relayed" !== o.candidateType) ||\n                                          ("udp" === o.mozLocalTransport &&\n                                            (g.relayUdpSuccess = !0),\n                                          "tcp" === o.mozLocalTransport &&\n                                            (g.relayTcpSuccess = !0),\n                                          "tls" === o.mozLocalTransport &&\n                                            (g.relayTlsSuccess = !0)),\n                                        ("srflx" !== o.candidateType &&\n                                          "serverreflexive" !==\n                                            o.candidateType) ||\n                                          (g.srflxSuccess = !0));\n                                    }\n                                }\n                                b(g);\n                              },\n                              function (a) {\n                                c(a);\n                              }\n                            )\n                          : c(new Error("PC not available for stats"));\n                      },\n                      function (a) {\n                        reject(a);\n                      }\n                    );\n                  },\n                },\n              ]),\n              a\n            );\n          })();\n        c.TurnConnection = j;\n      },\n      {\n        "./utility/parsedIceCandidate": 9,\n        "./utility/stats/detectbrowser": 11,\n        "./utility/stats/getstatshandler": 12,\n        bluebird: 1,\n      },\n    ],\n    7: [\n      function (a, b, c) {\n        "use strict";\n        function d(a, b) {\n          if (!(a instanceof b))\n            throw new TypeError("Cannot call a class as a function");\n        }\n        function e(a) {\n          for (var b = "", c = 0; c < a; c++)\n            b += String.fromCharCode(35 + 58 * Math.random());\n          return b;\n        }\n        Object.defineProperty(c, "__esModule", {\n          value: !0,\n        }),\n          (c.randomAsciiString = c.MessageMaker = void 0);\n        var f = (function () {\n            function a(a, b) {\n              for (var c = 0; c < b.length; c++) {\n                var d = b[c];\n                (d.enumerable = d.enumerable || !1),\n                  (d.configurable = !0),\n                  "value" in d && (d.writable = !0),\n                  Object.defineProperty(a, d.key, d);\n              }\n            }\n            return function (b, c, d) {\n              return c && a(b.prototype, c), d && a(b, d), b;\n            };\n          })(),\n          g = a("../utility/timestamps"),\n          h = (function (a) {\n            if (a && a.__esModule) return a;\n            var b = {};\n            if (null != a)\n              for (var c in a)\n                Object.prototype.hasOwnProperty.call(a, c) && (b[c] = a[c]);\n            return (b.default = a), b;\n          })(g),\n          i = (function () {\n            function a() {\n              var b =\n                0 < arguments.length && void 0 !== arguments[0]\n                  ? arguments[0]\n                  : 1200;\n              d(this, a),\n                (this.message = {\n                  timestamp: "",\n                  sentBytes: 1e4,\n                  padding: "",\n                });\n              var c = e(\n                b -\n                  h.getCurrent().toString().length -\n                  JSON.stringify(this.message).length\n              );\n              this.message.padding = c;\n            }\n            return (\n              f(a, [\n                {\n                  key: "make",\n                  value: function (a) {\n                    return (\n                      (this.message.timestamp = h.getCurrent()),\n                      (this.message.sentBytes = a),\n                      JSON.stringify(this.message)\n                    );\n                  },\n                },\n              ]),\n              a\n            );\n          })();\n        (c.MessageMaker = i), (c.randomAsciiString = e);\n      },\n      {\n        "../utility/timestamps": 14,\n      },\n    ],\n    8: [\n      function (a, b, c) {\n        "use strict";\n        function d(a, b) {\n          if (!(a instanceof b))\n            throw new TypeError("Cannot call a class as a function");\n        }\n        Object.defineProperty(c, "__esModule", {\n          value: !0,\n        }),\n          (c.OnlineCheck = void 0);\n        var e = (function () {\n            function a(a, b) {\n              for (var c = 0; c < b.length; c++) {\n                var d = b[c];\n                (d.enumerable = d.enumerable || !1),\n                  (d.configurable = !0),\n                  "value" in d && (d.writable = !0),\n                  Object.defineProperty(a, d.key, d);\n              }\n            }\n            return function (b, c, d) {\n              return c && a(b.prototype, c), d && a(b, d), b;\n            };\n          })(),\n          f = a("./timestamps"),\n          g = (function (a) {\n            if (a && a.__esModule) return a;\n            var b = {};\n            if (null != a)\n              for (var c in a)\n                Object.prototype.hasOwnProperty.call(a, c) && (b[c] = a[c]);\n            return (b.default = a), b;\n          })(f),\n          h = (function () {\n            function a() {\n              d(this, a), (this.active = !1);\n            }\n            return (\n              e(a, [\n                {\n                  key: "start",\n                  value: function () {\n                    var a = this;\n                    (this.active = !0),\n                      (this.onlineCheck = []),\n                      window &&\n                        window.addEventListener &&\n                        "function" == typeof window.addEventListener &&\n                        (window.addEventListener("offline", function () {\n                          a.addEntry();\n                        }),\n                        window.addEventListener("online", function () {\n                          a.addEntry();\n                        }),\n                        this.addEntry());\n                  },\n                },\n                {\n                  key: "addEntry",\n                  value: function () {\n                    if (this.active) {\n                      var a = g.getCurrent();\n                      if (navigator && navigator.onLine) {\n                        var b = navigator.onLine;\n                        this.onlineCheck.push({\n                          timestamp: a,\n                          online: b,\n                        });\n                      }\n                    }\n                  },\n                },\n                {\n                  key: "stop",\n                  value: function () {\n                    var a = this;\n                    return (\n                      (this.active = !1),\n                      window &&\n                        window.removeEventListener &&\n                        "function" == typeof window.removeEventListener &&\n                        (window.removeEventListener("offline", function () {\n                          a.addEntry();\n                        }),\n                        window.removeEventListener("online", function () {\n                          a.addEntry();\n                        })),\n                      this.onlineCheck\n                    );\n                  },\n                },\n              ]),\n              a\n            );\n          })();\n        c.OnlineCheck = h;\n      },\n      {\n        "./timestamps": 14,\n      },\n    ],\n    9: [\n      function (a, b, c) {\n        "use strict";\n        function d(a, b) {\n          if (!(a instanceof b))\n            throw new TypeError("Cannot call a class as a function");\n        }\n        Object.defineProperty(c, "__esModule", {\n          value: !0,\n        });\n        var e = (function () {\n            function a(a, b) {\n              for (var c = 0; c < b.length; c++) {\n                var d = b[c];\n                (d.enumerable = d.enumerable || !1),\n                  (d.configurable = !0),\n                  "value" in d && (d.writable = !0),\n                  Object.defineProperty(a, d.key, d);\n              }\n            }\n            return function (b, c, d) {\n              return c && a(b.prototype, c), d && a(b, d), b;\n            };\n          })(),\n          f = (function () {\n            function a(b) {\n              d(this, a), (this.iceCandidateStr = b.candidate), this.parse();\n            }\n            return (\n              e(a, [\n                {\n                  key: "parse",\n                  value: function () {\n                    var a = this.iceCandidateStr.split(" ");\n                    a.length < 8 ||\n                      ((this.protocol = "1" === a[1] ? "rtp" : "rtcp"),\n                      (this.transport = a[2]),\n                      (this.typeTransport = this.extractTypeTransport(a[3])),\n                      (this.ipv6 = -1 !== a[4].indexOf(":")),\n                      (this.ipAddress = a[4]),\n                      (this.port = a[5]),\n                      (this.type = a[7]));\n                  },\n                },\n                {\n                  key: "extractTypeTransport",\n                  value: function (a) {\n                    var b = "None",\n                      c = a >> 24;\n                    if ("rtp" === this.protocol && 0 <= c && c <= 2)\n                      switch (c) {\n                        case 0:\n                          b = "TLS";\n                          break;\n\n                        case 1:\n                          b = "TCP";\n                          break;\n\n                        case 2:\n                          b = "UDP";\n                      }\n                    return b;\n                  },\n                },\n                {\n                  key: "getString",\n                  value: function () {\n                    return this.iceCandidateStr;\n                  },\n                },\n                {\n                  key: "getType",\n                  value: function () {\n                    return this.type;\n                  },\n                },\n                {\n                  key: "isHost",\n                  value: function () {\n                    return "host" === this.type.toLowerCase();\n                  },\n                },\n                {\n                  key: "isServerReflexive",\n                  value: function () {\n                    return "srflx" === this.type.toLowerCase();\n                  },\n                },\n                {\n                  key: "isPeerReflexive",\n                  value: function () {\n                    return "prflx" === this.type.toLowerCase();\n                  },\n                },\n                {\n                  key: "isRelay",\n                  value: function () {\n                    return (\n                      "relay" === this.type.toLowerCase() ||\n                      "relayed" === this.type.toLowerCase()\n                    );\n                  },\n                },\n                {\n                  key: "getTypeTransport",\n                  value: function () {\n                    return this.typeTransport;\n                  },\n                },\n                {\n                  key: "isTypeTransportUdp",\n                  value: function () {\n                    return "UDP" === this.typeTransport;\n                  },\n                },\n                {\n                  key: "isTypeTransportTcp",\n                  value: function () {\n                    return "TCP" === this.typeTransport;\n                  },\n                },\n                {\n                  key: "isTypeTransportTls",\n                  value: function () {\n                    return "TLS" === this.typeTransport;\n                  },\n                },\n                {\n                  key: "getTransport",\n                  value: function () {\n                    return this.transport;\n                  },\n                },\n                {\n                  key: "isUdp",\n                  value: function () {\n                    return "udp" === this.transport.toLowerCase();\n                  },\n                },\n                {\n                  key: "isTcp",\n                  value: function () {\n                    return "tcp" === this.transport.toLowerCase();\n                  },\n                },\n                {\n                  key: "getProtocol",\n                  value: function () {\n                    return this.protocol;\n                  },\n                },\n                {\n                  key: "isRtp",\n                  value: function () {\n                    return "rtp" === this.protocol;\n                  },\n                },\n                {\n                  key: "isRtcp",\n                  value: function () {\n                    return "rtcp" === this.protocol;\n                  },\n                },\n                {\n                  key: "isIpv6",\n                  value: function () {\n                    return this.ipv6;\n                  },\n                },\n                {\n                  key: "getIpAddress",\n                  value: function () {\n                    return this.ipAddress;\n                  },\n                },\n                {\n                  key: "getPort",\n                  value: function () {\n                    return this.port;\n                  },\n                },\n              ]),\n              a\n            );\n          })();\n        c.ParsedIceCandidate = f;\n      },\n      {},\n    ],\n    10: [\n      function (a, b, c) {\n        "use strict";\n        function d(a, b) {\n          if (!(a instanceof b))\n            throw new TypeError("Cannot call a class as a function");\n        }\n        Object.defineProperty(c, "__esModule", {\n          value: !0,\n        }),\n          (c.ResultsHandler = void 0);\n        var e =\n            "function" == typeof Symbol && "symbol" == typeof Symbol.iterator\n              ? function (a) {\n                  return typeof a;\n                }\n              : function (a) {\n                  return a &&\n                    "function" == typeof Symbol &&\n                    a.constructor === Symbol &&\n                    a !== Symbol.prototype\n                    ? "symbol"\n                    : typeof a;\n                },\n          f = (function () {\n            function a(a, b) {\n              for (var c = 0; c < b.length; c++) {\n                var d = b[c];\n                (d.enumerable = d.enumerable || !1),\n                  (d.configurable = !0),\n                  "value" in d && (d.writable = !0),\n                  Object.defineProperty(a, d.key, d);\n              }\n            }\n            return function (b, c, d) {\n              return c && a(b.prototype, c), d && a(b, d), b;\n            };\n          })(),\n          g = a("./timestamps"),\n          h = (function (a) {\n            if (a && a.__esModule) return a;\n            var b = {};\n            if (null != a)\n              for (var c in a)\n                Object.prototype.hasOwnProperty.call(a, c) && (b[c] = a[c]);\n            return (b.default = a), b;\n          })(g),\n          i = a("./messageMaker"),\n          j = (function () {\n            function a() {\n              d(this, a),\n                (this.start = h.getCurrent()),\n                (this.id =\n                  Math.trunc(this.start) + "-" + (0, i.randomAsciiString)(20)),\n                (this.version = "1.3.1"),\n                (this.failures = []),\n                (this.results = {}),\n                (this.forceStopped = !0),\n                (this.provider = "callstats");\n            }\n            return (\n              f(a, [\n                {\n                  key: "setProvider",\n                  value: function (a) {\n                    a && (this.provider = a);\n                  },\n                },\n                {\n                  key: "getResults",\n                  value: function () {\n                    return {\n                      id: this.id,\n                      version: this.version,\n                      forceStopped: this.forceStopped,\n                      startTimestamp: this.start,\n                      endTimestamp: h.getCurrent(),\n                      failures: this.failures,\n                      tests: this.results,\n                      provider: this.provider,\n                    };\n                  },\n                },\n                {\n                  key: "getFailureNumber",\n                  value: function () {\n                    return this.failures.length;\n                  },\n                },\n                {\n                  key: "getId",\n                  value: function () {\n                    return this.id;\n                  },\n                },\n                {\n                  key: "add",\n                  value: function (a, b) {\n                    (this.results[a] = b).hasOwnProperty("forceStopped") &&\n                      (this.forceStopped = b.forceStopped);\n                  },\n                },\n                {\n                  key: "failure",\n                  value: function (a) {\n                    "object" === (void 0 === a ? "undefined" : e(a)) &&\n                      (a = a.toString());\n                    var b = {\n                      timestamp: h.getCurrent(),\n                      reason: a,\n                    };\n                    this.failures.push(b);\n                  },\n                },\n              ]),\n              a\n            );\n          })();\n        c.ResultsHandler = j;\n      },\n      {\n        "./messageMaker": 7,\n        "./timestamps": 14,\n      },\n    ],\n    11: [\n      function (a, b, c) {\n        "use strict";\n        function d() {\n          var a = e.browserName.chrome,\n            b = null,\n            c = null,\n            d = null,\n            f = null,\n            g = e.codeBaseType.chrome;\n          if (\n            window &&\n            (!window.navigator ||\n              !window.navigator.userAgent ||\n              window.csioReactNative)\n          )\n            return (\n              window && window.csioGetOsName && (b = window.csioGetOsName()),\n              window && window.csioGetOsVer && (c = window.csioGetOsVer()),\n              window && window.csioReactNative && (d = "react-native"),\n              {\n                browserName: a,\n                codeBase: g,\n                os: b,\n                osVersion: c,\n                userAgent: d,\n              }\n            );\n          var h = (d = navigator.userAgent).toLowerCase(),\n            i = void 0,\n            j = void 0;\n          (f = navigator.appVersion) &&\n            ((i = f.toLowerCase()), (j = "" + parseFloat(i)));\n          var k = void 0,\n            l = "Version";\n          -1 !== (k = h.indexOf("opera"))\n            ? ((a = e.browserName.opera),\n              (j = h.substring(k + 6)),\n              -1 !== (k = h.indexOf(l)) && (j = h.substring(k + 8)),\n              (g = e.codeBaseType.chrome))\n            : -1 !== (k = h.indexOf("opr"))\n            ? ((a = e.browserName.opera),\n              (j = h.substring(k + 4)),\n              -1 !== (k = h.indexOf(l)) && (j = h.substring(k + 8)),\n              (g = e.codeBaseType.chrome))\n            : -1 !== (k = h.indexOf("msie"))\n            ? ((a = e.browserName.msie),\n              (j = h.substring(k + 5)),\n              (g = e.codeBaseType.chrome))\n            : -1 !== (k = h.indexOf("edge"))\n            ? ((a = e.browserName.edge),\n              (j = h.substring(k + 5)),\n              (g = e.codeBaseType.edge))\n            : -1 !== (k = h.indexOf("chrome"))\n            ? ((a = e.browserName.chrome),\n              (j = h.substring(k + 7)),\n              (g = e.codeBaseType.chrome))\n            : -1 !== (k = h.indexOf("safari"))\n            ? ((a = e.browserName.safari),\n              (j = h.substring(k + 7)),\n              -1 !== (k = h.indexOf(l)) && (j = h.substring(k + 8)),\n              (g = e.codeBaseType.chrome))\n            : -1 !== (k = h.indexOf("firefox"))\n            ? ((a = e.browserName.firefox),\n              (j = h.substring(k + 8)),\n              (g = e.codeBaseType.firefox))\n            : -1 !== (k = h.indexOf("trident")) &&\n              ((a = e.browserName.msie),\n              (k = h.indexOf("rv")),\n              (j = h.substring(k + 3, k + 7)),\n              (g = e.codeBaseType.chrome));\n          var m = [\n              {\n                s: "Windows 3.11",\n                r: /win16/,\n              },\n              {\n                s: "Windows 95",\n                r: /(windows 95|win95|windows_95)/,\n              },\n              {\n                s: "Windows ME",\n                r: /(win 9x 4.90|windows me)/,\n              },\n              {\n                s: "Windows 98",\n                r: /(windows 98|win98)/,\n              },\n              {\n                s: "Windows CE",\n                r: /windows ce/,\n              },\n              {\n                s: "Windows 2000",\n                r: /(windows nt 5.0|windows 2000)/,\n              },\n              {\n                s: "Windows XP",\n                r: /(windows nt 5.1|windows xp)/,\n              },\n              {\n                s: "Windows Server 2003",\n                r: /windows nt 5.2/,\n              },\n              {\n                s: "Windows Vista",\n                r: /windows nt 6.0/,\n              },\n              {\n                s: "Windows 7",\n                r: /(windows 7|windows nt 6.1)/,\n              },\n              {\n                s: "Windows 8.1",\n                r: /(windows 8.1|windows nt 6.3)/,\n              },\n              {\n                s: "Windows 8",\n                r: /(windows 8|windows nt 6.2)/,\n              },\n              {\n                s: "Windows 10",\n                r: /(windows 10|windows nt 10.0)/,\n              },\n              {\n                s: "Windows NT 4.0",\n                r: /(windows nt 4.0|winnt4.0|winnt|windows nt)/,\n              },\n              {\n                s: "Windows ME",\n                r: /windows me/,\n              },\n              {\n                s: "Android",\n                r: /android/,\n              },\n              {\n                s: "Open BSD",\n                r: /openbsd/,\n              },\n              {\n                s: "Sun OS",\n                r: /sunos/,\n              },\n              {\n                s: "Linux",\n                r: /(linux|x11)/,\n              },\n              {\n                s: "iOS",\n                r: /(iphone|ipad|ipod)/,\n              },\n              {\n                s: "Mac OS X",\n                r: /mac os x/,\n              },\n              {\n                s: "Mac OS",\n                r: /(macppc|macintel|mac_powerpc|macintosh)/,\n              },\n              {\n                s: "QNX",\n                r: /qnx/,\n              },\n              {\n                s: "UNIX",\n                r: /unix/,\n              },\n              {\n                s: "BeOS",\n                r: /beos/,\n              },\n              {\n                s: "OS/2",\n                r: /os\\/2/,\n              },\n              {\n                s: "Search Bot",\n                r: /(nuhk|googlebot|yammybot|openbot|slurp|msnbot|ask jeeves\\/teoma|ia_archiver)/,\n              },\n            ],\n            n = void 0,\n            o = void 0;\n          for (n in m)\n            if (m.hasOwnProperty(n) && (o = m[n]).r.test(h)) {\n              b = o.s;\n              break;\n            }\n          switch (\n            (b &&\n              /Windows/.test(b) &&\n              ((c = /Windows (.*)/.exec(b)[1]), (b = e.osName.windows)),\n            b)\n          ) {\n            case e.osName.mac:\n              c = /mac os x (10[\\.\\_\\d]+)/.exec(h)[1];\n              break;\n\n            case e.osName.android:\n              c = /android ([\\.\\_\\d]+)/.exec(h)[1];\n              break;\n\n            case e.osName.ios:\n              if (!i) break;\n              if (!(c = /os (\\d+)_(\\d+)_?(\\d+)?/.exec(i))) break;\n              c = c[1] + "." + c[2] + "." + (0 | c[3]);\n          }\n          return {\n            browserName: a,\n            browserVersion: j.toString(),\n            os: b,\n            osVersion: c,\n            codeBase: g,\n            userAgent: d,\n          };\n        }\n        Object.defineProperty(c, "__esModule", {\n          value: !0,\n        }),\n          (c.detect = d);\n        var e = (c.Constants = {\n          codeBaseType: {\n            chrome: "Chrome",\n            firefox: "Firefox",\n            edge: "Edge",\n            plugin: "Plugin",\n          },\n          browserName: {\n            chrome: "Chrome",\n            firefox: "Firefox",\n            edge: "Edge",\n            msie: "Microsoft Internet Explorer",\n            safari: "Safari",\n          },\n          osName: {\n            windows: "Windows",\n            mac: "Mac OS X",\n            android: "Android",\n            ios: "iOS",\n          },\n        });\n      },\n      {},\n    ],\n    12: [\n      function (a, b, c) {\n        "use strict";\n        function d(a, b) {\n          if (!(a instanceof b))\n            throw new TypeError("Cannot call a class as a function");\n        }\n        Object.defineProperty(c, "__esModule", {\n          value: !0,\n        }),\n          (c.GetStatsHandler = void 0);\n        var e = (function () {\n            function a(a, b) {\n              for (var c = 0; c < b.length; c++) {\n                var d = b[c];\n                (d.enumerable = d.enumerable || !1),\n                  (d.configurable = !0),\n                  "value" in d && (d.writable = !0),\n                  Object.defineProperty(a, d.key, d);\n              }\n            }\n            return function (b, c, d) {\n              return c && a(b.prototype, c), d && a(b, d), b;\n            };\n          })(),\n          f = a("./detectbrowser"),\n          g = a("./statsadapter"),\n          h = a("bluebird"),\n          i = (function () {\n            function a(b) {\n              d(this, a),\n                (this.codeBase = b.codeBase),\n                (this.browserName = b.browserName),\n                (this.adapter = new g.StatsAdapter(\n                  this.codeBase,\n                  this.browserName\n                )),\n                (this.isPromiseBased = !0);\n            }\n            return (\n              e(a, [\n                {\n                  key: "getIceCandidates",\n                  value: function (a) {\n                    var b = this;\n                    return new h(function (c, d) {\n                      b.csioGetStats(\n                        b.iceCandidatesHandler.bind(b),\n                        a,\n                        function (a) {\n                          c(a);\n                        }\n                      );\n                    });\n                  },\n                },\n                {\n                  key: "iceCandidatesHandler",\n                  value: function (a, b) {\n                    b(this.adapter.getIceCandidates(a));\n                  },\n                },\n                {\n                  key: "csioGetStats",\n                  value: function (a, b, c) {\n                    var d = f.Constants.codeBaseType.firefox,\n                      e = f.Constants.codeBaseType.chrome,\n                      g = f.Constants.codeBaseType.edge,\n                      h = f.Constants.browserName.safari;\n                    b &&\n                      (this.codeBase === d\n                        ? this.getStatsFirefox(a, b, c)\n                        : this.browserName === h\n                        ? this.getStatsSafari(a, b, c)\n                        : this.codeBase === e\n                        ? this.getStatsChrome(a, b, c)\n                        : this.codeBase === g && this.getStatsEdge(a, b, c));\n                  },\n                },\n                {\n                  key: "getStatsFirefox",\n                  value: function (a, b, c) {\n                    var d = this;\n                    if (d.isPromiseBased)\n                      try {\n                        b.getStats()\n                          .then(function (b) {\n                            a(b, c);\n                          })\n                          .catch(function (e) {\n                            (d.isPromiseBased = !1),\n                              b.getStats(\n                                null,\n                                function (b) {\n                                  a(b, c);\n                                },\n                                function () {}\n                              );\n                          });\n                      } catch (e) {\n                        (d.isPromiseBased = !1),\n                          b.getStats(\n                            null,\n                            function (b) {\n                              a(b, c);\n                            },\n                            function () {}\n                          );\n                      }\n                    else\n                      b.getStats(\n                        null,\n                        function (b) {\n                          a(b, c);\n                        },\n                        function () {}\n                      );\n                  },\n                },\n                {\n                  key: "getStatsChrome",\n                  value: function (a, b, c) {\n                    var d = this;\n                    if (window && window.csioReactNative)\n                      b.getStats(\n                        null,\n                        function (b) {\n                          a(b, c);\n                        },\n                        function (a) {}\n                      );\n                    else if (d.isPromiseBased)\n                      try {\n                        b.getStats()\n                          .then(function (b) {\n                            a(b, c);\n                          })\n                          .catch(function (e) {\n                            (d.isPromiseBased = !1),\n                              b.getStats(function (b) {\n                                a(b, c);\n                              });\n                          });\n                      } catch (d) {\n                        (isPromiseBased = !1),\n                          b.getStats(function (b) {\n                            a(b, c);\n                          });\n                      }\n                    else\n                      b.getStats(function (b) {\n                        a(b, c);\n                      });\n                  },\n                },\n                {\n                  key: "getStatsEdge",\n                  value: function (a, b, c) {\n                    b.getStats()\n                      .then(function (b) {\n                        a(b, c);\n                      })\n                      .catch(function (a) {});\n                  },\n                },\n                {\n                  key: "getStatsSafari",\n                  value: function (a, b, c) {\n                    b.getStats()\n                      .then(function (b) {\n                        a(b, c);\n                      })\n                      .catch(function (a) {});\n                  },\n                },\n              ]),\n              a\n            );\n          })();\n        c.GetStatsHandler = i;\n      },\n      {\n        "./detectbrowser": 11,\n        "./statsadapter": 13,\n        bluebird: 1,\n      },\n    ],\n    13: [\n      function (a, b, c) {\n        "use strict";\n        function d(a, b) {\n          if (!(a instanceof b))\n            throw new TypeError("Cannot call a class as a function");\n        }\n        Object.defineProperty(c, "__esModule", {\n          value: !0,\n        }),\n          (c.StatsAdapter = void 0);\n        var e = (function () {\n            function a(a, b) {\n              for (var c = 0; c < b.length; c++) {\n                var d = b[c];\n                (d.enumerable = d.enumerable || !1),\n                  (d.configurable = !0),\n                  "value" in d && (d.writable = !0),\n                  Object.defineProperty(a, d.key, d);\n              }\n            }\n            return function (b, c, d) {\n              return c && a(b.prototype, c), d && a(b, d), b;\n            };\n          })(),\n          f = a("./detectbrowser"),\n          g = (function () {\n            function a(b, c) {\n              d(this, a), (this.codeBase = b), (this.browser = c);\n            }\n            return (\n              e(a, [\n                {\n                  key: "getIceCandidates",\n                  value: function (a) {\n                    if (!a)\n                      return {\n                        localCandidates: [],\n                        remoteCandidates: [],\n                        iceCandidatePairs: [],\n                      };\n                    var b = this.extractRawStats(a);\n                    return this.processRawStatsForIceInfo(b);\n                  },\n                },\n                {\n                  key: "extractRawStats",\n                  value: function (a) {\n                    var b = [],\n                      c = void 0,\n                      d = f.Constants.codeBaseType.firefox,\n                      e = f.Constants.codeBaseType.chrome,\n                      g = f.Constants.browserName.safari;\n                    if (this.codeBase === d && this.browser !== g)\n                      a.forEach(function (a) {\n                        b.push(a);\n                      });\n                    else if (this.codeBase === e && this.browser !== g)\n                      a && a.result\n                        ? (b = a.result())\n                        : a &&\n                          a.forEach &&\n                          ((b = []),\n                          a.forEach(function (a) {\n                            b.push(a);\n                          }));\n                    else for (c in a) a.hasOwnProperty(c) && b.push(a[c]);\n                    return b;\n                  },\n                },\n                {\n                  key: "processRawStatsForIceInfo",\n                  value: function (a) {\n                    var b = [],\n                      c = [],\n                      d = [],\n                      e = void 0;\n                    if (!a)\n                      return {\n                        localCandidates: b,\n                        remoteCandidates: c,\n                        iceCandidatePairs: d,\n                      };\n                    for (var f = 0; f < a.length; ++f) {\n                      var g = this.getParsedStats(a[f]),\n                        h = this.statsClassifier(g);\n                      if (h.candidatePair) d.push(h.candidatePair);\n                      else if (h.transportStats) {\n                        if ("transport" === h.transportStats.type) {\n                          e = h.transportStats.selectedCandidatePairId;\n                          continue;\n                        }\n                        d.push(h.transportStats);\n                      } else if (h.localCandidate) {\n                        var i = h.localCandidate;\n                        if (\n                          "relay" == i.candidateType ||\n                          "relayed" == i.candidateType\n                        ) {\n                          if (!i.mozLocalTransport) {\n                            var j = i.priority >> 24;\n                            i.mozLocalTransport = this.formatRelayType(j);\n                          }\n                          i.mozLocalTransport = i.mozLocalTransport.toLowerCase();\n                        }\n                        b.push(i);\n                      } else h.remoteCandidate && c.push(h.remoteCandidate);\n                    }\n                    if (e)\n                      for (var k = 0; k < d.length; ++k)\n                        d[k].id === e && (d[k].googActiveConnection = "true");\n                    return {\n                      localCandidates: b,\n                      remoteCandidates: c,\n                      iceCandidatePairs: d,\n                    };\n                  },\n                },\n                {\n                  key: "getParsedStats",\n                  value: function (a) {\n                    var b = {};\n                    if (\n                      (a.timestamp instanceof Date &&\n                        (b.timestamp = a.timestamp.getTime().toString()),\n                      a.type && (b.type = a.type),\n                      a.names)\n                    )\n                      for (var c = a.names(), d = 0; d < c.length; ++d)\n                        b[c[d]] = a.stat(c[d]);\n                    else Object.assign(b, a);\n                    if (b.values) {\n                      for (var e = 0; e < b.values.length; e++) {\n                        var f = b.values[e];\n                        Object.assign(b, f);\n                      }\n                      delete b.values;\n                    }\n                    return b;\n                  },\n                },\n                {\n                  key: "statsClassifier",\n                  value: function (a) {\n                    var b = {},\n                      c = function () {\n                        for (\n                          var b = arguments.length, c = Array(b), d = 0;\n                          d < b;\n                          d++\n                        )\n                          c[d] = arguments[d];\n                        for (var e = 0; e < c.length; e++) {\n                          var f = c[e];\n                          if (a.type === f) return !0;\n                        }\n                        return !1;\n                      },\n                      d = c("inbound-rtp", "inboundrtp"),\n                      e = "true" === a.isRemote || !0 === a.isRemote;\n                    return (\n                      d || c("outbound-rtp", "outboundrtp")\n                        ? ((b.tracks = {}),\n                          (b.tracks.data = a),\n                          (b.tracks.ssrc = a.ssrc),\n                          (b.tracks.streamType = d ? "inbound" : "outbound"),\n                          (b.tracks.reportType = "local"),\n                          void 0 !== a.isRemote &&\n                            (b.tracks.reportType = e ? "remote" : "local"))\n                        : c("candidatepair") && a.selected\n                        ? (b.transportStats = a)\n                        : c("localcandidate", "local-candidate")\n                        ? (b.localCandidate = a)\n                        : c("remotecandidate", "remote-candidate")\n                        ? (b.remoteCandidate = a)\n                        : c("transport", "googCandidatePair")\n                        ? (b.transportStats = a)\n                        : c("VideoBwe")\n                        ? (b.bwe = a)\n                        : c("track")\n                        ? (b.trackStats = a)\n                        : c("candidate-pair")\n                        ? (b.candidatePair = a)\n                        : c("codec")\n                        ? (b.codec = a)\n                        : c("ssrc") &&\n                          ((b.tracks = {}),\n                          (b.tracks.data = a),\n                          (b.tracks.ssrc = a.ssrc),\n                          (b.tracks.reportType = "local"),\n                          (b.tracks.streamType = a.bytesSent\n                            ? "outbound"\n                            : "inbound")),\n                      b\n                    );\n                  },\n                },\n                {\n                  key: "formatRelayType",\n                  value: function (a) {\n                    var b = "none";\n                    switch (a) {\n                      case 0:\n                        b = "tls";\n                        break;\n\n                      case 1:\n                        b = "tcp";\n                        break;\n\n                      case 2:\n                        b = "udp";\n                    }\n                    return b;\n                  },\n                },\n              ]),\n              a\n            );\n          })();\n        c.StatsAdapter = g;\n      },\n      {\n        "./detectbrowser": 11,\n      },\n    ],\n    14: [\n      function (a, b, c) {\n        "use strict";\n        function d() {\n          return window &&\n            window.performance &&\n            window.performance.now &&\n            window.performance.timing &&\n            window.performance.timing.navigationStart\n            ? window.performance.now() +\n                window.performance.timing.navigationStart\n            : Date.now();\n        }\n        Object.defineProperty(c, "__esModule", {\n          value: !0,\n        }),\n          (c.getCurrent = d);\n      },\n      {},\n    ],\n    15: [\n      function (a, b, c) {\n        function d() {\n          throw new Error("setTimeout has not been defined");\n        }\n        function e() {\n          throw new Error("clearTimeout has not been defined");\n        }\n        function f(a) {\n          if (l === setTimeout) return setTimeout(a, 0);\n          if ((l === d || !l) && setTimeout)\n            return (l = setTimeout), setTimeout(a, 0);\n          try {\n            return l(a, 0);\n          } catch (b) {\n            try {\n              return l.call(null, a, 0);\n            } catch (b) {\n              return l.call(this, a, 0);\n            }\n          }\n        }\n        function g(a) {\n          if (m === clearTimeout) return clearTimeout(a);\n          if ((m === e || !m) && clearTimeout)\n            return (m = clearTimeout), clearTimeout(a);\n          try {\n            return m(a);\n          } catch (b) {\n            try {\n              return m.call(null, a);\n            } catch (b) {\n              return m.call(this, a);\n            }\n          }\n        }\n        function h() {\n          q &&\n            o &&\n            ((q = !1),\n            o.length ? (p = o.concat(p)) : (r = -1),\n            p.length && i());\n        }\n        function i() {\n          if (!q) {\n            var a = f(h);\n            q = !0;\n            for (var b = p.length; b; ) {\n              for (o = p, p = []; ++r < b; ) o && o[r].run();\n              (r = -1), (b = p.length);\n            }\n            (o = null), (q = !1), g(a);\n          }\n        }\n        function j(a, b) {\n          (this.fun = a), (this.array = b);\n        }\n        function k() {}\n        var l,\n          m,\n          n = (b.exports = {});\n        !(function () {\n          try {\n            l = "function" == typeof setTimeout ? setTimeout : d;\n          } catch (a) {\n            l = d;\n          }\n          try {\n            m = "function" == typeof clearTimeout ? clearTimeout : e;\n          } catch (a) {\n            m = e;\n          }\n        })();\n        var o,\n          p = [],\n          q = !1,\n          r = -1;\n        (n.nextTick = function (a) {\n          var b = new Array(arguments.length - 1);\n          if (arguments.length > 1)\n            for (var c = 1; c < arguments.length; c++) b[c - 1] = arguments[c];\n          p.push(new j(a, b)), 1 !== p.length || q || f(i);\n        }),\n          (j.prototype.run = function () {\n            this.fun.apply(null, this.array);\n          }),\n          (n.title = "browser"),\n          (n.browser = !0),\n          (n.env = {}),\n          (n.argv = []),\n          (n.version = ""),\n          (n.versions = {}),\n          (n.on = k),\n          (n.addListener = k),\n          (n.once = k),\n          (n.off = k),\n          (n.removeListener = k),\n          (n.removeAllListeners = k),\n          (n.emit = k),\n          (n.prependListener = k),\n          (n.prependOnceListener = k),\n          (n.listeners = function (a) {\n            return [];\n          }),\n          (n.binding = function (a) {\n            throw new Error("process.binding is not supported");\n          }),\n          (n.cwd = function () {\n            return "/";\n          }),\n          (n.chdir = function (a) {\n            throw new Error("process.chdir is not supported");\n          }),\n          (n.umask = function () {\n            return 0;\n          });\n      },\n      {},\n    ],\n    16: [\n      function (a, b, c) {\n        (function (b, d) {\n          function e(a, b) {\n            (this._id = a), (this._clearFn = b);\n          }\n          var f = a("process/browser.js").nextTick,\n            g = Function.prototype.apply,\n            h = Array.prototype.slice,\n            i = {},\n            j = 0;\n          (c.setTimeout = function () {\n            return new e(g.call(setTimeout, window, arguments), clearTimeout);\n          }),\n            (c.setInterval = function () {\n              return new e(\n                g.call(setInterval, window, arguments),\n                clearInterval\n              );\n            }),\n            (c.clearTimeout = c.clearInterval = function (a) {\n              a.close();\n            }),\n            (e.prototype.unref = e.prototype.ref = function () {}),\n            (e.prototype.close = function () {\n              this._clearFn.call(window, this._id);\n            }),\n            (c.enroll = function (a, b) {\n              clearTimeout(a._idleTimeoutId), (a._idleTimeout = b);\n            }),\n            (c.unenroll = function (a) {\n              clearTimeout(a._idleTimeoutId), (a._idleTimeout = -1);\n            }),\n            (c._unrefActive = c.active = function (a) {\n              clearTimeout(a._idleTimeoutId);\n              var b = a._idleTimeout;\n              b >= 0 &&\n                (a._idleTimeoutId = setTimeout(function () {\n                  a._onTimeout && a._onTimeout();\n                }, b));\n            }),\n            (c.setImmediate =\n              "function" == typeof b\n                ? b\n                : function (a) {\n                    var b = j++,\n                      d = !(arguments.length < 2) && h.call(arguments, 1);\n                    return (\n                      (i[b] = !0),\n                      f(function () {\n                        i[b] &&\n                          (d ? a.apply(null, d) : a.call(null),\n                          c.clearImmediate(b));\n                      }),\n                      b\n                    );\n                  }),\n            (c.clearImmediate =\n              "function" == typeof d\n                ? d\n                : function (a) {\n                    delete i[a];\n                  });\n        }.call(this, a("timers").setImmediate, a("timers").clearImmediate));\n      },\n      {\n        "process/browser.js": 15,\n        timers: 16,\n      },\n    ],\n    17: [\n      function (a, b, c) {\n        "use strict";\n        function d(a, b) {\n          if (!(a instanceof b))\n            throw new TypeError("Cannot call a class as a function");\n        }\n        Object.defineProperty(c, "__esModule", {\n          value: !0,\n        });\n        var e = (function () {\n            function a(a, b) {\n              for (var c = 0; c < b.length; c++) {\n                var d = b[c];\n                (d.enumerable = d.enumerable || !1),\n                  (d.configurable = !0),\n                  "value" in d && (d.writable = !0),\n                  Object.defineProperty(a, d.key, d);\n              }\n            }\n            return function (b, c, d) {\n              return c && a(b.prototype, c), d && a(b, d), b;\n            };\n          })(),\n          f = (function () {\n            function a() {\n              var b = this;\n              d(this, a),\n                (this.batteryManager = null),\n                "function" == typeof navigator.getBattery &&\n                  navigator.getBattery().then(function (a) {\n                    b.batteryManager = a;\n                  });\n            }\n            return (\n              e(a, [\n                {\n                  key: "getLevel",\n                  value: function () {\n                    return this.batteryManager ? this.batteryManager.level : -1;\n                  },\n                },\n                {\n                  key: "getCharging",\n                  value: function () {\n                    return this.batteryManager\n                      ? this.batteryManager.charging\n                      : null;\n                  },\n                },\n              ]),\n              a\n            );\n          })();\n        c.Battery = f;\n      },\n      {},\n    ],\n    18: [\n      function (a, b, c) {\n        "use strict";\n        function d() {\n          var a = f.browserName.chrome,\n            b = null,\n            c = null,\n            d = null,\n            e = null,\n            g = f.codeBaseType.chrome;\n          if (!window.navigator.userAgent || window.csioReactNative)\n            return (\n              window && window.csioGetOsName && (b = window.csioGetOsName()),\n              window && window.csioGetOsVer && (c = window.csioGetOsVer()),\n              window && window.csioReactNative && (d = "react-native"),\n              {\n                browserName: a,\n                codeBase: g,\n                os: b,\n                osVersion: c,\n                userAgent: d,\n                browserVersion: null,\n              }\n            );\n          d = navigator.userAgent;\n          var h = d.toLowerCase();\n          e = navigator.appVersion;\n          var i = void 0,\n            j = void 0;\n          e && ((i = e.toLowerCase()), (j = "" + parseFloat(i)));\n          var k = void 0;\n          -1 !== (k = h.indexOf("opera"))\n            ? ((a = f.browserName.opera),\n              (j = h.substring(k + 6)),\n              -1 !== (k = h.indexOf("Version")) && (j = h.substring(k + 8)),\n              (g = f.codeBaseType.chrome))\n            : -1 !== (k = h.indexOf("opr"))\n            ? ((a = f.browserName.opera),\n              (j = h.substring(k + 4)),\n              -1 !== (k = h.indexOf("Version")) && (j = h.substring(k + 8)),\n              (g = f.codeBaseType.chrome))\n            : -1 !== (k = h.indexOf("msie"))\n            ? ((a = f.browserName.msie),\n              (j = h.substring(k + 5)),\n              (g = f.codeBaseType.chrome))\n            : -1 !== (k = h.indexOf("edge"))\n            ? ((a = f.browserName.edge),\n              (j = h.substring(k + 5)),\n              (g = f.codeBaseType.edge))\n            : -1 !== (k = h.indexOf("chrome"))\n            ? ((a = f.browserName.chrome),\n              (j = h.substring(k + 7)),\n              (g = f.codeBaseType.chrome))\n            : -1 !== (k = h.indexOf("safari"))\n            ? ((a = f.browserName.safari),\n              (j = h.substring(k + 7)),\n              -1 !== (k = h.indexOf("Version")) && (j = h.substring(k + 8)),\n              (g = f.codeBaseType.chrome))\n            : -1 !== (k = h.indexOf("firefox"))\n            ? ((a = f.browserName.firefox),\n              (j = h.substring(k + 8)),\n              (g = f.codeBaseType.firefox))\n            : -1 !== (k = h.indexOf("trident")) &&\n              ((a = f.browserName.msie),\n              (k = h.indexOf("rv")),\n              (j = h.substring(k + 3, k + 7)),\n              (g = f.codeBaseType.chrome));\n          var l = [\n              {\n                s: "Windows 3.11",\n                r: /win16/,\n              },\n              {\n                s: "Windows 95",\n                r: /(windows 95|win95|windows_95)/,\n              },\n              {\n                s: "Windows ME",\n                r: /(win 9x 4.90|windows me)/,\n              },\n              {\n                s: "Windows 98",\n                r: /(windows 98|win98)/,\n              },\n              {\n                s: "Windows CE",\n                r: /windows ce/,\n              },\n              {\n                s: "Windows 2000",\n                r: /(windows nt 5.0|windows 2000)/,\n              },\n              {\n                s: "Windows XP",\n                r: /(windows nt 5.1|windows xp)/,\n              },\n              {\n                s: "Windows Server 2003",\n                r: /windows nt 5.2/,\n              },\n              {\n                s: "Windows Vista",\n                r: /windows nt 6.0/,\n              },\n              {\n                s: "Windows 7",\n                r: /(windows 7|windows nt 6.1)/,\n              },\n              {\n                s: "Windows 8.1",\n                r: /(windows 8.1|windows nt 6.3)/,\n              },\n              {\n                s: "Windows 8",\n                r: /(windows 8|windows nt 6.2)/,\n              },\n              {\n                s: "Windows 10",\n                r: /(windows 10|windows nt 10.0)/,\n              },\n              {\n                s: "Windows NT 4.0",\n                r: /(windows nt 4.0|winnt4.0|winnt|windows nt)/,\n              },\n              {\n                s: "Windows ME",\n                r: /windows me/,\n              },\n              {\n                s: "Android",\n                r: /android/,\n              },\n              {\n                s: "Open BSD",\n                r: /openbsd/,\n              },\n              {\n                s: "Sun OS",\n                r: /sunos/,\n              },\n              {\n                s: "Linux",\n                r: /(linux|x11)/,\n              },\n              {\n                s: "iOS",\n                r: /(iphone|ipad|ipod)/,\n              },\n              {\n                s: "Mac OS X",\n                r: /mac os x/,\n              },\n              {\n                s: "Mac OS",\n                r: /(macppc|macintel|mac_powerpc|macintosh)/,\n              },\n              {\n                s: "QNX",\n                r: /qnx/,\n              },\n              {\n                s: "UNIX",\n                r: /unix/,\n              },\n              {\n                s: "BeOS",\n                r: /beos/,\n              },\n              {\n                s: "OS/2",\n                r: /os\\/2/,\n              },\n              {\n                s: "Search Bot",\n                r: /(nuhk|googlebot|yammybot|openbot|slurp|msnbot|ask jeeves\\/teoma|ia_archiver)/,\n              },\n            ],\n            m = void 0,\n            n = void 0;\n          for (m in l)\n            if (l.hasOwnProperty(m) && ((n = l[m]), n.r.test(h))) {\n              b = n.s;\n              break;\n            }\n          switch (\n            (b &&\n              /Windows/.test(b) &&\n              ((c = /Windows (.*)/.exec(b)[1]), (b = f.osName.windows)),\n            b)\n          ) {\n            case f.osName.mac:\n              c = /mac os x (10[\\.\\_\\d]+)/.exec(h)[1];\n              break;\n\n            case f.osName.android:\n              c = /android ([\\.\\_\\d]+)/.exec(h)[1];\n              break;\n\n            case f.osName.ios:\n              if (!i) break;\n              if (!(c = /os (\\d+)_(\\d+)_?(\\d+)?/.exec(i))) break;\n              c = c[1] + "." + c[2] + "." + (0 | c[3]);\n          }\n          return {\n            browserName: a,\n            browserVersion: j.toString(),\n            os: b,\n            osVersion: c,\n            codeBase: g,\n            userAgent: d,\n          };\n        }\n        Object.defineProperty(c, "__esModule", {\n          value: !0,\n        }),\n          (c.detect = d);\n        var e = a("../config/constants"),\n          f = (function (a) {\n            if (a && a.__esModule) return a;\n            var b = {};\n            if (null != a)\n              for (var c in a)\n                Object.prototype.hasOwnProperty.call(a, c) && (b[c] = a[c]);\n            return (b.default = a), b;\n          })(e);\n      },\n      {\n        "../config/constants": 33,\n      },\n    ],\n    19: [\n      function (a, b, c) {\n        "use strict";\n        function d(a) {\n          if (a && a.__esModule) return a;\n          var b = {};\n          if (null != a)\n            for (var c in a)\n              Object.prototype.hasOwnProperty.call(a, c) && (b[c] = a[c]);\n          return (b.default = a), b;\n        }\n        function e(a, b) {\n          if (!(a instanceof b))\n            throw new TypeError("Cannot call a class as a function");\n        }\n        Object.defineProperty(c, "__esModule", {\n          value: !0,\n        }),\n          (c.Devices = void 0);\n        var f = (function () {\n            function a(a, b) {\n              for (var c = 0; c < b.length; c++) {\n                var d = b[c];\n                (d.enumerable = d.enumerable || !1),\n                  (d.configurable = !0),\n                  "value" in d && (d.writable = !0),\n                  Object.defineProperty(a, d.key, d);\n              }\n            }\n            return function (b, c, d) {\n              return c && a(b.prototype, c), d && a(b, d), b;\n            };\n          })(),\n          g = a("../config/constants"),\n          h = d(g),\n          i = a("../utility/registry"),\n          j = a("../utility/csiologger"),\n          k = d(j),\n          l = a("../utility/utils"),\n          m = d(l),\n          n = (function () {\n            function a(b, c) {\n              e(this, a),\n                (this.conferenceId = b),\n                (this.pc = c),\n                (this.devices = null),\n                (this.emb = i.Registry.getEventMessageBuilder());\n            }\n            return (\n              f(a, [\n                {\n                  key: "collectConnected",\n                  value: function () {\n                    var a = this;\n                    if (\n                      navigator.mediaDevices &&\n                      navigator.mediaDevices.enumerateDevices\n                    ) {\n                      var b = this;\n                      navigator.mediaDevices\n                        .enumerateDevices()\n                        .then(function (c) {\n                          var d = m.normalizeMediaDeviceList(c);\n                          b.sendConnected(d),\n                            setTimeout(a.collectConnected.bind(b), 1e4);\n                        })\n                        .catch(function (c) {\n                          setTimeout(a.collectConnected.bind(b), 1e4);\n                        });\n                    }\n                  },\n                },\n                {\n                  key: "sendConnected",\n                  value: function (a) {\n                    this.devices\n                      ? this.compare(a) || ((this.devices = a), this.send())\n                      : ((this.devices = a), this.send());\n                  },\n                },\n                {\n                  key: "compare",\n                  value: function (a) {\n                    return (\n                      self.devices.sort().toString() === a.sort().toString()\n                    );\n                  },\n                },\n                {\n                  key: "send",\n                  value: function () {\n                    var a = {\n                      mediaDeviceList: this.devices,\n                    };\n                    k.log(\n                      "sending connectedDevice",\n                      h.internalFabricEvent.connectedDeviceList,\n                      a\n                    ),\n                      this.emb.make(\n                        h.internalFabricEvent.connectedDeviceList,\n                        this.conferenceId,\n                        this.pc,\n                        a\n                      );\n                  },\n                },\n              ]),\n              a\n            );\n          })();\n        c.Devices = n;\n      },\n      {\n        "../config/constants": 33,\n        "../utility/csiologger": 88,\n        "../utility/registry": 95,\n        "../utility/utils": 101,\n      },\n    ],\n    20: [\n      function (a, b, c) {\n        "use strict";\n        function d(a, b) {\n          if (b)\n            try {\n              window &&\n                window.localStorage &&\n                window.localStorage.setItem(a, b);\n            } catch (a) {\n              return;\n            }\n        }\n        function e(a) {\n          try {\n            if (window && window.localStorage)\n              return window.localStorage.getItem(a);\n          } catch (a) {\n            return null;\n          }\n          return null;\n        }\n        function f(a) {\n          try {\n            window && window.localStorage && window.localStorage.removeItem(a);\n          } catch (a) {\n            return;\n          }\n        }\n        Object.defineProperty(c, "__esModule", {\n          value: !0,\n        }),\n          (c.store = d),\n          (c.get = e),\n          (c.remove = f);\n      },\n      {},\n    ],\n    21: [\n      function (a, b, c) {\n        "use strict";\n        function d(a, b) {\n          if (b)\n            try {\n              window &&\n                window.sessionStorage &&\n                window.sessionStorage.setItem(a, b);\n            } catch (a) {\n              return;\n            }\n        }\n        function e(a) {\n          try {\n            if (window && window.sessionStorage)\n              return window.sessionStorage.getItem(a);\n          } catch (a) {\n            return null;\n          }\n          return null;\n        }\n        function f(a) {\n          try {\n            window &&\n              window.sessionStorage &&\n              window.sessionStorage.removeItem(a);\n          } catch (a) {\n            return;\n          }\n        }\n        function g(a, b) {\n          if (a) {\n            var c = JSON.parse(e("csio_ucid_data"));\n            c || (c = {}),\n              c[a] || (c[a] = {}),\n              (c[a].ucID = b),\n              d("csio_ucid_data", JSON.stringify(c));\n          }\n        }\n        function h(a) {\n          if (!a) return null;\n          var b = JSON.parse(e("csio_ucid_data"));\n          return b && b[a] ? b[a].ucID : null;\n        }\n        Object.defineProperty(c, "__esModule", {\n          value: !0,\n        }),\n          (c.store = d),\n          (c.get = e),\n          (c.remove = f),\n          (c.storeUcId = g),\n          (c.getUcId = h);\n      },\n      {},\n    ],\n    22: [\n      function (a, b, c) {\n        (function (c) {\n          "use strict";\n          function d(a) {\n            if (a && a.__esModule) return a;\n            var b = {};\n            if (null != a)\n              for (var c in a)\n                Object.prototype.hasOwnProperty.call(a, c) && (b[c] = a[c]);\n            return (b.default = a), b;\n          }\n          function e(a, b) {\n            if (!(a instanceof b))\n              throw new TypeError("Cannot call a class as a function");\n          }\n          function f(a, b) {\n            var c = {};\n            return (c.status = a), b && (c.message = b), c;\n          }\n          function g(a, b) {\n            return (\n              a +\n              ": " +\n              b +\n              " " +\n              (arguments.length > 2 && void 0 !== arguments[2]\n                ? arguments[2]\n                : "")\n            );\n          }\n          function h() {\n            var a = null,\n              b = r.Registry.getEndpoint().getBrowserName();\n            return (\n              "Firefox" === b\n                ? (a = mozRTCPeerConnection)\n                : "Chrome" === b || "Opera" === b\n                ? (a = webkitRTCPeerConnection)\n                : "Safari" === b\n                ? t.log("Browser type Safari")\n                : "Edge" === b && (a = window.RTCPeerConnection),\n              a\n            );\n          }\n          function i(a) {\n            if (null === a) return !1;\n            var b = r.Registry.getEndpoint().getCodeBase();\n            if (b === m.codeBaseType.firefox)\n              return (\n                ("undefined" != typeof mozRTCPeerConnection &&\n                  a instanceof mozRTCPeerConnection) ||\n                ("undefined" != typeof RTCPeerConnection &&\n                  a instanceof RTCPeerConnection)\n              );\n            if (b === m.codeBaseType.edge || "function" == typeof a) return !0;\n            var c = h();\n            return (null !== c && a instanceof c) || void 0 !== a.createOffer;\n          }\n          var j =\n              "function" == typeof Symbol && "symbol" == typeof Symbol.iterator\n                ? function (a) {\n                    return typeof a;\n                  }\n                : function (a) {\n                    return a &&\n                      "function" == typeof Symbol &&\n                      a.constructor === Symbol &&\n                      a !== Symbol.prototype\n                      ? "symbol"\n                      : typeof a;\n                  },\n            k = (function () {\n              function a(a, b) {\n                for (var c = 0; c < b.length; c++) {\n                  var d = b[c];\n                  (d.enumerable = d.enumerable || !1),\n                    (d.configurable = !0),\n                    "value" in d && (d.writable = !0),\n                    Object.defineProperty(a, d.key, d);\n                }\n              }\n              return function (b, c, d) {\n                return c && a(b.prototype, c), d && a(b, d), b;\n              };\n            })(),\n            l = a("./config/constants"),\n            m = d(l),\n            n = a("./config/settings"),\n            o = d(n),\n            p = a("./config/callstatserrors"),\n            q = a("./fsm/mainfsm"),\n            r = a("./utility/registry"),\n            s = a("./utility/csiologger"),\n            t = d(s),\n            u = a("./utility/onerroreventlistner"),\n            v = d(u),\n            w = a("./utility/utils"),\n            x = d(w);\n          v.setErrorEventListener(),\n            x.assignPollyfill(),\n            x.isIntegerPollyfill();\n          var y = null,\n            z = (function () {\n              function a() {\n                e(this, a), (y = new q.MainFSM());\n              }\n              return (\n                k(a, [\n                  {\n                    key: "initialize",\n                    value: function (a, b, c, d, e, h) {\n                      if (!a || !c || !b) {\n                        var i = g("initialize", p.csErrorStrings.argumentError);\n                        return (\n                          t.error(i), f(m.callstatsAPIReturnStatus.failure, i)\n                        );\n                      }\n                      if (d && "function" != typeof d) {\n                        var j = g("initialize", p.csErrorStrings.argumentError);\n                        t.warn(j), (d = null);\n                      }\n                      if (e && "function" != typeof e) {\n                        var k = g("initialize", p.csErrorStrings.argumentError);\n                        t.warn(k), (e = null);\n                      }\n                      if (\n                        "function" != typeof b &&\n                        !(\n                          (window.crypto &&\n                            (window.crypto.subtle ||\n                              window.crypto.webkitSubtle)) ||\n                          (window.msCrypto && window.msCrypto.subtle) ||\n                          window.csioReactNative\n                        )\n                      ) {\n                        var l = g("initialize", p.csErrorStrings.cryptoError);\n                        return (\n                          t.error(l),\n                          d &&\n                            d(\n                              p.csError.tokenGenerationError,\n                              p.csErrorStrings.cryptoError\n                            ),\n                          f(m.callstatsAPIReturnStatus.failure, l)\n                        );\n                      }\n                      try {\n                        y.fire(q.MainEvents.onInitialize, a, c, b, d, e, h),\n                          y.run();\n                      } catch (a) {\n                        r.Registry.getGenericEventHandler().sendEvent(\n                          m.logEvents.error,\n                          {\n                            msg: "initialize: Error",\n                            error: a.message + ":" + a.stack,\n                          }\n                        ),\n                          t.error("initialize: Error", a);\n                      }\n                      return f(m.callstatsAPIReturnStatus.success);\n                    },\n                  },\n                  {\n                    key: "addNewFabric",\n                    value: function (a, b, c, d, e, h) {\n                      var j = null,\n                        k = m.endpointType.peer,\n                        l = m.transmissionDirection.sendrecv;\n                      if (void 0 === b) {\n                        var n = g(\n                          "addNewFabric",\n                          p.csErrorStrings.argumentError\n                        );\n                        return (\n                          t.error(n), f(m.callstatsAPIReturnStatus.failure, n)\n                        );\n                      }\n                      if (void 0 === d) {\n                        var o = g(\n                          "addNewFabric",\n                          p.csErrorStrings.argumentError\n                        );\n                        return (\n                          t.error(o), f(m.callstatsAPIReturnStatus.failure, o)\n                        );\n                      }\n                      if ((d || (d = m.tmpConferenceId), !a || !c)) {\n                        var s = g(\n                          "addNewFabric",\n                          p.csErrorStrings.argumentError\n                        );\n                        return (\n                          t.error(s), f(m.callstatsAPIReturnStatus.failure, s)\n                        );\n                      }\n                      if (\n                        (h && "function" == typeof h && (j = h),\n                        e && "function" == typeof e && (j = e),\n                        e && "function" != typeof e)\n                      ) {\n                        if (e.remoteEndpointType) {\n                          if (\n                            !m.endpointType.hasOwnProperty(e.remoteEndpointType)\n                          ) {\n                            var u = g(\n                              "addNewFabric",\n                              p.csErrorStrings.invalidEndPointType,\n                              e.remoteEndpointType\n                            );\n                            return (\n                              t.error(u),\n                              f(m.callstatsAPIReturnStatus.failure, u)\n                            );\n                          }\n                          k = e.remoteEndpointType;\n                        }\n                        if (e.fabricTransmissionDirection) {\n                          if (\n                            !m.transmissionDirection.hasOwnProperty(\n                              e.fabricTransmissionDirection\n                            )\n                          ) {\n                            var v = g(\n                              "addNewFabric",\n                              p.csErrorStrings.invalidTransmissionDirection,\n                              e.fabricTransmissionDirection\n                            );\n                            return (\n                              t.error(v),\n                              f(m.callstatsAPIReturnStatus.failure, v)\n                            );\n                          }\n                          l = e.fabricTransmissionDirection;\n                        }\n                      }\n                      if (\n                        !m.fabricUsage.hasOwnProperty(c) ||\n                        c instanceof Function\n                      ) {\n                        var w = g(\n                          "addNewFabric",\n                          p.csErrorStrings.fabricUsageInvalid,\n                          c\n                        );\n                        return (\n                          t.error(w), f(m.callstatsAPIReturnStatus.failure, w)\n                        );\n                      }\n                      if (!i(a)) {\n                        var x = g("addNewFabric", p.csErrorStrings.pcInvalid);\n                        return (\n                          t.error(x), f(m.callstatsAPIReturnStatus.failure, x)\n                        );\n                      }\n                      var z = r.Registry.getConferenceManager().get(d);\n                      if (z) {\n                        if (z.getPeerConnectionManager().getPcHandler(a))\n                          return f(m.callstatsAPIReturnStatus.success);\n                      }\n                      if (\n                        !r.Registry.getCredentials().getAppId() ||\n                        !r.Registry.getCredentials().getUserId()\n                      ) {\n                        var A = g(\n                          "addNewFabric",\n                          p.csErrorStrings.notInitialized\n                        );\n                        return (\n                          t.error(A), f(m.callstatsAPIReturnStatus.failure, A)\n                        );\n                      }\n                      try {\n                        y.fire(\n                          q.MainEvents.onAddNewFabric,\n                          a,\n                          b,\n                          c,\n                          d,\n                          k,\n                          l,\n                          j\n                        ),\n                          y.run();\n                      } catch (a) {\n                        r.Registry.getGenericEventHandler().sendEvent(\n                          m.logEvents.error,\n                          {\n                            msg: "addNewFabric: Error",\n                            error: a.message + ":" + a.stack,\n                          }\n                        ),\n                          t.error("addNewFabric: Error", a);\n                      }\n                      return f(m.callstatsAPIReturnStatus.success);\n                    },\n                  },\n                  {\n                    key: "sendFabricEvent",\n                    value: function (a, b, c, d) {\n                      if (\n                        (t.log("sendFabricEvent ", b),\n                        c || (c = m.tmpConferenceId),\n                        !a || !b)\n                      ) {\n                        var e = g(\n                          "sendFabricEvent",\n                          p.csErrorStrings.argumentError\n                        );\n                        return (\n                          t.error(e), f(m.callstatsAPIReturnStatus.failure, e)\n                        );\n                      }\n                      if (b === m.fabricEvent.fabricSetupFailed) {\n                        var h = g(\n                          "sendFabricEvent",\n                          p.csErrorStrings.fabricEventUnsupported,\n                          b\n                        );\n                        return (\n                          t.error(h), f(m.callstatsAPIReturnStatus.failure, h)\n                        );\n                      }\n                      if (\n                        !m.fabricEvent.hasOwnProperty(b) &&\n                        !m.internalFabricEvent.hasOwnProperty(b)\n                      ) {\n                        var i = g(\n                          "sendFabricEvent",\n                          p.csErrorStrings.fabricEventInvalid,\n                          b\n                        );\n                        return (\n                          t.error(i), f(m.callstatsAPIReturnStatus.failure, i)\n                        );\n                      }\n                      if (\n                        !(\n                          b !== m.fabricEvent.activeDeviceList ||\n                          (d && d.deviceList)\n                        )\n                      ) {\n                        var j = g(\n                          "sendFabricEvent ",\n                          p.csErrorStrings.argumentError\n                        );\n                        return (\n                          t.error(j), f(m.callstatsAPIReturnStatus.failure, j)\n                        );\n                      }\n                      var k = r.Registry.getConferenceManager().get(c);\n                      if (\n                        !r.Registry.getCredentials().getAppId() ||\n                        !r.Registry.getCredentials().getUserId() ||\n                        !k\n                      ) {\n                        var l = g(\n                          "sendFabricEvent ",\n                          p.csErrorStrings.notInitialized\n                        );\n                        return (\n                          t.error(l), f(m.callstatsAPIReturnStatus.failure, l)\n                        );\n                      }\n                      if (!k.getPeerConnectionManager().getPcHandler(a)) {\n                        var n = g(\n                          "sendFabricEvent ",\n                          p.csErrorStrings.pcInvalid\n                        );\n                        return (\n                          t.error(n), f(m.callstatsAPIReturnStatus.failure, n)\n                        );\n                      }\n                      try {\n                        y.fire(q.MainEvents.onSendFabricEvent, a, b, c, d),\n                          y.run();\n                      } catch (a) {\n                        r.Registry.getGenericEventHandler().sendEvent(\n                          m.logEvents.error,\n                          {\n                            msg: "sendFabricEvent: Error",\n                            error: a.message + ":" + a.stack,\n                          }\n                        ),\n                          t.error("sendFabricEvent: Error", a);\n                      }\n                      return f(m.callstatsAPIReturnStatus.success);\n                    },\n                  },\n                  {\n                    key: "sendUserFeedback",\n                    value: function (a, b, c) {\n                      if (!b || !a) {\n                        var d = g(\n                          "sendUserFeedback",\n                          p.csErrorStrings.argumentError\n                        );\n                        return (\n                          t.error(d), f(m.callstatsAPIReturnStatus.failure, d)\n                        );\n                      }\n                      if ("object" !== (void 0 === b ? "undefined" : j(b))) {\n                        var e = g(\n                          "sendUserFeedback",\n                          p.csErrorStrings.argumentError\n                        );\n                        return (\n                          t.error(e), f(m.callstatsAPIReturnStatus.failure, e)\n                        );\n                      }\n                      if (0 === Object.keys(b).length) {\n                        var h = g(\n                          "sendUserFeedback",\n                          p.csErrorStrings.argumentError\n                        );\n                        return (\n                          t.error(h), f(m.callstatsAPIReturnStatus.failure, h)\n                        );\n                      }\n                      try {\n                        y.fire(q.MainEvents.onSendUserFeedback, a, b, c),\n                          y.run();\n                      } catch (a) {\n                        r.Registry.getGenericEventHandler().sendEvent(\n                          m.logEvents.error,\n                          {\n                            msg: "sendUserFeedback: Error",\n                            error: a.message + ":" + a.stack,\n                          }\n                        ),\n                          t.error("sendUserFeedback: Error", a);\n                      }\n                      return f(m.callstatsAPIReturnStatus.success);\n                    },\n                  },\n                  {\n                    key: "associateMstWithUserID",\n                    value: function (a, b, c, d, e, h) {\n                      if ((c || (c = m.tmpConferenceId), !a || !d || !e)) {\n                        var j = g(\n                          "associateMstWithUserID",\n                          p.csErrorStrings.argumentError\n                        );\n                        return (\n                          t.error(j), f(m.callstatsAPIReturnStatus.failure, j)\n                        );\n                      }\n                      if (!i(a)) {\n                        var k = g(\n                          "associateMstWithUserID",\n                          p.csErrorStrings.pcInvalid\n                        );\n                        return (\n                          t.error(k), f(m.callstatsAPIReturnStatus.failure, k)\n                        );\n                      }\n                      var l = r.Registry.getConferenceManager().get(c);\n                      if (!l) {\n                        var n = g(\n                          "associateMstWithUserID",\n                          p.csErrorStrings.confereneDoesNotExist\n                        );\n                        return (\n                          t.error(n), f(m.callstatsAPIReturnStatus.failure, n)\n                        );\n                      }\n                      if (!l.getPeerConnectionManager().getPcHandler(a)) {\n                        var o = g(\n                          "associateMstWithUserID",\n                          p.csErrorStrings.pcInvalid\n                        );\n                        return (\n                          t.error(o), f(m.callstatsAPIReturnStatus.failure, o)\n                        );\n                      }\n                      h &&\n                        "string" != typeof h &&\n                        (t.error("associateMstWithUserID: Invalid videoTag"),\n                        (h = null));\n                      try {\n                        y.fire(\n                          q.MainEvents.onAssociateMstWithUserID,\n                          a,\n                          b,\n                          c,\n                          d,\n                          e,\n                          h\n                        ),\n                          y.run();\n                      } catch (a) {\n                        r.Registry.getGenericEventHandler().sendEvent(\n                          m.logEvents.error,\n                          {\n                            msg: "associateMstWithUserID: Error",\n                            error: a.message + ":" + a.stack,\n                          }\n                        ),\n                          t.error("associateMstWithUserID: Error", a);\n                      }\n                      return f(m.callstatsAPIReturnStatus.success);\n                    },\n                  },\n                  {\n                    key: "reportError",\n                    value: function (a, b, c, d, e, h) {\n                      if ((b || (b = m.tmpConferenceId), void 0 === a || !c)) {\n                        var i = g(\n                          "reportError",\n                          p.csErrorStrings.argumentError\n                        );\n                        return (\n                          t.error(i), f(m.callstatsAPIReturnStatus.failure, i)\n                        );\n                      }\n                      if (!m.webRTCFunctions.hasOwnProperty(c)) {\n                        var j = g(\n                          "reportError",\n                          p.csErrorStrings.webRTCFunctionsInvalid,\n                          c\n                        );\n                        return (\n                          t.error(j), f(m.callstatsAPIReturnStatus.failure, j)\n                        );\n                      }\n                      if (\n                        (void 0 === d &&\n                          t.warn("reportError: Missing DOM error parameter"),\n                        !r.Registry.getCredentials().getAppId() ||\n                          !r.Registry.getCredentials().getUserId())\n                      ) {\n                        var k = g(\n                          "reportError",\n                          p.csErrorStrings.notInitialized\n                        );\n                        return (\n                          t.error(k), f(m.callstatsAPIReturnStatus.failure, k)\n                        );\n                      }\n                      try {\n                        y.fire(q.MainEvents.onReportError, a, b, c, d, e, h),\n                          y.run();\n                      } catch (a) {\n                        r.Registry.getGenericEventHandler().sendEvent(\n                          m.logEvents.error,\n                          {\n                            msg: "reportError: Error",\n                            error: a.message + ":" + a.stack,\n                          }\n                        ),\n                          t.error("reportError: Error", a);\n                      }\n                      return f(m.callstatsAPIReturnStatus.success);\n                    },\n                  },\n                  {\n                    key: "setProxyConfig",\n                    value: function (a) {\n                      if (window && !window.csioproxy) {\n                        var b = g(\n                          "setProxyConfig",\n                          p.csErrorStrings.setProxyConfigInvokeError\n                        );\n                        return (\n                          t.error(b), f(m.callstatsAPIReturnStatus.failure, b)\n                        );\n                      }\n                      if (!a) {\n                        var c = g(\n                          "setProxyConfig",\n                          p.csErrorStrings.argumentError\n                        );\n                        return (\n                          t.error(c), f(m.callstatsAPIReturnStatus.failure, c)\n                        );\n                      }\n                      try {\n                        y.fire(q.MainEvents.onSetProxyConfig, a), y.run();\n                      } catch (a) {\n                        r.Registry.getGenericEventHandler().sendEvent(\n                          m.logEvents.error,\n                          {\n                            msg: "setProxyConfig: Error",\n                            error: a.message + ":" + a.stack,\n                          }\n                        ),\n                          t.error("setProxyConfig: Error", a);\n                      }\n                      return f(m.callstatsAPIReturnStatus.success);\n                    },\n                  },\n                  {\n                    key: "attachWifiStatsHandler",\n                    value: function (a) {\n                      if (!a) {\n                        var b = g(\n                          "attachWifiStatsHandler",\n                          p.csErrorStrings.argumentError\n                        );\n                        return (\n                          t.error(b), f(m.callstatsAPIReturnStatus.failure, b)\n                        );\n                      }\n                      if ("function" != typeof a) {\n                        var c = g(\n                          "attachWifiStatsHandler",\n                          p.csErrorStrings.argumentError\n                        );\n                        return (\n                          t.error(c), f(m.callstatsAPIReturnStatus.failure, c)\n                        );\n                      }\n                      try {\n                        y.fire(q.MainEvents.onAttachWifiStatsHandler, a),\n                          y.run();\n                      } catch (a) {\n                        r.Registry.getGenericEventHandler().sendEvent(\n                          m.logEvents.error,\n                          {\n                            msg: "attachWifiStatsHandler: Error",\n                            error: a.message + ":" + a.stack,\n                          }\n                        ),\n                          t.error("attachWifiStatsHandler: Error", a);\n                      }\n                      return f(m.callstatsAPIReturnStatus.success);\n                    },\n                  },\n                  {\n                    key: "setIdentifiers",\n                    value: function (a, b) {\n                      if (!a) {\n                        var c = g(\n                          "setIdentifiers",\n                          p.csErrorStrings.argumentError\n                        );\n                        return (\n                          t.error(c), f(m.callstatsAPIReturnStatus.failure, c)\n                        );\n                      }\n                      try {\n                        y.fire(q.MainEvents.onSetIdentifiers, a, b), y.run();\n                      } catch (a) {\n                        r.Registry.getGenericEventHandler().sendEvent(\n                          m.logEvents.error,\n                          {\n                            msg: "setIdentifiers: Error",\n                            error: a.message + ":" + a.stack,\n                          }\n                        ),\n                          t.error("setIdentifiers: Error", a);\n                      }\n                      return f(m.callstatsAPIReturnStatus.success);\n                    },\n                  },\n                  {\n                    key: "makePrecallTest",\n                    value: function (a, b) {\n                      if (\n                        !r.Registry.getAuthenticator().getToken() ||\n                        !r.Registry.getCredentials().getAppId()\n                      ) {\n                        var c = g(\n                          "makePrecallTest",\n                          p.csErrorStrings.notInitialized\n                        );\n                        return (\n                          t.error(c), f(m.callstatsAPIReturnStatus.failure, c)\n                        );\n                      }\n                      if (!r.Registry.getAuthenticator().getIceServers()) {\n                        var d = g(\n                          "makePrecallTest",\n                          p.csErrorStrings.notInitialized\n                        );\n                        return (\n                          t.error(d), f(m.callstatsAPIReturnStatus.failure, d)\n                        );\n                      }\n                      if (!r.Registry.getCredentials().getCollectSDP()) {\n                        var e = g(\n                          "makePrecallTest",\n                          p.csErrorStrings.apiaccesserror\n                        );\n                        return (\n                          t.error(e), f(m.callstatsAPIReturnStatus.failure, e)\n                        );\n                      }\n                      try {\n                        y.fire(q.MainEvents.onMakePrecallTest, a, b), y.run();\n                      } catch (a) {\n                        r.Registry.getGenericEventHandler().sendEvent(\n                          m.logEvents.error,\n                          {\n                            msg: "on: Error",\n                            error: a.message + ":" + a.stack,\n                          }\n                        ),\n                          t.error("makePrecallTest: Error", a);\n                      }\n                      return f(m.callstatsAPIReturnStatus.success);\n                    },\n                  },\n                  {\n                    key: "on",\n                    value: function (a, b) {\n                      if (!b || "function" != typeof b) {\n                        var c = g("on", p.csErrorStrings.argumentError);\n                        return (\n                          t.error(c), f(m.callstatsAPIReturnStatus.failure, c)\n                        );\n                      }\n                      if (!a || !m.callbackFunctions.hasOwnProperty(a)) {\n                        var d = g("on", p.csErrorStrings.argumentError);\n                        return (\n                          t.error(d), f(m.callstatsAPIReturnStatus.failure, d)\n                        );\n                      }\n                      try {\n                        y.fire(q.MainEvents.onOn, a, b), y.run();\n                      } catch (a) {\n                        r.Registry.getGenericEventHandler().sendEvent(\n                          m.logEvents.error,\n                          {\n                            msg: "on: Error",\n                            error: a.message + ":" + a.stack,\n                          }\n                        ),\n                          t.error("on: Error", a);\n                      }\n                      return f(m.callstatsAPIReturnStatus.success);\n                    },\n                  },\n                  {\n                    key: "fabricUsage",\n                    get: function () {\n                      return this.constructor.fabricUsage;\n                    },\n                  },\n                  {\n                    key: "fabricEvent",\n                    get: function () {\n                      return this.constructor.fabricEvent;\n                    },\n                  },\n                  {\n                    key: "webRTCFunctions",\n                    get: function () {\n                      return this.constructor.webRTCFunctions;\n                    },\n                  },\n                  {\n                    key: "csError",\n                    get: function () {\n                      return this.constructor.csError;\n                    },\n                  },\n                  {\n                    key: "qualityRating",\n                    get: function () {\n                      return this.constructor.qualityRating;\n                    },\n                  },\n                  {\n                    key: "callStatsAPIReturnStatus",\n                    get: function () {\n                      return this.constructor.callStatsAPIReturnStatus;\n                    },\n                  },\n                  {\n                    key: "version",\n                    get: function () {\n                      return this.constructor.version;\n                    },\n                  },\n                  {\n                    key: "userIDType",\n                    get: function () {\n                      return this.constructor.userIDType;\n                    },\n                  },\n                  {\n                    key: "transmissionDirection",\n                    get: function () {\n                      return this.constructor.transmissionDirection;\n                    },\n                  },\n                  {\n                    key: "endpointType",\n                    get: function () {\n                      return this.constructor.endpointType;\n                    },\n                  },\n                ]),\n                a\n              );\n            })();\n          (z.fabricUsage = m.fabricUsage),\n            (z.fabricEvent = m.fabricEvent),\n            (z.webRTCFunctions = m.webRTCFunctions),\n            (z.csError = p.csError),\n            (z.qualityRating = m.qualityRating),\n            (z.callStatsAPIReturnStatus = m.callstatsAPIReturnStatus),\n            (z.version = o.version),\n            (z.userIDType = m.userIdType),\n            (z.endpointType = m.endpointType),\n            (z.transmissionDirection = m.transmissionDirection),\n            (function () {\n              function a() {\n                return new z();\n              }\n              "function" == typeof define && define.amd\n                ? define("callstats", [], a)\n                : (c.callstats = a),\n                (b.exports = a);\n            })("undefined" != typeof window && window);\n        }.call(\n          this,\n          "undefined" != typeof global\n            ? global\n            : "undefined" != typeof self\n            ? self\n            : "undefined" != typeof window\n            ? window\n            : {}\n        ));\n      },\n      {\n        "./config/callstatserrors": 32,\n        "./config/constants": 33,\n        "./config/settings": 34,\n        "./fsm/mainfsm": 35,\n        "./utility/csiologger": 88,\n        "./utility/onerroreventlistner": 94,\n        "./utility/registry": 95,\n        "./utility/utils": 101,\n      },\n    ],\n    23: [\n      function (a, b, c) {\n        "use strict";\n        function d(a) {\n          if (Array.isArray(a)) {\n            for (var b = 0, c = Array(a.length); b < a.length; b++) c[b] = a[b];\n            return c;\n          }\n          return Array.from(a);\n        }\n        function e(a, b) {\n          if (!(a instanceof b))\n            throw new TypeError("Cannot call a class as a function");\n        }\n        Object.defineProperty(c, "__esModule", {\n          value: !0,\n        }),\n          (c.BinaryTree = void 0);\n        var f = (function () {\n            function a(a, b) {\n              for (var c = 0; c < b.length; c++) {\n                var d = b[c];\n                (d.enumerable = d.enumerable || !1),\n                  (d.configurable = !0),\n                  "value" in d && (d.writable = !0),\n                  Object.defineProperty(a, d.key, d);\n              }\n            }\n            return function (b, c, d) {\n              return c && a(b.prototype, c), d && a(b, d), b;\n            };\n          })(),\n          g = a("./binarytreenode.js"),\n          h = a("../utility/csiologger"),\n          i = (function (a) {\n            if (a && a.__esModule) return a;\n            var b = {};\n            if (null != a)\n              for (var c in a)\n                Object.prototype.hasOwnProperty.call(a, c) && (b[c] = a[c]);\n            return (b.default = a), b;\n          })(h),\n          j = (function () {\n            function a(b) {\n              e(this, a),\n                (this.root = null),\n                (this.top = null),\n                (this.bottom = null),\n                (this.comparator = b),\n                (this.node_counter = 0),\n                (this.duplicate_counter = 0);\n            }\n            return (\n              f(a, [\n                {\n                  key: "getTopNode",\n                  value: function () {\n                    return this.top;\n                  },\n                },\n                {\n                  key: "getTopValue",\n                  value: function () {\n                    return null === this.top ? null : this.top.peek();\n                  },\n                },\n                {\n                  key: "getBottomValue",\n                  value: function () {\n                    return null === this.bottom ? null : this.bottom.peek();\n                  },\n                },\n                {\n                  key: "getBottomNode",\n                  value: function () {\n                    return this.bottom;\n                  },\n                },\n                {\n                  key: "getDuplicatedCounter",\n                  value: function () {\n                    return this.duplicate_counter;\n                  },\n                },\n                {\n                  key: "getNodeCounter",\n                  value: function () {\n                    return this.node_counter;\n                  },\n                },\n                {\n                  key: "getSize",\n                  value: function () {\n                    return this.duplicate_counter + this.node_counter;\n                  },\n                },\n                {\n                  key: "insertNodeAtTop",\n                  value: function (a) {\n                    a && this.inserting(a.getValues(), this.top);\n                  },\n                },\n                {\n                  key: "insertNodeAtBottom",\n                  value: function (a) {\n                    a && this.inserting(a.getValues(), this.bottom);\n                  },\n                },\n                {\n                  key: "insert",\n                  value: function (a) {\n                    this.inserting([a], this.root);\n                  },\n                },\n                {\n                  key: "createNode",\n                  value: function (a) {\n                    var b = new (Function.prototype.bind.apply(\n                      g.BinaryTreeNode,\n                      [null].concat(d(a))\n                    ))();\n                    return (\n                      null === this.top\n                        ? (this.top = b)\n                        : this.comparator(this.top.peek(), b.peek()) < 0 &&\n                          (this.top = b),\n                      null === this.bottom\n                        ? (this.bottom = b)\n                        : this.comparator(b.peek(), this.bottom.peek()) < 0 &&\n                          (this.bottom = b),\n                      b\n                    );\n                  },\n                },\n                {\n                  key: "inserting",\n                  value: function (a, b) {\n                    if (null === this.root)\n                      return (\n                        (this.root = this.createNode(a)),\n                        (this.node_counter = 1),\n                        void (this.duplicate_counter += a.length - 1)\n                      );\n                    for (var c = null, d = b, e = 0; null !== d; ) {\n                      if (0 === (e = this.comparator(a[0], d.peek())))\n                        return (\n                          d.concat(a),\n                          (this.duplicate_counter += a.length),\n                          void d.find(a[0])\n                        );\n                      (c = d), (d = e < 0 ? d.getLeft() : d.getRight());\n                    }\n                    ++this.node_counter,\n                      (this.duplicate_counter += a.length - 1),\n                      (d = this.createNode(a)),\n                      e < 0 ? c.setLeft(d) : c.setRight(d);\n                  },\n                },\n                {\n                  key: "getRightist",\n                  value: function (a) {\n                    for (var b = null; null !== a.right; )\n                      (b = a), (a = a.right);\n                    return [a, b];\n                  },\n                },\n                {\n                  key: "getLeftist",\n                  value: function (a) {\n                    for (var b = null; null !== a.getLeft(); )\n                      (b = a), (a = a.getLeft());\n                    return [a, b];\n                  },\n                },\n                {\n                  key: "popBottomNode",\n                  value: function () {\n                    if (null === this.bottom) return null;\n                    var a = this.search(this.bottom.peek()),\n                      b = a[0],\n                      c = a[1];\n                    return null === b\n                      ? null\n                      : (this.replaceNode(b, c, b.getRight()),\n                        this.disposeNode(b),\n                        --this.node_counter,\n                        (this.duplicate_counter -= b.getLength() - 1),\n                        b.setRight(null),\n                        b);\n                  },\n                },\n                {\n                  key: "popTopNode",\n                  value: function () {\n                    if (null === this.top) return null;\n                    var a = this.search(this.top.peek()),\n                      b = a[0],\n                      c = a[1];\n                    return null === b\n                      ? null\n                      : (this.replaceNode(b, c, b.getLeft()),\n                        this.disposeNode(b),\n                        --this.node_counter,\n                        (this.duplicate_counter -= b.getLength() - 1),\n                        b.setLeft(null),\n                        b);\n                  },\n                },\n                {\n                  key: "search",\n                  value: function (a) {\n                    for (\n                      var b = this.root, c = null, d = void 0;\n                      null !== b;\n\n                    ) {\n                      if (0 === (d = this.comparator(a, b.peek())))\n                        return b.find(a) ? [b, c] : [null, null];\n                      (c = b), (b = d < 0 ? b.getLeft() : b.getRight());\n                    }\n                    return [null, null];\n                  },\n                },\n                {\n                  key: "replaceNode",\n                  value: function (a, b, c) {\n                    null !== b\n                      ? b.left === a\n                        ? (b.left = c)\n                        : (b.right = c)\n                      : (this.root = c);\n                  },\n                },\n                {\n                  key: "disposeNode",\n                  value: function (a) {\n                    if (null !== a) {\n                      if (null === this.root)\n                        return void (this.bottom = this.top = null);\n                      if (0 === this.comparator(this.top.peek(), a.peek())) {\n                        var b = this.getRightist(this.root);\n                        this.top = b[0];\n                      }\n                      if (0 === this.comparator(this.bottom.peek(), a.peek())) {\n                        var c = this.getLeftist(this.root);\n                        this.bottom = c[0];\n                      }\n                    }\n                  },\n                },\n                {\n                  key: "delete",\n                  value: function (a) {\n                    var b = this.search(a),\n                      c = b[0],\n                      d = b[1];\n                    if (null === c) return !1;\n                    if (1 < c.getLength())\n                      return c.remove(a), --this.duplicate_counter, !0;\n                    if (\n                      (--this.node_counter,\n                      null === c.getLeft() && null === c.getRight())\n                    )\n                      this.replaceNode(c, d, null);\n                    else if (null === c.getLeft())\n                      this.replaceNode(c, d, c.getRight());\n                    else if (null === c.getRight())\n                      this.replaceNode(c, d, c.getLeft());\n                    else {\n                      for (\n                        var e = c.getLeft(), f = c;\n                        null !== e.getRight();\n                        f = e, e = e.getRight()\n                      );\n                      var g = e.getLeft();\n                      f === c ? f.setLeft(g) : f.setRight(g),\n                        c.setValues(e.getValues());\n                    }\n                    return this.disposeNode(c), !0;\n                  },\n                },\n                {\n                  key: "logging",\n                  value: function () {\n                    if (null === this.root)\n                      return void i.log(\n                        "This tree is empty Duplicate Counter: " +\n                          this.duplicate_counter\n                      );\n                    i.log(\n                      "Size of the tree: " +\n                        this.getSize() +\n                        " Node: " +\n                        this.getNodeCounter() +\n                        " Duplicates: " +\n                        this.getDuplicatedCounter() +\n                        " Top: " +\n                        this.getTopNode().toString() +\n                        " Bottom: " +\n                        this.getBottomNode().toString()\n                    ),\n                      (function a(b, c, d) {\n                        if (null !== b) {\n                          for (var e = "-", f = 0; f < c; ++f) e += "--";\n                          i.log(e + "> (" + d + ") [" + b.toString() + "]"),\n                            null !== b.getLeft() &&\n                              a(b.getLeft(), c + 1, "Left"),\n                            null !== b.getRight() &&\n                              a(b.getRight(), c + 1, "Right");\n                        }\n                      })(this.root, 0, "Root");\n                  },\n                },\n              ]),\n              a\n            );\n          })();\n        c.BinaryTree = j;\n      },\n      {\n        "../utility/csiologger": 88,\n        "./binarytreenode.js": 24,\n      },\n    ],\n    24: [\n      function (a, b, c) {\n        "use strict";\n        function d(a, b) {\n          if (!(a instanceof b))\n            throw new TypeError("Cannot call a class as a function");\n        }\n        Object.defineProperty(c, "__esModule", {\n          value: !0,\n        });\n        var e = (function () {\n            function a(a, b) {\n              for (var c = 0; c < b.length; c++) {\n                var d = b[c];\n                (d.enumerable = d.enumerable || !1),\n                  (d.configurable = !0),\n                  "value" in d && (d.writable = !0),\n                  Object.defineProperty(a, d.key, d);\n              }\n            }\n            return function (b, c, d) {\n              return c && a(b.prototype, c), d && a(b, d), b;\n            };\n          })(),\n          f = (function () {\n            function a() {\n              d(this, a);\n              for (var b = arguments.length, c = Array(b), e = 0; e < b; e++)\n                c[e] = arguments[e];\n              (this.values = c), (this.left = null), (this.right = null);\n            }\n            return (\n              e(a, [\n                {\n                  key: "getRight",\n                  value: function () {\n                    return this.right;\n                  },\n                },\n                {\n                  key: "setRight",\n                  value: function (a) {\n                    this.right = a;\n                  },\n                },\n                {\n                  key: "getLeft",\n                  value: function () {\n                    return this.left;\n                  },\n                },\n                {\n                  key: "setLeft",\n                  value: function (a) {\n                    this.left = a;\n                  },\n                },\n                {\n                  key: "push",\n                  value: function (a) {\n                    this.values.push(a);\n                  },\n                },\n                {\n                  key: "concat",\n                  value: function (a) {\n                    this.values = this.values.concat(a);\n                  },\n                },\n                {\n                  key: "pop",\n                  value: function () {\n                    return this.values.length < 1 ? null : this.values.shift();\n                  },\n                },\n                {\n                  key: "remove",\n                  value: function (a) {\n                    this.values.splice(this.values.indexOf(a), 1);\n                  },\n                },\n                {\n                  key: "setValues",\n                  value: function (a) {\n                    this.values = a;\n                  },\n                },\n                {\n                  key: "getValues",\n                  value: function () {\n                    return this.values;\n                  },\n                },\n                {\n                  key: "hasValue",\n                  value: function () {\n                    return 0 < this.values.length;\n                  },\n                },\n                {\n                  key: "getLength",\n                  value: function () {\n                    return this.values.length;\n                  },\n                },\n                {\n                  key: "peek",\n                  value: function () {\n                    return this.values.length < 1 ? null : this.values[0];\n                  },\n                },\n                {\n                  key: "find",\n                  value: function (a) {\n                    return this.values.find(function (b) {\n                      return b === a;\n                    });\n                  },\n                },\n                {\n                  key: "toString",\n                  value: function () {\n                    return this.values.toString();\n                  },\n                },\n              ]),\n              a\n            );\n          })();\n        c.BinaryTreeNode = f;\n      },\n      {},\n    ],\n    25: [\n      function (a, b, c) {\n        "use strict";\n        function d(a, b) {\n          if (!(a instanceof b))\n            throw new TypeError("Cannot call a class as a function");\n        }\n        Object.defineProperty(c, "__esModule", {\n          value: !0,\n        }),\n          (c.Cache = void 0);\n        var e = (function () {\n            function a(a, b) {\n              for (var c = 0; c < b.length; c++) {\n                var d = b[c];\n                (d.enumerable = d.enumerable || !1),\n                  (d.configurable = !0),\n                  "value" in d && (d.writable = !0),\n                  Object.defineProperty(a, d.key, d);\n              }\n            }\n            return function (b, c, d) {\n              return c && a(b.prototype, c), d && a(b, d), b;\n            };\n          })(),\n          f = a("../utility/csiologger"),\n          g = (function (a) {\n            if (a && a.__esModule) return a;\n            var b = {};\n            if (null != a)\n              for (var c in a)\n                Object.prototype.hasOwnProperty.call(a, c) && (b[c] = a[c]);\n            return (b.default = a), b;\n          })(f),\n          h = (function () {\n            function a() {\n              d(this, a), (this.queue = []), (this.priority = []);\n            }\n            return (\n              e(a, [\n                {\n                  key: "add",\n                  value: function (a) {\n                    var b =\n                      arguments.length > 1 &&\n                      void 0 !== arguments[1] &&\n                      arguments[1];\n                    if (this.length() > 1e6)\n                      return void g.error(\n                        "Maximum cached items reached, dropping."\n                      );\n                    b ? this.priority.push(a) : this.queue.push(a);\n                  },\n                },\n                {\n                  key: "pop",\n                  value: function () {\n                    return this.priority.length > 0\n                      ? this.priority.shift()\n                      : this.queue.shift();\n                  },\n                },\n                {\n                  key: "peak",\n                  value: function () {\n                    return this.priority.length > 0\n                      ? this.priority[0]\n                      : this.queue.length > 0\n                      ? this.queue[0]\n                      : null;\n                  },\n                },\n                {\n                  key: "length",\n                  value: function () {\n                    return this.queue.length + this.priority.length;\n                  },\n                },\n                {\n                  key: "updateConferenceId",\n                  value: function (a) {\n                    for (var b = 0; b < this.queue.length; ++b) {\n                      this.queue[b].updateConferenceId(a);\n                    }\n                    for (var c = 0; c < this.priority.length; ++c) {\n                      this.priority[c].updateConferenceId(a);\n                    }\n                  },\n                },\n              ]),\n              a\n            );\n          })();\n        c.Cache = h;\n      },\n      {\n        "../utility/csiologger": 88,\n      },\n    ],\n    26: [\n      function (a, b, c) {\n        "use strict";\n        function d(a, b) {\n          if (!(a instanceof b))\n            throw new TypeError("Cannot call a class as a function");\n        }\n        Object.defineProperty(c, "__esModule", {\n          value: !0,\n        }),\n          (c.Component = void 0);\n        var e = (function () {\n            function a(a, b) {\n              for (var c = 0; c < b.length; c++) {\n                var d = b[c];\n                (d.enumerable = d.enumerable || !1),\n                  (d.configurable = !0),\n                  "value" in d && (d.writable = !0),\n                  Object.defineProperty(a, d.key, d);\n              }\n            }\n            return function (b, c, d) {\n              return c && a(b.prototype, c), d && a(b, d), b;\n            };\n          })(),\n          f = a("./port"),\n          g = a("../utility/csiologger"),\n          h = (function (a) {\n            if (a && a.__esModule) return a;\n            var b = {};\n            if (null != a)\n              for (var c in a)\n                Object.prototype.hasOwnProperty.call(a, c) && (b[c] = a[c]);\n            return (b.default = a), b;\n          })(g),\n          i = (function () {\n            function a() {\n              var b =\n                arguments.length > 0 && void 0 !== arguments[0]\n                  ? arguments[0]\n                  : "Unknown";\n              d(this, a), (this.name = b), (this.ports = new Map());\n            }\n            return (\n              e(a, [\n                {\n                  key: "bindPort",\n                  value: function (a, b) {\n                    var c =\n                      arguments.length > 2 && void 0 !== arguments[2]\n                        ? arguments[2]\n                        : this;\n                    if (this.ports.has(a))\n                      return void h.warn(\n                        "Port (" + a + ") for " + this.name + " already exists."\n                      );\n                    this.ports.set(a, new f.Port(b, c));\n                  },\n                },\n                {\n                  key: "declarePort",\n                  value: function (a) {\n                    if (this.ports.has(a))\n                      return void h.warn(\n                        "Port (" + a + ") for " + this.name + " already exists."\n                      );\n                    this.ports.set(a, null);\n                  },\n                },\n                {\n                  key: "getPort",\n                  value: function (a) {\n                    return this.ports.get(a);\n                  },\n                },\n                {\n                  key: "isConnected",\n                  value: function (a) {\n                    return !!this.ports.has(a) && null !== this.ports.get(a);\n                  },\n                },\n                {\n                  key: "connect",\n                  value: function (a, b) {\n                    if (!this.ports.has(a))\n                      return void h.warn(\n                        "Port (" +\n                          a +\n                          ") for " +\n                          this.name +\n                          " does not exists."\n                      );\n                    this.ports.set(a, b);\n                  },\n                },\n                {\n                  key: "transmit",\n                  value: function (a) {\n                    var b = this.ports.get(a);\n                    if (void 0 === b)\n                      return void h.warn(\n                        "Port (" +\n                          a +\n                          ") for " +\n                          this.name +\n                          " does not exists."\n                      );\n                    if (null === b)\n                      return void h.warn(\n                        "Port (" +\n                          a +\n                          ") for " +\n                          this.name +\n                          " is not connected."\n                      );\n                    for (\n                      var c = arguments.length,\n                        d = Array(c > 1 ? c - 1 : 0),\n                        e = 1;\n                      e < c;\n                      e++\n                    )\n                      d[e - 1] = arguments[e];\n                    b.transmit(d);\n                  },\n                },\n                {\n                  key: "request",\n                  value: function (a) {\n                    var b = this.ports.get(a);\n                    if (void 0 === b)\n                      return (\n                        h.warn(\n                          "Port (" +\n                            a +\n                            ") for " +\n                            this.name +\n                            " does not exists."\n                        ),\n                        null\n                      );\n                    if (null === b)\n                      return (\n                        h.warn(\n                          "Port (" +\n                            a +\n                            ") for " +\n                            this.name +\n                            " is not connected."\n                        ),\n                        null\n                      );\n                    for (\n                      var c = arguments.length,\n                        d = Array(c > 1 ? c - 1 : 0),\n                        e = 1;\n                      e < c;\n                      e++\n                    )\n                      d[e - 1] = arguments[e];\n                    return b.request(d);\n                  },\n                },\n              ]),\n              a\n            );\n          })();\n        c.Component = i;\n      },\n      {\n        "../utility/csiologger": 88,\n        "./port": 27,\n      },\n    ],\n    27: [\n      function (a, b, c) {\n        "use strict";\n        function d(a, b) {\n          if (!(a instanceof b))\n            throw new TypeError("Cannot call a class as a function");\n        }\n        Object.defineProperty(c, "__esModule", {\n          value: !0,\n        });\n        var e = (function () {\n            function a(a, b) {\n              for (var c = 0; c < b.length; c++) {\n                var d = b[c];\n                (d.enumerable = d.enumerable || !1),\n                  (d.configurable = !0),\n                  "value" in d && (d.writable = !0),\n                  Object.defineProperty(a, d.key, d);\n              }\n            }\n            return function (b, c, d) {\n              return c && a(b.prototype, c), d && a(b, d), b;\n            };\n          })(),\n          f = (function () {\n            function a(b) {\n              var c =\n                arguments.length > 1 && void 0 !== arguments[1]\n                  ? arguments[1]\n                  : null;\n              d(this, a), (this.target = b), (this.object = c);\n            }\n            return (\n              e(a, [\n                {\n                  key: "transmit",\n                  value: function (a) {\n                    this.target.apply(this.object, a);\n                  },\n                },\n                {\n                  key: "request",\n                  value: function (a) {\n                    return this.target.apply(this.object, a);\n                  },\n                },\n              ]),\n              a\n            );\n          })();\n        c.Port = f;\n      },\n      {},\n    ],\n    28: [\n      function (a, b, c) {\n        "use strict";\n        function d(a, b) {\n          if (!(a instanceof b))\n            throw new TypeError("Cannot call a class as a function");\n        }\n        Object.defineProperty(c, "__esModule", {\n          value: !0,\n        }),\n          (c.SlidingWindow = void 0);\n        var e = (function () {\n            function a(a, b) {\n              for (var c = 0; c < b.length; c++) {\n                var d = b[c];\n                (d.enumerable = d.enumerable || !1),\n                  (d.configurable = !0),\n                  "value" in d && (d.writable = !0),\n                  Object.defineProperty(a, d.key, d);\n              }\n            }\n            return function (b, c, d) {\n              return c && a(b.prototype, c), d && a(b, d), b;\n            };\n          })(),\n          f = a("./switem"),\n          g = a("../utility/timestamps"),\n          h = (function (a) {\n            if (a && a.__esModule) return a;\n            var b = {};\n            if (null != a)\n              for (var c in a)\n                Object.prototype.hasOwnProperty.call(a, c) && (b[c] = a[c]);\n            return (b.default = a), b;\n          })(g),\n          i = (function () {\n            function a(b, c) {\n              d(this, a),\n                (this.items = []),\n                (this.plugins = []),\n                (this.postProcesses = []),\n                (this.preProcesses = []),\n                (this.timeoutInMs = c),\n                (this.maxItemsNum = b),\n                (this.minItemsNum = 0);\n            }\n            return (\n              e(a, [\n                {\n                  key: "setMaxItemsNum",\n                  value: function (a) {\n                    this.maxItemsNum = a;\n                  },\n                },\n                {\n                  key: "setTimeoutInMs",\n                  value: function (a) {\n                    this.timeoutInMs = a;\n                  },\n                },\n                {\n                  key: "setMinItemsNum",\n                  value: function (a) {\n                    this.minItemsNum = a;\n                  },\n                },\n                {\n                  key: "refresh",\n                  value: function () {\n                    var a = h.getCurrent();\n                    if (!(this.items.length <= this.minItemsNum)) {\n                      for (\n                        ;\n                        0 < this.maxItemsNum &&\n                        this.maxItemsNum <= this.items.length;\n\n                      )\n                        this.remove();\n                      this.timeoutInMs &&\n                        this.timeoutInMs < a - this.items[0].getCreated() &&\n                        (this.remove(), this.refresh());\n                    }\n                  },\n                },\n                {\n                  key: "getLength",\n                  value: function () {\n                    return this.items.length;\n                  },\n                },\n                {\n                  key: "add",\n                  value: function (a) {\n                    this.refresh(), this.items.push(new f.SWItem(a));\n                    for (var b = 0; b < this.preProcesses.length; b++) {\n                      (0, this.preProcesses[b])(a);\n                    }\n                    for (var c = 0; c < this.plugins.length; c++) {\n                      this.plugins[c].add(a);\n                    }\n                    for (var d = 0; d < this.postProcesses.length; d++) {\n                      (0, this.postProcesses[d])(a);\n                    }\n                  },\n                },\n                {\n                  key: "remove",\n                  value: function () {\n                    for (\n                      var a = this.items.shift(), b = 0;\n                      b < this.plugins.length;\n                      b++\n                    ) {\n                      this.plugins[b].remove(a.value);\n                    }\n                  },\n                },\n                {\n                  key: "peek",\n                  value: function () {\n                    var a =\n                      arguments.length > 0 && void 0 !== arguments[0]\n                        ? arguments[0]\n                        : 0;\n                    return this.items.length <= a\n                      ? null\n                      : this.items[this.items.length - a - 1].getValue();\n                  },\n                },\n                {\n                  key: "attach",\n                  value: function (a) {\n                    this.plugins.push(a);\n                  },\n                },\n                {\n                  key: "addPreProcess",\n                  value: function (a) {\n                    this.preProcesses.push(a);\n                  },\n                },\n                {\n                  key: "addPostProcess",\n                  value: function (a) {\n                    this.postProcesses.push(a);\n                  },\n                },\n                {\n                  key: "detach",\n                  value: function (a) {\n                    this.plugins = this.plugins.filter(function (b) {\n                      return b !== a;\n                    });\n                  },\n                },\n              ]),\n              a\n            );\n          })();\n        c.SlidingWindow = i;\n      },\n      {\n        "../utility/timestamps": 99,\n        "./switem": 29,\n      },\n    ],\n    29: [\n      function (a, b, c) {\n        "use strict";\n        function d(a, b) {\n          if (!(a instanceof b))\n            throw new TypeError("Cannot call a class as a function");\n        }\n        Object.defineProperty(c, "__esModule", {\n          value: !0,\n        }),\n          (c.SWItem = void 0);\n        var e = (function () {\n            function a(a, b) {\n              for (var c = 0; c < b.length; c++) {\n                var d = b[c];\n                (d.enumerable = d.enumerable || !1),\n                  (d.configurable = !0),\n                  "value" in d && (d.writable = !0),\n                  Object.defineProperty(a, d.key, d);\n              }\n            }\n            return function (b, c, d) {\n              return c && a(b.prototype, c), d && a(b, d), b;\n            };\n          })(),\n          f = a("../utility/timestamps"),\n          g = (function (a) {\n            if (a && a.__esModule) return a;\n            var b = {};\n            if (null != a)\n              for (var c in a)\n                Object.prototype.hasOwnProperty.call(a, c) && (b[c] = a[c]);\n            return (b.default = a), b;\n          })(f),\n          h = (function () {\n            function a(b) {\n              d(this, a), (this.value = b), (this.created = g.getCurrent());\n            }\n            return (\n              e(a, [\n                {\n                  key: "getValue",\n                  value: function () {\n                    return this.value;\n                  },\n                },\n                {\n                  key: "getCreated",\n                  value: function () {\n                    return this.created;\n                  },\n                },\n                {\n                  key: "toString",\n                  value: function () {\n                    return "";\n                  },\n                },\n              ]),\n              a\n            );\n          })();\n        c.SWItem = h;\n      },\n      {\n        "../utility/timestamps": 99,\n      },\n    ],\n    30: [\n      function (a, b, c) {\n        "use strict";\n        function d(a) {\n          if (a && a.__esModule) return a;\n          var b = {};\n          if (null != a)\n            for (var c in a)\n              Object.prototype.hasOwnProperty.call(a, c) && (b[c] = a[c]);\n          return (b.default = a), b;\n        }\n        function e(a, b) {\n          if (!(a instanceof b))\n            throw new TypeError("Cannot call a class as a function");\n        }\n        Object.defineProperty(c, "__esModule", {\n          value: !0,\n        }),\n          (c.Conference = void 0);\n        var f = (function () {\n            function a(a, b) {\n              for (var c = 0; c < b.length; c++) {\n                var d = b[c];\n                (d.enumerable = d.enumerable || !1),\n                  (d.configurable = !0),\n                  "value" in d && (d.writable = !0),\n                  Object.defineProperty(a, d.key, d);\n              }\n            }\n            return function (b, c, d) {\n              return c && a(b.prototype, c), d && a(b, d), b;\n            };\n          })(),\n          g = a("../peerconnection/peerconnectionmanager"),\n          h = a("../config/settings"),\n          i = d(h),\n          j = a("../utility/registry"),\n          k = a("../browserapi/sessionstorage"),\n          l = d(k),\n          m = (function () {\n            function a(b, c) {\n              e(this, a),\n                (this.conferenceId = b),\n                this.startTime,\n                (this.peerConnectionManager = new g.PeerConnectionManager()),\n                (this.credentials = c),\n                (this.ucId = null),\n                (this.url = null),\n                (this.userJoinedSent = !1);\n            }\n            return (\n              f(a, [\n                {\n                  key: "getCredentials",\n                  value: function () {\n                    return this.credentials;\n                  },\n                },\n                {\n                  key: "getUcId",\n                  value: function () {\n                    return this.ucId;\n                  },\n                },\n                {\n                  key: "setUcId",\n                  value: function (a) {\n                    (this.ucId = a),\n                      (this.url =\n                        i.conferenceBaseUrl +\n                        j.Registry.getCredentials().getAppId() +\n                        "/conferences/" +\n                        encodeURIComponent(this.conferenceId) +\n                        "/" +\n                        a +\n                        "/general"),\n                      l.storeUcId(this.conferenceId, a);\n                  },\n                },\n                {\n                  key: "getPeerConnectionManager",\n                  value: function () {\n                    return this.peerConnectionManager;\n                  },\n                },\n                {\n                  key: "getUrl",\n                  value: function () {\n                    return this.url;\n                  },\n                },\n                {\n                  key: "updateConferenceId",\n                  value: function (a) {\n                    (this.conferenceId = a),\n                      this.peerConnectionManager.updateConferenceId(a);\n                  },\n                },\n                {\n                  key: "close",\n                  value: function (a) {},\n                },\n              ]),\n              a\n            );\n          })();\n        c.Conference = m;\n      },\n      {\n        "../browserapi/sessionstorage": 21,\n        "../config/settings": 34,\n        "../peerconnection/peerconnectionmanager": 42,\n        "../utility/registry": 95,\n      },\n    ],\n    31: [\n      function (a, b, c) {\n        "use strict";\n        function d(a, b) {\n          if (!(a instanceof b))\n            throw new TypeError("Cannot call a class as a function");\n        }\n        Object.defineProperty(c, "__esModule", {\n          value: !0,\n        }),\n          (c.ConferenceManager = void 0);\n        var e = (function () {\n            function a(a, b) {\n              for (var c = 0; c < b.length; c++) {\n                var d = b[c];\n                (d.enumerable = d.enumerable || !1),\n                  (d.configurable = !0),\n                  "value" in d && (d.writable = !0),\n                  Object.defineProperty(a, d.key, d);\n              }\n            }\n            return function (b, c, d) {\n              return c && a(b.prototype, c), d && a(b, d), b;\n            };\n          })(),\n          f = a("./conference"),\n          g = a("../config/constants"),\n          h = (function (a) {\n            if (a && a.__esModule) return a;\n            var b = {};\n            if (null != a)\n              for (var c in a)\n                Object.prototype.hasOwnProperty.call(a, c) && (b[c] = a[c]);\n            return (b.default = a), b;\n          })(g),\n          i = (function () {\n            function a() {\n              d(this, a), (this.conferenceMap = new Map());\n            }\n            return (\n              e(a, [\n                {\n                  key: "add",\n                  value: function (a, b) {\n                    if (!this.get(a)) {\n                      var c = new f.Conference(a, b);\n                      this.conferenceMap.set(a, c);\n                    }\n                  },\n                },\n                {\n                  key: "get",\n                  value: function (a) {\n                    return this.conferenceMap.get(a);\n                  },\n                },\n                {\n                  key: "getConferenceForPc",\n                  value: function (a) {\n                    var b = null;\n                    return a\n                      ? (this.conferenceMap.forEach(function (c, d) {\n                          var e = c.getPeerConnectionManager().getPcHandler(a);\n                          e && e.getConferenceId() === d && (b = c);\n                        }),\n                        b)\n                      : b;\n                  },\n                },\n                {\n                  key: "getConferenceForPcHash",\n                  value: function (a) {\n                    var b = null;\n                    return a\n                      ? (this.conferenceMap.forEach(function (c, d) {\n                          var e = c\n                            .getPeerConnectionManager()\n                            .getPcHandlerByHash(a);\n                          e && e.getConferenceId() === d && (b = c);\n                        }),\n                        b)\n                      : b;\n                  },\n                },\n                {\n                  key: "updateConferenceId",\n                  value: function (a) {\n                    var b = h.tmpConferenceId,\n                      c = this.get(b);\n                    c &&\n                      (c.updateConferenceId(a),\n                      this.conferenceMap.set(a, c),\n                      this.conferenceMap.delete(b));\n                  },\n                },\n                {\n                  key: "getConferenceIds",\n                  value: function () {\n                    var a = [];\n                    return (\n                      this.conferenceMap.forEach(function (b, c) {\n                        a.push(c);\n                      }),\n                      a\n                    );\n                  },\n                },\n              ]),\n              a\n            );\n          })();\n        c.ConferenceManager = i;\n      },\n      {\n        "../config/constants": 33,\n        "./conference": 30,\n      },\n    ],\n    32: [\n      function (a, b, c) {\n        "use strict";\n        Object.defineProperty(c, "__esModule", {\n          value: !0,\n        });\n        (c.csError = {\n          httpError: "httpError",\n          authError: "authError",\n          wsChannelFailure: "wsChannelFailure",\n          success: "success",\n          csProtoError: "csProtoError",\n          appConnectivityError: "appConnectivityError",\n          tokenGenerationError: "tokenGenerationError",\n          ok: "OK",\n          authOngoing: "authOngoing",\n          invalidWebRTCFunctionName: "Invalid WebRTC function name",\n          invalidEndPointType: "Invalid EndPoint Type",\n          invalidTransmissionDirection: "Invalid fabric transmission direction",\n        }),\n          (c.csErrorStrings = {\n            argumentError: "Argument missing/invalid",\n            cryptoError:\n              "Browser does not support Web Cryptography API. App secret based authentication requires Web Cryptography API",\n            fabricEventUnsupported: "Unsupported fabricEvent",\n            fabricEventInvalid: "Invalid fabricEvents value",\n            fabricUsageInvalid: "Invalid fabricUsage value",\n            notInitialized: "SDK is not initialized or no Fabrics added",\n            pcInvalid: "Invalid PeerConnection object passed",\n            confereneDoesNotExist: "conferenceId does not exist",\n            webRTCFunctionsInvalid: "Invalid webRTC functionName value",\n            setProxyConfigInvokeError:\n              "cannot be called if window.csioproxy is false",\n            invalidWebRTCFunctionName: "Invalid WebRTC function name",\n            invalidEndPointType: "Invalid EndPoint Type",\n            invalidTransmissionDirection:\n              "Invalid fabric transmission direction",\n            apiaccesserror: "API access Error",\n          }),\n          (c.csErrorReason = {\n            csProtoError: "Protocol fields cannot be empty.",\n            csNoAuthState: "Authentication state unavailable in server.",\n          }),\n          (c.internalErrors = {\n            authOngoing: "authOngoing",\n          }),\n          (c.authErrorActions = {\n            RETRY: 0,\n            GET_NEW_TOKEN: 1,\n            REPORT_ERROR: 2,\n          });\n      },\n      {},\n    ],\n    33: [\n      function (a, b, c) {\n        "use strict";\n        Object.defineProperty(c, "__esModule", {\n          value: !0,\n        });\n        (c.logEvents = {\n          stateMachine: "stateMachine",\n          log: "log",\n          timing: "timing",\n          error: "error",\n          getStatsError: "getStatsError",\n          restResponseError: "restResponseError",\n        }),\n          (c.fabricEvent = {\n            fabricSetupFailed: "fabricSetupFailed",\n            fabricHold: "fabricHold",\n            fabricResume: "fabricResume",\n            audioMute: "audioMute",\n            audioUnmute: "audioUnmute",\n            videoPause: "videoPause",\n            videoResume: "videoResume",\n            fabricUsageEvent: "fabricUsageEvent",\n            fabricTerminated: "fabricTerminated",\n            screenShareStart: "screenShareStart",\n            screenShareStop: "screenShareStop",\n            dominantSpeaker: "dominantSpeaker",\n            activeDeviceList: "activeDeviceList",\n            applicationErrorLog: "applicationErrorLog",\n          }),\n          (c.internalFabricEvent = {\n            fabricSetup: "fabricSetup",\n            fabricSetupFailed: "fabricSetupFailed",\n            userJoined: "userJoined",\n            userLeft: "userLeft",\n            userAlive: "userAlive",\n            ssrcMap: "ssrcMap",\n            mediaPlaybackStart: "mediaPlaybackStart",\n            mediaPlaybackSuspended: "mediaPlaybackSuspended",\n            mediaPlaybackStalled: "mediaPlaybackStalled",\n            oneWayMedia: "oneWayMedia",\n            fabricStateChange: "fabricStateChange",\n            iceDisruptionStart: "iceDisruptionStart",\n            iceDisruptionEnd: "iceDisruptionEnd",\n            fabricTransportSwitch: "fabricTransportSwitch",\n            iceConnectionDisruptionStart: "iceConnectionDisruptionStart",\n            iceConnectionDisruptionEnd: "iceConnectionDisruptionEnd",\n            iceAborted: "iceAborted",\n            iceTerminated: "iceTerminated",\n            iceFailed: "iceFailed",\n            iceRestarted: "iceRestarted",\n            fabricDropped: "fabricDropped",\n            connectedDeviceList: "connectedDeviceList",\n            sdpSubmission: "sdpSubmissionEvent",\n            sendingThroughputObservations: "sendingThroughputObservations",\n            limitationObservations: "limitationObservations",\n            userDetails: "userDetails",\n          }),\n          (c.callstatsChannels = {\n            sdpSubmission: "sdpSubmissionEvent",\n            processedStats: "processedStats",\n            callstatsEvent: "callStatsEvent",\n            userFeedback: "userFeedbackEvent",\n            preCallTest: "preCallTest",\n            senderConfiguration: "senderConfiguration",\n          }),\n          (c.precalltestEvents = {\n            results: "preCallTestResults",\n            associate: "preCallTestAssociate",\n          }),\n          (c.callstatsAPIReturnStatus = {\n            success: "success",\n            failure: "failure",\n          }),\n          (c.fabricUsage = {\n            audio: "audio",\n            video: "video",\n            data: "data",\n            screen: "screen",\n            multiplex: "multiplex",\n            unbundled: "unbundled",\n          }),\n          (c.userIdType = {\n            local: "local",\n            remote: "remote",\n          }),\n          (c.qualityRating = {\n            excellent: 5,\n            good: 4,\n            fair: 3,\n            poor: 2,\n            bad: 1,\n          }),\n          (c.reportType = {\n            local: "local",\n            remote: "remote",\n            inbound: "inbound",\n            outbound: "outbound",\n          }),\n          (c.avQualityRatings = {\n            excellent: "excellent",\n            fair: "fair",\n            bad: "bad",\n            unknown: "unknown",\n          }),\n          (c.fabricState = {\n            established: "established",\n            initializing: "initializing",\n            failed: "failed",\n            disrupted: "disrupted",\n            hold: "hold",\n            checkingDisrupted: "checkingDisrupted",\n            terminated: "terminated",\n          }),\n          (c.webRTCFunctions = {\n            createOffer: "createOffer",\n            createAnswer: "createAnswer",\n            setLocalDescription: "setLocalDescription",\n            setRemoteDescription: "setRemoteDescription",\n            addIceCandidate: "addIceCandidate",\n            getUserMedia: "getUserMedia",\n            iceConnectionFailure: "iceConnectionFailure",\n            signalingError: "signalingError",\n            applicationError: "applicationError",\n            applicationLog: "applicationLog",\n          }),\n          (c.callFailureReasons = {\n            mediaConfigError: "MediaConfigError",\n            negotiationFailure: "NegotiationFailure",\n            sdpError: "SDPGenerationError",\n            iceFailure: "IceConnectionFailure",\n            transportFailure: "TransportFailure",\n            signalingError: "SignalingError",\n            applicationError: "ApplicationError",\n            applicationLog: "ApplicationLog",\n            invalidWebRTCFunctionName: "Invalid WebRTC function name",\n          }),\n          (c.throughputThreshold = {\n            video: {\n              green: 1024,\n              red: 256,\n            },\n            audio: {\n              green: 30,\n              red: 8,\n            },\n          }),\n          (c.currOverPrevFrameRateThreshold = {\n            video: {\n              green: 0.8,\n              red: 0.3,\n            },\n          }),\n          (c.rttThreshold = {\n            video: {\n              green: 400,\n              red: 1e3,\n            },\n          }),\n          (c.fractionalLossThreshold = {\n            video: {\n              green: 0.1,\n              red: 0.5,\n            },\n            audio: {\n              green: 0.15,\n              red: 0.3,\n            },\n          }),\n          (c.eModelThreshold = {\n            audio: {\n              green: 240,\n              red: 400,\n            },\n          }),\n          (c.codeBaseType = {\n            chrome: "Chrome",\n            firefox: "Firefox",\n            edge: "Edge",\n            plugin: "Plugin",\n          }),\n          (c.browserName = {\n            chrome: "Chrome",\n            firefox: "Firefox",\n            edge: "Edge",\n            msie: "Microsoft Internet Explorer",\n            safari: "Safari",\n            opera: "Opera",\n          }),\n          (c.osName = {\n            windows: "Windows",\n            mac: "Mac OS X",\n            android: "Android",\n            ios: "iOS",\n          }),\n          (c.mediaType = {\n            audio: "audio",\n            video: "video",\n          }),\n          (c.streamType = {\n            inbound: "inbound",\n            outbound: "outbound",\n          }),\n          (c.fabricStateChangeType = {\n            signalingState: "signalingState",\n            iceConnectionState: "iceConnectionState",\n            iceGatheringState: "iceGatheringState",\n          }),\n          (c.transportType = {\n            rest: "rest",\n            ws: "ws",\n          }),\n          (c.wsConnectionState = {\n            initiated: "initiated",\n            connected: "connected",\n            closed: "closed",\n          }),\n          (c.csCallBackMessages = {\n            authSuccessful: "SDK authentication successful.",\n            authFailed: "SDK authentication failed.",\n            authProtocolInvalid:\n              "Fatal authentication error. Invalid auth protocol message.",\n            authOngoing: "Authentication on going.",\n            wsConnected: "WebSocket establishment successful.",\n            wsClosed: "WebSocket server closed.",\n            wsFailed: "WebSocket establishment failed.",\n          }),\n          (c.oneWayMediaTypes = {\n            audio: "audio",\n            video: "video",\n            screen: "screen",\n          }),\n          (c.limitationType = {\n            cpu: "cpu",\n            network: "network",\n          }),\n          (c.qualityDisruptionTypes = {\n            qpchange: "qpchange",\n          }),\n          (c.callbackFunctions = {\n            stats: "stats",\n            defaultConfig: "defaultConfig",\n            recommendedConfig: "recommendedConfig",\n            preCallTestResults: "preCallTestResults",\n            preCallTest: "preCallTest",\n          }),\n          (c.endpointType = {\n            peer: "peer",\n            server: "server",\n          }),\n          (c.transmissionDirection = {\n            sendonly: "sendonly",\n            receiveonly: "receiveonly",\n            sendrecv: "sendrecv",\n            inactive: "inactive",\n          }),\n          (c.tmpConferenceId = "csio-conf-id-tmp");\n      },\n      {},\n    ],\n    34: [\n      function (a, b, c) {\n        "use strict";\n        function d(a) {\n          c.configServiceUrl = m = a;\n        }\n        function e(a) {\n          c.authServiceUrl = n = a;\n        }\n        function f(a) {\n          c.conferenceBaseUrl = o = a;\n        }\n        function g(a) {\n          c.wsUrl = p = a;\n        }\n        function h(a) {\n          c.restEventUrl = q = a;\n        }\n        function i(a) {\n          c.restStatsUrl = r = a;\n        }\n        function j(a) {\n          c.baseUrl = s = a;\n        }\n        function k(a) {\n          c.qmodelThresholdsAPIUrl = t = a;\n        }\n        function l(a) {\n          c.transportType = u = a;\n        }\n        Object.defineProperty(c, "__esModule", {\n          value: !0,\n        }),\n          (c.setConfigServiceUrl = d),\n          (c.setAuthServiceUrl = e),\n          (c.setConferenceBaseUrl = f),\n          (c.setWsUrl = g),\n          (c.setRestEventUrl = h),\n          (c.setRestStatsUrl = i),\n          (c.setBaseUrl = j),\n          (c.setQmodelThresholdsAPIUrl = k),\n          (c.setTransportType = l);\n        var m =\n            ((c.version = "3.53.1"),\n            (c.configServiceUrl = "https://appsettings.callstats.io/v1/apps/")),\n          n = (c.authServiceUrl = "https://auth.callstats.io/"),\n          o =\n            ((c.authRetryTimeout = 5e3),\n            (c.conferenceBaseUrl = "https://dashboard.callstats.io/apps/")),\n          p = (c.wsUrl =\n            "wss://collector.callstats.io:443/csiows/collectCallStats"),\n          q = (c.restEventUrl = "https://events.callstats.io/v1/apps/"),\n          r = (c.restStatsUrl = "https://stats.callstats.io/v1/apps/"),\n          s = (c.baseUrl = "https://collector.callstats.io:443/"),\n          t = (c.qmodelThresholdsAPIUrl =\n            "https://dashboard.callstats.io/api-internal/v1/qmodelthresholds"),\n          u = ((c.csioDebug = "false"), (c.transportType = "@@transportType"));\n      },\n      {},\n    ],\n    35: [\n      function (a, b, c) {\n        "use strict";\n        function d(a) {\n          if (a && a.__esModule) return a;\n          var b = {};\n          if (null != a)\n            for (var c in a)\n              Object.prototype.hasOwnProperty.call(a, c) && (b[c] = a[c]);\n          return (b.default = a), b;\n        }\n        function e(a) {\n          if (Array.isArray(a)) {\n            for (var b = 0, c = Array(a.length); b < a.length; b++) c[b] = a[b];\n            return c;\n          }\n          return Array.from(a);\n        }\n        function f(a, b) {\n          if (!(a instanceof b))\n            throw new TypeError("Cannot call a class as a function");\n        }\n        function g(a, b) {\n          if (!a)\n            throw new ReferenceError(\n              "this hasn\'t been initialised - super() hasn\'t been called"\n            );\n          return !b || ("object" != typeof b && "function" != typeof b) ? a : b;\n        }\n        function h(a, b) {\n          if ("function" != typeof b && null !== b)\n            throw new TypeError(\n              "Super expression must either be null or a function, not " +\n                typeof b\n            );\n          (a.prototype = Object.create(b && b.prototype, {\n            constructor: {\n              value: a,\n              enumerable: !1,\n              writable: !0,\n              configurable: !0,\n            },\n          })),\n            b &&\n              (Object.setPrototypeOf\n                ? Object.setPrototypeOf(a, b)\n                : (a.__proto__ = b));\n        }\n        function i() {\n          Array.prototype.find ||\n            Object.defineProperty(Array.prototype, "find", {\n              value: function (a) {\n                if (null === this)\n                  throw new TypeError(\n                    "Array.prototype.find called on null or undefined"\n                  );\n                if ("function" != typeof a)\n                  throw new TypeError("predicate must be a function");\n                for (\n                  var b = Object(this),\n                    c = b.length >>> 0,\n                    d = arguments[1],\n                    e = void 0,\n                    f = 0;\n                  f < c;\n                  f++\n                )\n                  if (((e = b[f]), a.call(d, e, f, b))) return e;\n              },\n            });\n        }\n        Object.defineProperty(c, "__esModule", {\n          value: !0,\n        }),\n          (c.MainFSM = c.MainEvents = void 0);\n        var j =\n            "function" == typeof Symbol && "symbol" == typeof Symbol.iterator\n              ? function (a) {\n                  return typeof a;\n                }\n              : function (a) {\n                  return a &&\n                    "function" == typeof Symbol &&\n                    a.constructor === Symbol &&\n                    a !== Symbol.prototype\n                    ? "symbol"\n                    : typeof a;\n                },\n          k = (function () {\n            function a(a, b) {\n              for (var c = 0; c < b.length; c++) {\n                var d = b[c];\n                (d.enumerable = d.enumerable || !1),\n                  (d.configurable = !0),\n                  "value" in d && (d.writable = !0),\n                  Object.defineProperty(a, d.key, d);\n              }\n            }\n            return function (b, c, d) {\n              return c && a(b.prototype, c), d && a(b, d), b;\n            };\n          })(),\n          l = a("./statemachine"),\n          m = a("../utility/registry"),\n          n = a("../utility/csiologger"),\n          o = d(n),\n          p = a("../utility/utils"),\n          q = d(p),\n          r = a("../utility/timestamps"),\n          s = d(r),\n          t = a("../config/constants"),\n          u = d(t),\n          v = a("../config/settings"),\n          w = d(v),\n          x = a("./utility"),\n          y = d(x),\n          z = a("../statspipeline/statsadapter"),\n          A = a("../statspipeline/statsparser"),\n          B = a("../statspipeline/statsmonitor"),\n          C = a("../statspipeline/statstransmitter"),\n          D = a("../statspipeline/statsassembler"),\n          E = {\n            Created: "Created",\n            Initializing: "Initializing",\n            Idle: "Idle",\n            Run: "Run",\n          },\n          F = (c.MainEvents = {\n            onStart: "onStart",\n            onInitialize: "onInitialize",\n            onAddNewFabric: "onAddNewFabric",\n            onSendFabricEvent: "onSendFabricEvent",\n            onReportError: "onReportError",\n            onAssociateMstWithUserID: "onAssociateMstWithUserID",\n            onSetProxyConfig: "onSetProxyConfig",\n            onAttachWifiStatsHandler: "onAttachWifiStatsHandler",\n            onSendUserFeedback: "onSendUserFeedback",\n            onOn: "onOn",\n            onSetIdentifiers: "onSetIdentifiers",\n            onMakePrecallTest: "onMakePrecallTest",\n          }),\n          G = {\n            onServicesFinished: "onServicesFinished",\n          },\n          H = (function (a) {\n            function b() {\n              f(this, b);\n              var a = g(\n                this,\n                (b.__proto__ || Object.getPrototypeOf(b)).call(this, E.Created)\n              );\n              return (\n                o.log("FSM:", a.getState()), a.fire(F.onStart), a.run(), i(), a\n              );\n            }\n            return (\n              h(b, a),\n              k(b, [\n                {\n                  key: "proceed",\n                  value: function (a, b) {\n                    switch (this.getState()) {\n                      case E.Created:\n                        switch (a) {\n                          case F.onStart:\n                            this.onStart.apply(this, e(b));\n                            break;\n\n                          case F.onInitialize:\n                            this.setState(E.Initializing),\n                              o.log("FSM:", this.getState()),\n                              this.onInitialize.apply(this, e(b));\n                            break;\n\n                          case F.onOn:\n                            this.onOn.apply(this, e(b));\n                            break;\n\n                          case F.onSetProxyConfig:\n                            this.onSetProxyConfig.apply(this, e(b));\n                        }\n                        break;\n\n                      case E.Initializing:\n                        switch (a) {\n                          case G.onServicesFinished:\n                            this.onServicesFinished() &&\n                              (this.setState(E.Idle),\n                              o.log("FSM:", this.getState()));\n                            break;\n\n                          case F.onAddNewFabric:\n                            this.onAddNewFabric.apply(this, e(b));\n                            break;\n\n                          case F.onSendFabricEvent:\n                            this.onSendFabricEvent.apply(this, e(b));\n                            break;\n\n                          case F.onReportError:\n                            this.onReportError.apply(this, e(b));\n                            break;\n\n                          case F.onAssociateMstWithUserID:\n                            this.onAssociateMstWithUserID.apply(this, e(b));\n                            break;\n\n                          case F.onSendUserFeedback:\n                            this.onSendUserFeedback.apply(this, e(b));\n                            break;\n\n                          case F.onAttachWifiStatsHandler:\n                            this.onAttachWifiStatsHandler.apply(this, e(b));\n                            break;\n\n                          case F.onOn:\n                            this.onOn.apply(this, e(b));\n                            break;\n\n                          case F.onMakePrecallTest:\n                            this.onMakePrecallTest.apply(this, e(b));\n                            break;\n\n                          case F.onSetIdentifiers:\n                            this.onSetIdentifiers.apply(this, e(b));\n                            break;\n\n                          case F.onSetProxyConfig:\n                            this.onSetProxyConfig.apply(this, e(b));\n                        }\n                        break;\n\n                      case E.Idle:\n                      case E.Run:\n                        switch (a) {\n                          case F.onAddNewFabric:\n                            this.onAddNewFabric.apply(this, e(b));\n                            break;\n\n                          case F.onSendFabricEvent:\n                            this.onSendFabricEvent.apply(this, e(b));\n                            break;\n\n                          case F.onReportError:\n                            this.onReportError.apply(this, e(b));\n                            break;\n\n                          case F.onAssociateMstWithUserID:\n                            this.onAssociateMstWithUserID.apply(this, e(b));\n                            break;\n\n                          case F.onSendUserFeedback:\n                            this.onSendUserFeedback.apply(this, e(b));\n                            break;\n\n                          case F.onAttachWifiStatsHandler:\n                            this.onAttachWifiStatsHandler.apply(this, e(b));\n                            break;\n\n                          case F.onOn:\n                            this.onOn.apply(this, e(b));\n                            break;\n\n                          case F.onSetProxyConfig:\n                            this.onSetProxyConfig.apply(this, e(b));\n                            break;\n\n                          case F.onMakePrecallTest:\n                            this.onMakePrecallTest.apply(this, e(b));\n                            break;\n\n                          case F.onSetIdentifiers:\n                            this.onSetIdentifiers.apply(this, e(b));\n                        }\n                    }\n                  },\n                },\n                {\n                  key: "onStart",\n                  value: function () {\n                    m.Registry.getEndpoint().setup(),\n                      (this.authenticator = m.Registry.getAuthenticator()),\n                      (this.configservicewrapper = m.Registry.getConfigServiceWrapper()),\n                      (this.precalltest = m.Registry.getPreCallTest()),\n                      (this.precalltestIds = []);\n                    var a = m.Registry.getStatsAdapter(),\n                      b = m.Registry.getStatsParser(),\n                      c = m.Registry.getStatsMonitor(),\n                      d = m.Registry.getStatsTransmitter(),\n                      e = m.Registry.getStatsAssembler();\n                    a.connect(\n                      z.StatsAdapterIO.RawStatsOut,\n                      b.getPort(A.StatsParserIO.RawStatsIn)\n                    ),\n                      b.connect(\n                        A.StatsParserIO.PcStatsTupleOut,\n                        c.getPort(B.StatsMonitorIO.PcStatsTupleIn)\n                      ),\n                      c.connect(\n                        B.StatsMonitorIO.StatsTupleOut,\n                        e.getPort(D.StatsAssemblerIO.StatsTupleIn)\n                      ),\n                      e.connect(\n                        D.StatsAssemblerIO.CallstatsOut,\n                        d.getPort(C.StatsTransmitterIO.CallstatsIn)\n                      ),\n                      a.connect(\n                        z.StatsAdapterIO.UnprocessedOut,\n                        d.getPort(C.StatsTransmitterIO.UnprocessedIn)\n                      );\n                  },\n                },\n                {\n                  key: "setupConnection",\n                  value: function () {\n                    var a = this;\n                    (this.connectionManager = m.Registry.getConnectionManager()),\n                      this.connectionManager.setupCollectorConnection(\n                        m.Registry.getCredentials().getTransportType()\n                      ),\n                      this.connectionManager\n                        .setup()\n                        .then(function () {\n                          o.log("Connected to connectionManager"),\n                            a.fire(G.onServicesFinished),\n                            a.run();\n                        })\n                        .catch(function (a) {\n                          return o.log(\n                            "Could not connect to connectionManager",\n                            a\n                          );\n                        });\n                  },\n                },\n                {\n                  key: "setup",\n                  value: function () {\n                    var a = this;\n                    (this.clocksync = m.Registry.getClockSync()),\n                      this.clocksync\n                        .initiate()\n                        .then(function () {\n                          o.log("Clocksync completed"),\n                            a.fire(G.onServicesFinished),\n                            a.run();\n                        })\n                        .catch(function (a) {\n                          return o.log("Could not finish ClockSync", a);\n                        });\n                  },\n                },\n                {\n                  key: "onInitialize",\n                  value: function (a, b, c, d, e, f) {\n                    var g = this,\n                      h = m.Registry.getCredentials();\n                    if (\n                      (h.setAppId(a),\n                      h.setUserId(b),\n                      m.Registry.getCallbacks().set(\n                        u.callbackFunctions.stats,\n                        e\n                      ),\n                      (this.doPrecalltest = !0),\n                      f)\n                    ) {\n                      if (\n                        (!0 === f.disableBeforeUnloadHandler &&\n                          this.setBeforeUnloadHandler(),\n                        f.applicationVersion)\n                      ) {\n                        m.Registry.getEndpoint().setAppVersion(\n                          f.applicationVersion\n                        );\n                      }\n                      f.transportType && w.setTransportType(f.transportType),\n                        f.disablePrecalltest && (this.doPrecalltest = !1);\n                    }\n                    this.setup(),\n                      this.authenticator.initiate(c, d).then(\n                        function (a) {\n                          o.log("Authentication complete"), g.setupConnection();\n                          var b = m.Registry.getCredentials().getStatsSubmissionInterval();\n                          m.Registry.getStatsMonitor().setIntervals(b, b),\n                            g.fire(G.onServicesFinished),\n                            g.run();\n                          var c = g.authenticator.getIceServers();\n                          c &&\n                            g.doPrecalltest &&\n                            g.precalltest.start(\n                              c,\n                              "callstats",\n                              g.precalltestCallback.bind(g)\n                            ),\n                            g.configservicewrapper\n                              .initiateInternalConfig()\n                              .then(\n                                function () {\n                                  o.log(\n                                    "ConfigService internal config:",\n                                    g.configservicewrapper.getInternalConfig()\n                                  ),\n                                    g.fire(G.onServicesFinished),\n                                    g.run();\n                                },\n                                function (a) {\n                                  return o.log(a);\n                                }\n                              ),\n                            g.configservicewrapper.initiateAppConfig().then(\n                              function () {\n                                var a = m.Registry.getCallbacks().get(\n                                    u.callbackFunctions.defaultConfig\n                                  ),\n                                  b = g.configservicewrapper.getAppDefaultConfig();\n                                a && b && a(b);\n                                var c = m.Registry.getCallbacks().get(\n                                    u.callbackFunctions.recommendedConfig\n                                  ),\n                                  d = g.configservicewrapper.getAppRecommendedConfig();\n                                c && d && c(d),\n                                  g.fire(G.onServicesFinished),\n                                  g.run();\n                              },\n                              function (a) {\n                                return o.log(a);\n                              }\n                            );\n                        },\n                        function (a) {\n                          o.log(a);\n                        }\n                      );\n                  },\n                },\n                {\n                  key: "precalltestCallback",\n                  value: function (a, b) {\n                    var c = m.Registry.getCallbacks().get(\n                        u.callbackFunctions.preCallTestResults\n                      ),\n                      d = m.Registry.getCallbacks().get(\n                        u.callbackFunctions.preCallTest\n                      );\n                    if ((d && d(a), c)) {\n                      if (b) {\n                        var e = {\n                          msg: "precalltest error: " + b,\n                        };\n                        return (\n                          o.warn("backendlog", e),\n                          m.Registry.getGenericEventHandler().sendEvent(\n                            u.logEvents.log,\n                            e\n                          ),\n                          void c(u.callstatsAPIReturnStatus.failure, null)\n                        );\n                      }\n                      var f = y.getPublicPrecalltestResults(a);\n                      c(u.callstatsAPIReturnStatus.success, f);\n                    }\n                    a &&\n                      (this.precalltestIds.push(a.id),\n                      a.tests &&\n                        a.tests.ice &&\n                        ("" === a.tests.ice.turnIpAddress &&\n                          delete a.tests.ice.turnIpAddress,\n                        "" === a.tests.ice.turnIpVersion &&\n                          delete a.tests.ice.turnIpVersion,\n                        "" === a.tests.ice.turnTransport &&\n                          delete a.tests.ice.turnTransport),\n                      o.log("sending preCallTest results", a),\n                      m.Registry.getEventMessageBuilder().make(\n                        u.precalltestEvents.results,\n                        null,\n                        null,\n                        {\n                          results: a,\n                        }\n                      ));\n                  },\n                },\n                {\n                  key: "setBeforeUnloadHandler",\n                  value: function () {\n                    window &&\n                      window.addEventListener &&\n                      (o.log("setBeforeUnloadHandler"),\n                      window.addEventListener("beforeunload", function (a) {\n                        return (\n                          m.Registry.getConferenceManager().conferenceMap.forEach(\n                            function (a, b) {\n                              a &&\n                                a\n                                  .getPeerConnectionManager()\n                                  .pcHandlers.forEach(function (a, b) {\n                                    m.Registry.getEventMessageBuilder().make(\n                                      u.internalFabricEvent.userLeft,\n                                      a.getConferenceId(),\n                                      a.getPeerConnection()\n                                    );\n                                  });\n                            }\n                          ),\n                          "Are you sure you want to close the call?"\n                        );\n                      }));\n                  },\n                },\n                {\n                  key: "onServicesFinished",\n                  value: function () {\n                    return (\n                      !!(\n                        this.connectionManager &&\n                        this.connectionManager.isReady() &&\n                        this.clocksync.isCompleted() &&\n                        this.authenticator.isCompleted()\n                      ) && (m.Registry.getTransmissionManager().trySend(), !0)\n                    );\n                  },\n                },\n                {\n                  key: "onAddNewFabric",\n                  value: function (a, b, c, d, e, f, g) {\n                    o.warn("FSM onAddNewFabric"),\n                      m.Registry.getConferenceManager().add(\n                        d,\n                        m.Registry.getCredentials()\n                      );\n                    var h = m.Registry.getConferenceManager().get(d);\n                    h.getPeerConnectionManager().addPcHandler(\n                      a,\n                      b,\n                      c,\n                      d,\n                      e,\n                      f,\n                      g\n                    );\n                    var i = {\n                      endpointInfo: m.Registry.getEndpoint().serialize(),\n                    };\n                    m.Registry.getCredentials().getUserIdObject() &&\n                      (i.localUserIDObject = m.Registry.getCredentials().getUserIdObject()),\n                      h.userJoinedSent ||\n                        (m.Registry.getEventMessageBuilder().make(\n                          u.internalFabricEvent.userJoined,\n                          d,\n                          a,\n                          i\n                        ),\n                        (h.userJoinedSent = !0),\n                        m.Registry.getCredentials().getTransportType() ===\n                          u.transportType.rest &&\n                          i.localUserIDObject &&\n                          i.localUserIDObject.userName &&\n                          m.Registry.getEventMessageBuilder().make(\n                            u.internalFabricEvent.userDetails,\n                            d,\n                            a,\n                            {\n                              userName: String(i.localUserIDObject.userName),\n                            }\n                          ));\n                    var j = this.precalltestIds;\n                    this.precalltestIds = [];\n                    var k = this.precalltest.getId();\n                    k && j.push(k),\n                      j.length > 0 &&\n                        m.Registry.getEventMessageBuilder().make(\n                          u.precalltestEvents.associate,\n                          d,\n                          a,\n                          {\n                            ids: j,\n                          }\n                        );\n                  },\n                },\n                {\n                  key: "onSendFabricEvent",\n                  value: function (a, b, c, d) {\n                    o.warn("FSM onSendFabricEvent");\n                    var e = {};\n                    if (\n                      (d && ((e = d), e.ssrc && (e.ssrc = String(e.ssrc))),\n                      b === u.fabricEvent.activeDeviceList)\n                    ) {\n                      e = {\n                        mediaDeviceList: q.normalizeMediaDeviceList(\n                          d.deviceList\n                        ),\n                      };\n                    }\n                    m.Registry.getEventMessageBuilder().make(b, c, a, e);\n                    var f = m.Registry.getConferenceManager().get(c);\n                    if (f) {\n                      var g = f.getPeerConnectionManager().getPcHandler(a);\n                      (b !== u.fabricEvent.fabricTerminated &&\n                        b !== u.internalFabricEvent.fabricSetupFailed) ||\n                        (g.stopUserAliveHandler(),\n                        g.setPcState(u.fabricState.terminated),\n                        g.stopStatsPolling(),\n                        f.getPeerConnectionManager().removePcHandler(a)),\n                        b === u.fabricEvent.fabricHold &&\n                          (g.setPcState(u.fabricState.hold),\n                          g.stopStatsPolling()),\n                        b === u.fabricEvent.fabricResume &&\n                          (g.setPcState(u.fabricState.established),\n                          g.startStatsPolling());\n                    }\n                  },\n                },\n                {\n                  key: "onReportError",\n                  value: function (a, b, c, d, e, f) {\n                    o.warn("FSM onReportError");\n                    var g = {\n                      failureDelay: 0,\n                      reason: this.callFailureClassifier(c),\n                      function: c,\n                      magicKey: m.Registry.getEndpoint().getMagicKey(),\n                      endpoint: m.Registry.getEndpoint().serialize(),\n                      level: "debug",\n                    };\n                    if (d) {\n                      var h = this.formatDomError(d);\n                      (g.message = h.message),\n                        (g.messageType = h.messageType),\n                        (g.name = d.name),\n                        (g.stack = d.stack);\n                    }\n                    if (a) {\n                      var i = m.Registry.getConferenceManager().get(b),\n                        j = void 0;\n                      if (\n                        (i &&\n                          (j = i.getPeerConnectionManager().getPcHandler(a)),\n                        !j)\n                      )\n                        return void o.error(\n                          "onReportError: No handler found for given PeerConnection!"\n                        );\n                      if (\n                        ((g.failureDelay = s.getCurrent() - j.getStartTime()),\n                        (g.fabricState = j.getPcState()),\n                        (g.iceConnectionState = j.getIceConnectionState()),\n                        (e || f || (a && "closed" !== a.signalingState)) &&\n                          m.Registry.getCredentials().getCollectSDP() &&\n                          c === u.fabricEvent.fabricSetupFailed)\n                      ) {\n                        var k = {};\n                        (k.localSDP = this.pickSDP(a, e, "localDescription")),\n                          (k.remoteSDP = this.pickSDP(\n                            a,\n                            f,\n                            "remoteDescription"\n                          )),\n                          m.Registry.getEventMessageBuilder().make(\n                            u.callstatsChannels.sdpSubmission,\n                            b,\n                            a,\n                            k\n                          );\n                      }\n                    }\n                    c === u.webRTCFunctions.applicationLog ||\n                    c === u.webRTCFunctions.applicationError\n                      ? m.Registry.getEventMessageBuilder().make(\n                          u.fabricEvent.applicationErrorLog,\n                          b,\n                          a,\n                          g\n                        )\n                      : (m.Registry.getEventMessageBuilder().make(\n                          u.fabricEvent.fabricSetupFailed,\n                          b,\n                          a,\n                          g\n                        ),\n                        c === u.webRTCFunctions.getUserMedia &&\n                          this.handleGUMErrors(b));\n                  },\n                },\n                {\n                  key: "onAssociateMstWithUserID",\n                  value: function (a, b, c, d, e, f) {\n                    var g = m.Registry.getConferenceManager().get(c);\n                    if (g) {\n                      var h = g.getPeerConnectionManager().getPcHandler(a);\n                      "string" != typeof d && (d += ""),\n                        h.updateSSRCInfo(d, b, e, f);\n                    }\n                  },\n                },\n                {\n                  key: "onAttachWifiStatsHandler",\n                  value: function (a) {\n                    m.Registry.getWifiStatsExecutor().setGetWifiStatsMethod(a);\n                  },\n                },\n                {\n                  key: "onSetProxyConfig",\n                  value: function (a) {\n                    o.warn("FSM onSetProxyConfig"),\n                      a.collectorURL && w.setBaseUrl(a.collectorURL),\n                      a.authServiceURL && w.setAuthServiceUrl(a.authServiceURL),\n                      a.csioInternalAPIURL &&\n                        w.setQmodelThresholdsAPIUrl(a.csioInternalAPIURL),\n                      a.wsURL && w.setWsUrl(a.wsURL),\n                      a.restEventURL && w.setRestEventUrl(a.restEventURL),\n                      a.restStatsURL && w.setRestStatsUrl(a.restStatsURL),\n                      a.appSettingsURL &&\n                        w.setConfigServiceUrl(a.appSettingsURL);\n                  },\n                },\n                {\n                  key: "onSendUserFeedback",\n                  value: function (a, b, c) {\n                    var d = {\n                      feedback: {\n                        overallRating: b.overall,\n                      },\n                    };\n                    b.video && (d.feedback.videoQualityRating = b.video),\n                      b.audio && (d.feedback.audioQualityRating = b.audio),\n                      b.comment && (d.feedback.comments = b.comment),\n                      m.Registry.getEventMessageBuilder().make(\n                        u.callstatsChannels.userFeedback,\n                        a,\n                        null,\n                        d\n                      );\n                  },\n                },\n                {\n                  key: "onOn",\n                  value: function (a, b) {\n                    m.Registry.getCallbacks().set(a, b);\n                  },\n                },\n                {\n                  key: "onSetIdentifiers",\n                  value: function (a, b) {\n                    if (\n                      (a.conferenceID &&\n                        (m.Registry.getConferenceManager().updateConferenceId(\n                          a.conferenceID\n                        ),\n                        m.Registry.getTransmissionManager().updateConferenceId(\n                          a.conferenceID\n                        ),\n                        m.Registry.getTransmissionManager().trySend()),\n                      a.remoteUserID && b)\n                    ) {\n                      var c = m.Registry.getConferenceManager().getConferenceForPc(\n                        b\n                      );\n                      if (!c)\n                        return void o.log(\n                          "onSetIdentifiers conference not found"\n                        );\n                      var d = c.getPeerConnectionManager().getPcHandler(b);\n                      if (!d) return void o.log("pcHandler not found");\n                      d.updateRemoteId(a.remoteUserID),\n                        m.Registry.getTransmissionManager().trySend();\n                    }\n                  },\n                },\n                {\n                  key: "onMakePrecallTest",\n                  value: function (a, b) {\n                    var c = this,\n                      d = a,\n                      e = b || "callstats";\n                    a ||\n                      ((d = this.authenticator.getIceServers()),\n                      (e = "callstats")),\n                      c.precalltest.start(d, e, c.precalltestCallback.bind(c));\n                  },\n                },\n                {\n                  key: "handleGUMErrors",\n                  value: function (a) {\n                    var b = m.Registry.getConferenceManager().get(a);\n                    if (\n                      (b ||\n                        (m.Registry.getConferenceManager().add(\n                          a,\n                          m.Registry.getCredentials()\n                        ),\n                        (b = m.Registry.getConferenceManager().get(a))),\n                      !b.getUcId())\n                    ) {\n                      var c = {\n                        endpointInfo: m.Registry.getEndpoint().serialize(),\n                      };\n                      m.Registry.getEventMessageBuilder().make(\n                        u.internalFabricEvent.userJoined,\n                        a,\n                        null,\n                        c\n                      ),\n                        (b.userJoinedSent = !0);\n                    }\n                  },\n                },\n                {\n                  key: "callFailureClassifier",\n                  value: function (a) {\n                    var b = void 0;\n                    return (\n                      u.webRTCFunctions.hasOwnProperty(a)\n                        ? a === u.webRTCFunctions.createOffer ||\n                          a === u.webRTCFunctions.createAnswer ||\n                          a === u.webRTCFunctions.setRemoteDescription\n                          ? (b = u.callFailureReasons.negotiationFailure)\n                          : a === u.webRTCFunctions.setLocalDescription\n                          ? (b = u.callFailureReasons.sdpError)\n                          : a === u.webRTCFunctions.addIceCandidate\n                          ? (b = u.callFailureReasons.sdpError)\n                          : a === u.webRTCFunctions.getUserMedia\n                          ? (b = u.callFailureReasons.mediaConfigError)\n                          : a === u.webRTCFunctions.iceConnectionFailure\n                          ? (b = u.callFailureReasons.iceFailure)\n                          : a === u.webRTCFunctions.signalingError\n                          ? (b = u.callFailureReasons.signalingError)\n                          : (a === u.webRTCFunctions.applicationLog ||\n                              u.webRTCFunctions.applicationError) &&\n                            (b = u.callFailureReasons.applicationLog)\n                        : (b = u.callFailureReasons.invalidWebRTCFunctionName),\n                      b\n                    );\n                  },\n                },\n                {\n                  key: "formatDomError",\n                  value: function (a) {\n                    var b = {},\n                      c = {};\n                    a &&\n                      (window.DOMException && a instanceof window.DOMException\n                        ? ((c.message = a.message),\n                          (c.name = a.name),\n                          (b.messageType = "domError"))\n                        : "object" === (void 0 === a ? "undefined" : j(a))\n                        ? (a.message && (c.message = a.message),\n                          a.name && (c.name = a.name),\n                          a.constraintName && (c.name = a.constraintName),\n                          a.stack && (c.stack = a.stack),\n                          (b.messageType = "json"))\n                        : ((c = a), (b.messageType = "text")));\n                    var d = this.truncateLog(c);\n                    return (\n                      "object" === (void 0 === d ? "undefined" : j(d))\n                        ? (b.message = JSON.stringify(d))\n                        : (b.message = d),\n                      b\n                    );\n                  },\n                },\n                {\n                  key: "pickSDP",\n                  value: function (a, b, c) {\n                    return b || (a && a[c] ? a[c].sdp : "");\n                  },\n                },\n                {\n                  key: "truncateString",\n                  value: function (a) {\n                    return (\n                      a.length > 2e4 &&\n                        (o.log("Log exceeds 20kb, It will be truncated"),\n                        (a = a.substring(0, 2e4))),\n                      a\n                    );\n                  },\n                },\n                {\n                  key: "truncateLog",\n                  value: function (a) {\n                    return a\n                      ? ("string" == typeof a\n                          ? (a = this.truncateString(a))\n                          : "object" === (void 0 === a ? "undefined" : j(a)) &&\n                            a.message &&\n                            (a.message = this.truncateString(a.message)),\n                        a)\n                      : a;\n                  },\n                },\n              ]),\n              b\n            );\n          })(l.StateMachine);\n        c.MainFSM = H;\n      },\n      {\n        "../config/constants": 33,\n        "../config/settings": 34,\n        "../statspipeline/statsadapter": 69,\n        "../statspipeline/statsassembler": 70,\n        "../statspipeline/statsmonitor": 72,\n        "../statspipeline/statsparser": 73,\n        "../statspipeline/statstransmitter": 74,\n        "../utility/csiologger": 88,\n        "../utility/registry": 95,\n        "../utility/timestamps": 99,\n        "../utility/utils": 101,\n        "./statemachine": 37,\n        "./utility": 38,\n      },\n    ],\n    36: [\n      function (a, b, c) {\n        "use strict";\n        function d(a, b) {\n          if (!(a instanceof b))\n            throw new TypeError("Cannot call a class as a function");\n        }\n        Object.defineProperty(c, "__esModule", {\n          value: !0,\n        });\n        var e = (function () {\n            function a(a, b) {\n              for (var c = 0; c < b.length; c++) {\n                var d = b[c];\n                (d.enumerable = d.enumerable || !1),\n                  (d.configurable = !0),\n                  "value" in d && (d.writable = !0),\n                  Object.defineProperty(a, d.key, d);\n              }\n            }\n            return function (b, c, d) {\n              return c && a(b.prototype, c), d && a(b, d), b;\n            };\n          })(),\n          f = (function () {\n            function a(b, c) {\n              d(this, a),\n                (this.type = b),\n                (this.args = void 0 !== c ? c : null);\n            }\n            return (\n              e(a, [\n                {\n                  key: "getType",\n                  value: function () {\n                    return this.type;\n                  },\n                },\n                {\n                  key: "getArgs",\n                  value: function () {\n                    return this.args;\n                  },\n                },\n              ]),\n              a\n            );\n          })();\n        c.ProgramEvent = f;\n      },\n      {},\n    ],\n    37: [\n      function (a, b, c) {\n        "use strict";\n        function d(a, b) {\n          if (!(a instanceof b))\n            throw new TypeError("Cannot call a class as a function");\n        }\n        Object.defineProperty(c, "__esModule", {\n          value: !0,\n        }),\n          (c.StateMachine = void 0);\n        var e = (function () {\n            function a(a, b) {\n              for (var c = 0; c < b.length; c++) {\n                var d = b[c];\n                (d.enumerable = d.enumerable || !1),\n                  (d.configurable = !0),\n                  "value" in d && (d.writable = !0),\n                  Object.defineProperty(a, d.key, d);\n              }\n            }\n            return function (b, c, d) {\n              return c && a(b.prototype, c), d && a(b, d), b;\n            };\n          })(),\n          f = a("./programevent"),\n          g = a("../utility/csiologger"),\n          h = (function (a) {\n            if (a && a.__esModule) return a;\n            var b = {};\n            if (null != a)\n              for (var c in a)\n                Object.prototype.hasOwnProperty.call(a, c) && (b[c] = a[c]);\n            return (b.default = a), b;\n          })(g),\n          i = (function () {\n            function a(b) {\n              d(this, a), (this.events = []), (this.state = b);\n            }\n            return (\n              e(a, [\n                {\n                  key: "fire",\n                  value: function (a) {\n                    for (\n                      var b = arguments.length,\n                        c = Array(b > 1 ? b - 1 : 0),\n                        d = 1;\n                      d < b;\n                      d++\n                    )\n                      c[d - 1] = arguments[d];\n                    var e = new f.ProgramEvent(a, c);\n                    this.events.push(e);\n                  },\n                },\n                {\n                  key: "proceed",\n                  value: function (a, b) {\n                    h.warn(\n                      "You need to overwrite the proceed function inan extended StateMachine"\n                    );\n                  },\n                },\n                {\n                  key: "setState",\n                  value: function (a) {\n                    this.state = a;\n                  },\n                },\n                {\n                  key: "getState",\n                  value: function () {\n                    return this.state;\n                  },\n                },\n                {\n                  key: "run",\n                  value: function () {\n                    if (!(this.events.length < 1)) {\n                      var a = this.events.shift();\n                      this.proceed(a.getType(), a.getArgs());\n                    }\n                  },\n                },\n              ]),\n              a\n            );\n          })();\n        c.StateMachine = i;\n      },\n      {\n        "../utility/csiologger": 88,\n        "./programevent": 36,\n      },\n    ],\n    38: [\n      function (a, b, c) {\n        "use strict";\n        function d(a) {\n          var b = {\n            mediaConnectivity: !1,\n            throughput: null,\n            fractionalLoss: null,\n            rtt: null,\n          };\n          return a && a.tests\n            ? ((b.provider = a.provider),\n              a.tests.rtt &&\n                ((b.rtt = a.tests.rtt.median), (b.mediaConnectivity = !0)),\n              a.tests.throughput &&\n                ((b.throughput = a.tests.throughput.average),\n                (b.fractionalLoss = Math.max(\n                  a.tests.throughput.fractionLostBytes,\n                  0\n                )),\n                (b.mediaConnectivity = !0)),\n              a.tests.ice &&\n                (a.tests.ice.relayTcpSuccess ||\n                  a.tests.ice.relayTlsSuccess ||\n                  a.tests.ice.relayUdpSuccess) &&\n                (b.mediaConnectivity = !0),\n              b)\n            : b;\n        }\n        Object.defineProperty(c, "__esModule", {\n          value: !0,\n        }),\n          (c.getPublicPrecalltestResults = d);\n      },\n      {},\n    ],\n    39: [\n      function (a, b, c) {\n        "use strict";\n        function d(a) {\n          if (a && a.__esModule) return a;\n          var b = {};\n          if (null != a)\n            for (var c in a)\n              Object.prototype.hasOwnProperty.call(a, c) && (b[c] = a[c]);\n          return (b.default = a), b;\n        }\n        function e(a, b) {\n          if (!(a instanceof b))\n            throw new TypeError("Cannot call a class as a function");\n        }\n        Object.defineProperty(c, "__esModule", {\n          value: !0,\n        }),\n          (c.GetStatsHandler = void 0);\n        var f = (function () {\n            function a(a, b) {\n              for (var c = 0; c < b.length; c++) {\n                var d = b[c];\n                (d.enumerable = d.enumerable || !1),\n                  (d.configurable = !0),\n                  "value" in d && (d.writable = !0),\n                  Object.defineProperty(a, d.key, d);\n              }\n            }\n            return function (b, c, d) {\n              return c && a(b.prototype, c), d && a(b, d), b;\n            };\n          })(),\n          g = a("../config/constants"),\n          h = d(g),\n          i = a("../statspipeline/statsadapter"),\n          j = a("../utility/registry"),\n          k = a("../utility/rttregistry"),\n          l = a("../utility/csiologger"),\n          m = d(l),\n          n = (function () {\n            function a(b, c, d, f, g) {\n              e(this, a),\n                (this.pc = b),\n                (this.interval = d),\n                (this.codeBase = f),\n                (this.browserName = g),\n                (this.getStatsTimer = null),\n                (this.isPromiseBased = !0),\n                (this.pcHash = c),\n                (this.genericevent = j.Registry.getGenericEventHandler());\n            }\n            return (\n              f(a, [\n                {\n                  key: "startStatsPolling",\n                  value: function () {\n                    var a = this;\n                    a.getStatsTimer ||\n                      (m.log("startStatsPolling for ", a.pcHash),\n                      (this.getStatsTimer = setInterval(function () {\n                        a.csioGetStats(a.statsHandler, a.pcHash);\n                      }, a.interval)));\n                  },\n                },\n                {\n                  key: "stopStatsPolling",\n                  value: function () {\n                    this.getStatsTimer &&\n                      (clearInterval(this.getStatsTimer),\n                      (this.getStatsTimer = null));\n                  },\n                },\n                {\n                  key: "csioGetStats",\n                  value: function (a, b) {\n                    var c = h.codeBaseType.firefox,\n                      d = h.codeBaseType.chrome,\n                      e = h.codeBaseType.edge,\n                      f = h.browserName.safari;\n                    if (this.pc) {\n                      if ("closed" === this.pc.iceConnectionState)\n                        return void this.stopStatsPolling();\n                      try {\n                        this.isTemaSys()\n                          ? this.getStatsTemasys(a, b)\n                          : this.codeBase === c\n                          ? this.getStatsFirefox(a, b)\n                          : this.browserName === f\n                          ? this.getStatsSafari(a, b)\n                          : this.codeBase === d\n                          ? this.getStatsChrome(a, b)\n                          : this.codeBase === e && this.getStatsEdge(a, b);\n                      } catch (a) {\n                        m.log("csioGetStats: Error ", a);\n                      }\n                    }\n                  },\n                },\n                {\n                  key: "getStatsTemasys",\n                  value: function (a, b) {\n                    this.pc.getStats(\n                      null,\n                      function (c) {\n                        a(c, b);\n                      },\n                      function (a) {\n                        m.log("getStatsTemasys error", a);\n                      }\n                    );\n                  },\n                },\n                {\n                  key: "getStatsFirefox",\n                  value: function (a, b) {\n                    var c = this,\n                      d = this.pc;\n                    if (!c.isPromiseBased)\n                      return void d.getStats(null, function (c) {\n                        a(c, b);\n                      });\n                    try {\n                      d.getStats()\n                        .then(function (c) {\n                          a(c, b);\n                        })\n                        .catch(function (e) {\n                          (c.isPromiseBased = !1),\n                            d.getStats(null, function (c) {\n                              a(c, b);\n                            });\n                        });\n                    } catch (e) {\n                      (c.isPromiseBased = !1),\n                        c.genericevent.sendEvent(h.logEvents.getStatsError, {\n                          msg: "Firefox getStats reports error ",\n                          error: e.message + ":" + e.stack,\n                        }),\n                        d.getStats(null, function (c) {\n                          a(c, b);\n                        });\n                    }\n                  },\n                },\n                {\n                  key: "getStatsChrome",\n                  value: function (a, b) {\n                    var c = this,\n                      d = c.pc;\n                    if (window && window.csioReactNative)\n                      return void d.getStats(\n                        null,\n                        function (c) {\n                          a(c, b);\n                        },\n                        function (a) {\n                          c.genericevent.sendEvent(h.logEvents.getStatsError, {\n                            msg: "react-native getStats reports error",\n                            error: a.message + ":" + a.stack,\n                          });\n                        }\n                      );\n                    if (!c.isPromiseBased)\n                      return void d.getStats(function (c) {\n                        a(c, b);\n                      });\n                    try {\n                      d.getStats()\n                        .then(function (c) {\n                          (0, k.getRTTRegistry)().update(d), a(c, b);\n                        })\n                        .catch(function (e) {\n                          m.log("Chrome getStats Error ", e),\n                            (c.isPromiseBased = !1),\n                            c.genericevent.sendEvent(\n                              h.logEvents.getStatsError,\n                              {\n                                msg: "Chrome getStats reports error",\n                                error: e.message + ":" + e.stack,\n                              }\n                            ),\n                            d.getStats(function (c) {\n                              a(c, b);\n                            });\n                        });\n                    } catch (e) {\n                      (c.isPromiseBased = !1),\n                        c.genericevent.sendEvent(h.logEvents.getStatsError, {\n                          msg: "Chrome getStats reports error",\n                          error: e.message + ":" + e.stack,\n                        }),\n                        d.getStats(function (c) {\n                          a(c, b);\n                        });\n                    }\n                  },\n                },\n                {\n                  key: "getStatsEdge",\n                  value: function (a, b) {\n                    var c = this;\n                    c.pc\n                      .getStats()\n                      .then(function (c) {\n                        a(c, b);\n                      })\n                      .catch(function (d) {\n                        a({}, b),\n                          d\n                            ? c.genericevent.sendEvent(\n                                h.logEvents.getStatsError,\n                                {\n                                  msg: "Edge getStats reports error",\n                                  error: d.message + ":" + d.stack,\n                                }\n                              )\n                            : c.genericevent.sendEvent(\n                                h.logEvents.getStatsError,\n                                {\n                                  msg: "Edge getStats reports error",\n                                }\n                              );\n                      });\n                  },\n                },\n                {\n                  key: "getStatsSafari",\n                  value: function (a, b) {\n                    var c = this;\n                    c.pc\n                      .getStats()\n                      .then(function (c) {\n                        a(c, b);\n                      })\n                      .catch(function (a) {\n                        c.genericevent.sendEvent(h.logEvents.getStatsError, {\n                          msg: "Safari getStats reports error",\n                          error: a.message + ":" + a.stack,\n                        });\n                      });\n                  },\n                },\n                {\n                  key: "statsHandler",\n                  value: function (a, b) {\n                    var c = j.Registry.getStatsAdapter();\n                    if (a && c)\n                      try {\n                        c.transmit(i.StatsAdapterIO.RawStatsIn, a, b);\n                      } catch (a) {\n                        m.log("statsHandler 123: Error ", a),\n                          j.Registry.getGenericEventHandler().sendEvent(\n                            h.logEvents.error,\n                            {\n                              msg: "statsHandler: Error",\n                              error: a.message + ":" + a.stack,\n                            }\n                          );\n                      }\n                  },\n                },\n                {\n                  key: "iceCandidatesHandler",\n                  value: function (a, b) {\n                    var c = j.Registry.getStatsAdapter(),\n                      d = void 0;\n                    (d = c.getIceCandidates(a)), b(d);\n                  },\n                },\n                {\n                  key: "getIceCandidates",\n                  value: function () {\n                    var a = this;\n                    return new Promise(function (b, c) {\n                      a.csioGetStats(a.iceCandidatesHandler, function (a) {\n                        b(a);\n                      });\n                    });\n                  },\n                },\n                {\n                  key: "isTemaSys",\n                  value: function () {\n                    return !!(\n                      window &&\n                      window.AdapterJS &&\n                      window.AdapterJS.WebRTCPlugin &&\n                      window.AdapterJS.WebRTCPlugin.plugin\n                    );\n                  },\n                },\n              ]),\n              a\n            );\n          })();\n        c.GetStatsHandler = n;\n      },\n      {\n        "../config/constants": 33,\n        "../statspipeline/statsadapter": 69,\n        "../utility/csiologger": 88,\n        "../utility/registry": 95,\n        "../utility/rttregistry": 96,\n      },\n    ],\n    40: [\n      function (a, b, c) {\n        "use strict";\n        function d(a) {\n          if (a && a.__esModule) return a;\n          var b = {};\n          if (null != a)\n            for (var c in a)\n              Object.prototype.hasOwnProperty.call(a, c) && (b[c] = a[c]);\n          return (b.default = a), b;\n        }\n        function e(a, b) {\n          if (!(a instanceof b))\n            throw new TypeError("Cannot call a class as a function");\n        }\n        Object.defineProperty(c, "__esModule", {\n          value: !0,\n        }),\n          (c.PcCallbackHandler = void 0);\n        var f = (function () {\n            function a(a, b) {\n              for (var c = 0; c < b.length; c++) {\n                var d = b[c];\n                (d.enumerable = d.enumerable || !1),\n                  (d.configurable = !0),\n                  "value" in d && (d.writable = !0),\n                  Object.defineProperty(a, d.key, d);\n              }\n            }\n            return function (b, c, d) {\n              return c && a(b.prototype, c), d && a(b, d), b;\n            };\n          })(),\n          g = a("../config/constants"),\n          h = d(g),\n          i = a("../utility/registry"),\n          j = a("../utility/timestamps"),\n          k = d(j),\n          l = a("../config/callstatserrors"),\n          m = d(l),\n          n = a("../utility/csiologger"),\n          o = d(n),\n          p = (function () {\n            function a(b, c, d, f, g, j) {\n              var l = this;\n              e(this, a),\n                c &&\n                  ((this.conferenceId = b),\n                  (this.pc = c),\n                  (this.getStatsHandler = d),\n                  (this.userAlive = f),\n                  (this.callback = j),\n                  (this.remoteId = g),\n                  (this.clocksync = i.Registry.getClockSync()),\n                  (this.emb = i.Registry.getEventMessageBuilder()),\n                  (this.precalltest = i.Registry.getPreCallTest()),\n                  (this.genericevent = i.Registry.getGenericEventHandler()),\n                  (this.iceCandidates = []),\n                  (this.iceConnectionState = c.iceConnectionState),\n                  (this.iceGatheringState = c.iceGatheringState),\n                  (this.signalingState = c.signalingState),\n                  (this.oldIceConnectionState = ""),\n                  (this.oldIceGatheringState = ""),\n                  (this.iceConnectionStateTS = ""),\n                  (this.negotiationNeeded = 0),\n                  (this.pcState = h.fabricState.initializing),\n                  (this.disruptedTS = 0),\n                  (this.connectionDisruptedTS = 0),\n                  (this.startTime = k.getCurrent()),\n                  (this.established = !1),\n                  (this.activeIceCandidatePair = null),\n                  (this.prevActiveIceCandidatePair = null),\n                  (this.localIceCandidates = []),\n                  (this.remoteIceCandidates = []),\n                  (this.iceCandidatePairs = []),\n                  (this.iceConnectivityDelay = 0),\n                  (this.iceGatheringDelay = 0),\n                  (this.fabricSetupSent = !1),\n                  this.pc && this.pc.addEventListener\n                    ? (this.pc.addEventListener(\n                        "icecandidate",\n                        this.iceCandidateCallback.bind(this),\n                        !1\n                      ),\n                      this.pc.addEventListener(\n                        "iceconnectionstatechange",\n                        this.iceConnectionStateChangeCallback.bind(this),\n                        !1\n                      ),\n                      this.pc.addEventListener(\n                        "signalingstatechange",\n                        this.pcSignalingStateChangeCallback.bind(this),\n                        !1\n                      ),\n                      this.pc.addEventListener(\n                        "negotiationneeded",\n                        this.pcNegotiationNeededCallback.bind(this),\n                        !1\n                      ))\n                    : this.pc && this.pc.attachEvent\n                    ? (o.info("attachEvent"),\n                      this.pc.attachEvent(\n                        "onicecandidate",\n                        this.iceCandidateCallback.bind(this)\n                      ),\n                      this.pc.attachEvent(\n                        "oniceconnectionstatechange",\n                        this.iceConnectionStateChangeCallback.bind(this)\n                      ),\n                      this.pc.attachEvent(\n                        "onsignalingstatechange",\n                        this.pcSignalingStateChangeCallback.bind(this)\n                      ),\n                      this.pc.attachEvent(\n                        "onnegotiationneeded",\n                        this.pcNegotiationNeededCallback.bind(this)\n                      ))\n                    : o.error("callstats cannot monitor or collect stats"),\n                  !c ||\n                    ("connected" !== c.iceConnectionState &&\n                      "completed" !== c.iceConnectionState) ||\n                    ((this.pcState = h.fabricState.established),\n                    this.getStatsHandler.getIceCandidates().then(function (a) {\n                      (l.localIceCandidates = a.localIceCandidates),\n                        (l.remoteIceCandidates = a.remoteIceCandidates),\n                        (l.iceCandidatePairs = a.iceCandidatePairs),\n                        (l.prevActiveIceCandidatePair =\n                          l.activeIceCandidatePair),\n                        (l.activeIceCandidatePair = l.getActiveIceCandidatePair()),\n                        l.sendfabricSetup(),\n                        l.startStatsPolling();\n                    })));\n            }\n            return (\n              f(a, [\n                {\n                  key: "iceCandidateCallback",\n                  value: function (a) {\n                    if (a && a.candidate) {\n                      var b = a.candidate.candidate.split(" ");\n                      if ("0" !== b[4] && "0" !== b[5]) {\n                        var c = -1 !== b[4].indexOf(":"),\n                          d = "1" === b[1] ? "rtp" : "rtcp",\n                          e = {\n                            transport: b[2],\n                            protocol: d,\n                            typePreference: b[3],\n                            address: c\n                              ? "[" + b[4] + "]:" + b[5]\n                              : b[4] + ":" + b[5],\n                            type: b[7],\n                            media: a.candidate.sdpMid,\n                          };\n                        -1 === this.iceCandidates.indexOf(e) &&\n                          (this.iceCandidates.push(e),\n                          o.warn("CALLBACK: ICE candidate", e));\n                      }\n                    }\n                  },\n                },\n                {\n                  key: "iceConnectionStateChangeCallback",\n                  value: function (a) {\n                    var b = this;\n                    if (a) {\n                      o.log(\n                        "pc states ",\n                        this.pc.iceGatheringState,\n                        this.pc.iceConnectionState\n                      ),\n                        (this.iceConnectionStateTS = this.clocksync.getSynchronizedTimestamp()),\n                        this.handleIceGatheringState(),\n                        this.handleIceConnectionState(),\n                        o.log(\n                          "states ",\n                          this.iceGatheringState,\n                          this.iceConnectionState\n                        ),\n                        "complete" === this.iceGatheringState &&\n                          "checking" === this.iceConnectionState &&\n                          this.handleIceChecking();\n                      var c = {\n                          prevIceConnectionState: this.oldIceConnectionState,\n                          currIceConnectionState: this.iceConnectionState,\n                        },\n                        d = this.iceConnectionState;\n                      this.getStatsHandler\n                        .getIceCandidates()\n                        .then(function (a) {\n                          (b.localIceCandidates = a.localIceCandidates),\n                            (b.remoteIceCandidates = a.remoteIceCandidates),\n                            (b.iceCandidatePairs = a.iceCandidatePairs),\n                            (b.prevActiveIceCandidatePair =\n                              b.activeIceCandidatePair),\n                            (b.activeIceCandidatePair = b.getActiveIceCandidatePair()),\n                            "connected" === d || "completed" === d\n                              ? b.handleIceConnectedOrCompleted(c)\n                              : "failed" === d\n                              ? b.handleIceFailed(c)\n                              : "disconnected" === d\n                              ? b.handleIceDisconnected(c)\n                              : "closed" === d\n                              ? b.handleIceClosed(c)\n                              : "new" === d && b.handleIceRestart(c);\n                        });\n                    }\n                  },\n                },\n                {\n                  key: "sendFabricStateChange",\n                  value: function (a) {\n                    this.emb.make(\n                      h.internalFabricEvent.fabricStateChange,\n                      this.conferenceId,\n                      this.pc,\n                      a\n                    );\n                  },\n                },\n                {\n                  key: "handleIceConnectionState",\n                  value: function () {\n                    (this.oldIceConnectionState = this.iceConnectionState),\n                      (this.iceConnectionState = this.pc.iceConnectionState),\n                      o.warn(\n                        "CALLBACK: ICE connection state change",\n                        this.oldIceConnectionState,\n                        "->",\n                        this.iceConnectionState\n                      );\n                    var a = {\n                      changedState: h.fabricStateChangeType.iceConnectionState,\n                      prevState: this.oldIceConnectionState,\n                      newState: this.iceConnectionState,\n                    };\n                    this.sendFabricStateChange(a);\n                  },\n                },\n                {\n                  key: "handleIceGatheringState",\n                  value: function () {\n                    if (this.iceGatheringState !== this.pc.iceGatheringState) {\n                      "complete" === this.pc.iceGatheringState &&\n                        (this.iceGatheringDelay =\n                          k.getCurrent() - this.startTime),\n                        (this.oldIceGatheringState = this.iceGatheringState),\n                        (this.iceGatheringState = this.pc.iceGatheringState),\n                        o.warn(\n                          "CALLBACK: ICE gathering state change",\n                          this.oldIceGatheringState,\n                          "->",\n                          this.iceGatheringState\n                        );\n                      var a = {\n                        changedState: h.fabricStateChangeType.iceGatheringState,\n                        prevState: this.oldIceGatheringState,\n                        newState: this.iceGatheringState,\n                      };\n                      this.sendFabricStateChange(a);\n                    }\n                  },\n                },\n                {\n                  key: "handleIceChecking",\n                  value: function () {\n                    var a = k.getCurrent();\n                    if (\n                      "disconnected" === this.oldIceConnectionState &&\n                      (this.pcState === h.fabricState.checkingDisrupted ||\n                        this.pcState === h.fabricState.disrupted)\n                    ) {\n                      var b = {\n                        prevIceConnectionState: this.oldIceConnectionState,\n                        currIceConnectionState: this.iceConnectionState,\n                        delay: a - this.connectionDisruptedTS,\n                      };\n                      this.pcState === h.fabricState.disrupted &&\n                        ((b.prevIceCandidatePair = this.prevActiveIceCandidatePair),\n                        (b.currIceCandidatePair = this.activeIceCandidatePair),\n                        (b.delay = a - this.disruptedTS),\n                        this.emb.make(\n                          h.internalFabricEvent.iceDisruptionEnd,\n                          this.conferenceId,\n                          this.pc,\n                          b\n                        )),\n                        (this.pcState = h.fabricState.initializing),\n                        this.emb.make(\n                          h.internalFabricEvent.iceConnectionDisruptionEnd,\n                          this.conferenceId,\n                          this.pc,\n                          b\n                        );\n                    }\n                  },\n                },\n                {\n                  key: "handleIceConnectedOrCompleted",\n                  value: function (a) {\n                    var b = k.getCurrent();\n                    this.pcState === h.fabricState.disrupted &&\n                      ((a.prevIceCandidatePair = this.prevActiveIceCandidatePair),\n                      (a.currIceCandidatePair = this.activeIceCandidatePair),\n                      (a.delay = b - this.disruptedTS),\n                      this.emb.make(\n                        h.internalFabricEvent.iceDisruptionEnd,\n                        this.conferenceId,\n                        this.pc,\n                        a\n                      )),\n                      (this.iceConnectivityDelay = b - this.startTime),\n                      (this.established = !0),\n                      (this.pcState = h.fabricState.established),\n                      this.sendfabricSetup(),\n                      this.startStatsPolling();\n                  },\n                },\n                {\n                  key: "sendfabricSetup",\n                  value: function () {\n                    if (this.fabricSetupSent)\n                      return void o.log("fabricSetup has been sent already");\n                    var a = {\n                        delay: k.getCurrent() - this.startTime,\n                        iceGatheringDelay: this.iceGatheringDelay,\n                        iceConnectivityDelay: this.iceConnectivityDelay,\n                        localIceCandidates: this.localIceCandidates,\n                        remoteIceCandidates: this.remoteIceCandidates,\n                        iceCandidatePairs: this.iceCandidatePairs,\n                      },\n                      b = this.getActiveIceCandidatePair();\n                    b && (a.selectedCandidatePairID = b.id),\n                      (this.fabricSetupSent = !0);\n                    var c = void 0;\n                    if (this.conferenceId) {\n                      (c = i.Registry.getConferenceManager()\n                        .get(this.conferenceId)\n                        .getPeerConnectionManager()\n                        .getPcHandler(this.pc)),\n                        (a.remoteEndpointType = c.getRemoteEndpointType()),\n                        (a.fabricTransmissionDirection = c.getFabricTransmissionDirection());\n                    }\n                    (this.pcState = h.fabricState.established),\n                      this.emb.make(\n                        h.internalFabricEvent.fabricSetup,\n                        this.conferenceId,\n                        this.pc,\n                        a\n                      );\n                  },\n                },\n                {\n                  key: "isFabricSetupSent",\n                  value: function () {\n                    return this.fabricSetupSent;\n                  },\n                },\n                {\n                  key: "startStatsPolling",\n                  value: function () {\n                    this.getStatsHandler.startStatsPolling();\n                  },\n                },\n                {\n                  key: "stopStatsPolling",\n                  value: function () {\n                    this.getStatsHandler.stopStatsPolling();\n                  },\n                },\n                {\n                  key: "handleIceFailed",\n                  value: function (a) {\n                    (a.currIceCandidatePair = this.activeIceCandidatePair),\n                      (a.failureDelay = k.getCurrent() - this.startTime),\n                      (a.delay = k.getCurrent() - this.startTime),\n                      (this.pcState = h.fabricState.failed),\n                      "checking" === a.prevIceConnectionState\n                        ? this.sendIceFailed(a)\n                        : "completed" === a.prevIceConnectionState ||\n                          "connected" === a.prevIceConnectionState\n                        ? this.emb.make(\n                            h.internalFabricEvent.fabricDropped,\n                            this.conferenceId,\n                            this.pc,\n                            a\n                          )\n                        : "disconnected" === a.prevIceConnectionState &&\n                          this.established\n                        ? this.emb.make(\n                            h.internalFabricEvent.fabricDropped,\n                            this.conferenceId,\n                            this.pc,\n                            a\n                          )\n                        : "disconnected" === a.prevIceConnectionState &&\n                          this.sendIceFailed(a);\n                  },\n                },\n                {\n                  key: "getActiveIceCandidatePair",\n                  value: function () {\n                    var a = null,\n                      b = this.iceCandidatePairs;\n                    if (b && b.length > 0) {\n                      var c = b.filter(function (a) {\n                        return (\n                          "true" === a.selected ||\n                          "true" === a.googActiveConnection ||\n                          !0 === a.selected ||\n                          !0 === a.googActiveConnection\n                        );\n                      });\n                      c.length > 0 && (a = c[0]);\n                    }\n                    return a;\n                  },\n                },\n                {\n                  key: "sendIceFailed",\n                  value: function (a) {\n                    (a.localIceCandidates = this.localIceCandidates),\n                      (a.remoteIceCandidates = this.remoteIceCandidates),\n                      (a.iceCandidatePairs = this.iceCandidatePairs),\n                      o.log("sending icefailed ", a),\n                      this.emb.make(\n                        h.internalFabricEvent.iceFailed,\n                        this.conferenceId,\n                        this.pc,\n                        a\n                      );\n                  },\n                },\n                {\n                  key: "sendFabricTransportSwitch",\n                  value: function (a) {\n                    var b = this,\n                      c = {};\n                    (c.prevIceCandidatePair = b.activeIceCandidatePair),\n                      (c.relayType = a),\n                      (c.currIceConnectionState = b.iceConnectionState),\n                      (c.prevIceConnectionState = b.oldIceConnectionState),\n                      (c.switchDelay = null),\n                      b.getStatsHandler.getIceCandidates().then(function (a) {\n                        (b.localIceCandidates = a.localIceCandidates),\n                          (b.remoteIceCandidates = a.remoteIceCandidates),\n                          (b.iceCandidatePairs = a.iceCandidatePairs),\n                          (b.activeIceCandidatePair = b.getActiveIceCandidatePair()),\n                          (c.currIceCandidatePair = b.activeIceCandidatePair),\n                          (c.localIceCandidates = b.localIceCandidates),\n                          (c.remoteIceCandidates = b.remoteIceCandidates),\n                          o.log("sending fabric transport switch ", c),\n                          ("completed" !== c.currIceConnectionState &&\n                            "connected" !== c.currIceConnectionState) ||\n                            ("completed" !== c.prevIceConnectionState &&\n                              "connected" !== c.prevIceConnectionState) ||\n                            b.emb.make(\n                              h.internalFabricEvent.fabricTransportSwitch,\n                              b.conferenceId,\n                              b.pc,\n                              c\n                            );\n                      });\n                  },\n                },\n                {\n                  key: "handleIceDisconnected",\n                  value: function (a) {\n                    var b = k.getCurrent();\n                    (this.startTime = b),\n                      (a.prevIceConnectionStateTs = this.iceConnectionStateTS),\n                      (a.currIceCandidatePair = this.activeIceCandidatePair),\n                      "connected" === a.prevIceConnectionState ||\n                      "completed" === a.prevIceConnectionState\n                        ? ((this.pcState = h.fabricState.disrupted),\n                          (this.disruptedTS = b),\n                          this.emb.make(\n                            h.internalFabricEvent.iceDisruptionStart,\n                            this.conferenceId,\n                            this.pc,\n                            a\n                          ),\n                          this.callback &&\n                            this.callback(\n                              m.csError.appConnectivityError,\n                              "Connectivity check for PC object to " +\n                                this.remoteId +\n                                " failed."\n                            ))\n                        : "checking" === a.prevIceConnectionState &&\n                          ((this.pcState = h.fabricState.checkingDisrupted),\n                          (this.connectionDisruptedTS = b),\n                          this.emb.make(\n                            h.internalFabricEvent.iceConnectionDisruptionStart,\n                            this.conferenceId,\n                            this.pc,\n                            a\n                          ),\n                          this.callback &&\n                            this.callback(\n                              m.csError.appConnectivityError,\n                              "Connectivity check for PC object to " +\n                                this.remoteId +\n                                " failed."\n                            ));\n                  },\n                },\n                {\n                  key: "handleIceClosed",\n                  value: function (a) {\n                    "new" === a.prevIceConnectionState ||\n                    "checking" === a.prevIceConnectionState\n                      ? ((a.failureDelay = k.getCurrent() - this.startTime),\n                        (a.localIceCandidates = this.localIceCandidates),\n                        (a.remoteIceCandidates = this.remoteIceCandidates),\n                        (a.iceCandidatePairs = this.iceCandidatePairs),\n                        this.emb.make(\n                          h.internalFabricEvent.iceAborted,\n                          this.conferenceId,\n                          this.pc,\n                          a\n                        ))\n                      : ("connected" !== a.prevIceConnectionState &&\n                          "completed" !== a.prevIceConnectionState) ||\n                        ((a.prevIceCandidatePair = this.activeIceCandidatePair),\n                        this.emb.make(\n                          h.internalFabricEvent.iceTerminated,\n                          this.conferenceId,\n                          this.pc,\n                          a\n                        )),\n                      (this.pcState = h.fabricState.terminated),\n                      this.stopStatsPolling();\n                  },\n                },\n                {\n                  key: "handleIceRestart",\n                  value: function (a) {\n                    (a.prevIceCandidatePair = this.prevActiveIceCandidatePair),\n                      "new" !== a.prevIceConnectionState &&\n                        (o.log("iceRestarted sending"),\n                        (this.established = !1),\n                        this.emb.make(\n                          h.internalFabricEvent.iceRestarted,\n                          this.conferenceId,\n                          this.pc,\n                          a\n                        ));\n                  },\n                },\n                {\n                  key: "pcSignalingStateChangeCallback",\n                  value: function (a) {\n                    var b = this;\n                    if (a) {\n                      var c = this.signalingState;\n                      (this.signalingState = this.pc.signalingState),\n                        o.warn(\n                          "CALLBACK: signaling state change",\n                          c,\n                          "->",\n                          this.signalingState\n                        );\n                      var d = {\n                        changedState: h.fabricStateChangeType.signalingState,\n                        prevState: c,\n                        newState: this.signalingState,\n                      };\n                      this.sendFabricStateChange(d),\n                        ("have-remote-offer" !== this.signalingState &&\n                          "stable" !== this.signalingState) ||\n                          (this.precalltest.callStarts(),\n                          this.genericevent.sendEvent(h.logEvents.log, {\n                            msg: "precalltest told to stop ",\n                          })),\n                        "closed" === this.signalingState &&\n                          (this.emb.make(\n                            h.fabricEvent.fabricTerminated,\n                            this.conferenceId,\n                            this.pc\n                          ),\n                          this.userAlive.stop(),\n                          this.precalltest.callFinished(),\n                          this.stopStatsPolling(),\n                          (this.pcState = h.fabricState.terminated)),\n                        ("have-local-offer" !== this.signalingState &&\n                          "have-local-pranswer" !== this.signalingState &&\n                          "stable" !== this.signalingState) ||\n                          (o.log(\n                            this.signalingState,\n                            ".. requesting sender config."\n                          ),\n                          i.Registry.getConfigServiceWrapper()\n                            .initiateSenderConfig(this.pc)\n                            .then(function () {\n                              var a = i.Registry.getConfigServiceWrapper().getSenderConfig();\n                              o.log("Sender config:", a);\n                              var c = h.callstatsChannels.senderConfiguration;\n                              a &&\n                                i.Registry.getEventMessageBuilder().make(\n                                  c,\n                                  b.conferenceId,\n                                  b.pc,\n                                  a\n                                );\n                            })\n                            .catch(function (a) {\n                              o.warn(a);\n                            }));\n                    }\n                  },\n                },\n                {\n                  key: "pcNegotiationNeededCallback",\n                  value: function (a) {\n                    a &&\n                      (this.negotiationNeeded++,\n                      (this.startTime = k.getCurrent()),\n                      o.warn(\n                        "CALLBACK: negotiation needed",\n                        this.negotiationNeeded\n                      ));\n                  },\n                },\n              ]),\n              a\n            );\n          })();\n        c.PcCallbackHandler = p;\n      },\n      {\n        "../config/callstatserrors": 32,\n        "../config/constants": 33,\n        "../utility/csiologger": 88,\n        "../utility/registry": 95,\n        "../utility/timestamps": 99,\n      },\n    ],\n    41: [\n      function (a, b, c) {\n        "use strict";\n        function d(a) {\n          if (a && a.__esModule) return a;\n          var b = {};\n          if (null != a)\n            for (var c in a)\n              Object.prototype.hasOwnProperty.call(a, c) && (b[c] = a[c]);\n          return (b.default = a), b;\n        }\n        function e(a, b) {\n          if (!(a instanceof b))\n            throw new TypeError("Cannot call a class as a function");\n        }\n        Object.defineProperty(c, "__esModule", {\n          value: !0,\n        }),\n          (c.PeerConnectionHandler = void 0);\n        var f = (function () {\n            function a(a, b) {\n              for (var c = 0; c < b.length; c++) {\n                var d = b[c];\n                (d.enumerable = d.enumerable || !1),\n                  (d.configurable = !0),\n                  "value" in d && (d.writable = !0),\n                  Object.defineProperty(a, d.key, d);\n              }\n            }\n            return function (b, c, d) {\n              return c && a(b.prototype, c), d && a(b, d), b;\n            };\n          })(),\n          g = a("../utility/registry"),\n          h = a("../peerconnection/pccallbackhandler"),\n          i = a("../browserapi/devices"),\n          j = a("./useralivehandler"),\n          k = a("./getstatshandler"),\n          l = a("../config/constants"),\n          m = d(l),\n          n = a("../utility/timestamps"),\n          o = d(n),\n          p = a("../utility/csiologger"),\n          q = d(p),\n          r = (function () {\n            function a(b) {\n              e(this, a),\n                (this.pc = b.pc),\n                (this.remoteId = b.remoteId),\n                (this.fabricUsage = b.fabricUsage),\n                (this.callback = b.callback),\n                (this.conferenceId = b.conferenceId),\n                (this.remoteEndpointType = b.remoteEndpointType),\n                (this.fabricTransmissionDirection =\n                  b.fabricTransmissionDirection),\n                (this.clocksync = g.Registry.getClockSync()),\n                (this.startTime = this.clocksync.getSynchronizedTimestamp()),\n                (this.credentials = g.Registry.getCredentials()),\n                (this.pcHash = this.generatePcHash()),\n                (this.ssrcMap = new Map()),\n                (this.localSdp = null),\n                (this.remoteSdp = null),\n                (this.transportInfo = null),\n                (this.userAliveHandler = new j.UserAliveHandler(\n                  this.conferenceId,\n                  this.pc\n                )),\n                this.userAliveHandler.start(),\n                (this.emb = g.Registry.getEventMessageBuilder()),\n                (this.devices = new i.Devices(this.conferenceId, this.pc));\n              var c = g.Registry.getEndpoint();\n              (this.getStatsHandler = new k.GetStatsHandler(\n                this.pc,\n                this.pcHash,\n                5e3,\n                c.getCodeBase(),\n                c.getBrowserName()\n              )),\n                (this.pcCallbackHandler = new h.PcCallbackHandler(\n                  this.conferenceId,\n                  this.pc,\n                  this.getStatsHandler,\n                  this.userAliveHandler,\n                  this.remoteId,\n                  this.callback\n                )),\n                this.devices.collectConnected(),\n                this.fabricTransmissionDirection ||\n                  (this.fabricTransmissionDirection = "sendrecv"),\n                this.remoteEndpointType || (this.remoteEndpointType = "peer");\n            }\n            return (\n              f(\n                a,\n                [\n                  {\n                    key: "getFabricTransmissionDirection",\n                    value: function () {\n                      return this.fabricTransmissionDirection;\n                    },\n                  },\n                  {\n                    key: "getRemoteEndpointType",\n                    value: function () {\n                      return this.remoteEndpointType;\n                    },\n                  },\n                  {\n                    key: "stopUserAliveHandler",\n                    value: function () {\n                      this.userAliveHandler.stop();\n                    },\n                  },\n                  {\n                    key: "getPcState",\n                    value: function () {\n                      return this.pcCallbackHandler.pcState;\n                    },\n                  },\n                  {\n                    key: "stopStatsPolling",\n                    value: function () {\n                      this.getStatsHandler.stopStatsPolling();\n                    },\n                  },\n                  {\n                    key: "startStatsPolling",\n                    value: function () {\n                      this.getStatsHandler.startStatsPolling();\n                    },\n                  },\n                  {\n                    key: "setPcState",\n                    value: function (a) {\n                      a in m.fabricState\n                        ? (this.pcCallbackHandler.pcState = a)\n                        : q.error("setPcState: Invalid state");\n                    },\n                  },\n                  {\n                    key: "getAppId",\n                    value: function () {\n                      return this.credentials.getAppId();\n                    },\n                  },\n                  {\n                    key: "getLocalId",\n                    value: function () {\n                      return this.credentials.getUserId();\n                    },\n                  },\n                  {\n                    key: "getConferenceId",\n                    value: function () {\n                      return this.conferenceId;\n                    },\n                  },\n                  {\n                    key: "getPeerConnection",\n                    value: function () {\n                      return this.pc;\n                    },\n                  },\n                  {\n                    key: "getRemoteId",\n                    value: function () {\n                      return this.remoteId;\n                    },\n                  },\n                  {\n                    key: "isFabricSetupSent",\n                    value: function () {\n                      return this.pcCallbackHandler.isFabricSetupSent();\n                    },\n                  },\n                  {\n                    key: "getStartTime",\n                    value: function () {\n                      return this.startTime;\n                    },\n                  },\n                  {\n                    key: "getCallback",\n                    value: function () {\n                      return this.callback;\n                    },\n                  },\n                  {\n                    key: "getPcHash",\n                    value: function () {\n                      return this.pcHash;\n                    },\n                  },\n                  {\n                    key: "getIceCandidates",\n                    value: function () {\n                      return this.pcCallbackHandler\n                        ? this.pcCallbackHandler.iceCandidates\n                        : null;\n                    },\n                  },\n                  {\n                    key: "getIceConnectionState",\n                    value: function () {\n                      return this.pcCallbackHandler\n                        ? this.pcCallbackHandler.iceConnectionState\n                        : null;\n                    },\n                  },\n                  {\n                    key: "getNegotiationsNumber",\n                    value: function () {\n                      return this.pcCallbackHandler\n                        ? this.pcCallbackHandler.negotiationNeeded\n                        : 0;\n                    },\n                  },\n                  {\n                    key: "sendFabricTransportSwitch",\n                    value: function (a) {\n                      this.pcCallbackHandler &&\n                        this.pcCallbackHandler.sendFabricTransportSwitch(a);\n                    },\n                  },\n                  {\n                    key: "getSdp",\n                    value: function () {\n                      return {\n                        localSdp: this.localSdp,\n                        remoteSdp: this.remoteSdp,\n                      };\n                    },\n                  },\n                  {\n                    key: "setSdp",\n                    value: function (a, b) {\n                      (this.localSdp = a), (this.remoteSdp = b);\n                    },\n                  },\n                  {\n                    key: "generatePcHash",\n                    value: function () {\n                      var a = (Math.random() + 1).toString(36);\n                      return a.substring(2, a.length);\n                    },\n                  },\n                  {\n                    key: "getTransportInfo",\n                    value: function () {\n                      return this.transportInfo;\n                    },\n                  },\n                  {\n                    key: "setTransportInfo",\n                    value: function (a) {\n                      this.transportInfo = a;\n                    },\n                  },\n                  {\n                    key: "updateSDP",\n                    value: function (a) {\n                      var b = this,\n                        c = void 0,\n                        d = void 0;\n                      if (\n                        (this.pc &&\n                          this.pc.localDescription &&\n                          (c = this.pc.localDescription.sdp),\n                        this.pc &&\n                          this.pc.remoteDescription &&\n                          (d = this.pc.remoteDescription.sdp),\n                        c && d && (c !== this.localSdp || d !== this.remoteSdp))\n                      ) {\n                        this.parseSDP(c, m.streamType.outbound),\n                          this.parseSDP(d, m.streamType.inbound);\n                        var e = {\n                          localSDP: c !== this.localSdp ? c : "",\n                          remoteSDP: d !== this.remoteSdp ? d : "",\n                        };\n                        ("" === c && "" === remoteSDP) ||\n                          !g.Registry.getCredentials().getCollectSDP() ||\n                          this.emb.make(\n                            m.internalFabricEvent.sdpSubmission,\n                            this.conferenceId,\n                            this.pc,\n                            e\n                          ),\n                          a &&\n                            a.forEach(function (a) {\n                              var c = String(a.data.ssrc),\n                                d = b.ssrcMap.get(c);\n                              d || (d = {}),\n                                (d.mediaType = a.data.mediaType),\n                                (d.reportType = a.data.isRemote\n                                  ? "remote"\n                                  : "local"),\n                                (d.ssrc = c),\n                                b.ssrcMap.set(c, d);\n                            });\n                        var f = [];\n                        this.ssrcMap.forEach(function (a, b) {\n                          a.msid && a.mslabel && a.label && f.push(a);\n                        });\n                        for (\n                          var h = {\n                              ssrcData: f,\n                            },\n                            i = 0;\n                          i < h.ssrcData.length;\n                          i += 1\n                        ) {\n                          h.ssrcData[\n                            i\n                          ].userID = g.Registry.getCredentials().getUserId();\n                        }\n                        this.emb.make(\n                          m.internalFabricEvent.ssrcMap,\n                          this.conferenceId,\n                          this.pc,\n                          h\n                        ),\n                          this.setSdp(c, d);\n                      }\n                    },\n                  },\n                  {\n                    key: "parseSDP",\n                    value: function (a, b) {\n                      var c = this,\n                        d = RegExp.prototype.test.bind(/^([a-z])=(.*)/),\n                        e = /^ssrc:(\\d*) ([\\w_]*):(.*)/,\n                        f = /^ssrc-group:SIM (\\d*)/;\n                      a.split(/(\\r\\n|\\r|\\n)/)\n                        .filter(d)\n                        .forEach(function (a) {\n                          var d = a[0],\n                            g = a.slice(2);\n                          if ("a" === d && e.test(g)) {\n                            var h = g.match(e),\n                              i = h[1],\n                              j = h[2],\n                              k = h[3],\n                              l = c.ssrcMap.get(i);\n                            if (\n                              (l || (l = {}),\n                              (l.ssrc = i),\n                              (l[j] = k),\n                              (l.localStartTime = o.getCurrent()),\n                              (l.syncedStartTime = c.clocksync.getSynchronizedTimestamp()),\n                              (l.streamType = b),\n                              !f.test(g))\n                            )\n                              return void c.ssrcMap.set(i, l);\n                            (l.ssrcGroup = {}),\n                              (l.ssrcGroup[b] = {}),\n                              (l.ssrcGroup[b].simulcastGroup = g.match(/\\d+/g)),\n                              c.ssrcMap.set(i, l);\n                          }\n                        });\n                    },\n                  },\n                  {\n                    key: "getSSRCInfo",\n                    value: function (a) {\n                      return this.ssrcMap.get(a);\n                    },\n                  },\n                  {\n                    key: "setupVideoTagMethods",\n                    value: function (a, b) {\n                      var c = this,\n                        d = document.getElementById(a);\n                      d &&\n                        ((d.oncanplay = function () {\n                          var a = {\n                            ssrc: String(b),\n                            highResTs: o.getCurrent(),\n                          };\n                          c.emb.make(\n                            m.internalFabricEvent.mediaPlaybackStart,\n                            c.conferenceId,\n                            c.pc,\n                            a\n                          );\n                        }),\n                        (d.onsuspend = function () {\n                          var a = {\n                            ssrc: String(b),\n                            highResTs: o.getCurrent(),\n                          };\n                          c.emb.make(\n                            m.internalFabricEvent.mediaPlaybackSuspended,\n                            c.conferenceId,\n                            c.pc,\n                            a\n                          );\n                        }));\n                    },\n                  },\n                  {\n                    key: "updateSSRCInfo",\n                    value: function (a, b, c, d) {\n                      var e = this.ssrcMap.get(a);\n                      e || (e = {}),\n                        (e.ssrc = a),\n                        (e.remoteUserID = b),\n                        (e.usageLabel = c),\n                        (e.associatedVideoTag = d),\n                        this.ssrcMap.set(a, e),\n                        d &&\n                          b !== this.credentials.getUserId() &&\n                          this.setupVideoTagMethods(d, a);\n                    },\n                  },\n                  {\n                    key: "updateConferenceId",\n                    value: function (a) {\n                      (this.conferenceId = a),\n                        this.userAliveHandler.updateConferenceId(a);\n                    },\n                  },\n                  {\n                    key: "updateRemoteId",\n                    value: function (a) {\n                      this.remoteId = a;\n                    },\n                  },\n                ],\n                [\n                  {\n                    key: "Builder",\n                    get: function () {\n                      return (function () {\n                        function b() {\n                          e(this, b);\n                        }\n                        return (\n                          f(b, [\n                            {\n                              key: "withPc",\n                              value: function (a) {\n                                return (this.pc = a), this;\n                              },\n                            },\n                            {\n                              key: "withRemoteId",\n                              value: function (a) {\n                                return (this.remoteId = a), this;\n                              },\n                            },\n                            {\n                              key: "withFabricUsage",\n                              value: function (a) {\n                                return (this.fabricUsage = a), this;\n                              },\n                            },\n                            {\n                              key: "withConferenceId",\n                              value: function (a) {\n                                return (this.conferenceId = a), this;\n                              },\n                            },\n                            {\n                              key: "withRemoteEndpointType",\n                              value: function (a) {\n                                return (this.remoteEndpointType = a), this;\n                              },\n                            },\n                            {\n                              key: "withFabricTransmissionDirection",\n                              value: function (a) {\n                                return (\n                                  (this.fabricTransmissionDirection = a), this\n                                );\n                              },\n                            },\n                            {\n                              key: "withCallback",\n                              value: function (a) {\n                                return (this.callback = a), this;\n                              },\n                            },\n                            {\n                              key: "make",\n                              value: function () {\n                                return new a(this);\n                              },\n                            },\n                          ]),\n                          b\n                        );\n                      })();\n                    },\n                  },\n                ]\n              ),\n              a\n            );\n          })();\n        c.PeerConnectionHandler = r;\n      },\n      {\n        "../browserapi/devices": 19,\n        "../config/constants": 33,\n        "../peerconnection/pccallbackhandler": 40,\n        "../utility/csiologger": 88,\n        "../utility/registry": 95,\n        "../utility/timestamps": 99,\n        "./getstatshandler": 39,\n        "./useralivehandler": 43,\n      },\n    ],\n    42: [\n      function (a, b, c) {\n        "use strict";\n        function d(a, b) {\n          if (!(a instanceof b))\n            throw new TypeError("Cannot call a class as a function");\n        }\n        Object.defineProperty(c, "__esModule", {\n          value: !0,\n        }),\n          (c.PeerConnectionManager = void 0);\n        var e = (function () {\n            function a(a, b) {\n              for (var c = 0; c < b.length; c++) {\n                var d = b[c];\n                (d.enumerable = d.enumerable || !1),\n                  (d.configurable = !0),\n                  "value" in d && (d.writable = !0),\n                  Object.defineProperty(a, d.key, d);\n              }\n            }\n            return function (b, c, d) {\n              return c && a(b.prototype, c), d && a(b, d), b;\n            };\n          })(),\n          f = a("./peerconnectionhandler"),\n          g = (function () {\n            function a() {\n              d(this, a), (this.pcHandlers = new Map());\n            }\n            return (\n              e(a, [\n                {\n                  key: "removePcHandler",\n                  value: function (a) {\n                    var b = this.getPcHandler(a);\n                    if (b) {\n                      var c = b.getPcHash();\n                      this.pcHandlers.delete(c);\n                    }\n                  },\n                },\n                {\n                  key: "addPcHandler",\n                  value: function (a, b, c, d, e, g, h) {\n                    if (!this.getPcHandler(a)) {\n                      var i = new f.PeerConnectionHandler.Builder()\n                        .withPc(a)\n                        .withRemoteId(b)\n                        .withFabricUsage(c)\n                        .withConferenceId(d)\n                        .withRemoteEndpointType(e)\n                        .withFabricTransmissionDirection(g)\n                        .withCallback(h)\n                        .make();\n                      this.pcHandlers.set(i.getPcHash(), i);\n                    }\n                  },\n                },\n                {\n                  key: "getPcHandler",\n                  value: function (a) {\n                    var b = null;\n                    return a\n                      ? (this.pcHandlers.forEach(function (c, d) {\n                          c && c.getPeerConnection() === a && (b = c);\n                        }),\n                        b)\n                      : b;\n                  },\n                },\n                {\n                  key: "getPcHandlerByHash",\n                  value: function (a) {\n                    return a && this.pcHandlers.has(a)\n                      ? this.pcHandlers.get(a)\n                      : null;\n                  },\n                },\n                {\n                  key: "updateConferenceId",\n                  value: function (a) {\n                    this.pcHandlers.forEach(function (b, c) {\n                      b.updateConferenceId(a);\n                    });\n                  },\n                },\n              ]),\n              a\n            );\n          })();\n        c.PeerConnectionManager = g;\n      },\n      {\n        "./peerconnectionhandler": 41,\n      },\n    ],\n    43: [\n      function (a, b, c) {\n        "use strict";\n        function d(a, b) {\n          if (!(a instanceof b))\n            throw new TypeError("Cannot call a class as a function");\n        }\n        function e(a, b) {\n          if (!a)\n            throw new ReferenceError(\n              "this hasn\'t been initialised - super() hasn\'t been called"\n            );\n          return !b || ("object" != typeof b && "function" != typeof b) ? a : b;\n        }\n        function f(a, b) {\n          if ("function" != typeof b && null !== b)\n            throw new TypeError(\n              "Super expression must either be null or a function, not " +\n                typeof b\n            );\n          (a.prototype = Object.create(b && b.prototype, {\n            constructor: {\n              value: a,\n              enumerable: !1,\n              writable: !0,\n              configurable: !0,\n            },\n          })),\n            b &&\n              (Object.setPrototypeOf\n                ? Object.setPrototypeOf(a, b)\n                : (a.__proto__ = b));\n        }\n        Object.defineProperty(c, "__esModule", {\n          value: !0,\n        }),\n          (c.UserAliveHandler = void 0);\n        var g = (function () {\n            function a(a, b) {\n              for (var c = 0; c < b.length; c++) {\n                var d = b[c];\n                (d.enumerable = d.enumerable || !1),\n                  (d.configurable = !0),\n                  "value" in d && (d.writable = !0),\n                  Object.defineProperty(a, d.key, d);\n              }\n            }\n            return function (b, c, d) {\n              return c && a(b.prototype, c), d && a(b, d), b;\n            };\n          })(),\n          h = a("../config/constants"),\n          i = (function (a) {\n            if (a && a.__esModule) return a;\n            var b = {};\n            if (null != a)\n              for (var c in a)\n                Object.prototype.hasOwnProperty.call(a, c) && (b[c] = a[c]);\n            return (b.default = a), b;\n          })(h),\n          j = a("../utility/timeoutprocess"),\n          k = a("../utility/registry"),\n          l = 1e4,\n          m = (function (a) {\n            function b(a, c) {\n              d(this, b);\n              var f = e(\n                this,\n                (b.__proto__ || Object.getPrototypeOf(b)).call(this, l)\n              );\n              return (\n                (f.emb = k.Registry.getEventMessageBuilder()),\n                (f.pc = c),\n                (f.conferenceId = a),\n                f.setCallback(f.send),\n                f\n              );\n            }\n            return (\n              f(b, a),\n              g(b, [\n                {\n                  key: "send",\n                  value: function () {\n                    this.conferenceId !== i.tmpConferenceId &&\n                      this.pc &&\n                      this.emb.make(\n                        i.internalFabricEvent.userAlive,\n                        this.conferenceId,\n                        this.pc\n                      );\n                  },\n                },\n                {\n                  key: "updateConferenceId",\n                  value: function (a) {\n                    this.conferenceId = a;\n                  },\n                },\n              ]),\n              b\n            );\n          })(j.TimeoutProcess);\n        c.UserAliveHandler = m;\n      },\n      {\n        "../config/constants": 33,\n        "../utility/registry": 95,\n        "../utility/timeoutprocess": 98,\n      },\n    ],\n    44: [\n      function (a, b, c) {\n        "use strict";\n        function d(a) {\n          if (a && a.__esModule) return a;\n          var b = {};\n          if (null != a)\n            for (var c in a)\n              Object.prototype.hasOwnProperty.call(a, c) && (b[c] = a[c]);\n          return (b.default = a), b;\n        }\n        function e(a, b) {\n          if (!(a instanceof b))\n            throw new TypeError("Cannot call a class as a function");\n        }\n        function f(a, b) {\n          if (!a)\n            throw new ReferenceError(\n              "this hasn\'t been initialised - super() hasn\'t been called"\n            );\n          return !b || ("object" != typeof b && "function" != typeof b) ? a : b;\n        }\n        function g(a, b) {\n          if ("function" != typeof b && null !== b)\n            throw new TypeError(\n              "Super expression must either be null or a function, not " +\n                typeof b\n            );\n          (a.prototype = Object.create(b && b.prototype, {\n            constructor: {\n              value: a,\n              enumerable: !1,\n              writable: !0,\n              configurable: !0,\n            },\n          })),\n            b &&\n              (Object.setPrototypeOf\n                ? Object.setPrototypeOf(a, b)\n                : (a.__proto__ = b));\n        }\n        Object.defineProperty(c, "__esModule", {\n          value: !0,\n        }),\n          (c.Authenticator = void 0);\n        var h = (function () {\n            function a(a, b) {\n              for (var c = 0; c < b.length; c++) {\n                var d = b[c];\n                (d.enumerable = d.enumerable || !1),\n                  (d.configurable = !0),\n                  "value" in d && (d.writable = !0),\n                  Object.defineProperty(a, d.key, d);\n              }\n            }\n            return function (b, c, d) {\n              return c && a(b.prototype, c), d && a(b, d), b;\n            };\n          })(),\n          i = function a(b, c, d) {\n            null === b && (b = Function.prototype);\n            var e = Object.getOwnPropertyDescriptor(b, c);\n            if (void 0 === e) {\n              var f = Object.getPrototypeOf(b);\n              return null === f ? void 0 : a(f, c, d);\n            }\n            if ("value" in e) return e.value;\n            var g = e.get;\n            if (void 0 !== g) return g.call(d);\n          },\n          j = a("./jwt/jwt"),\n          k = a("./jwt/jwttoken"),\n          l = a("../config/settings"),\n          m = d(l),\n          n = a("../utility/base64"),\n          o = d(n),\n          p = a("../config/callstatserrors"),\n          q = d(p),\n          r = a("../config/constants"),\n          s = d(r),\n          t = a("../browserapi/localstorage"),\n          u = d(t),\n          v = a("../utility/json"),\n          w = d(v),\n          x = a("./xmlhttp"),\n          y = a("./xmlhttpservice"),\n          z = a("../utility/registry"),\n          A = a("../utility/csiologger"),\n          B = d(A),\n          C = m.authRetryTimeout,\n          D = (function (a) {\n            function b() {\n              e(this, b);\n              var a = f(\n                this,\n                (b.__proto__ || Object.getPrototypeOf(b)).call(\n                  this,\n                  "Authenticator"\n                )\n              );\n              return (\n                (a.clockSync = z.Registry.getClockSync()),\n                (a.credentials = z.Registry.getCredentials()),\n                a\n              );\n            }\n            return (\n              g(b, a),\n              h(b, [\n                {\n                  key: "initiate",\n                  value: function (a, c) {\n                    var d = this;\n                    return this.inProgress\n                      ? (c && c(q.csError.authOngoing, null),\n                        new Promise(function (a, b) {\n                          b(new Error(d.name + ": in progress"));\n                        }))\n                      : this.credentials.getAppId() &&\n                        this.credentials.getUserId()\n                      ? ((this.initCallback = c),\n                        "function" == typeof a\n                          ? (this.setTokenGenerator(a),\n                            i(\n                              b.prototype.__proto__ ||\n                                Object.getPrototypeOf(b.prototype),\n                              "initiate",\n                              this\n                            ).call(this))\n                          : new Promise(function (c, e) {\n                              d.createTokenGenerator(a).then(\n                                function (a) {\n                                  d.setTokenGenerator(a),\n                                    i(\n                                      b.prototype.__proto__ ||\n                                        Object.getPrototypeOf(b.prototype),\n                                      "initiate",\n                                      d\n                                    )\n                                      .call(d)\n                                      .then(\n                                        function () {\n                                          c();\n                                        },\n                                        function (a) {\n                                          e(a);\n                                        }\n                                      );\n                                },\n                                function (a) {\n                                  e(\n                                    new Error(\n                                      d.name +\n                                        ": tokenGenerator creation problem (" +\n                                        a +\n                                        ")"\n                                    )\n                                  );\n                                }\n                              );\n                            }))\n                      : new Promise(function (a, b) {\n                          b(new Error(d.name + ": credentials not set"));\n                        });\n                  },\n                },\n                {\n                  key: "getToken",\n                  value: function () {\n                    var a = null;\n                    return this.token && (a = this.token.getToken()), a;\n                  },\n                },\n                {\n                  key: "isTokenValid",\n                  value: function () {\n                    return !!this.token && this.token.isValid(this.credentials);\n                  },\n                },\n                {\n                  key: "getElapsed",\n                  value: function () {\n                    return this.isCompleted() ? this.elapsed : null;\n                  },\n                },\n                {\n                  key: "getIceServers",\n                  value: function () {\n                    return this.iceServers;\n                  },\n                },\n                {\n                  key: "reset",\n                  value: function () {\n                    (this.token = null),\n                      (this.reauthTimer = null),\n                      (this.renew = !1),\n                      (this.credentials = null),\n                      (this.jwt = new j.Jwt()),\n                      (this.tokenGenerator = function (a, b) {\n                        b("Token generator is not set");\n                      }),\n                      (this.elapsed = 0),\n                      (this.iceServers = null),\n                      i(\n                        b.prototype.__proto__ ||\n                          Object.getPrototypeOf(b.prototype),\n                        "reset",\n                        this\n                      ).call(this);\n                  },\n                },\n                {\n                  key: "setupToken",\n                  value: function (a) {\n                    u.store("csio_auth_data", JSON.stringify(a)),\n                      (this.token = new k.JwtToken(a, this.clockSync));\n                  },\n                },\n                {\n                  key: "clearReauthTimer",\n                  value: function () {\n                    null !== this.reauthTimer &&\n                      (clearTimeout(this.reauthTimer),\n                      (this.reauthTimer = null));\n                  },\n                },\n                {\n                  key: "setupReauthTimer",\n                  value: function (a) {\n                    var b = this;\n                    b.clearReauthTimer(),\n                      (b.reauthTimer = setTimeout(function () {\n                        b.reAuthenticate();\n                      }, a));\n                  },\n                },\n                {\n                  key: "reAuthenticate",\n                  value: function () {\n                    this.inProgress ||\n                      ((this.inProgress = !0),\n                      (this.token = null),\n                      this.sendRequest());\n                  },\n                },\n                {\n                  key: "handleErrorActions",\n                  value: function (a) {\n                    if (0 !== a.length) {\n                      var b = a.shift();\n                      if (b.action === q.authErrorActions.RETRY) {\n                        var c = b.params.timeout\n                          ? b.params.timeout\n                          : m.authRetryTimeout;\n                        this.setupReauthTimer(c), this.handleErrorActions(a);\n                      }\n                      b.action === q.authErrorActions.GET_NEW_TOKEN &&\n                        ((this.renew = !0), this.handleErrorActions(a)),\n                        b.action === q.authErrorActions.REPORT_ERROR &&\n                          (B.error(this.name + ": " + b.params.errorReason),\n                          this.handleErrorActions(a));\n                    }\n                  },\n                },\n                {\n                  key: "setTokenGenerator",\n                  value: function (a) {\n                    this.tokenGenerator = a;\n                  },\n                },\n                {\n                  key: "handleResponse",\n                  value: function (a) {\n                    var b = a.getXhr(),\n                      c = a.getElapsed(),\n                      d = w.parse(b.response);\n                    if (!d)\n                      return (\n                        B.error(\n                          this.name + ": invalid authentication response"\n                        ),\n                        void this.sendNextRequest()\n                      );\n                    if (\n                      d["urn:x-callstats:auth:errorActions"] &&\n                      d["urn:x-callstats:auth:errorActions"].length > 0\n                    )\n                      return void this.handleErrorActions(\n                        d["urn:x-callstats:auth:errorActions"]\n                      );\n                    if (200 === b.status) {\n                      if ("bearer" !== d.token_type)\n                        return (\n                          B.error(\n                            this.name +\n                              ": successful, but token type was not bearer. Scheduling retry."\n                          ),\n                          void this.sendNextRequest()\n                        );\n                      this.setupToken(d.access_token),\n                        d.iceServers && (this.iceServers = d.iceServers);\n                      var e = parseInt(1e3 * parseInt(d.expires_in) * 0.9);\n                      return (\n                        this.setupReauthTimer(e),\n                        (this.renew = !1),\n                        this.initCallback &&\n                          this.initCallback(\n                            q.csError.success,\n                            s.csCallBackMessages.authSuccessful\n                          ),\n                        (this.elapsed = c),\n                        void this.completeProcess()\n                      );\n                    }\n                    B.error(\n                      "Authentication failed, but no error actions were defined in response."\n                    ),\n                      this.sendNextRequest();\n                  },\n                },\n                {\n                  key: "request",\n                  value: function () {\n                    var a = this;\n                    this.clearReauthTimer();\n                    var b = new Promise(function (b, c) {\n                      (a.tempResolve = b), (a.tempReject = c);\n                    });\n                    return (\n                      this.tokenGenerator(this.renew, function (b, c) {\n                        if (null !== b)\n                          return (\n                            a.initCallback &&\n                              a.initCallback(\n                                q.csError.tokenGenerationError,\n                                b.toString()\n                              ),\n                            a.rejectCb(\n                              new Error(a.name + ": tokenGenerationError")\n                            ),\n                            B.error("tokenGenerationError ", b),\n                            null\n                          );\n                        var d = m.authServiceUrl + "authenticate",\n                          e = {\n                            client_id:\n                              a.credentials.userId +\n                              "@" +\n                              a.credentials.getAppId(),\n                            code: c,\n                            grant_type: "authorization_code",\n                          },\n                          f = {\n                            "Content-Type": "application/x-www-form-urlencoded",\n                          };\n                        (0, x.sendPostRequest)(d, f, C, e).then(\n                          function (b) {\n                            a.tempResolve(b);\n                          },\n                          function (b) {\n                            a.tempReject(b);\n                          }\n                        );\n                      }),\n                      b\n                    );\n                  },\n                },\n                {\n                  key: "tokenGeneratorCreator",\n                  value: function (a, b) {\n                    var c = this;\n                    return function (d, e) {\n                      var f = null,\n                        g = {\n                          alg: "HS256",\n                        };\n                      if (!d && null !== f) return e(null, f);\n                      var h = c.credentials,\n                        i = {\n                          userID: h.getUserId(),\n                          appID: h.getAppId(),\n                        };\n                      b && (i.keyId = b),\n                        c.jwt\n                          .sign(g, i, a)\n                          .then(function (a) {\n                            (f = a), e(null, a);\n                          })\n                          .catch(function (a) {\n                            e(a);\n                          });\n                    };\n                  },\n                },\n                {\n                  key: "createTokenGenerator",\n                  value: function (a) {\n                    var b = this;\n                    return new Promise(function (c, d) {\n                      var e = null;\n                      a.indexOf(":") > -1 &&\n                        ((e = o.strtohex(a.split(":")[0])),\n                        (a = a.split(":")[1])),\n                        b.jwt\n                          .importKey(a)\n                          .then(function (d) {\n                            a = null;\n                            var f = b.tokenGeneratorCreator(d, e);\n                            c(f);\n                          })\n                          .catch(function (a) {\n                            B.error(\n                              b.name + ": could not import key (" + a + ")"\n                            ),\n                              d(a);\n                          });\n                    });\n                  },\n                },\n              ]),\n              b\n            );\n          })(y.XMLHttpService);\n        c.Authenticator = D;\n      },\n      {\n        "../browserapi/localstorage": 20,\n        "../config/callstatserrors": 32,\n        "../config/constants": 33,\n        "../config/settings": 34,\n        "../utility/base64": 85,\n        "../utility/csiologger": 88,\n        "../utility/json": 93,\n        "../utility/registry": 95,\n        "./jwt/jwt": 52,\n        "./jwt/jwttoken": 53,\n        "./xmlhttp": 58,\n        "./xmlhttpservice": 59,\n      },\n    ],\n    45: [\n      function (a, b, c) {\n        "use strict";\n        function d(a) {\n          if (a && a.__esModule) return a;\n          var b = {};\n          if (null != a)\n            for (var c in a)\n              Object.prototype.hasOwnProperty.call(a, c) && (b[c] = a[c]);\n          return (b.default = a), b;\n        }\n        function e(a, b) {\n          if (!(a instanceof b))\n            throw new TypeError("Cannot call a class as a function");\n        }\n        Object.defineProperty(c, "__esModule", {\n          value: !0,\n        }),\n          (c.GenericEventHandler = void 0);\n        var f = (function () {\n            function a(a, b) {\n              for (var c = 0; c < b.length; c++) {\n                var d = b[c];\n                (d.enumerable = d.enumerable || !1),\n                  (d.configurable = !0),\n                  "value" in d && (d.writable = !0),\n                  Object.defineProperty(a, d.key, d);\n              }\n            }\n            return function (b, c, d) {\n              return c && a(b.prototype, c), d && a(b, d), b;\n            };\n          })(),\n          g = a("../config/settings"),\n          h = d(g),\n          i = a("./xmlhttp"),\n          j = a("../utility/registry"),\n          k = a("../utility/csiologger"),\n          l = d(k),\n          m = (function () {\n            function a() {\n              e(this, a),\n                (this.credentials = j.Registry.getCredentials()),\n                (this.enabled = !1);\n            }\n            return (\n              f(a, [\n                {\n                  key: "enable",\n                  value: function () {\n                    this.enabled = !0;\n                  },\n                },\n                {\n                  key: "disable",\n                  value: function () {\n                    this.enabled = !1;\n                  },\n                },\n                {\n                  key: "sendEvent",\n                  value: function (a, b) {\n                    this.send(a, b)\n                      .then(function (a) {\n                        l.log("Got generic response: %o", a);\n                      })\n                      .catch(function (a) {\n                        l.log("Got error for generic request", a);\n                      });\n                  },\n                },\n                {\n                  key: "send",\n                  value: function (a, b) {\n                    if (!this.enabled)\n                      return new Promise(function (a, b) {\n                        b(new Error("GenericEvent Error: not enabled"));\n                      });\n                    var c = this;\n                    return new Promise(function (d, e) {\n                      var f = {\n                          "Content-Type": "application/json",\n                        },\n                        g = {\n                          appID: c.credentials.appId,\n                          userID: encodeURIComponent(c.credentials.userId),\n                          version: h.version,\n                          eventType: a,\n                          data: b,\n                        },\n                        j = h.baseUrl + "generics";\n                      (0, i.sendPostRequest)(j, f, 5e3, g).then(\n                        function (a) {\n                          d(a.getXhr().response);\n                        },\n                        function (a) {\n                          e(a);\n                        }\n                      );\n                    });\n                  },\n                },\n              ]),\n              a\n            );\n          })();\n        c.GenericEventHandler = m;\n      },\n      {\n        "../config/settings": 34,\n        "../utility/csiologger": 88,\n        "../utility/registry": 95,\n        "./xmlhttp": 58,\n      },\n    ],\n    46: [\n      function (a, b, c) {\n        "use strict";\n        function d(a) {\n          if (a && a.__esModule) return a;\n          var b = {};\n          if (null != a)\n            for (var c in a)\n              Object.prototype.hasOwnProperty.call(a, c) && (b[c] = a[c]);\n          return (b.default = a), b;\n        }\n        function e(a, b) {\n          if (!(a instanceof b))\n            throw new TypeError("Cannot call a class as a function");\n        }\n        function f(a, b) {\n          if (!a)\n            throw new ReferenceError(\n              "this hasn\'t been initialised - super() hasn\'t been called"\n            );\n          return !b || ("object" != typeof b && "function" != typeof b) ? a : b;\n        }\n        function g(a, b) {\n          if ("function" != typeof b && null !== b)\n            throw new TypeError(\n              "Super expression must either be null or a function, not " +\n                typeof b\n            );\n          (a.prototype = Object.create(b && b.prototype, {\n            constructor: {\n              value: a,\n              enumerable: !1,\n              writable: !0,\n              configurable: !0,\n            },\n          })),\n            b &&\n              (Object.setPrototypeOf\n                ? Object.setPrototypeOf(a, b)\n                : (a.__proto__ = b));\n        }\n        Object.defineProperty(c, "__esModule", {\n          value: !0,\n        }),\n          (c.ClockSync = void 0);\n        var h = (function () {\n            function a(a, b) {\n              for (var c = 0; c < b.length; c++) {\n                var d = b[c];\n                (d.enumerable = d.enumerable || !1),\n                  (d.configurable = !0),\n                  "value" in d && (d.writable = !0),\n                  Object.defineProperty(a, d.key, d);\n              }\n            }\n            return function (b, c, d) {\n              return c && a(b.prototype, c), d && a(b, d), b;\n            };\n          })(),\n          i = function a(b, c, d) {\n            null === b && (b = Function.prototype);\n            var e = Object.getOwnPropertyDescriptor(b, c);\n            if (void 0 === e) {\n              var f = Object.getPrototypeOf(b);\n              return null === f ? void 0 : a(f, c, d);\n            }\n            if ("value" in e) return e.value;\n            var g = e.get;\n            if (void 0 !== g) return g.call(d);\n          },\n          j = a("../config/settings"),\n          k = d(j),\n          l = a("./xmlhttp"),\n          m = a("../utility/timestamps"),\n          n = d(m),\n          o = a("./xmlhttpservice"),\n          p = a("../utility/registry"),\n          q = a("../config/constants"),\n          r = d(q),\n          s = (function (a) {\n            function b() {\n              e(this, b);\n              var a = f(\n                this,\n                (b.__proto__ || Object.getPrototypeOf(b)).call(\n                  this,\n                  "ClockSync"\n                )\n              );\n              return (a.currentOffset = 0), (a.completed = !1), a;\n            }\n            return (\n              g(b, a),\n              h(b, [\n                {\n                  key: "initiate",\n                  value: function () {\n                    return (\n                      (this.startTime = n.getCurrent()),\n                      i(\n                        b.prototype.__proto__ ||\n                          Object.getPrototypeOf(b.prototype),\n                        "initiate",\n                        this\n                      ).call(this)\n                    );\n                  },\n                },\n                {\n                  key: "getSynchronizedTimestamp",\n                  value: function () {\n                    return n.getCurrent() + this.currentOffset;\n                  },\n                },\n                {\n                  key: "getElapsed",\n                  value: function () {\n                    return this.isCompleted()\n                      ? this.endTime - this.startTime\n                      : null;\n                  },\n                },\n                {\n                  key: "getOffset",\n                  value: function () {\n                    return this.currentOffset;\n                  },\n                },\n                {\n                  key: "reset",\n                  value: function () {\n                    (this.currentOffset = 0),\n                      (this.offsetResults = []),\n                      (this.startTime = 0),\n                      (this.endTime = 0),\n                      i(\n                        b.prototype.__proto__ ||\n                          Object.getPrototypeOf(b.prototype),\n                        "reset",\n                        this\n                      ).call(this);\n                  },\n                },\n                {\n                  key: "request",\n                  value: function () {\n                    var a = k.baseUrl + "clockSync";\n                    return (0, l.sendGetRequest)(a, null, 5e3);\n                  },\n                },\n                {\n                  key: "handleResponse",\n                  value: function (a) {\n                    var b = a.getXhr(),\n                      c = a.getElapsed(),\n                      d = JSON.parse(b.response),\n                      e = n.getCurrent();\n                    this.handleMessage(d, c, e);\n                  },\n                },\n                {\n                  key: "handleMessage",\n                  value: function (a, b, c) {\n                    var d = b / 2;\n                    d > 6e4\n                      ? (this.offsetResults = [])\n                      : this.addOffset(a, d, c),\n                      this.offsetResults.length >= 5\n                        ? (this.calculateOffset(),\n                          (this.endTime = n.getCurrent()),\n                          this.completeProcess())\n                        : this.sendRequest();\n                  },\n                },\n                {\n                  key: "isCompleted",\n                  value: function () {\n                    return this.completed;\n                  },\n                },\n                {\n                  key: "addOffset",\n                  value: function (a, b, c) {\n                    var d = a.now + b,\n                      e = d - c;\n                    this.offsetResults.push(e);\n                  },\n                },\n                {\n                  key: "calculateOffset",\n                  value: function () {\n                    var a = this.offsetResults.reduce(function (a, b) {\n                      return a + b;\n                    });\n                    (this.currentOffset = a / this.offsetResults.length),\n                      (this.currentOffset = isNaN(this.currentOffset)\n                        ? 0\n                        : this.currentOffset),\n                      p.Registry.getGenericEventHandler().sendEvent(\n                        r.logEvents.log,\n                        {\n                          msg:\n                            "clockSync Done, offset is: " +\n                            this.currentOffset +\n                            "results length" +\n                            this.offsetResults.length,\n                        }\n                      ),\n                      (this.offsetResults = []),\n                      (this.completed = !0);\n                  },\n                },\n              ]),\n              b\n            );\n          })(o.XMLHttpService);\n        c.ClockSync = s;\n      },\n      {\n        "../config/constants": 33,\n        "../config/settings": 34,\n        "../utility/registry": 95,\n        "../utility/timestamps": 99,\n        "./xmlhttp": 58,\n        "./xmlhttpservice": 59,\n      },\n    ],\n    47: [\n      function (a, b, c) {\n        "use strict";\n        function d(a, b) {\n          if (!(a instanceof b))\n            throw new TypeError("Cannot call a class as a function");\n        }\n        Object.defineProperty(c, "__esModule", {\n          value: !0,\n        });\n        var e = (function () {\n            function a(a, b) {\n              for (var c = 0; c < b.length; c++) {\n                var d = b[c];\n                (d.enumerable = d.enumerable || !1),\n                  (d.configurable = !0),\n                  "value" in d && (d.writable = !0),\n                  Object.defineProperty(a, d.key, d);\n              }\n            }\n            return function (b, c, d) {\n              return c && a(b.prototype, c), d && a(b, d), b;\n            };\n          })(),\n          f = (function () {\n            function a() {\n              d(this, a),\n                (this.connected = !1),\n                (this.reconnected = !1),\n                (this.conferenceUrl = {});\n            }\n            return (\n              e(a, [\n                {\n                  key: "setup",\n                  value: function () {\n                    return new Promise(function (a, b) {\n                      a();\n                    });\n                  },\n                },\n                {\n                  key: "isReady",\n                  value: function () {\n                    return this.connected;\n                  },\n                },\n                {\n                  key: "send",\n                  value: function (a) {},\n                },\n              ]),\n              a\n            );\n          })();\n        c.CollectorConnection = f;\n      },\n      {},\n    ],\n    48: [\n      function (a, b, c) {\n        "use strict";\n        function d(a, b) {\n          if (!(a instanceof b))\n            throw new TypeError("Cannot call a class as a function");\n        }\n        function e(a, b) {\n          if (!a)\n            throw new ReferenceError(\n              "this hasn\'t been initialised - super() hasn\'t been called"\n            );\n          return !b || ("object" != typeof b && "function" != typeof b) ? a : b;\n        }\n        function f(a, b) {\n          if ("function" != typeof b && null !== b)\n            throw new TypeError(\n              "Super expression must either be null or a function, not " +\n                typeof b\n            );\n          (a.prototype = Object.create(b && b.prototype, {\n            constructor: {\n              value: a,\n              enumerable: !1,\n              writable: !0,\n              configurable: !0,\n            },\n          })),\n            b &&\n              (Object.setPrototypeOf\n                ? Object.setPrototypeOf(a, b)\n                : (a.__proto__ = b));\n        }\n        Object.defineProperty(c, "__esModule", {\n          value: !0,\n        }),\n          (c.ConfigServiceGet = void 0);\n        var g = (function () {\n            function a(a, b) {\n              for (var c = 0; c < b.length; c++) {\n                var d = b[c];\n                (d.enumerable = d.enumerable || !1),\n                  (d.configurable = !0),\n                  "value" in d && (d.writable = !0),\n                  Object.defineProperty(a, d.key, d);\n              }\n            }\n            return function (b, c, d) {\n              return c && a(b.prototype, c), d && a(b, d), b;\n            };\n          })(),\n          h = function a(b, c, d) {\n            null === b && (b = Function.prototype);\n            var e = Object.getOwnPropertyDescriptor(b, c);\n            if (void 0 === e) {\n              var f = Object.getPrototypeOf(b);\n              return null === f ? void 0 : a(f, c, d);\n            }\n            if ("value" in e) return e.value;\n            var g = e.get;\n            if (void 0 !== g) return g.call(d);\n          },\n          i = a("../xmlhttp"),\n          j = a("../xmlhttpservice"),\n          k = a("../../utility/registry"),\n          l = (function (a) {\n            function b() {\n              return (\n                d(this, b),\n                e(\n                  this,\n                  (b.__proto__ || Object.getPrototypeOf(b)).call(\n                    this,\n                    "ConfigService"\n                  )\n                )\n              );\n            }\n            return (\n              f(b, a),\n              g(b, [\n                {\n                  key: "initiate",\n                  value: function (a) {\n                    var c = this;\n                    return (\n                      (this.url = a),\n                      (this.authToken = k.Registry.getAuthenticator().getToken()),\n                      this.authToken\n                        ? h(\n                            b.prototype.__proto__ ||\n                              Object.getPrototypeOf(b.prototype),\n                            "initiate",\n                            this\n                          ).call(this)\n                        : new Promise(function (a, b) {\n                            b(\n                              new Error(c.name + ": authToken has to be string")\n                            );\n                          })\n                    );\n                  },\n                },\n                {\n                  key: "getConfig",\n                  value: function () {\n                    return this.config;\n                  },\n                },\n                {\n                  key: "getElapsed",\n                  value: function () {\n                    return this.isCompleted() ? this.elapsed : null;\n                  },\n                },\n                {\n                  key: "reset",\n                  value: function () {\n                    (this.authToken = null),\n                      (this.url = null),\n                      (this.config = null),\n                      (this.elapsed = 0),\n                      h(\n                        b.prototype.__proto__ ||\n                          Object.getPrototypeOf(b.prototype),\n                        "reset",\n                        this\n                      ).call(this);\n                  },\n                },\n                {\n                  key: "request",\n                  value: function () {\n                    var a = {\n                      Authorization: "Bearer " + this.authToken,\n                    };\n                    return (0, i.sendGetRequest)(this.url, a, 2e3);\n                  },\n                },\n                {\n                  key: "handleResponse",\n                  value: function (a) {\n                    var b = a.getXhr(),\n                      c = a.getElapsed();\n                    (this.config = JSON.parse(b.response)),\n                      (this.elapsed = c),\n                      this.completeProcess();\n                  },\n                },\n              ]),\n              b\n            );\n          })(j.XMLHttpService);\n        c.ConfigServiceGet = l;\n      },\n      {\n        "../../utility/registry": 95,\n        "../xmlhttp": 58,\n        "../xmlhttpservice": 59,\n      },\n    ],\n    49: [\n      function (a, b, c) {\n        "use strict";\n        function d(a, b) {\n          if (!(a instanceof b))\n            throw new TypeError("Cannot call a class as a function");\n        }\n        function e(a, b) {\n          if (!a)\n            throw new ReferenceError(\n              "this hasn\'t been initialised - super() hasn\'t been called"\n            );\n          return !b || ("object" != typeof b && "function" != typeof b) ? a : b;\n        }\n        function f(a, b) {\n          if ("function" != typeof b && null !== b)\n            throw new TypeError(\n              "Super expression must either be null or a function, not " +\n                typeof b\n            );\n          (a.prototype = Object.create(b && b.prototype, {\n            constructor: {\n              value: a,\n              enumerable: !1,\n              writable: !0,\n              configurable: !0,\n            },\n          })),\n            b &&\n              (Object.setPrototypeOf\n                ? Object.setPrototypeOf(a, b)\n                : (a.__proto__ = b));\n        }\n        Object.defineProperty(c, "__esModule", {\n          value: !0,\n        }),\n          (c.ConfigServicePost = void 0);\n        var g = (function () {\n            function a(a, b) {\n              for (var c = 0; c < b.length; c++) {\n                var d = b[c];\n                (d.enumerable = d.enumerable || !1),\n                  (d.configurable = !0),\n                  "value" in d && (d.writable = !0),\n                  Object.defineProperty(a, d.key, d);\n              }\n            }\n            return function (b, c, d) {\n              return c && a(b.prototype, c), d && a(b, d), b;\n            };\n          })(),\n          h = function a(b, c, d) {\n            null === b && (b = Function.prototype);\n            var e = Object.getOwnPropertyDescriptor(b, c);\n            if (void 0 === e) {\n              var f = Object.getPrototypeOf(b);\n              return null === f ? void 0 : a(f, c, d);\n            }\n            if ("value" in e) return e.value;\n            var g = e.get;\n            if (void 0 !== g) return g.call(d);\n          },\n          i = a("../xmlhttp"),\n          j = a("./configserviceget"),\n          k = (function (a) {\n            function b() {\n              return (\n                d(this, b),\n                e(this, (b.__proto__ || Object.getPrototypeOf(b)).call(this))\n              );\n            }\n            return (\n              f(b, a),\n              g(b, [\n                {\n                  key: "initiate",\n                  value: function (a, c) {\n                    return (\n                      (this.body = c),\n                      h(\n                        b.prototype.__proto__ ||\n                          Object.getPrototypeOf(b.prototype),\n                        "initiate",\n                        this\n                      ).call(this, a)\n                    );\n                  },\n                },\n                {\n                  key: "request",\n                  value: function () {\n                    var a = {\n                      Authorization: "Bearer " + this.authToken,\n                    };\n                    return (\n                      (a["Content-Type"] = "application/json"),\n                      (0, i.sendPostRequest)(this.url, a, 2e3, this.body)\n                    );\n                  },\n                },\n              ]),\n              b\n            );\n          })(j.ConfigServiceGet);\n        c.ConfigServicePost = k;\n      },\n      {\n        "../xmlhttp": 58,\n        "./configserviceget": 48,\n      },\n    ],\n    50: [\n      function (a, b, c) {\n        "use strict";\n        function d(a) {\n          if (a && a.__esModule) return a;\n          var b = {};\n          if (null != a)\n            for (var c in a)\n              Object.prototype.hasOwnProperty.call(a, c) && (b[c] = a[c]);\n          return (b.default = a), b;\n        }\n        function e(a, b) {\n          if (!(a instanceof b))\n            throw new TypeError("Cannot call a class as a function");\n        }\n        Object.defineProperty(c, "__esModule", {\n          value: !0,\n        }),\n          (c.ConfigServiceWrapper = void 0);\n        var f =\n            "function" == typeof Symbol && "symbol" == typeof Symbol.iterator\n              ? function (a) {\n                  return typeof a;\n                }\n              : function (a) {\n                  return a &&\n                    "function" == typeof Symbol &&\n                    a.constructor === Symbol &&\n                    a !== Symbol.prototype\n                    ? "symbol"\n                    : typeof a;\n                },\n          g = (function () {\n            function a(a, b) {\n              for (var c = 0; c < b.length; c++) {\n                var d = b[c];\n                (d.enumerable = d.enumerable || !1),\n                  (d.configurable = !0),\n                  "value" in d && (d.writable = !0),\n                  Object.defineProperty(a, d.key, d);\n              }\n            }\n            return function (b, c, d) {\n              return c && a(b.prototype, c), d && a(b, d), b;\n            };\n          })(),\n          h = a("./configserviceget"),\n          i = a("./configservicepost"),\n          j = a("../../config/settings"),\n          k = d(j),\n          l = a("../../utility/registry"),\n          m = a("../../utility/csiologger"),\n          n = d(m),\n          o = (function () {\n            function a() {\n              e(this, a),\n                (this.internalConfigService = new h.ConfigServiceGet()),\n                (this.appConfigService = new h.ConfigServiceGet()),\n                (this.senderConfigService = new i.ConfigServicePost()),\n                (this.defaultSenderConfig = null);\n            }\n            return (\n              g(a, [\n                {\n                  key: "initiateInternalConfig",\n                  value: function () {\n                    var a = this,\n                      b = l.Registry.getCredentials().getAppId();\n                    if (!b)\n                      return new Promise(function (b, c) {\n                        n.log("appId has to be string"),\n                          c(\n                            new Error(\n                              a.internalConfigService.name +\n                                ": appId has to be string"\n                            )\n                          );\n                      });\n                    var c = k.configServiceUrl + b;\n                    return this.internalConfigService.initiate(\n                      c + "/configurations/internal"\n                    );\n                  },\n                },\n                {\n                  key: "initiateAppConfig",\n                  value: function () {\n                    var a = this,\n                      b = l.Registry.getCredentials().getAppId();\n                    if (!b)\n                      return new Promise(function (b, c) {\n                        n.log("appId has to be string"),\n                          c(\n                            new Error(\n                              a.appConfigService.name +\n                                ": appId has to be string"\n                            )\n                          );\n                      });\n                    var c = k.configServiceUrl + b;\n                    return this.appConfigService.initiate(\n                      c + "/configurations"\n                    );\n                  },\n                },\n                {\n                  key: "initiateSenderConfig",\n                  value: function (a) {\n                    var b = this;\n                    if (this.senderConfigService.getConfig())\n                      return new Promise(function (a, c) {\n                        n.log("sender config already present"),\n                          c(\n                            new Error(\n                              b.senderConfigService.name +\n                                ": sender config already present"\n                            )\n                          );\n                      });\n                    var c = l.Registry.getCredentials().getAppId(),\n                      d = l.Registry.getCredentials().getUserId();\n                    if (!c || !d)\n                      return new Promise(function (a, c) {\n                        n.log("appId and userId have to be string"),\n                          c(\n                            new Error(\n                              b.senderConfigService.name +\n                                ": appId and userId have to be string"\n                            )\n                          );\n                      });\n                    if (\n                      ((this.defaultSenderConfig = this.getCurrentVideoSenderConfig(\n                        a\n                      )),\n                      !this.defaultSenderConfig)\n                    )\n                      return new Promise(function (a, c) {\n                        n.log("Could not obtain a sender config"),\n                          c(\n                            new Error(\n                              b.senderConfigService.name +\n                                ": Could not obtain a sender config"\n                            )\n                          );\n                      });\n                    var e = k.configServiceUrl + c,\n                      f = {\n                        app_id: c,\n                        local_id: d,\n                        rtc_rtp_parameters: this.defaultSenderConfig,\n                      };\n                    return this.senderConfigService.initiate(\n                      e + "/configurations",\n                      f\n                    );\n                  },\n                },\n                {\n                  key: "getInternalConfig",\n                  value: function () {\n                    return this.internalConfigService.getConfig();\n                  },\n                },\n                {\n                  key: "getAppDefaultConfig",\n                  value: function () {\n                    var a = this.appConfigService.getConfig(),\n                      b = {\n                        peerConnection: null,\n                        media: null,\n                      };\n                    return a.default\n                      ? (a.default.peerConnection &&\n                          (b.peerConnection = a.default.peerConnection),\n                        a.default.media && (b.media = a.default.media),\n                        b)\n                      : b;\n                  },\n                },\n                {\n                  key: "getAppRecommendedConfig",\n                  value: function () {\n                    var a = this.appConfigService.getConfig(),\n                      b = {};\n                    return a.recommended\n                      ? (a.recommended.peerConnection &&\n                          (b.peerConnection = a.recommended.peerConnection),\n                        a.recommended.media && (b.media = a.recommended.media),\n                        b)\n                      : b;\n                  },\n                },\n                {\n                  key: "getSenderConfig",\n                  value: function () {\n                    var a = this.senderConfigService.getConfig();\n                    return a && a.recommended && a.recommended.sender\n                      ? a.recommended.sender\n                      : null;\n                  },\n                },\n                {\n                  key: "getDefaultSenderConfig",\n                  value: function () {\n                    return this.defaultSenderConfig\n                      ? this.defaultSenderConfig\n                      : null;\n                  },\n                },\n                {\n                  key: "getInternalElapsed",\n                  value: function () {\n                    return this.internalConfigService.getElapsed();\n                  },\n                },\n                {\n                  key: "getAppElapsed",\n                  value: function () {\n                    return this.appConfigService.getElapsed();\n                  },\n                },\n                {\n                  key: "getSenderElapsed",\n                  value: function () {\n                    return this.senderConfigService.getElapsed();\n                  },\n                },\n                {\n                  key: "getCurrentVideoSenderConfig",\n                  value: function (a) {\n                    var b = {\n                        encodings: [\n                          {\n                            maxBitrate: 0,\n                          },\n                        ],\n                      },\n                      c = l.Registry.getConferenceManager().getConferenceForPc(\n                        a\n                      );\n                    if (!c)\n                      return (\n                        n.warn("No conference found for PC, skipping"), null\n                      );\n                    if (c.getPeerConnectionManager().pcHandlers.size > 1)\n                      return n.warn("Multiple PCs found, skipping"), null;\n                    if (!a.getSenders || "function" != typeof a.getSenders)\n                      return n.warn("Get senders error"), b;\n                    for (\n                      var d = a.getSenders(), e = void 0, g = 0;\n                      g < d.length;\n                      g += 1\n                    ) {\n                      var h = d[g];\n                      if (\n                        "object" !== (void 0 === h ? "undefined" : f(h)) ||\n                        !h.track ||\n                        "object" !== f(h.track) ||\n                        !h.track.kind\n                      )\n                        return n.warn("Access senders error"), null;\n                      if ("video" === h.track.kind) {\n                        if (e)\n                          return (\n                            n.warn("Multiple video sender, skipping"), null\n                          );\n                        e = h;\n                      }\n                    }\n                    if (!e) return n.warn("No video sender found"), null;\n                    if (\n                      !e.getParameters ||\n                      "function" != typeof e.getParameters\n                    )\n                      return n.warn("Sender getParameters error"), b;\n                    var i = e.getParameters();\n                    return "object" !== (void 0 === i ? "undefined" : f(i))\n                      ? null\n                      : ("encodings" in i || (i.encodings = []),\n                        0 === i.encodings.length &&\n                          i.encodings.push({\n                            maxBitrate: 0,\n                          }),\n                        i);\n                  },\n                },\n              ]),\n              a\n            );\n          })();\n        c.ConfigServiceWrapper = o;\n      },\n      {\n        "../../config/settings": 34,\n        "../../utility/csiologger": 88,\n        "../../utility/registry": 95,\n        "./configserviceget": 48,\n        "./configservicepost": 49,\n      },\n    ],\n    51: [\n      function (a, b, c) {\n        "use strict";\n        function d(a, b) {\n          if (!(a instanceof b))\n            throw new TypeError("Cannot call a class as a function");\n        }\n        Object.defineProperty(c, "__esModule", {\n          value: !0,\n        }),\n          (c.ConnectionManager = void 0);\n        var e = (function () {\n            function a(a, b) {\n              for (var c = 0; c < b.length; c++) {\n                var d = b[c];\n                (d.enumerable = d.enumerable || !1),\n                  (d.configurable = !0),\n                  "value" in d && (d.writable = !0),\n                  Object.defineProperty(a, d.key, d);\n              }\n            }\n            return function (b, c, d) {\n              return c && a(b.prototype, c), d && a(b, d), b;\n            };\n          })(),\n          f = a("../config/constants"),\n          g = (function (a) {\n            if (a && a.__esModule) return a;\n            var b = {};\n            if (null != a)\n              for (var c in a)\n                Object.prototype.hasOwnProperty.call(a, c) && (b[c] = a[c]);\n            return (b.default = a), b;\n          })(f),\n          h = a("./wscollectorconnection"),\n          i = a("./restcollectorconnection"),\n          j = a("../utility/registry"),\n          k = (function () {\n            function a() {\n              d(this, a), (this.connection = null);\n            }\n            return (\n              e(a, [\n                {\n                  key: "setupCollectorConnection",\n                  value: function (a) {\n                    a === g.transportType.rest\n                      ? (this.connection = new i.RestCollectorConnection())\n                      : (this.connection = new h.WsCollectorConnection());\n                  },\n                },\n                {\n                  key: "setup",\n                  value: function () {\n                    return this.connection\n                      ? this.connection.setup()\n                      : new Promise(function (a, b) {\n                          b();\n                        });\n                  },\n                },\n                {\n                  key: "isReady",\n                  value: function () {\n                    return !!this.connection && this.connection.isReady();\n                  },\n                },\n                {\n                  key: "send",\n                  value: function (a) {\n                    if (!this.connection)\n                      return void j.Registry.getGenericEventHandler().sendEvent(\n                        g.logEvents.error,\n                        {\n                          msg: "Connection not available to the collector",\n                        }\n                      );\n                    this.connection.send(a);\n                  },\n                },\n              ]),\n              a\n            );\n          })();\n        c.ConnectionManager = k;\n      },\n      {\n        "../config/constants": 33,\n        "../utility/registry": 95,\n        "./restcollectorconnection": 54,\n        "./wscollectorconnection": 57,\n      },\n    ],\n    52: [\n      function (a, b, c) {\n        "use strict";\n        function d(a) {\n          if (a && a.__esModule) return a;\n          var b = {};\n          if (null != a)\n            for (var c in a)\n              Object.prototype.hasOwnProperty.call(a, c) && (b[c] = a[c]);\n          return (b.default = a), b;\n        }\n        function e(a, b) {\n          if (!(a instanceof b))\n            throw new TypeError("Cannot call a class as a function");\n        }\n        Object.defineProperty(c, "__esModule", {\n          value: !0,\n        }),\n          (c.Jwt = void 0);\n        var f = (function () {\n            function a(a, b) {\n              for (var c = 0; c < b.length; c++) {\n                var d = b[c];\n                (d.enumerable = d.enumerable || !1),\n                  (d.configurable = !0),\n                  "value" in d && (d.writable = !0),\n                  Object.defineProperty(a, d.key, d);\n              }\n            }\n            return function (b, c, d) {\n              return c && a(b.prototype, c), d && a(b, d), b;\n            };\n          })(),\n          g = a("../../utility/base64"),\n          h = d(g),\n          i = a("../../utility/csiologger"),\n          j = d(i),\n          k = a("../../utility/registry"),\n          l = a("../../config/constants"),\n          m = d(l),\n          n = (function () {\n            function a() {\n              e(this, a),\n                (this.cryptotype = null),\n                window.crypto && window.crypto.subtle\n                  ? ((this.cryptotype = "standard"),\n                    (this.subtlecrypto = window.crypto.subtle))\n                  : window.crypto &&\n                    !window.crypto.subtle &&\n                    window.crypto.webkitSubtle\n                  ? ((this.cryptotype = "webkit"),\n                    (this.subtlecrypto = window.crypto.webkitSubtle))\n                  : window.msCrypto && window.msCrypto.subtle\n                  ? ((this.cryptotype = "ie"),\n                    (this.subtlecrypto = window.msCrypto.subtle))\n                  : ((this.subtlecrypto = null),\n                    j.info(\n                      "WebCryptography API not supported in this browser."\n                    )),\n                (this.browserName = k.Registry.getEndpoint().getBrowserName());\n            }\n            return (\n              f(a, [\n                {\n                  key: "sign",\n                  value: function (a, b, c) {\n                    var d = this;\n                    return new Promise(function (e, f) {\n                      "HS256" !== a.alg && f("Use header.alg=HS256"),\n                        (a = JSON.stringify(a)),\n                        "string" != typeof b && (b = JSON.stringify(b));\n                      var g =\n                        h.urlencodeUnicode(a) + "." + h.urlencodeUnicode(b);\n                      window.csioReactNative &&\n                        window.csiosign(g, c, function (a, b) {\n                          if (a)\n                            return j.log("Token sign error", a), void f(error);\n                          e(b);\n                        });\n                      var i = new ArrayBuffer(g.length),\n                        k = new Uint8Array(i),\n                        l = {\n                          name: "HMAC",\n                        };\n                      ("ie" !== d.cryptotype &&\n                        "webkit" !== d.cryptotype &&\n                        d.browserName !== m.browserName.edge) ||\n                        (l.hash = {\n                          name: "sha-256",\n                        });\n                      for (var n = g.length - 1; n >= 0; n--)\n                        k[n] = g.charCodeAt(n);\n                      var o = d.subtlecrypto.sign(l, c, k);\n                      "ie" === d.cryptotype\n                        ? ((o.onerror = f),\n                          (o.oncomplete = function (a) {\n                            (g = d.buildToken(a.target.result, g)), e(g);\n                          }))\n                        : o\n                            .then(function (a) {\n                              (g = d.buildToken(a, g)), e(g);\n                            })\n                            .catch(function (a) {\n                              f(a);\n                            });\n                    });\n                  },\n                },\n                {\n                  key: "buildToken",\n                  value: function (a, b) {\n                    for (\n                      var c = "",\n                        d = new Uint8Array(a),\n                        e = d.byteLength,\n                        f = 0;\n                      f < e;\n                      f++\n                    )\n                      c += String.fromCharCode(d[f]);\n                    return (b += "." + h.urlencode(c));\n                  },\n                },\n                {\n                  key: "decode",\n                  value: function (a) {\n                    try {\n                      var b = a.split(".")[1],\n                        c = h.decode(b);\n                      return JSON.parse(c);\n                    } catch (a) {\n                      return j.error("Could not decode token. "), null;\n                    }\n                  },\n                },\n                {\n                  key: "importKey",\n                  value: function (a) {\n                    var b = this;\n                    return new Promise(function (c, d) {\n                      if (window.csioReactNative) return void c(a);\n                      if ("webkit" === b.cryptotype)\n                        for (; a.length < 32; ) a += "\\0";\n                      var e = {\n                          kty: "oct",\n                          k: h.urlencode(a),\n                          alg: "HS256",\n                        },\n                        f = {\n                          name: "HMAC",\n                          hash: {\n                            name: "SHA-256",\n                          },\n                        };\n                      if (\n                        ("ie" === b.cryptotype\n                          ? (e.extractable = !1)\n                          : (e.ext = !1),\n                        "webkit" === b.cryptotype &&\n                          ((f = null), (e.use = "sig")),\n                        "ie" === b.cryptotype || "webkit" === b.cryptotype)\n                      ) {\n                        var g = JSON.stringify(e);\n                        e = new Uint8Array(g.length);\n                        for (var i = 0; i < g.length; i++)\n                          e[i] = g.charCodeAt(i);\n                      }\n                      var j = b.subtlecrypto.importKey("jwk", e, f, !1, [\n                        "sign",\n                      ]);\n                      "ie" === b.cryptotype\n                        ? ((j.onerror = d),\n                          (j.oncomplete = function (a) {\n                            c(a.target.result);\n                          }))\n                        : j.then(c).catch(d);\n                    });\n                  },\n                },\n              ]),\n              a\n            );\n          })();\n        c.Jwt = n;\n      },\n      {\n        "../../config/constants": 33,\n        "../../utility/base64": 85,\n        "../../utility/csiologger": 88,\n        "../../utility/registry": 95,\n      },\n    ],\n    53: [\n      function (a, b, c) {\n        "use strict";\n        function d(a) {\n          if (a && a.__esModule) return a;\n          var b = {};\n          if (null != a)\n            for (var c in a)\n              Object.prototype.hasOwnProperty.call(a, c) && (b[c] = a[c]);\n          return (b.default = a), b;\n        }\n        function e(a, b) {\n          if (!(a instanceof b))\n            throw new TypeError("Cannot call a class as a function");\n        }\n        Object.defineProperty(c, "__esModule", {\n          value: !0,\n        }),\n          (c.JwtToken = void 0);\n        var f = (function () {\n            function a(a, b) {\n              for (var c = 0; c < b.length; c++) {\n                var d = b[c];\n                (d.enumerable = d.enumerable || !1),\n                  (d.configurable = !0),\n                  "value" in d && (d.writable = !0),\n                  Object.defineProperty(a, d.key, d);\n              }\n            }\n            return function (b, c, d) {\n              return c && a(b.prototype, c), d && a(b, d), b;\n            };\n          })(),\n          g = a("./jwt"),\n          h = a("../../utility/registry"),\n          i = a("../../config/constants"),\n          j = d(i),\n          k = a("../../utility/csiologger"),\n          l = d(k),\n          m = (function () {\n            function a(b) {\n              e(this, a),\n                (this.token = b),\n                (this.statsSubmissionInterval = 15e3),\n                (this.collectSDP = !1),\n                (this.appId = null),\n                (this.userId = null),\n                (this.tokenPayload = null),\n                (this.jwt = new g.Jwt()),\n                (this.expires = null),\n                (this.clockSync = h.Registry.getClockSync()),\n                (this.adaptiveInterval = !1),\n                (this.transportType = j.transportType.rest),\n                this.setupTokenPayload(),\n                (this.restApiTransport = !1);\n            }\n            return (\n              f(a, [\n                {\n                  key: "getToken",\n                  value: function () {\n                    return this.token;\n                  },\n                },\n                {\n                  key: "setupTokenPayload",\n                  value: function () {\n                    var a = this.jwt.decode(this.token);\n                    if (\n                      ((this.statsSubmissionInterval = parseInt(\n                        a.submissionInterval,\n                        10\n                      )),\n                      (this.collectSDP = a.collectSDP),\n                      (this.adaptiveInterval = a.adaptiveInterval),\n                      (this.appId = a.appID),\n                      (this.userId = a.userID),\n                      (this.restApiTransport = a.restApiTransport),\n                      navigator.mozGetUserMedia)\n                    ) {\n                      var b = a.expiry.split(" ").join("T");\n                      this.expires = Date.parse(b);\n                    } else this.expires = new Date(a.expiry);\n                    this.restApiTransport\n                      ? (this.transportType = j.transportType.rest)\n                      : (this.transportType = j.transportType.ws),\n                      l.info(\n                        "transportType is ",\n                        this.transportType,\n                        this.restApiTransport\n                      ),\n                      h.Registry.getCredentials().setStatsSubmissionInterval(\n                        this.statsSubmissionInterval\n                      ),\n                      h.Registry.getCredentials().setCollectSDP(\n                        this.collectSDP\n                      ),\n                      h.Registry.getCredentials().setTransportType(\n                        this.transportType\n                      ),\n                      h.Registry.getCredentials().setAdaptiveInterval(\n                        this.adaptiveInterval\n                      );\n                  },\n                },\n                {\n                  key: "isValid",\n                  value: function (a) {\n                    var b = this,\n                      c = !1;\n                    if (\n                      null !== b.token &&\n                      b.appId === a.appId &&\n                      b.userId === encodeURIComponent(a.userId)\n                    ) {\n                      new Date(this.clockSync.getSynchronizedTimestamp()) <\n                        b.expires && (c = !0);\n                    }\n                    return c;\n                  },\n                },\n              ]),\n              a\n            );\n          })();\n        c.JwtToken = m;\n      },\n      {\n        "../../config/constants": 33,\n        "../../utility/csiologger": 88,\n        "../../utility/registry": 95,\n        "./jwt": 52,\n      },\n    ],\n    54: [\n      function (a, b, c) {\n        "use strict";\n        function d(a) {\n          if (a && a.__esModule) return a;\n          var b = {};\n          if (null != a)\n            for (var c in a)\n              Object.prototype.hasOwnProperty.call(a, c) && (b[c] = a[c]);\n          return (b.default = a), b;\n        }\n        function e(a, b) {\n          if (!(a instanceof b))\n            throw new TypeError("Cannot call a class as a function");\n        }\n        function f(a, b) {\n          if (!a)\n            throw new ReferenceError(\n              "this hasn\'t been initialised - super() hasn\'t been called"\n            );\n          return !b || ("object" != typeof b && "function" != typeof b) ? a : b;\n        }\n        function g(a, b) {\n          if ("function" != typeof b && null !== b)\n            throw new TypeError(\n              "Super expression must either be null or a function, not " +\n                typeof b\n            );\n          (a.prototype = Object.create(b && b.prototype, {\n            constructor: {\n              value: a,\n              enumerable: !1,\n              writable: !0,\n              configurable: !0,\n            },\n          })),\n            b &&\n              (Object.setPrototypeOf\n                ? Object.setPrototypeOf(a, b)\n                : (a.__proto__ = b));\n        }\n        Object.defineProperty(c, "__esModule", {\n          value: !0,\n        }),\n          (c.RestCollectorConnection = void 0);\n        var h = (function () {\n            function a(a, b) {\n              for (var c = 0; c < b.length; c++) {\n                var d = b[c];\n                (d.enumerable = d.enumerable || !1),\n                  (d.configurable = !0),\n                  "value" in d && (d.writable = !0),\n                  Object.defineProperty(a, d.key, d);\n              }\n            }\n            return function (b, c, d) {\n              return c && a(b.prototype, c), d && a(b, d), b;\n            };\n          })(),\n          i = a("../utility/registry"),\n          j = a("./xmlhttp"),\n          k = a("./collectorconnection"),\n          l = a("./restrelays"),\n          m = a("../config/constants"),\n          n = d(m),\n          o = a("../utility/csiologger"),\n          p = d(o),\n          q = (function (a) {\n            function b() {\n              e(this, b);\n              var a = f(\n                this,\n                (b.__proto__ || Object.getPrototypeOf(b)).call(this)\n              );\n              return (a.relays = new l.RestRelays()), a;\n            }\n            return (\n              g(b, a),\n              h(b, [\n                {\n                  key: "isReady",\n                  value: function () {\n                    return !0;\n                  },\n                },\n                {\n                  key: "send",\n                  value: function (a) {\n                    var b = {\n                        "Content-Type": "application/json",\n                        Authorization:\n                          "Bearer " + i.Registry.getAuthenticator().getToken(),\n                      },\n                      c = a.eventType,\n                      d = a.confID,\n                      e = a.ucID,\n                      f = this.relays,\n                      g = f.getRequestUrl(c, d, e);\n                    if (!g)\n                      return void p.warn("No action for message type: " + c);\n                    var h = this.getMessage(c, a);\n                    p.log("sending ", g, a),\n                      (0, j.sendPostRequest)(g, b, 5e3, h).then(\n                        function (b) {\n                          if (!b || !b.xhr)\n                            return void p.log("Response for request is null");\n                          var e = JSON.parse(b.xhr.response);\n                          e &&\n                            "success" !== e.status &&\n                            (i.Registry.getGenericEventHandler().sendEvent(\n                              n.logEvents.restResponseError,\n                              {\n                                msg:\n                                  "response failure " +\n                                  d +\n                                  ":" +\n                                  c +\n                                  ":" +\n                                  e.msg +\n                                  ":" +\n                                  e.status +\n                                  JSON.stringify(a),\n                              }\n                            ),\n                            p.error("Response error:", e.msg, a)),\n                            f.handleResponse(c, e, d);\n                        },\n                        function (a) {\n                          p.error(a);\n                        }\n                      );\n                  },\n                },\n                {\n                  key: "getMessage",\n                  value: function (a, b) {\n                    delete b.confID,\n                      delete b.channel,\n                      delete b.token,\n                      delete b.appID,\n                      delete b.action,\n                      delete b.ucID,\n                      delete b.version,\n                      delete b.timeShift;\n                    var c = decodeURIComponent(b.localID);\n                    b.localID = c;\n                    var d = decodeURIComponent(b.remoteID);\n                    return (\n                      (b.remoteID = d),\n                      a === n.callstatsChannels.processedStats &&\n                        (b.eventType = "stats"),\n                      b\n                    );\n                  },\n                },\n              ]),\n              b\n            );\n          })(k.CollectorConnection);\n        c.RestCollectorConnection = q;\n      },\n      {\n        "../config/constants": 33,\n        "../utility/csiologger": 88,\n        "../utility/registry": 95,\n        "./collectorconnection": 47,\n        "./restrelays": 55,\n        "./xmlhttp": 58,\n      },\n    ],\n    55: [\n      function (a, b, c) {\n        "use strict";\n        function d(a) {\n          if (a && a.__esModule) return a;\n          var b = {};\n          if (null != a)\n            for (var c in a)\n              Object.prototype.hasOwnProperty.call(a, c) && (b[c] = a[c]);\n          return (b.default = a), b;\n        }\n        function e(a, b) {\n          if (!(a instanceof b))\n            throw new TypeError("Cannot call a class as a function");\n        }\n        function f() {\n          var a =\n              arguments.length > 0 && void 0 !== arguments[0]\n                ? arguments[0]\n                : null,\n            b =\n              arguments.length > 1 && void 0 !== arguments[1]\n                ? arguments[1]\n                : null;\n          return function (c, d, e) {\n            "success" === c.status ? a && a(c, d) : b && b(c);\n          };\n        }\n        function g(a) {\n          var b = f();\n          return new Map([\n            [\n              j.fabricEvent.fabricTerminated,\n              new r(l.restEventUrl, "/events/fabric/terminated", b),\n            ],\n            [\n              j.fabricEvent.audioMute,\n              new r(l.restEventUrl, "/events/media/actions", b),\n            ],\n            [\n              j.fabricEvent.audioUnmute,\n              new r(l.restEventUrl, "/events/media/actions", b),\n            ],\n            [\n              j.fabricEvent.videoPause,\n              new r(l.restEventUrl, "/events/media/actions", b),\n            ],\n            [\n              j.fabricEvent.videoResume,\n              new r(l.restEventUrl, "/events/media/actions", b),\n            ],\n            [\n              j.fabricEvent.screenShareStart,\n              new r(l.restEventUrl, "/events/media/actions", b),\n            ],\n            [\n              j.fabricEvent.screenShareStop,\n              new r(l.restEventUrl, "/events/media/actions", b),\n            ],\n            [\n              j.fabricEvent.activeDeviceList,\n              new r(l.restEventUrl, "/events/devices/list", b),\n            ],\n            [\n              j.fabricEvent.applicationErrorLog,\n              new r(l.restEventUrl, "/events/app/logs", b),\n            ],\n            [\n              j.fabricEvent.dominantSpeaker,\n              new r(l.restEventUrl, "/events/dominantspeaker", b),\n            ],\n            [\n              j.fabricEvent.fabricHold,\n              new r(l.restEventUrl, "/events/fabric/actions", b),\n            ],\n            [\n              j.fabricEvent.fabricResume,\n              new r(l.restEventUrl, "/events/fabric/actions", b),\n            ],\n            [\n              j.internalFabricEvent.fabricSetup,\n              new r(l.restEventUrl, "/events/fabric/setup", b),\n            ],\n            [\n              j.fabricEvent.fabricSetupFailed,\n              new r(l.restEventUrl, "/events/fabric/setupfailed", b),\n            ],\n            [\n              j.internalFabricEvent.userJoined,\n              new r(\n                l.restEventUrl,\n                "",\n                f(function (a, b) {\n                  b = decodeURIComponent(b);\n                  var c = m.Registry.getConferenceManager().get(b);\n                  c &&\n                    (p.log("UcId is - ", a.ucID, b),\n                    c.setUcId(a.ucID),\n                    m.Registry.getTransmissionManager().trySend());\n                })\n              ),\n            ],\n            [\n              j.internalFabricEvent.userLeft,\n              new r(l.restEventUrl, "/events/user/left", b),\n            ],\n            [\n              j.internalFabricEvent.userAlive,\n              new r(l.restEventUrl, "/events/user/alive", b),\n            ],\n            [\n              j.internalFabricEvent.fabricTransportSwitch,\n              new r(l.restEventUrl, "/events/fabric/transportchange", b),\n            ],\n            [\n              j.internalFabricEvent.mediaPlaybackStart,\n              new r(l.restEventUrl, "/events/media/pipeline", b),\n            ],\n            [\n              j.internalFabricEvent.mediaPlaybackSuspended,\n              new r(l.restEventUrl, "/events/media/pipeline", b),\n            ],\n            [\n              j.internalFabricEvent.mediaPlaybackStalled,\n              new r(l.restEventUrl, "/events/media/pipeline", b),\n            ],\n            [\n              j.internalFabricEvent.ssrcMap,\n              new r(l.restEventUrl, "/events/ssrcmap", b),\n            ],\n            [\n              j.internalFabricEvent.connectedDeviceList,\n              new r(l.restEventUrl, "/events/devices/list", b),\n            ],\n            [\n              j.internalFabricEvent.sdpSubmission,\n              new r(l.restEventUrl, "/events/sdp", b),\n            ],\n            [\n              j.internalFabricEvent.iceDisruptionStart,\n              new r(l.restEventUrl, "/events/ice/status", b),\n            ],\n            [\n              j.internalFabricEvent.iceDisruptionEnd,\n              new r(l.restEventUrl, "/events/ice/status", b),\n            ],\n            [\n              j.internalFabricEvent.iceConnectionDisruptionStart,\n              new r(l.restEventUrl, "/events/ice/status", b),\n            ],\n            [\n              j.internalFabricEvent.iceConnectionDisruptionEnd,\n              new r(l.restEventUrl, "/events/ice/status", b),\n            ],\n            [\n              j.internalFabricEvent.iceAborted,\n              new r(l.restEventUrl, "/events/ice/status", b),\n            ],\n            [\n              j.internalFabricEvent.iceTerminated,\n              new r(l.restEventUrl, "/events/ice/status", b),\n            ],\n            [\n              j.internalFabricEvent.iceFailed,\n              new r(l.restEventUrl, "/events/ice/status", b),\n            ],\n            [\n              j.internalFabricEvent.iceRestarted,\n              new r(l.restEventUrl, "/events/ice/status", b),\n            ],\n            [\n              j.internalFabricEvent.fabricDropped,\n              new r(l.restEventUrl, "/events/fabric/status", b),\n            ],\n            [\n              j.callstatsChannels.processedStats,\n              new r(l.restStatsUrl, "/stats", b),\n            ],\n            [\n              j.internalFabricEvent.fabricStateChange,\n              new r(l.restEventUrl, "/events/fabric/statechange", b),\n            ],\n            [\n              j.callstatsChannels.userFeedback,\n              new r(l.restEventUrl, "/events/feedback", b),\n            ],\n            [\n              j.precalltestEvents.results,\n              new r(l.restEventUrl, "/events/precall", b),\n            ],\n            [\n              j.precalltestEvents.associate,\n              new r(l.restEventUrl, "/events/precall", b),\n            ],\n            [\n              j.internalFabricEvent.userDetails,\n              new r(l.restEventUrl, "/events/userdetails", b),\n            ],\n          ]);\n        }\n        Object.defineProperty(c, "__esModule", {\n          value: !0,\n        }),\n          (c.RestRelays = void 0);\n        var h = (function () {\n            function a(a, b) {\n              for (var c = 0; c < b.length; c++) {\n                var d = b[c];\n                (d.enumerable = d.enumerable || !1),\n                  (d.configurable = !0),\n                  "value" in d && (d.writable = !0),\n                  Object.defineProperty(a, d.key, d);\n              }\n            }\n            return function (b, c, d) {\n              return c && a(b.prototype, c), d && a(b, d), b;\n            };\n          })(),\n          i = a("../config/constants"),\n          j = d(i),\n          k = a("../config/settings"),\n          l = d(k),\n          m = a("../utility/registry"),\n          n = a("../utility/url"),\n          o = a("../utility/csiologger"),\n          p = d(o),\n          q = (function () {\n            function a() {\n              e(this, a), (this.items = g());\n            }\n            return (\n              h(a, [\n                {\n                  key: "getRequestUrl",\n                  value: function (a, b, c) {\n                    return this.items.has(a)\n                      ? this.items.get(a).getRequestUrl(a, b, c)\n                      : (p.warn("EventType Unsupported ", a), null);\n                  },\n                },\n                {\n                  key: "handleResponse",\n                  value: function (a, b, c) {\n                    if (!this.items.has(a))\n                      return void p.warn(\n                        "No response handler for event type " + a\n                      );\n                    this.items.get(a).handleResponse(b, c, a);\n                  },\n                },\n              ]),\n              a\n            );\n          })(),\n          r = (function () {\n            function a(b, c) {\n              var d =\n                arguments.length > 2 && void 0 !== arguments[2]\n                  ? arguments[2]\n                  : null;\n              e(this, a),\n                (this.baseUrl = b),\n                (this.urlAppendix = c),\n                (this.responseHandler = d);\n            }\n            return (\n              h(a, [\n                {\n                  key: "getRequestUrl",\n                  value: function (a, b, c) {\n                    return (\n                      this.makeRequestUrl(a, b, c), this.requestUrl.toString()\n                    );\n                  },\n                },\n                {\n                  key: "makeRequestUrl",\n                  value: function (a, b, c) {\n                    a === j.precalltestEvents.results\n                      ? (this.requestUrl = new n.Url(\n                          this.baseUrl,\n                          m.Registry.getCredentials().getAppId(),\n                          this.urlAppendix\n                        ))\n                      : (a === j.internalFabricEvent.userJoined &&\n                          c &&\n                          (c = ""),\n                        (this.requestUrl = new n.Url(\n                          this.baseUrl,\n                          m.Registry.getCredentials().getAppId() +\n                            "/conferences/" +\n                            b,\n                          c,\n                          this.urlAppendix\n                        )));\n                  },\n                },\n                {\n                  key: "handleResponse",\n                  value: function (a, b, c) {\n                    this.responseHandler(a, b, c);\n                  },\n                },\n              ]),\n              a\n            );\n          })();\n        c.RestRelays = q;\n      },\n      {\n        "../config/constants": 33,\n        "../config/settings": 34,\n        "../utility/csiologger": 88,\n        "../utility/registry": 95,\n        "../utility/url": 100,\n      },\n    ],\n    56: [\n      function (a, b, c) {\n        "use strict";\n        function d(a) {\n          if (a && a.__esModule) return a;\n          var b = {};\n          if (null != a)\n            for (var c in a)\n              Object.prototype.hasOwnProperty.call(a, c) && (b[c] = a[c]);\n          return (b.default = a), b;\n        }\n        function e(a, b) {\n          if (!(a instanceof b))\n            throw new TypeError("Cannot call a class as a function");\n        }\n        Object.defineProperty(c, "__esModule", {\n          value: !0,\n        }),\n          (c.TransmissionManager = void 0);\n        var f = (function () {\n            function a(a, b) {\n              for (var c = 0; c < b.length; c++) {\n                var d = b[c];\n                (d.enumerable = d.enumerable || !1),\n                  (d.configurable = !0),\n                  "value" in d && (d.writable = !0),\n                  Object.defineProperty(a, d.key, d);\n              }\n            }\n            return function (b, c, d) {\n              return c && a(b.prototype, c), d && a(b, d), b;\n            };\n          })(),\n          g = a("../utility/timestamps"),\n          h = d(g),\n          i = a("../collections/cache"),\n          j = a("../utility/registry"),\n          k = a("../config/constants"),\n          l = d(k),\n          m = a("../utility/csiologger"),\n          n = d(m),\n          o = (function () {\n            function a() {\n              e(this, a),\n                (this.cache = []),\n                (this.connectionManager = j.Registry.getConnectionManager()),\n                (this.lastTS = 0),\n                (this.timerStarted = !1);\n            }\n            return (\n              f(a, [\n                {\n                  key: "send",\n                  value: function (a) {\n                    (a.isCachable() || a.canBeSent()) &&\n                      (this.cache[a.getConferenceId()] ||\n                        (this.cache[a.getConferenceId()] = new i.Cache()),\n                      this.cache[a.getConferenceId()].add(a, a.isPriority()),\n                      this.trySend());\n                  },\n                },\n                {\n                  key: "trySend",\n                  value: function () {\n                    if (!this.connectionManager.isReady())\n                      return void this.setupConnection();\n                    if (!this.timerStarted)\n                      return this.timeToSend()\n                        ? void (this.sendMessage() && this.startTimer())\n                        : void (this.getCacheLength() > 0 && this.startTimer());\n                  },\n                },\n                {\n                  key: "setupConnection",\n                  value: function () {\n                    this.connectionManager\n                      .setup()\n                      .then(function () {\n                        n.log("Connected to connectionManager");\n                      })\n                      .catch(function (a) {\n                        return n.log(\n                          "Could not connect to connectionManager",\n                          a\n                        );\n                      });\n                  },\n                },\n                {\n                  key: "sendMessage",\n                  value: function () {\n                    var a = void 0,\n                      b = void 0;\n                    if (0 === this.getCacheLength()) return !1;\n                    for (var c in this.cache)\n                      if (\n                        this.cache.hasOwnProperty(c) &&\n                        ((b = c), (a = this.cache[b].peak()) && a.canBeSent())\n                      )\n                        break;\n                    return (\n                      !(!a || !a.canBeSent()) &&\n                      (n.log(\n                        "sending message type :",\n                        a.toJson().action,\n                        a.toJson()\n                      ),\n                      (a = this.cache[b].pop()),\n                      (this.lastTS = h.getCurrent()),\n                      this.connectionManager.send(a.toJson()),\n                      !0)\n                    );\n                  },\n                },\n                {\n                  key: "startTimer",\n                  value: function () {\n                    var a = this;\n                    this.timerStarted ||\n                      (0 != this.getCacheLength() &&\n                        ((this.timerStarted = !0),\n                        setTimeout(function () {\n                          (a.timerStarted = !1), a.trySend();\n                        }, 200)));\n                  },\n                },\n                {\n                  key: "timeToSend",\n                  value: function () {\n                    return h.getCurrent() >= this.lastTS + 200;\n                  },\n                },\n                {\n                  key: "getCacheLength",\n                  value: function () {\n                    var a = 0;\n                    for (var b in this.cache)\n                      this.cache.hasOwnProperty(b) &&\n                        (a += this.cache[b].length());\n                    return a;\n                  },\n                },\n                {\n                  key: "updateConferenceId",\n                  value: function (a) {\n                    var b = l.tmpConferenceId;\n                    this.cache[b] && this.cache[b].updateConferenceId(a);\n                  },\n                },\n              ]),\n              a\n            );\n          })();\n        c.TransmissionManager = o;\n      },\n      {\n        "../collections/cache": 25,\n        "../config/constants": 33,\n        "../utility/csiologger": 88,\n        "../utility/registry": 95,\n        "../utility/timestamps": 99,\n      },\n    ],\n    57: [\n      function (a, b, c) {\n        "use strict";\n        function d(a) {\n          if (a && a.__esModule) return a;\n          var b = {};\n          if (null != a)\n            for (var c in a)\n              Object.prototype.hasOwnProperty.call(a, c) && (b[c] = a[c]);\n          return (b.default = a), b;\n        }\n        function e(a, b) {\n          if (!(a instanceof b))\n            throw new TypeError("Cannot call a class as a function");\n        }\n        function f(a, b) {\n          if (!a)\n            throw new ReferenceError(\n              "this hasn\'t been initialised - super() hasn\'t been called"\n            );\n          return !b || ("object" != typeof b && "function" != typeof b) ? a : b;\n        }\n        function g(a, b) {\n          if ("function" != typeof b && null !== b)\n            throw new TypeError(\n              "Super expression must either be null or a function, not " +\n                typeof b\n            );\n          (a.prototype = Object.create(b && b.prototype, {\n            constructor: {\n              value: a,\n              enumerable: !1,\n              writable: !0,\n              configurable: !0,\n            },\n          })),\n            b &&\n              (Object.setPrototypeOf\n                ? Object.setPrototypeOf(a, b)\n                : (a.__proto__ = b));\n        }\n        Object.defineProperty(c, "__esModule", {\n          value: !0,\n        }),\n          (c.WsCollectorConnection = void 0);\n        var h = (function () {\n            function a(a, b) {\n              for (var c = 0; c < b.length; c++) {\n                var d = b[c];\n                (d.enumerable = d.enumerable || !1),\n                  (d.configurable = !0),\n                  "value" in d && (d.writable = !0),\n                  Object.defineProperty(a, d.key, d);\n              }\n            }\n            return function (b, c, d) {\n              return c && a(b.prototype, c), d && a(b, d), b;\n            };\n          })(),\n          i = a("../config/callstatserrors"),\n          j = d(i),\n          k = a("../config/constants"),\n          l = d(k),\n          m = a("../config/settings"),\n          n = d(m),\n          o = a("../utility/registry"),\n          p = a("../utility/csiologger"),\n          q = d(p),\n          r = a("./collectorconnection"),\n          s = (function (a) {\n            function b() {\n              e(this, b);\n              var a = f(\n                this,\n                (b.__proto__ || Object.getPrototypeOf(b)).call(this)\n              );\n              return (\n                (a.wsConnection = null),\n                (a.wsConnectionState = l.wsConnectionState.closed),\n                (a.connected = !1),\n                (a.reconnected = !1),\n                a\n              );\n            }\n            return (\n              g(b, a),\n              h(b, [\n                {\n                  key: "onOpenHandler",\n                  value: function () {\n                    var a = this;\n                    (a.wsConnectionState = l.wsConnectionState.connected),\n                      a.connected ? (a.reconnected = !0) : (a.connected = !0),\n                      (a.reconnected = !1);\n                  },\n                },\n                {\n                  key: "onCloseHandler",\n                  value: function () {\n                    var a = this;\n                    (a.wsConnectionState = l.wsConnectionState.closed),\n                      q.log("**** Connection to the backend closed."),\n                      a.wsConnection && (a.wsConnection = null);\n                  },\n                },\n                {\n                  key: "onErrorHandler",\n                  value: function (a) {\n                    var b = this;\n                    (b.wsConnectionState = l.wsConnectionState.closed),\n                      q.log(\n                        "**** Connection establishment to the backend failed."\n                      ),\n                      b.callback &&\n                        b.callback(\n                          j.csError.wsChannelFailure,\n                          "WebSocket establishment failed.",\n                          a\n                        );\n                  },\n                },\n                {\n                  key: "onMessageHandler",\n                  value: function (a) {\n                    var b = a.data,\n                      c = JSON.parse(b);\n                    if ("200 OK" === c.status) {\n                      if ("feedback" === c.event)\n                        window.localStorage.removeItem("feedback");\n                      else if (c.event === l.internalFabricEvent.userJoined) {\n                        var d = o.Registry.getConferenceManager().get(\n                          decodeURIComponent(c.conferenceID)\n                        );\n                        d && d.setUcId(c.ucID),\n                          q.log("UcId =", c.ucID),\n                          o.Registry.getTransmissionManager().trySend();\n                      }\n                    } else q.error("Collector error:", c.reason);\n                  },\n                },\n                {\n                  key: "setup",\n                  value: function () {\n                    var a = this;\n                    return new Promise(function (b, c) {\n                      if (\n                        a.wsConnectionState === l.wsConnectionState.initiated ||\n                        a.wsConnectionState === l.wsConnectionState.connected\n                      )\n                        return (\n                          q.log(\n                            "setupWebSocketConnection is called when already connected!"\n                          ),\n                          a.callback &&\n                            a.callback(\n                              j.csError.success,\n                              l.csCallBackMessages.wsConnected\n                            ),\n                          void b()\n                        );\n                      (a.wsConnectionState = l.wsConnectionState.initiated),\n                        q.log("creating new WebSocket", n.wsUrl),\n                        (a.wsConnection = new WebSocket(\n                          n.wsUrl,\n                          "echo-protocol"\n                        )),\n                        (a.wsConnection.onopen = function () {\n                          b(), a.onOpenHandler();\n                        }),\n                        (a.wsConnection.onclose = function () {\n                          a.onCloseHandler();\n                        }),\n                        (a.wsConnection.onerror = function (b) {\n                          c(b), a.onErrorHandler(b);\n                        }),\n                        (a.wsConnection.onmessage = function (b) {\n                          a.onMessageHandler(b);\n                        });\n                    });\n                  },\n                },\n                {\n                  key: "isReady",\n                  value: function () {\n                    var a = this;\n                    return !(\n                      !a.wsConnection || 1 !== a.wsConnection.readyState\n                    );\n                  },\n                },\n                {\n                  key: "getState",\n                  value: function () {\n                    var a = this;\n                    return a.wsConnection ? a.wsConnection.readyState : -1;\n                  },\n                },\n                {\n                  key: "send",\n                  value: function (a) {\n                    this.wsConnection.send(JSON.stringify(a));\n                  },\n                },\n              ]),\n              b\n            );\n          })(r.CollectorConnection);\n        c.WsCollectorConnection = s;\n      },\n      {\n        "../config/callstatserrors": 32,\n        "../config/constants": 33,\n        "../config/settings": 34,\n        "../utility/csiologger": 88,\n        "../utility/registry": 95,\n        "./collectorconnection": 47,\n      },\n    ],\n    58: [\n      function (a, b, c) {\n        "use strict";\n        function d(a) {\n          if (a && a.__esModule) return a;\n          var b = {};\n          if (null != a)\n            for (var c in a)\n              Object.prototype.hasOwnProperty.call(a, c) && (b[c] = a[c]);\n          return (b.default = a), b;\n        }\n        function e(a, b) {\n          if (!(a instanceof b))\n            throw new TypeError("Cannot call a class as a function");\n        }\n        function f(a, b, c, d, e) {\n          return new Promise(function (f, g) {\n            var h = null,\n              i = null,\n              j = null,\n              l = new XMLHttpRequest(),\n              p = n.Registry.getEndpoint().getBrowserName();\n            if (!l) return void g(new Error("creating instance failed"));\n            (h = k.getCurrent()),\n              l.open(a, b),\n              p !== m.browserName.msie && (l.timeout = d);\n            for (var q in c) c.hasOwnProperty(q) && l.setRequestHeader(q, c[q]);\n            var r = null;\n            if ("POST" === a) {\n              if ("application/x-www-form-urlencoded" === c["Content-Type"]) {\n                var s = [];\n                for (var t in e)\n                  e.hasOwnProperty(t) &&\n                    s.push(\n                      encodeURIComponent(t) + "=" + encodeURIComponent(e[t])\n                    );\n                r = s.join("&");\n              }\n              "application/json" === c["Content-Type"] &&\n                (r = JSON.stringify(e));\n            }\n            (l.onload = function () {\n              (i = k.getCurrent()), (j = i - h);\n              var a = new o(l, j);\n              f(a);\n            }),\n              (l.ontimeout = function () {\n                g(new Error("connection timeout"));\n              }),\n              (l.onreadystatechange = function () {\n                4 === l.readyState &&\n                  0 === l.status &&\n                  g(new Error("no server response received"));\n              }),\n              l.send(r);\n          });\n        }\n        function g(a, b, c) {\n          return f("GET", a, b, c, null);\n        }\n        function h(a, b, c, d) {\n          return f("POST", a, b, c, d);\n        }\n        Object.defineProperty(c, "__esModule", {\n          value: !0,\n        });\n        var i = (function () {\n          function a(a, b) {\n            for (var c = 0; c < b.length; c++) {\n              var d = b[c];\n              (d.enumerable = d.enumerable || !1),\n                (d.configurable = !0),\n                "value" in d && (d.writable = !0),\n                Object.defineProperty(a, d.key, d);\n            }\n          }\n          return function (b, c, d) {\n            return c && a(b.prototype, c), d && a(b, d), b;\n          };\n        })();\n        (c.sendGetRequest = g), (c.sendPostRequest = h);\n        var j = a("../utility/timestamps"),\n          k = d(j),\n          l = a("../config/constants"),\n          m = d(l),\n          n = a("../utility/registry"),\n          o = (function () {\n            function a(b, c) {\n              e(this, a), (this.xhr = b), (this.elapsed = c);\n            }\n            return (\n              i(a, [\n                {\n                  key: "getXhr",\n                  value: function () {\n                    return this.xhr;\n                  },\n                },\n                {\n                  key: "getElapsed",\n                  value: function () {\n                    return this.elapsed;\n                  },\n                },\n              ]),\n              a\n            );\n          })();\n      },\n      {\n        "../config/constants": 33,\n        "../utility/registry": 95,\n        "../utility/timestamps": 99,\n      },\n    ],\n    59: [\n      function (a, b, c) {\n        "use strict";\n        function d(a, b) {\n          if (!(a instanceof b))\n            throw new TypeError("Cannot call a class as a function");\n        }\n        Object.defineProperty(c, "__esModule", {\n          value: !0,\n        }),\n          (c.XMLHttpService = void 0);\n        var e = (function () {\n            function a(a, b) {\n              for (var c = 0; c < b.length; c++) {\n                var d = b[c];\n                (d.enumerable = d.enumerable || !1),\n                  (d.configurable = !0),\n                  "value" in d && (d.writable = !0),\n                  Object.defineProperty(a, d.key, d);\n              }\n            }\n            return function (b, c, d) {\n              return c && a(b.prototype, c), d && a(b, d), b;\n            };\n          })(),\n          f = a("../utility/sigmoid"),\n          g = a("../utility/csiologger"),\n          h = (function (a) {\n            if (a && a.__esModule) return a;\n            var b = {};\n            if (null != a)\n              for (var c in a)\n                Object.prototype.hasOwnProperty.call(a, c) && (b[c] = a[c]);\n            return (b.default = a), b;\n          })(g),\n          i = 100,\n          j = 1e4,\n          k = (function () {\n            function a() {\n              var b =\n                  arguments.length > 0 && void 0 !== arguments[0]\n                    ? arguments[0]\n                    : "XMLHttpService",\n                c =\n                  arguments.length > 1 && void 0 !== arguments[1]\n                    ? arguments[1]\n                    : i,\n                e =\n                  arguments.length > 2 && void 0 !== arguments[2]\n                    ? arguments[2]\n                    : j;\n              d(this, a),\n                (this.name = b),\n                (this.minRetryTimeout = c),\n                (this.sigmoid = new f.Sigmoid(e - c, 15, 0.5)),\n                this.reset();\n            }\n            return (\n              e(a, [\n                {\n                  key: "reset",\n                  value: function () {\n                    (this.inProgress = !1),\n                      (this.completed = !1),\n                      this.resolveCb &&\n                        this.rejectCb(new Error(this.name + ": resetting")),\n                      (this.resolveCb = null),\n                      (this.rejectCb = null);\n                  },\n                },\n                {\n                  key: "initiate",\n                  value: function () {\n                    var a = this;\n                    if (this.inProgress)\n                      return new Promise(function (b, c) {\n                        c(new Error(a.name + ": in progress"));\n                      });\n                    var b = new Promise(function (b, c) {\n                      (a.resolveCb = b), (a.rejectCb = c);\n                    });\n                    return (this.inProgress = !0), this.sendRequest(), b;\n                  },\n                },\n                {\n                  key: "isCompleted",\n                  value: function () {\n                    return this.completed;\n                  },\n                },\n                {\n                  key: "handleSendError",\n                  value: function (a) {\n                    h.log(this.name + ": send next request (" + a + ")"),\n                      this.sendNextRequest();\n                  },\n                },\n                {\n                  key: "handleResponseProxy",\n                  value: function (a) {\n                    this.handleResponse(a), this.resetTimeout();\n                  },\n                },\n                {\n                  key: "handleResponse",\n                  value: function (a) {\n                    h.error(this.name + ": handleResponse() not implemented"),\n                      this.completeProcess();\n                  },\n                },\n                {\n                  key: "completeProcess",\n                  value: function () {\n                    (this.inProgress = !1),\n                      (this.completed = !0),\n                      this.resolveCb.apply(this, arguments);\n                  },\n                },\n                {\n                  key: "request",\n                  value: function () {\n                    return (\n                      h.error(this.name + ": request() not implemented!"),\n                      new Promise(function (a, b) {\n                        a();\n                      })\n                    );\n                  },\n                },\n                {\n                  key: "sendRequest",\n                  value: function () {\n                    if (this.inProgress) {\n                      var a = this.request();\n                      a &&\n                        a.then(\n                          this.handleResponseProxy.bind(this),\n                          this.handleSendError.bind(this)\n                        );\n                    }\n                  },\n                },\n                {\n                  key: "sendNextRequest",\n                  value: function () {\n                    setTimeout(this.sendRequest.bind(this), this.getTimeout());\n                  },\n                },\n                {\n                  key: "resetTimeout",\n                  value: function () {\n                    this.sigmoid.reset();\n                  },\n                },\n                {\n                  key: "getTimeout",\n                  value: function () {\n                    return this.minRetryTimeout + this.sigmoid.getActual();\n                  },\n                },\n              ]),\n              a\n            );\n          })();\n        c.XMLHttpService = k;\n      },\n      {\n        "../utility/csiologger": 88,\n        "../utility/sigmoid": 97,\n      },\n    ],\n    60: [\n      function (a, b, c) {\n        "use strict";\n        function d(a, b) {\n          if (!(a instanceof b))\n            throw new TypeError("Cannot call a class as a function");\n        }\n        Object.defineProperty(c, "__esModule", {\n          value: !0,\n        }),\n          (c.Measurement = void 0);\n        var e = (function () {\n            function a(a, b) {\n              for (var c = 0; c < b.length; c++) {\n                var d = b[c];\n                (d.enumerable = d.enumerable || !1),\n                  (d.configurable = !0),\n                  "value" in d && (d.writable = !0),\n                  Object.defineProperty(a, d.key, d);\n              }\n            }\n            return function (b, c, d) {\n              return c && a(b.prototype, c), d && a(b, d), b;\n            };\n          })(),\n          f = a("./resolution"),\n          g = a("./validator"),\n          h = (function (a) {\n            if (a && a.__esModule) return a;\n            var b = {};\n            if (null != a)\n              for (var c in a)\n                Object.prototype.hasOwnProperty.call(a, c) && (b[c] = a[c]);\n            return (b.default = a), b;\n          })(g),\n          i = (function () {\n            function a() {\n              d(this, a),\n                (this.pcHash = null),\n                (this.ssrc = null),\n                (this.streamType = null),\n                (this.mediaType = null),\n                (this.resolution = null),\n                (this.frameRateReceived = null),\n                (this.frameHeight = null),\n                (this.frameWidth = null),\n                (this.droppedFramesNum = null),\n                (this.framesReceived = null),\n                (this.rtt = null),\n                (this.jitter = null),\n                (this.lostPackets = -1),\n                (this.receivedPackets = -1),\n                (this.sentPackets = -1),\n                (this.discardedPackets = -1),\n                (this.sentBytes = -1),\n                (this.receivedBytes = -1),\n                (this.track = null),\n                (this.fractionLost = 0);\n            }\n            return (\n              e(a, null, [\n                {\n                  key: "make",\n                  value: function (\n                    b,\n                    c,\n                    d,\n                    e,\n                    f,\n                    g,\n                    i,\n                    j,\n                    k,\n                    l,\n                    m,\n                    n,\n                    o,\n                    p,\n                    q,\n                    r,\n                    s,\n                    t\n                  ) {\n                    var u = new a(),\n                      v = function (a, b) {\n                        -1 === [void 0, null].indexOf(b) && (u[a] = b);\n                      };\n                    return (\n                      v("pcHash", b),\n                      v("ssrc", c),\n                      v("streamType", d),\n                      v("mediaType", e),\n                      v("frameRateReceived", f),\n                      v("frameHeight", h.checkForNan(parseInt(g, 10))),\n                      v("frameWidth", h.checkForNan(parseInt(i, 10))),\n                      v("droppedFramesNum", j),\n                      v("framesReceived", k),\n                      v("rtt", l),\n                      v("jitter", m),\n                      v("lostPackets", n),\n                      v("receivedPackets", o),\n                      v("sentPackets", p),\n                      v("discardedPackets", q),\n                      v("sentBytes", r),\n                      v("receivedBytes", s),\n                      v("track", t),\n                      u.setFrameRateReceived(f),\n                      u\n                    );\n                  },\n                },\n              ]),\n              e(a, [\n                {\n                  key: "getPcHash",\n                  value: function () {\n                    return this.pcHash;\n                  },\n                },\n                {\n                  key: "getSSRC",\n                  value: function () {\n                    return this.ssrc;\n                  },\n                },\n                {\n                  key: "getStreamType",\n                  value: function () {\n                    return this.streamType;\n                  },\n                },\n                {\n                  key: "getMediaType",\n                  value: function () {\n                    return this.mediaType;\n                  },\n                },\n                {\n                  key: "getResolution",\n                  value: function () {\n                    return this.resolution ? this.resolution.toString() : null;\n                  },\n                },\n                {\n                  key: "getFrameRateReceived",\n                  value: function () {\n                    return this.frameRateReceived;\n                  },\n                },\n                {\n                  key: "getFrameHeight",\n                  value: function () {\n                    return this.frameHeight;\n                  },\n                },\n                {\n                  key: "getFrameWidth",\n                  value: function () {\n                    return this.frameWidth;\n                  },\n                },\n                {\n                  key: "getDroppedFramesNum",\n                  value: function () {\n                    return this.droppedFramesNum;\n                  },\n                },\n                {\n                  key: "getFramesReceived",\n                  value: function () {\n                    return this.framesReceived;\n                  },\n                },\n                {\n                  key: "setFrameRateReceived",\n                  value: function (a) {\n                    (this.frameRateReceived = a),\n                      void 0 !== this.frameRateReceived &&\n                      void 0 !== this.frameWidth &&\n                      void 0 !== this.frameHeight &&\n                      this.frameWidth > 0 &&\n                      this.frameHeight > 0\n                        ? (this.resolution = new f.Resolution(\n                            this.frameWidth,\n                            this.frameHeight,\n                            this.frameRateReceived\n                          ))\n                        : (this.resolution = null);\n                  },\n                },\n                {\n                  key: "getJitter",\n                  value: function () {\n                    return this.jitter;\n                  },\n                },\n                {\n                  key: "getRTT",\n                  value: function () {\n                    return this.rtt;\n                  },\n                },\n                {\n                  key: "getLostPackets",\n                  value: function () {\n                    return this.lostPackets;\n                  },\n                },\n                {\n                  key: "getDiscardedPackets",\n                  value: function () {\n                    return this.discardedPackets;\n                  },\n                },\n                {\n                  key: "getReceivedPackets",\n                  value: function () {\n                    return this.receivedPackets;\n                  },\n                },\n                {\n                  key: "getSentPackets",\n                  value: function () {\n                    return this.sentPackets;\n                  },\n                },\n                {\n                  key: "getSentBytes",\n                  value: function () {\n                    return this.sentBytes;\n                  },\n                },\n                {\n                  key: "getReceivedBytes",\n                  value: function () {\n                    return this.receivedBytes;\n                  },\n                },\n                {\n                  key: "setFractionLost",\n                  value: function (a) {\n                    this.fractionLost = void 0 === a ? null : a;\n                  },\n                },\n                {\n                  key: "getFractionLost",\n                  value: function () {\n                    return this.fractionLost;\n                  },\n                },\n                {\n                  key: "extractTrack",\n                  value: function () {\n                    var a = this.track;\n                    return (this.track = null), a;\n                  },\n                },\n                {\n                  key: "toString",\n                  value: function () {\n                    return (\n                      "pcHash: " +\n                      this.pcHash +\n                      ", ssrc: " +\n                      this.ssrc +\n                      ", streamType: " +\n                      this.streamType +\n                      ", mediaType: " +\n                      this.mediaType +\n                      ", frameRateReceived: " +\n                      this.frameRateReceived +\n                      ", frameHeight: " +\n                      this.frameHeight +\n                      ", frameWidth: " +\n                      this.frameWidth +\n                      ", droppedFramesNum: " +\n                      this.droppedFramesNum +\n                      ", rtt: " +\n                      this.rtt +\n                      ", jitter: " +\n                      this.jitter +\n                      ", lostPackets: " +\n                      this.lostPackets +\n                      ", receivedPackets: " +\n                      this.receivedPackets +\n                      ", sentPackets: " +\n                      this.sentPackets +\n                      ", discardedPackets: " +\n                      this.discardedPackets +\n                      ", sentBytes: " +\n                      this.sentBytes +\n                      ", receivedBytes: " +\n                      this.receivedBytes\n                    );\n                  },\n                },\n              ]),\n              a\n            );\n          })();\n        c.Measurement = i;\n      },\n      {\n        "./resolution": 68,\n        "./validator": 83,\n      },\n    ],\n    61: [\n      function (a, b, c) {\n        "use strict";\n        function d(a) {\n          if (a && a.__esModule) return a;\n          var b = {};\n          if (null != a)\n            for (var c in a)\n              Object.prototype.hasOwnProperty.call(a, c) && (b[c] = a[c]);\n          return (b.default = a), b;\n        }\n        function e(a, b) {\n          if (!(a instanceof b))\n            throw new TypeError("Cannot call a class as a function");\n        }\n        Object.defineProperty(c, "__esModule", {\n          value: !0,\n        }),\n          (c.CPULimitationObserver = void 0);\n        var f = (function () {\n            function a(a, b) {\n              for (var c = 0; c < b.length; c++) {\n                var d = b[c];\n                (d.enumerable = d.enumerable || !1),\n                  (d.configurable = !0),\n                  "value" in d && (d.writable = !0),\n                  Object.defineProperty(a, d.key, d);\n              }\n            }\n            return function (b, c, d) {\n              return c && a(b.prototype, c), d && a(b, d), b;\n            };\n          })(),\n          g = a("../../config/constants"),\n          h = d(g),\n          i = a("../../utility/timestamps"),\n          j = d(i),\n          k = (function () {\n            function a() {\n              e(this, a),\n                (this.ewmaDiscardedPackets = 0),\n                (this.ewmaLostPackets = 0),\n                (this.ewmaDroppedFrames = 0),\n                (this.last = 0),\n                (this.noticed = 0);\n            }\n            return (\n              f(a, [\n                {\n                  key: "test",\n                  value: function (a) {\n                    var b = a.discardedPackets,\n                      c = a.lostPackets;\n                    if (!c || c < 1 || !b || b < 1) return !1;\n                    if (0 === this.last)\n                      return (\n                        (this.last = j.getCurrent()),\n                        (this.ewmaLostPackets = c),\n                        (this.ewmaDiscardedPackets = b),\n                        !1\n                      );\n                    var d = j.getCurrent(),\n                      e = Math.max(d - this.last, 1),\n                      f = Math.min((5e3 - e) / 5e3, 0.9),\n                      g = a.droppedFrames;\n                    return (\n                      (this.ewmaLostPackets = this.ewmaLostPackets * f + c),\n                      (this.ewmaDroppedFrames = this.ewmaDroppedFrames * f + g),\n                      (this.ewmaDiscardedPackets =\n                        this.ewmaDiscardedPackets * f + b),\n                      !(!g || g < 1) &&\n                        !(\n                          1 < this.ewmaLostPackets ||\n                          1 < this.ewmaDiscardedPackets\n                        ) &&\n                        !(d - this.noticed < 1e4) &&\n                        !(this.ewmaDroppedFrames < 1) &&\n                        ((this.noticed = d), !0)\n                    );\n                  },\n                },\n              ]),\n              a\n            );\n          })(),\n          l = (function () {\n            function a(b) {\n              e(this, a),\n                (this.notifyCallback = b),\n                (this.inbVideoTesters = new Map());\n            }\n            return (\n              f(a, [\n                {\n                  key: "accept",\n                  value: function (a) {\n                    for (\n                      var b = a.filter(function (a) {\n                          return (\n                            a.getMediaType() === h.mediaType.video &&\n                            a.getStreamType() === h.streamType.inbound\n                          );\n                        }),\n                        c = 0;\n                      c < b.length;\n                      ++c\n                    ) {\n                      var d = b[c];\n                      this.checkInboundVideo(d);\n                    }\n                  },\n                },\n                {\n                  key: "checkInboundVideo",\n                  value: function (a) {\n                    var b = a.peek(),\n                      c = a.getSSRC();\n                    if (\n                      (this.inbVideoTesters.has(c) ||\n                        this.inbVideoTesters.set(c, new k()),\n                      this.inbVideoTesters.get(c).test(b))\n                    ) {\n                      var d = {\n                        reason: h.limitationType.cpu,\n                        ssrc: c,\n                      };\n                      this.notifyCallback(d);\n                    }\n                  },\n                },\n                {\n                  key: "toString",\n                  value: function () {\n                    return "CPULimitationObserver";\n                  },\n                },\n              ]),\n              a\n            );\n          })();\n        c.CPULimitationObserver = l;\n      },\n      {\n        "../../config/constants": 33,\n        "../../utility/timestamps": 99,\n      },\n    ],\n    62: [\n      function (a, b, c) {\n        "use strict";\n        function d(a) {\n          if (a && a.__esModule) return a;\n          var b = {};\n          if (null != a)\n            for (var c in a)\n              Object.prototype.hasOwnProperty.call(a, c) && (b[c] = a[c]);\n          return (b.default = a), b;\n        }\n        function e(a, b) {\n          if (!(a instanceof b))\n            throw new TypeError("Cannot call a class as a function");\n        }\n        Object.defineProperty(c, "__esModule", {\n          value: !0,\n        }),\n          (c.OneWayMediaObserver = void 0);\n        var f = (function () {\n            function a(a, b) {\n              for (var c = 0; c < b.length; c++) {\n                var d = b[c];\n                (d.enumerable = d.enumerable || !1),\n                  (d.configurable = !0),\n                  "value" in d && (d.writable = !0),\n                  Object.defineProperty(a, d.key, d);\n              }\n            }\n            return function (b, c, d) {\n              return c && a(b.prototype, c), d && a(b, d), b;\n            };\n          })(),\n          g = a("../../config/constants"),\n          h = d(g),\n          i = a("../onewaymediadisruption"),\n          j = a("../../utility/timestamps"),\n          k = d(j),\n          l = (function () {\n            function a(b) {\n              e(this, a),\n                (this.notifierCallback = b),\n                (this.inbOneWayAudioDisruption = {\n                  sent: !1,\n                  started: 0,\n                  hasTrafficTs: 0,\n                }),\n                (this.outbOneWayAudioDisruption = {\n                  sent: !1,\n                  started: 0,\n                  hasTrafficTs: 0,\n                });\n            }\n            return (\n              f(a, [\n                {\n                  key: "accept",\n                  value: function (a) {\n                    var b = a.filter(function (a) {\n                        return (\n                          a.getMediaType() == h.mediaType.audio &&\n                          a.getStreamType() === h.streamType.inbound\n                        );\n                      }),\n                      c = a.filter(function (a) {\n                        return (\n                          a.getMediaType() == h.mediaType.audio &&\n                          a.getStreamType() === h.streamType.outbound\n                        );\n                      }),\n                      d = [\n                        this.getInbOneWayAudioDisruption(b, c),\n                        this.getOutbOneWayAudioDisruption(b, c),\n                      ],\n                      e = d.filter(function (a) {\n                        return null !== a;\n                      });\n                    0 < e.length && this.notifierCallback(e);\n                  },\n                },\n                {\n                  key: "toString",\n                  value: function () {\n                    return "DisruptionObserver";\n                  },\n                },\n                {\n                  key: "getInbOneWayAudioDisruption",\n                  value: function (a, b) {\n                    var c = this.inbOneWayAudioDisruption;\n                    if (c.sent) return null;\n                    var d =\n                        b.filter(function (a) {\n                          return 0 === a.getStartTime();\n                        }).length < 1,\n                      e =\n                        b.filter(function (a) {\n                          return !a.hasTraffic();\n                        }).length < 1;\n                    if (!d || e) return null;\n                    var f =\n                      a.filter(function (a) {\n                        return !a.hasTraffic();\n                      }).length < 1;\n                    return 0 < a.length && f\n                      ? ((c.started = 0), null)\n                      : 0 === c.started\n                      ? ((c.started = k.getCurrent()), null)\n                      : k.getCurrent() - 5e3 < c.started\n                      ? null\n                      : ((c.sent = !0),\n                        new i.OneWayMediaDisruption(h.oneWayMediaTypes.audio));\n                  },\n                },\n                {\n                  key: "getOutbOneWayAudioDisruption",\n                  value: function (a, b) {\n                    var c = this.outbOneWayAudioDisruption;\n                    if (c.sent) return null;\n                    var d =\n                        a.filter(function (a) {\n                          return 0 === a.getStartTime();\n                        }).length < 1,\n                      e =\n                        a.filter(function (a) {\n                          return !a.hasTraffic();\n                        }).length < 1;\n                    if (!d || !e) return null;\n                    var f =\n                      b.filter(function (a) {\n                        return !a.hasTraffic();\n                      }).length < 1;\n                    return 0 < b.length && f\n                      ? ((c.started = 0), null)\n                      : 0 === c.started\n                      ? ((c.started = k.getCurrent()), null)\n                      : k.getCurrent() - 5e3 < c.started\n                      ? null\n                      : ((c.sent = !0),\n                        new i.OneWayMediaDisruption(h.oneWayMediaTypes.audio));\n                  },\n                },\n              ]),\n              a\n            );\n          })();\n        c.OneWayMediaObserver = l;\n      },\n      {\n        "../../config/constants": 33,\n        "../../utility/timestamps": 99,\n        "../onewaymediadisruption": 66,\n      },\n    ],\n    63: [\n      function (a, b, c) {\n        "use strict";\n        function d(a) {\n          if (a && a.__esModule) return a;\n          var b = {};\n          if (null != a)\n            for (var c in a)\n              Object.prototype.hasOwnProperty.call(a, c) && (b[c] = a[c]);\n          return (b.default = a), b;\n        }\n        function e(a, b) {\n          if (!(a instanceof b))\n            throw new TypeError("Cannot call a class as a function");\n        }\n        Object.defineProperty(c, "__esModule", {\n          value: !0,\n        }),\n          (c.QPSumObserver = void 0);\n        var f = (function () {\n            function a(a, b) {\n              for (var c = 0; c < b.length; c++) {\n                var d = b[c];\n                (d.enumerable = d.enumerable || !1),\n                  (d.configurable = !0),\n                  "value" in d && (d.writable = !0),\n                  Object.defineProperty(a, d.key, d);\n              }\n            }\n            return function (b, c, d) {\n              return c && a(b.prototype, c), d && a(b, d), b;\n            };\n          })(),\n          g = a("../../config/constants"),\n          h = d(g),\n          i = a("../../utility/timestamps"),\n          j = d(i),\n          k = (function () {\n            function a(b) {\n              e(this, a),\n                (this.lastQpSum = null),\n                (this.qpAvg = null),\n                (this.noticed = 0);\n            }\n            return (\n              f(a, [\n                {\n                  key: "test",\n                  value: function (a) {\n                    var b = a.getTrack();\n                    if (!b || !b.data || !b.data.qpSum) return !1;\n                    if (!this.lastQpSum)\n                      return (this.lastQpSum = b.data.qpSum), !1;\n                    var c = b.data.qpSum - this.lastQpSum;\n                    if (((this.lastQpSum = b.data.qpSum), null === this.qpAvg))\n                      this.qpAvg = c;\n                    else {\n                      this.qpAvg = 0.2 * c + 0.8 * this.qpAvg;\n                    }\n                    var d = Math.max(2 * this.qpAvg, 1);\n                    if (c < this.qpAvg + d) return !1;\n                    var e = j.getCurrent();\n                    return this.noticed < e - 1e4;\n                  },\n                },\n              ]),\n              a\n            );\n          })(),\n          l = (function () {\n            function a(b) {\n              e(this, a), (this.notifyCallback = b), (this.testers = new Map());\n            }\n            return (\n              f(a, [\n                {\n                  key: "accept",\n                  value: function (a) {\n                    for (var b = 0; b < a.length; ++b) {\n                      var c = a[b];\n                      if (c.getMediaType() === h.mediaType.video) {\n                        var d = c.getSSRC();\n                        this.testers.has(d) || this.testers.set(d, new k(c));\n                        if (this.testers.get(d).test(c)) {\n                          var e = {\n                            reason: h.qualityDisruptionTypes.qpchange,\n                          };\n                          this.notifyCallback(e);\n                        }\n                      }\n                    }\n                  },\n                },\n                {\n                  key: "toString",\n                  value: function () {\n                    return "QPSumObserver";\n                  },\n                },\n              ]),\n              a\n            );\n          })();\n        c.QPSumObserver = l;\n      },\n      {\n        "../../config/constants": 33,\n        "../../utility/timestamps": 99,\n      },\n    ],\n    64: [\n      function (a, b, c) {\n        "use strict";\n        function d(a) {\n          if (a && a.__esModule) return a;\n          var b = {};\n          if (null != a)\n            for (var c in a)\n              Object.prototype.hasOwnProperty.call(a, c) && (b[c] = a[c]);\n          return (b.default = a), b;\n        }\n        function e(a, b) {\n          if (!(a instanceof b))\n            throw new TypeError("Cannot call a class as a function");\n        }\n        Object.defineProperty(c, "__esModule", {\n          value: !0,\n        }),\n          (c.SendingTrigger = void 0);\n        var f = (function () {\n            function a(a, b) {\n              for (var c = 0; c < b.length; c++) {\n                var d = b[c];\n                (d.enumerable = d.enumerable || !1),\n                  (d.configurable = !0),\n                  "value" in d && (d.writable = !0),\n                  Object.defineProperty(a, d.key, d);\n              }\n            }\n            return function (b, c, d) {\n              return c && a(b.prototype, c), d && a(b, d), b;\n            };\n          })(),\n          g = a("../../utility/timestamps"),\n          h = d(g),\n          i = a("../validator"),\n          j = d(i),\n          k = 1e3,\n          l = 3e4,\n          m = (function () {\n            function a(b, c, d) {\n              e(this, a),\n                (this.last = null),\n                (this.actual = 0),\n                (this.name = b),\n                (this.alpha = c),\n                (this.supplier = d);\n            }\n            return (\n              f(a, [\n                {\n                  key: "update",\n                  value: function (a) {\n                    if (null === this.last) return void (this.last = a);\n                    var b = Math.abs(a - this.last);\n                    (this.actual =\n                      b * this.alpha + this.actual * (1 - this.alpha)),\n                      (this.last = a);\n                  },\n                },\n                {\n                  key: "doTest",\n                  value: function (a) {\n                    var b = this.last;\n                    return (\n                      this.update(a),\n                      null !== b && b + this.supplier(this.actual) < a\n                    );\n                  },\n                },\n              ]),\n              a\n            );\n          })(),\n          n = (function () {\n            function a() {\n              e(this, a);\n              var b = this;\n              (this.marginFactor = 1),\n                (this.rttTester = new m("RTT Tester", 0.2, function (a) {\n                  return Math.max(50, a) * b.marginFactor;\n                })),\n                (this.throughputTester = new m(\n                  "Throughput Tester",\n                  0.1,\n                  function (a) {\n                    return Math.max(100, a) * b.marginFactor;\n                  }\n                )),\n                (this.FLTester = new m("FL Tester", 0.1, function (a) {\n                  return Math.max(0.2, a) * b.marginFactor;\n                })),\n                (this.lastDecreased = h.getCurrent());\n            }\n            return (\n              f(a, [\n                {\n                  key: "test",\n                  value: function (a) {\n                    var b = a.peek();\n                    if (!b) return !1;\n                    var c = a.getTrack(),\n                      d = c.data,\n                      e = b.getRTT(),\n                      f = j.checkForNan(parseInt(d.csioIntBRKbps, 10)),\n                      g = b.getFractionLost();\n                    if (\n                      this.rttTester.doTest(e) ||\n                      this.throughputTester.doTest(f) ||\n                      this.FLTester.doTest(g)\n                    )\n                      return (\n                        (this.marginFactor = Math.min(\n                          2 * this.marginFactor,\n                          15\n                        )),\n                        !0\n                      );\n                    var i = h.getCurrent();\n                    return (\n                      3e3 < i - this.lastChanged &&\n                        ((this.marginFactor = Math.max(\n                          this.marginFactor - 0.5,\n                          1\n                        )),\n                        (this.lastDecreased = i)),\n                      !1\n                    );\n                  },\n                },\n              ]),\n              a\n            );\n          })(),\n          o = (function () {\n            function a(b) {\n              e(this, a),\n                (this.notifyCallback = b),\n                (this.minInterval = k),\n                (this.maxInterval = l),\n                (this.notified = 0),\n                (this.testers = new Map());\n            }\n            return (\n              f(a, [\n                {\n                  key: "setup",\n                  value: function (a, b) {\n                    (this.minInterval = a), (this.maxInterval = b);\n                  },\n                },\n                {\n                  key: "accept",\n                  value: function (a) {\n                    var b = h.getCurrent(),\n                      c = b - this.notified;\n                    if (this.minInterval === this.maxInterval)\n                      return void (\n                        this.minInterval <= c &&\n                        (this.notifyCallback(), (this.notified = b))\n                      );\n                    if (!(c < this.minInterval)) {\n                      if (c < this.maxInterval) {\n                        if (!1 === this.doSend(a)) return;\n                      }\n                      this.notifyCallback(), (this.notified = b);\n                    }\n                  },\n                },\n                {\n                  key: "setIntervals",\n                  value: function (a, b) {\n                    (this.minInterval = a), (this.maxInterval = b);\n                  },\n                },\n                {\n                  key: "toString",\n                  value: function () {\n                    return "SendingTrigger";\n                  },\n                },\n                {\n                  key: "doSend",\n                  value: function (a) {\n                    for (var b = 0; b < a.length; ++b) {\n                      var c = a[b],\n                        d = c.getSSRC();\n                      this.testers.has(d) || this.testers.set(d, new n());\n                      if (this.testers.get(d).test(c)) return !0;\n                    }\n                    return !1;\n                  },\n                },\n              ]),\n              a\n            );\n          })();\n        c.SendingTrigger = o;\n      },\n      {\n        "../../utility/timestamps": 99,\n        "../validator": 83,\n      },\n    ],\n    65: [\n      function (a, b, c) {\n        "use strict";\n        function d(a) {\n          if (a && a.__esModule) return a;\n          var b = {};\n          if (null != a)\n            for (var c in a)\n              Object.prototype.hasOwnProperty.call(a, c) && (b[c] = a[c]);\n          return (b.default = a), b;\n        }\n        function e(a, b) {\n          if (!(a instanceof b))\n            throw new TypeError("Cannot call a class as a function");\n        }\n        Object.defineProperty(c, "__esModule", {\n          value: !0,\n        }),\n          (c.ThroughputObserver = void 0);\n        var f = (function () {\n            function a(a, b) {\n              for (var c = 0; c < b.length; c++) {\n                var d = b[c];\n                (d.enumerable = d.enumerable || !1),\n                  (d.configurable = !0),\n                  "value" in d && (d.writable = !0),\n                  Object.defineProperty(a, d.key, d);\n              }\n            }\n            return function (b, c, d) {\n              return c && a(b.prototype, c), d && a(b, d), b;\n            };\n          })(),\n          g = a("../../config/constants"),\n          h = d(g),\n          i = a("../../utility/timestamps"),\n          j = d(i),\n          k = (function () {\n            function a(b) {\n              e(this, a),\n                (this.notifierCallback = b),\n                (this.observations = new Map());\n            }\n            return (\n              f(a, [\n                {\n                  key: "accept",\n                  value: function (a) {\n                    var b = a.filter(function (a) {\n                      return (\n                        a.getMediaType() === h.mediaType.video &&\n                        a.getStreamType() === h.streamType.outbound\n                      );\n                    });\n                    if (!(b.length < 1)) {\n                      var c = this;\n                      b.forEach(function (a) {\n                        c.observe(a);\n                      });\n                    }\n                  },\n                },\n                {\n                  key: "toString",\n                  value: function () {\n                    return "ThroughputObserver";\n                  },\n                },\n                {\n                  key: "getObservations",\n                  value: function (a) {\n                    if (this.observations.has(a))\n                      return this.observations.get(a);\n                    var b = {\n                      ssrc: 0,\n                      started: 0,\n                      max: 0,\n                      maxTs: 0,\n                      stable: 0,\n                      stableTs: 0,\n                      ready: !1,\n                      maxVerified: !1,\n                      stableVerified: !1,\n                    };\n                    return (\n                      this.observations.set(a, b), this.observations.get(a)\n                    );\n                  },\n                },\n                {\n                  key: "observe",\n                  value: function (a) {\n                    var b = a.getSSRC(),\n                      c = this.getObservations(b),\n                      d = j.getCurrent();\n                    if (!0 !== c.ready) {\n                      if (0 === c.started)\n                        return (c.ssrc = b), void (c.started = d);\n                      var e = a.getTrack(),\n                        f = e.data,\n                        g = f.csioIntBRKbps,\n                        h = Math.min(50, 0.05 * g);\n                      if (\n                        (c.max < g\n                          ? ((c.max = g), (c.maxTs = d))\n                          : 1e4 < d - c.maxTs && (c.maxVerified = !0),\n                        !(d - c.started < 15e3) &&\n                          (g - h < f.csioAvgBRKbps &&\n                            f.csioAvgBRKbps < g + h &&\n                            ((c.stableTs = d),\n                            (c.stable = g),\n                            (c.stableVerified = !0)),\n                          c.stableVerified && c.maxVerified))\n                      ) {\n                        var i = {\n                          ssrc: String(c.ssrc),\n                          maxsendingKBitrate: c.max,\n                          timeToMaxSendingKBitrate: c.maxTs - c.started,\n                          stablesendingKBitrate: c.stable,\n                          timeToStableSendingKBitrate: c.stableTs - c.started,\n                        };\n                        this.notifierCallback(i), (c.ready = !0);\n                      }\n                    }\n                  },\n                },\n              ]),\n              a\n            );\n          })();\n        c.ThroughputObserver = k;\n      },\n      {\n        "../../config/constants": 33,\n        "../../utility/timestamps": 99,\n      },\n    ],\n    66: [\n      function (a, b, c) {\n        "use strict";\n        function d(a, b) {\n          if (!(a instanceof b))\n            throw new TypeError("Cannot call a class as a function");\n        }\n        Object.defineProperty(c, "__esModule", {\n          value: !0,\n        });\n        var e = (function () {\n            function a(a, b) {\n              for (var c = 0; c < b.length; c++) {\n                var d = b[c];\n                (d.enumerable = d.enumerable || !1),\n                  (d.configurable = !0),\n                  "value" in d && (d.writable = !0),\n                  Object.defineProperty(a, d.key, d);\n              }\n            }\n            return function (b, c, d) {\n              return c && a(b.prototype, c), d && a(b, d), b;\n            };\n          })(),\n          f = (function () {\n            function a(b) {\n              var c =\n                arguments.length > 1 && void 0 !== arguments[1]\n                  ? arguments[1]\n                  : "0";\n              d(this, a), (this.mediaType = b), (this.ssrc = c);\n            }\n            return (\n              e(a, [\n                {\n                  key: "getContent",\n                  value: function () {\n                    var a = this;\n                    return {\n                      mediaType: a.mediaType,\n                      ssrc: a.ssrc,\n                    };\n                  },\n                },\n              ]),\n              a\n            );\n          })();\n        c.OneWayMediaDisruption = f;\n      },\n      {},\n    ],\n    67: [\n      function (a, b, c) {\n        "use strict";\n        function d(a, b) {\n          if (!(a instanceof b))\n            throw new TypeError("Cannot call a class as a function");\n        }\n        Object.defineProperty(c, "__esModule", {\n          value: !0,\n        });\n        var e = (function () {\n            function a(a, b) {\n              for (var c = 0; c < b.length; c++) {\n                var d = b[c];\n                (d.enumerable = d.enumerable || !1),\n                  (d.configurable = !0),\n                  "value" in d && (d.writable = !0),\n                  Object.defineProperty(a, d.key, d);\n              }\n            }\n            return function (b, c, d) {\n              return c && a(b.prototype, c), d && a(b, d), b;\n            };\n          })(),\n          f = (function () {\n            function a(b, c, e, f, g, h) {\n              d(this, a),\n                (this.candidatePair = b),\n                (this.codec = c),\n                (this.pcHash = e),\n                (this.trackStats = f),\n                (this.transportStats = g),\n                (this.measurements = h);\n            }\n            return (\n              e(a, [\n                {\n                  key: "getCandidatePair",\n                  value: function () {\n                    return this.candidatePair;\n                  },\n                },\n                {\n                  key: "getCodec",\n                  value: function () {\n                    return this.codec;\n                  },\n                },\n                {\n                  key: "getPcHash",\n                  value: function () {\n                    return this.pcHash;\n                  },\n                },\n                {\n                  key: "getTrackStats",\n                  value: function () {\n                    return this.trackStats;\n                  },\n                },\n                {\n                  key: "getTransportStats",\n                  value: function () {\n                    return this.transportStats;\n                  },\n                },\n                {\n                  key: "getMeasurements",\n                  value: function () {\n                    return this.measurements;\n                  },\n                },\n              ]),\n              a\n            );\n          })();\n        c.PcStats = f;\n      },\n      {},\n    ],\n    68: [\n      function (a, b, c) {\n        "use strict";\n        function d(a, b) {\n          if (!(a instanceof b))\n            throw new TypeError("Cannot call a class as a function");\n        }\n        Object.defineProperty(c, "__esModule", {\n          value: !0,\n        });\n        var e = (function () {\n            function a(a, b) {\n              for (var c = 0; c < b.length; c++) {\n                var d = b[c];\n                (d.enumerable = d.enumerable || !1),\n                  (d.configurable = !0),\n                  "value" in d && (d.writable = !0),\n                  Object.defineProperty(a, d.key, d);\n              }\n            }\n            return function (b, c, d) {\n              return c && a(b.prototype, c), d && a(b, d), b;\n            };\n          })(),\n          f = (function () {\n            function a(b, c, e) {\n              d(this, a),\n                (this.width = b),\n                (this.height = c),\n                (this.frameRate = e);\n            }\n            return (\n              e(a, [\n                {\n                  key: "getWidth",\n                  value: function () {\n                    return this.width;\n                  },\n                },\n                {\n                  key: "getHeight",\n                  value: function () {\n                    return this.height;\n                  },\n                },\n                {\n                  key: "getFrameRate",\n                  value: function () {\n                    return this.frameRate;\n                  },\n                },\n                {\n                  key: "toString",\n                  value: function () {\n                    return this.width && this.height && this.frameRate\n                      ? this.width.toString() +\n                          "X" +\n                          this.height.toString() +\n                          "X" +\n                          this.frameRate.toString()\n                      : null;\n                  },\n                },\n              ]),\n              a\n            );\n          })();\n        c.Resolution = f;\n      },\n      {},\n    ],\n    69: [\n      function (a, b, c) {\n        "use strict";\n        function d(a) {\n          if (a && a.__esModule) return a;\n          var b = {};\n          if (null != a)\n            for (var c in a)\n              Object.prototype.hasOwnProperty.call(a, c) && (b[c] = a[c]);\n          return (b.default = a), b;\n        }\n        function e(a, b) {\n          if (!(a instanceof b))\n            throw new TypeError("Cannot call a class as a function");\n        }\n        function f(a, b) {\n          if (!a)\n            throw new ReferenceError(\n              "this hasn\'t been initialised - super() hasn\'t been called"\n            );\n          return !b || ("object" != typeof b && "function" != typeof b) ? a : b;\n        }\n        function g(a, b) {\n          if ("function" != typeof b && null !== b)\n            throw new TypeError(\n              "Super expression must either be null or a function, not " +\n                typeof b\n            );\n          (a.prototype = Object.create(b && b.prototype, {\n            constructor: {\n              value: a,\n              enumerable: !1,\n              writable: !0,\n              configurable: !0,\n            },\n          })),\n            b &&\n              (Object.setPrototypeOf\n                ? Object.setPrototypeOf(a, b)\n                : (a.__proto__ = b));\n        }\n        Object.defineProperty(c, "__esModule", {\n          value: !0,\n        }),\n          (c.StatsAdapter = c.StatsAdapterIO = void 0);\n        var h = (function () {\n            function a(a, b) {\n              for (var c = 0; c < b.length; c++) {\n                var d = b[c];\n                (d.enumerable = d.enumerable || !1),\n                  (d.configurable = !0),\n                  "value" in d && (d.writable = !0),\n                  Object.defineProperty(a, d.key, d);\n              }\n            }\n            return function (b, c, d) {\n              return c && a(b.prototype, c), d && a(b, d), b;\n            };\n          })(),\n          i = a("../config/constants"),\n          j = d(i),\n          k = a("../collections/component"),\n          l = a("../utility/registry"),\n          m = a("../utility/hash"),\n          n = d(m),\n          o = (c.StatsAdapterIO = {\n            RawStatsIn: "RawStatsIn",\n            RawStatsOut: "RawStatsOut",\n            UnprocessedOut: "UnprocessedOut",\n          }),\n          p = (function (a) {\n            function b(a, c) {\n              e(this, b);\n              var d = f(\n                this,\n                (b.__proto__ || Object.getPrototypeOf(b)).call(\n                  this,\n                  "StatsAdapter"\n                )\n              );\n              return (\n                d.bindPort(o.RawStatsIn, d.receiveRawData, d),\n                d.declarePort(o.RawStatsOut),\n                d.declarePort(o.UnprocessedOut),\n                (d.codeBase = a),\n                (d.browser = c),\n                d\n              );\n            }\n            return (\n              g(b, a),\n              h(b, [\n                {\n                  key: "receiveRawData",\n                  value: function (a, b) {\n                    if (a) {\n                      var c = this.extractRawStats(a);\n                      if (c) {\n                        window &&\n                          window.csioReactNative &&\n                          (c = this.removeValues(c)),\n                          this.isConnected(o.UnprocessedOut) &&\n                            this.transmit(o.UnprocessedOut, c, b);\n                        var d = this.processRawStats(c, b);\n                        if (d && d.transportStats)\n                          for (var e = 0; e < d.transportStats.length; e++)\n                            d.transportStats[e].hash = this.getTransportHash(\n                              d.transportStats[e]\n                            );\n                        d &&\n                          d.transportStats &&\n                          this.checkTransportStatsUpdates(d.transportStats, b),\n                          d && d.trackStats && (d = this.backFillTrackStats(d)),\n                          d &&\n                            d.transportStats &&\n                            d.candidatePair &&\n                            (d = this.backFillCandidatePairStats(d)),\n                          (d.pcHash = b),\n                          this.transmit(o.RawStatsOut, d);\n                      }\n                    }\n                  },\n                },\n                {\n                  key: "removeValues",\n                  value: function (a) {\n                    for (var b = 0; b < a.length; ++b) {\n                      var c = a[b];\n                      if (c && c.values) {\n                        for (var d = 0; d < c.values.length; ++d)\n                          Object.assign(c, c.values[d]);\n                        delete c.values;\n                      }\n                    }\n                    return a;\n                  },\n                },\n                {\n                  key: "getIceCandidates",\n                  value: function (a) {\n                    if (!a)\n                      return {\n                        localIceCandidates: [],\n                        remoteIceCandidates: [],\n                        iceCandidatePairs: [],\n                      };\n                    var b = this.extractRawStats(a);\n                    return this.processRawStatsForIceInfo(b);\n                  },\n                },\n                {\n                  key: "extractRawStats",\n                  value: function (a) {\n                    var b = [];\n                    if (a && a.result) b = a.result();\n                    else if (a && a.forEach)\n                      a.forEach(function (a) {\n                        b.push(a);\n                      });\n                    else for (var c in a) a.hasOwnProperty(c) && b.push(a[c]);\n                    return b;\n                  },\n                },\n                {\n                  key: "normalizeIceCandidates",\n                  value: function (a) {\n                    for (var b = 0; b < a.length; b += 1) {\n                      var c = a[b];\n                      (c.transport = c.protocol ? c.protocol : "udp"),\n                        (c.ip = c.ip ? c.ip : c.ipAddress),\n                        (c.port = c.portNumber ? Number(c.portNumber) : c.port),\n                        "ssltcp" === c.transport && (c.transport = "tcp"),\n                        c.id || (c.id = "csio" + c.port);\n                    }\n                    return a;\n                  },\n                },\n                {\n                  key: "normalizeCanidatePairs",\n                  value: function (a) {\n                    for (var b = 0; b < a.length; b += 1) {\n                      var c = a[b];\n                      "in-progress" === c.state && (c.state = "inprogress"),\n                        c.state || (c.state = "succeeded"),\n                        c.nominated ||\n                          (c.nominated = "true" === c.googActiveConnection),\n                        c.priority || (c.priority = 123),\n                        c.id || (c.id = "csio" + c.priority);\n                    }\n                    return a;\n                  },\n                },\n                {\n                  key: "processRawStatsForIceInfo",\n                  value: function (a) {\n                    var b = [],\n                      c = [],\n                      d = [],\n                      e = void 0;\n                    if (!a)\n                      return {\n                        localIceCandidates: b,\n                        remoteIceCandidates: c,\n                        iceCandidatePairs: d,\n                      };\n                    for (var f = 0; f < a.length; ++f) {\n                      var g = this.getParsedStats(a[f]),\n                        h = this.statsClassifier(g);\n                      if (h.candidatePair) d.push(h.candidatePair);\n                      else if (h.transportStats) {\n                        if ("transport" === h.transportStats.type) {\n                          e = h.transportStats.selectedCandidatePairId;\n                          continue;\n                        }\n                        d.push(h.transportStats);\n                      } else\n                        h.localCandidate\n                          ? b.push(h.localCandidate)\n                          : h.remoteCandidate && c.push(h.remoteCandidate);\n                    }\n                    if (e)\n                      for (var i = 0; i < d.length; ++i)\n                        d[i].id === e && (d[i].googActiveConnection = "true");\n                    return {\n                      localIceCandidates: this.normalizeIceCandidates(b),\n                      remoteIceCandidates: this.normalizeIceCandidates(c),\n                      iceCandidatePairs: this.normalizeCanidatePairs(d),\n                    };\n                  },\n                },\n                {\n                  key: "processRawStats",\n                  value: function (a, b) {\n                    var c = {},\n                      d = {},\n                      e = {};\n                    (c.tracks = []),\n                      (c.candidatePair = []),\n                      (c.transportStats = []),\n                      (c.trackStats = []),\n                      (c.codec = []);\n                    for (var f = 0; f < a.length; f++) {\n                      var g = this.getParsedStats(a[f]),\n                        h = this.statsClassifier(g);\n                      h.tracks\n                        ? c.tracks.push(h.tracks)\n                        : h.candidatePair\n                        ? c.candidatePair.push(h.candidatePair)\n                        : h.transportStats\n                        ? this.codeBase !== j.codeBaseType.firefox\n                          ? (parseInt(h.transportStats.bytesReceived, 10) > 0 ||\n                              parseInt(h.transportStats.bytesSent, 10) > 0) &&\n                            (c.transportStats.push(h.transportStats),\n                            ("true" !== h.transportStats.googActiveConnection &&\n                              !0 !== h.transportStats.googActiveConnection) ||\n                              (c.activeConnectionIndex =\n                                h.transportStats.length))\n                          : ("true" !== h.transportStats.selected &&\n                              !0 !== h.transportStats.selected) ||\n                            (c.transportStats.push(h.transportStats),\n                            (c.activeConnectionIndex = h.transportStats.length))\n                        : h.bwe\n                        ? (c.bwe = h.bwe)\n                        : h.trackStats\n                        ? c.trackStats.push(h.trackStats)\n                        : h.codec\n                        ? c.codec.push(h.codec)\n                        : h.localCandidate\n                        ? (d[h.localCandidate.id] = h.localCandidate)\n                        : h.remoteCandidate &&\n                          (e[h.remoteCandidate.id] = h.remoteCandidate);\n                    }\n                    if (c.tracks) {\n                      var i = l.Registry.getConferenceManager().getConferenceForPcHash(\n                          b\n                        ),\n                        k = void 0;\n                      i &&\n                        (k = i\n                          .getPeerConnectionManager()\n                          .getPcHandlerByHash(b)),\n                        c.tracks.forEach(function (a) {\n                          var b = k.getSSRCInfo(a.data.ssrc);\n                          (void 0 !== b && b.localStartTime) ||\n                            (k &&\n                              (k.updateSDP(c.tracks),\n                              (b = k.getSSRCInfo(a.data.ssrc)))),\n                            b &&\n                              ((a.cname = b.cname),\n                              (a.msid = b.msid),\n                              (a.associatedVideoTag = b.associatedVideoTag),\n                              (a.usageLabel = b.usageLabel));\n                        });\n                    }\n                    return (\n                      c.transportStats &&\n                        this.codeBase === j.codeBaseType.firefox &&\n                        (c.transportStats = this.getAddressInfoFromCandidates(\n                          c.transportStats,\n                          d,\n                          e\n                        )),\n                      c\n                    );\n                  },\n                },\n                {\n                  key: "getParsedStats",\n                  value: function (a) {\n                    var b = {};\n                    if (\n                      (a.timestamp instanceof Date &&\n                        (b.timestamp = a.timestamp.getTime().toString()),\n                      a.type && (b.type = a.type),\n                      a.names)\n                    ) {\n                      for (var c = a.names(), d = 0; d < c.length; ++d)\n                        b[c[d]] = a.stat(c[d]);\n                      a.id && (b.id = a.id);\n                    } else Object.assign(b, a);\n                    if (b.values) {\n                      for (var e = 0; e < b.values.length; ++e)\n                        Object.assign(b, b.values[e]);\n                      delete b.values;\n                    }\n                    return b;\n                  },\n                },\n                {\n                  key: "statsClassifier",\n                  value: function (a) {\n                    var b = {},\n                      c = function () {\n                        for (\n                          var b = arguments.length, c = Array(b), d = 0;\n                          d < b;\n                          d++\n                        )\n                          c[d] = arguments[d];\n                        return -1 !== c.indexOf(a.type);\n                      },\n                      d = c("inbound-rtp", "inboundrtp", "remote-inbound-rtp"),\n                      e = "true" === a.isRemote || !0 === a.isRemote;\n                    return (\n                      d ||\n                      c("outbound-rtp", "outboundrtp", "remote-outbound-rtp")\n                        ? ((b.tracks = {}),\n                          (b.tracks.data = a),\n                          (b.tracks.ssrc = a.ssrc),\n                          (b.tracks.streamType = d ? "inbound" : "outbound"),\n                          (b.tracks.reportType = "local"),\n                          void 0 !== a.isRemote &&\n                            (b.tracks.reportType = e ? "remote" : "local"))\n                        : c("candidatepair") && a.selected\n                        ? (b.transportStats = a)\n                        : c("localcandidate", "local-candidate")\n                        ? (b.localCandidate = a)\n                        : c("remotecandidate", "remote-candidate")\n                        ? (b.remoteCandidate = a)\n                        : c("transport", "googCandidatePair")\n                        ? (b.transportStats = a)\n                        : c("VideoBwe")\n                        ? (b.bwe = a)\n                        : c("track")\n                        ? (b.trackStats = a)\n                        : c("candidate-pair")\n                        ? (b.candidatePair = a)\n                        : c("codec")\n                        ? (b.codec = a)\n                        : c("ssrc") &&\n                          ((b.tracks = {}),\n                          (b.tracks.data = a),\n                          (b.tracks.ssrc = a.ssrc),\n                          (b.tracks.reportType = "local"),\n                          (b.tracks.streamType = a.bytesSent\n                            ? "outbound"\n                            : "inbound")),\n                      b\n                    );\n                  },\n                },\n                {\n                  key: "getAddressInfoFromCandidates",\n                  value: function (a, b, c) {\n                    for (var d = void 0, e = void 0, f = 0; f < a.length; f++)\n                      (d = b[a[f].localCandidateId]),\n                        (e = c[a[f].remoteCandidateId]),\n                        d &&\n                          e &&\n                          ((a[f].localAddr = d.ipAddress + ":" + d.portNumber),\n                          (a[f].remoteAddr = e.ipAddress + ":" + e.portNumber),\n                          (a[f].localAddrType = d.candidateType),\n                          (a[f].remoteAddrType = e.candidateType),\n                          (a[f].transportType = d.transport));\n                    return a;\n                  },\n                },\n                {\n                  key: "getTransportHash",\n                  value: function (a) {\n                    var b = void 0;\n                    return (\n                      a &&\n                        (this.codeBase === j.codeBaseType.chrome\n                          ? a.googLocalAddress\n                            ? ((b = a.googLocalAddress),\n                              b.concat(":", a.googRemoteAddress))\n                            : a.selectedCandidatePairId &&\n                              (b = a.selectedCandidatePairId)\n                          : this.codeBase === j.codeBaseType.firefox &&\n                            ((b = a.localAddr), b.concat(":", a.remoteAddr))),\n                      n.generateHash(b)\n                    );\n                  },\n                },\n                {\n                  key: "backFillTrackStats",\n                  value: function (a) {\n                    for (\n                      var b = a.tracks.length,\n                        c = void 0,\n                        d = void 0,\n                        e = void 0,\n                        f = 0;\n                      f < b;\n                      f++\n                    )\n                      (c = a.tracks[f]),\n                        c.data.trackId &&\n                          (d = this.getStatsForId(\n                            a.trackStats,\n                            c.data.trackId\n                          )) &&\n                          (a.tracks[f].data = this.mergeObjects(\n                            a.tracks[f].data,\n                            d\n                          )),\n                        c.data.codecId &&\n                          (e = this.getStatsForId(a.codec, c.data.codecId)) &&\n                          (a.tracks[f].data = this.mergeObjects(\n                            a.tracks[f].data,\n                            e\n                          ));\n                    return a;\n                  },\n                },\n                {\n                  key: "backFillCandidatePairStats",\n                  value: function (a) {\n                    for (\n                      var b = a.transportStats.length,\n                        c = void 0,\n                        d = void 0,\n                        e = 0;\n                      e < b;\n                      e++\n                    )\n                      (d = a.transportStats[e]),\n                        d.selectedCandidatePairId &&\n                          (c = this.getStatsForId(\n                            a.candidatePair,\n                            d.selectedCandidatePairId\n                          )) &&\n                          (a.transportStats[e] = this.mergeObjects(\n                            a.transportStats[e],\n                            c\n                          ));\n                    return a;\n                  },\n                },\n                {\n                  key: "mergeObjects",\n                  value: function (a, b) {\n                    for (var c in b)\n                      b.hasOwnProperty(c) &&\n                        "id" !== c &&\n                        "type" !== c &&\n                        (a[c] = b[c]);\n                    return a;\n                  },\n                },\n                {\n                  key: "getStatsForId",\n                  value: function (a, b) {\n                    if (a) {\n                      var c = a.filter(function (a) {\n                        return a.id === b;\n                      });\n                      if (c.length > 0) return c[0];\n                    }\n                  },\n                },\n                {\n                  key: "formatRelayType",\n                  value: function (a) {\n                    var b = "None";\n                    switch (a) {\n                      case 0:\n                        b = "TURN/TLS";\n                        break;\n\n                      case 1:\n                        b = "TURN/TCP";\n                        break;\n\n                      case 2:\n                        b = "TURN/UDP";\n                    }\n                    return b;\n                  },\n                },\n                {\n                  key: "getRelayType",\n                  value: function (a, b) {\n                    var c = this,\n                      d = void 0,\n                      e = function (b) {\n                        if (b.typePreference) {\n                          var e = b.typePreference >> 24;\n                          return (\n                            "rtp" === b.protocol &&\n                            b.address === a &&\n                            (e >= 0 &&\n                              e <= 2 &&\n                              (d = c.formatTypePreference(e)),\n                            !0)\n                          );\n                        }\n                        return !1;\n                      };\n                    return b.getIceCandidates().some(e), d;\n                  },\n                },\n                {\n                  key: "getTransportInfo",\n                  value: function (a, b) {\n                    for (var c = {}, d = !1, e = 0; e < a.length; e++) {\n                      var f = a[e];\n                      if (\n                        navigator.mozGetUserMedia &&\n                        "candidatepair" === f.type &&\n                        ("true" === f.selected || !0 === f.selected)\n                      ) {\n                        (c.foundActive = !0),\n                          (c.localAddr = f.localAddr),\n                          (c.remoteAddr = f.remoteAddr),\n                          (c.localAddrType = f.localAddrType),\n                          (c.remoteAddrType = f.remoteAddrType),\n                          (c.transportType = f.transportType),\n                          (c.localCandidateId = f.localCandidateId),\n                          (c.remoteCandidateId = f.remoteCandidateId);\n                        break;\n                      }\n                      if (\n                        "googCandidatePair" === f.type &&\n                        ("true" === f.googActiveConnection ||\n                          !0 === f.googActiveConnection)\n                      ) {\n                        (c.foundActive = !0),\n                          (c.localAddr = f.googLocalAddress),\n                          (c.remoteAddr = f.googRemoteAddress),\n                          (c.localAddrType = f.googLocalCandidateType),\n                          (c.remoteAddrType = f.googRemoteCandidateType),\n                          (c.transportType = f.googTransportType);\n                        break;\n                      }\n                      if ("transport" === f.type) {\n                        (d = !0),\n                          f.selectedCandidatePairId &&\n                            (c.selectedCandidatePairId =\n                              f.selectedCandidatePairId);\n                        break;\n                      }\n                    }\n                    return (\n                      d &&\n                        c.localAddr &&\n                        ((c.ipv6 = 0 === c.localAddr.indexOf("[")),\n                        (c.relayType = getRelayType(c.localAddr, b))),\n                      c\n                    );\n                  },\n                },\n                {\n                  key: "sendFabricTransportSwitch",\n                  value: function (a, b) {\n                    a.sendFabricTransportSwitch(b);\n                  },\n                },\n                {\n                  key: "checkTransportStatsUpdates",\n                  value: function (a, b) {\n                    var c = l.Registry.getConferenceManager().getConferenceForPcHash(\n                      b\n                    );\n                    if (c) {\n                      var d = c\n                        .getPeerConnectionManager()\n                        .getPcHandlerByHash(b);\n                      if (d) {\n                        var e = this.getTransportInfo(a, d),\n                          f = d.getTransportInfo();\n                        f &&\n                          ((f.localAddr === e.localAddr &&\n                            f.remoteAddr === e.remoteAddr &&\n                            f.transportType === e.transportType &&\n                            f.selectedCandidatePairId ===\n                              e.selectedCandidatePairId &&\n                            f.localCandidateId === e.localCandidateId &&\n                            f.remoteCandidateId === e.remoteCandidateId) ||\n                            (d.setTransportInfo(e),\n                            this.sendFabricTransportSwitch(d, e.relayType)));\n                      }\n                    }\n                  },\n                },\n              ]),\n              b\n            );\n          })(k.Component);\n        c.StatsAdapter = p;\n      },\n      {\n        "../collections/component": 26,\n        "../config/constants": 33,\n        "../utility/hash": 92,\n        "../utility/registry": 95,\n      },\n    ],\n    70: [\n      function (a, b, c) {\n        "use strict";\n        function d(a, b) {\n          if (!(a instanceof b))\n            throw new TypeError("Cannot call a class as a function");\n        }\n        function e(a, b) {\n          if (!a)\n            throw new ReferenceError(\n              "this hasn\'t been initialised - super() hasn\'t been called"\n            );\n          return !b || ("object" != typeof b && "function" != typeof b) ? a : b;\n        }\n        function f(a, b) {\n          if ("function" != typeof b && null !== b)\n            throw new TypeError(\n              "Super expression must either be null or a function, not " +\n                typeof b\n            );\n          (a.prototype = Object.create(b && b.prototype, {\n            constructor: {\n              value: a,\n              enumerable: !1,\n              writable: !0,\n              configurable: !0,\n            },\n          })),\n            b &&\n              (Object.setPrototypeOf\n                ? Object.setPrototypeOf(a, b)\n                : (a.__proto__ = b));\n        }\n        Object.defineProperty(c, "__esModule", {\n          value: !0,\n        }),\n          (c.StatsAssembler = c.StatsAssemblerIO = void 0);\n        var g = (function () {\n            function a(a, b) {\n              for (var c = 0; c < b.length; c++) {\n                var d = b[c];\n                (d.enumerable = d.enumerable || !1),\n                  (d.configurable = !0),\n                  "value" in d && (d.writable = !0),\n                  Object.defineProperty(a, d.key, d);\n              }\n            }\n            return function (b, c, d) {\n              return c && a(b.prototype, c), d && a(b, d), b;\n            };\n          })(),\n          h = a("../collections/component"),\n          i = (c.StatsAssemblerIO = {\n            StatsTupleIn: "StatsTupleIn",\n            CallstatsOut: "CallstatsOut",\n          }),\n          j = (function (a) {\n            function b() {\n              d(this, b);\n              var a = e(\n                this,\n                (b.__proto__ || Object.getPrototypeOf(b)).call(\n                  this,\n                  "StatsAssembler"\n                )\n              );\n              return (\n                (a.pcHashes = []),\n                a.bindPort(i.StatsTupleIn, a.receiveStats, a),\n                a.declarePort(i.CallstatsOut),\n                a\n              );\n            }\n            return (\n              f(b, a),\n              g(b, [\n                {\n                  key: "receiveStats",\n                  value: function (a) {\n                    for (var b = this, c = 0; c < a.tracks.length; c++) {\n                      (function (c) {\n                        var d = a.tracks[c];\n                        if (\n                          b.pcHashes.find(function (a) {\n                            return a === d.pcHash;\n                          })\n                        )\n                          return "continue";\n                        b.pcHashes.push(d.pcHash);\n                      })(c);\n                    }\n                    for (\n                      var d = a.getTransportStats(), c = 0;\n                      c < this.pcHashes.length;\n                      c++\n                    ) {\n                      var e = this.pcHashes[c],\n                        f = {};\n                      (f.codec = a.getCodec()),\n                        (f.trackStats = a.getTrackStats()),\n                        (f.tracks = []);\n                      for (var g = 0; g < a.tracks.length; g++) {\n                        var h = a.tracks[g];\n                        h.pcHash === e && f.tracks.push(h);\n                      }\n                      var j = d.get(e);\n                      1 == j.length ? (f.Transport = j[0]) : (f.Transport = j),\n                        this.transmit(i.CallstatsOut, e, f);\n                    }\n                  },\n                },\n              ]),\n              b\n            );\n          })(h.Component);\n        c.StatsAssembler = j;\n      },\n      {\n        "../collections/component": 26,\n      },\n    ],\n    71: [\n      function (a, b, c) {\n        "use strict";\n        function d(a, b) {\n          if (!(a instanceof b))\n            throw new TypeError("Cannot call a class as a function");\n        }\n        Object.defineProperty(c, "__esModule", {\n          value: !0,\n        }),\n          (c.StatsCallbackBuilder = void 0);\n        var e = (function () {\n            function a(a, b) {\n              for (var c = 0; c < b.length; c++) {\n                var d = b[c];\n                (d.enumerable = d.enumerable || !1),\n                  (d.configurable = !0),\n                  "value" in d && (d.writable = !0),\n                  Object.defineProperty(a, d.key, d);\n              }\n            }\n            return function (b, c, d) {\n              return c && a(b.prototype, c), d && a(b, d), b;\n            };\n          })(),\n          f = a("../utility/registry"),\n          g = (function () {\n            function a() {\n              d(this, a), (this.callback = null);\n            }\n            return (\n              e(a, [\n                {\n                  key: "setCallback",\n                  value: function (a) {\n                    this.callback = a;\n                  },\n                },\n                {\n                  key: "buildStats",\n                  value: function (a, b) {\n                    this.callback && this.buildFromUnifiedFormat(a, b);\n                  },\n                },\n                {\n                  key: "getConnectionState",\n                  value: function () {\n                    return !0 === navigator.onLine ? "online" : "offline";\n                  },\n                },\n                {\n                  key: "buildConferenceUrl",\n                  value: function (a) {\n                    var b = a.getConferenceId(),\n                      c = f.Registry.getConferenceManager().get(b);\n                    return c ? c.getUrl() : null;\n                  },\n                },\n                {\n                  key: "buildFromUnifiedFormat",\n                  value: function (a, b) {\n                    var c = {};\n                    (c.connectionState = this.getConnectionState()),\n                      (c.conferenceURL = this.buildConferenceUrl(b)),\n                      (c.fabricState = b.getPcState()),\n                      (c.streams = {}),\n                      (c.mediaStreamTracks = []);\n                    for (var d = 0; d < a.length; d++) {\n                      var e = a[d];\n                      if (\n                        "inbound-rtp" === e.type ||\n                        "outbound-rtp" === e.type ||\n                        "ssrc" === e.type ||\n                        "inboundrtp" === e.type ||\n                        "outboundrtp" === e.type\n                      ) {\n                        var f = {\n                            ssrc: e.ssrc,\n                            statsType: e.type,\n                            fractionLoss: e.csioIntFL,\n                            bitrate: e.csioIntBRKbps,\n                            quality: e.csioMark,\n                            mediaType: e.csioMediaType,\n                            jitter: e.jitter,\n                            audioOutputLevel: e.audioOutputLevel,\n                            audioIntputLevel: e.audioInputLevel,\n                            audioLevel: e.audioLevel,\n                            averageRTT: e.csioAvgRtt,\n                            averageJitter: e.csioAvgJitter,\n                            packetLossPercentage: e.csioPktLossPercentage,\n                            rtt: e.roundTripTime,\n                            packetRate: e.csioIntPR,\n                            remoteUserID: b.getRemoteId(),\n                          },\n                          g = b.getSSRCInfo(e.ssrc + "");\n                        if (\n                          (g &&\n                            ((f.cname = g.cname),\n                            (f.msid = g.msid),\n                            (f.usageLabel = g.usageLabel),\n                            (f.associatedVideoTag = g.associatedVideoTag)),\n                          e.hasOwnProperty("googRtt") && (f.rtt = e.googRtt),\n                          e.hasOwnProperty("mozRtt") && (f.rtt = e.mozRtt),\n                          e.hasOwnProperty("googJitterReceived") &&\n                            (f.jitter = e.googJitterReceived),\n                          "inboundrtp" === f.statsType)\n                        )\n                          f.statsType = "inbound-rtp";\n                        else if ("outboundrtp" === f.statsType)\n                          f.statsType = "outbound-rtp";\n                        else if ("ssrc" === f.statsType) {\n                          var h = e.id;\n                          h.indexOf("send") > 0\n                            ? (f.statsType = "outbound-rtp")\n                            : (f.statsType = "inbound-rtp");\n                        }\n                        "remote-inbound-rtp" !== f.statsType &&\n                          "remote-outbound-rtp" !== f.statsType &&\n                          ((!0 !== e.isRemote && "true" !== e.isRemote) ||\n                            (f.statsType = "remote-" + f.statsType)),\n                          (c.streams[e.ssrc] = f),\n                          c.mediaStreamTracks.push(f);\n                      }\n                    }\n                    this.callback(c);\n                  },\n                },\n              ]),\n              a\n            );\n          })();\n        c.StatsCallbackBuilder = g;\n      },\n      {\n        "../utility/registry": 95,\n      },\n    ],\n    72: [\n      function (a, b, c) {\n        "use strict";\n        function d(a) {\n          if (a && a.__esModule) return a;\n          var b = {};\n          if (null != a)\n            for (var c in a)\n              Object.prototype.hasOwnProperty.call(a, c) && (b[c] = a[c]);\n          return (b.default = a), b;\n        }\n        function e(a, b) {\n          if (!(a instanceof b))\n            throw new TypeError("Cannot call a class as a function");\n        }\n        function f(a, b) {\n          if (!a)\n            throw new ReferenceError(\n              "this hasn\'t been initialised - super() hasn\'t been called"\n            );\n          return !b || ("object" != typeof b && "function" != typeof b) ? a : b;\n        }\n        function g(a, b) {\n          if ("function" != typeof b && null !== b)\n            throw new TypeError(\n              "Super expression must either be null or a function, not " +\n                typeof b\n            );\n          (a.prototype = Object.create(b && b.prototype, {\n            constructor: {\n              value: a,\n              enumerable: !1,\n              writable: !0,\n              configurable: !0,\n            },\n          })),\n            b &&\n              (Object.setPrototypeOf\n                ? Object.setPrototypeOf(a, b)\n                : (a.__proto__ = b));\n        }\n        Object.defineProperty(c, "__esModule", {\n          value: !0,\n        }),\n          (c.StatsMonitor = c.StatsMonitorIO = void 0);\n        var h = (function () {\n            function a(a, b) {\n              for (var c = 0; c < b.length; c++) {\n                var d = b[c];\n                (d.enumerable = d.enumerable || !1),\n                  (d.configurable = !0),\n                  "value" in d && (d.writable = !0),\n                  Object.defineProperty(a, d.key, d);\n              }\n            }\n            return function (b, c, d) {\n              return c && a(b.prototype, c), d && a(b, d), b;\n            };\n          })(),\n          i = a("../collections/component"),\n          j = a("./tracksmonitor"),\n          k = a("./transportsmonitor"),\n          l = a("./statstuple"),\n          m = a("../utility/registry"),\n          n = a("./monitorhooks/sendingtrigger"),\n          o = a("./monitorhooks/onewaymediaobserver"),\n          p = a("./monitorhooks/throughputobserver"),\n          q = a("./monitorhooks/cpulimitationobserver"),\n          r = a("./monitorhooks/qpsumobserver"),\n          s = a("../config/constants"),\n          t = d(s),\n          u = a("../utility/csiologger"),\n          v = d(u),\n          w = (c.StatsMonitorIO = {\n            PcStatsTupleIn: "PcStatsTupleIn",\n            StatsTupleOut: "StatsTupleOut",\n          }),\n          x = (function (a) {\n            function b(a) {\n              e(this, b);\n              var c = f(\n                this,\n                (b.__proto__ || Object.getPrototypeOf(b)).call(\n                  this,\n                  "StatsMonitor"\n                )\n              );\n              return (\n                c.bindPort(w.PcStatsTupleIn, c.receive, c),\n                c.declarePort(w.StatsTupleOut),\n                (c.lastPcStats = null),\n                (c.lastPcHash = null),\n                (c.tracksmonitor = new j.TracksMonitor()),\n                (c.transportsmonitor = new k.TransportsMonitor(a)),\n                (c.candidatepairs = new Map()),\n                (c.monitorhooks = []),\n                (c.sendingTrigger = new n.SendingTrigger(\n                  c.sendStatsTuple.bind(c)\n                )),\n                (c.oneWayMediaObserver = new o.OneWayMediaObserver(\n                  c.sendDisruptions.bind(c)\n                )),\n                (c.throughputObserver = new p.ThroughputObserver(\n                  c.sendThroughputObservations.bind(c)\n                )),\n                (c.cpuLimitationObserver = new q.CPULimitationObserver(\n                  c.sendCPULimitationObservations.bind(c)\n                )),\n                (c.qpSumObserver = new r.QPSumObserver(\n                  c.sendQPSumDistortions.bind(c)\n                )),\n                c.setupHooks(),\n                c\n              );\n            }\n            return (\n              g(b, a),\n              h(b, [\n                {\n                  key: "setupHooks",\n                  value: function () {\n                    this.monitorhooks.push(\n                      this.sendingTrigger.accept.bind(this.sendingTrigger)\n                    ),\n                      this.monitorhooks.push(\n                        this.oneWayMediaObserver.accept.bind(\n                          this.oneWayMediaObserver\n                        )\n                      ),\n                      this.monitorhooks.push(\n                        this.throughputObserver.accept.bind(\n                          this.throughputObserver\n                        )\n                      ),\n                      this.monitorhooks.push(\n                        this.cpuLimitationObserver.accept.bind(\n                          this.cpuLimitationObserver\n                        )\n                      ),\n                      this.monitorhooks.push(\n                        this.qpSumObserver.accept.bind(this.qpSumObserver)\n                      );\n                  },\n                },\n                {\n                  key: "setIntervals",\n                  value: function (a, b) {\n                    this.sendingTrigger.setup(a, b);\n                  },\n                },\n                {\n                  key: "receive",\n                  value: function (a) {\n                    var b = a.getPcHash(),\n                      c = a.getMeasurements();\n                    this.candidatepairs.set(b, a.getCandidatePair()),\n                      this.transportsmonitor.set(b, a.getTransportStats());\n                    for (var d = 0; d < c.length; d++) {\n                      var e = c[d],\n                        f = this.tracksmonitor.getMonitor(e);\n                      f\n                        ? f.add(e)\n                        : v.warn("No monitor for ssrc " + e.getSSRC());\n                    }\n                    (this.lastPcStats = a), (this.lastPcHash = b);\n                    for (\n                      var g = this.tracksmonitor.getMonitors(),\n                        h = this.monitorhooks,\n                        i = 0;\n                      i < h.length;\n                      i++\n                    ) {\n                      (0, h[i])(g);\n                    }\n                  },\n                },\n                {\n                  key: "getCandidatePairs",\n                  value: function () {\n                    var a = [];\n                    return (\n                      this.candidatepairs.forEach(function (b, c) {\n                        var d = [c, b];\n                        a.push(d);\n                      }),\n                      a\n                    );\n                  },\n                },\n                {\n                  key: "sendStatsTuple",\n                  value: function () {\n                    var a = new l.StatsTuple(\n                      this.getCandidatePairs(),\n                      this.lastPcStats.getCodec(),\n                      this.lastPcStats.getTrackStats(),\n                      this.transportsmonitor.getIntervalStats(),\n                      this.tracksmonitor.extractTracks()\n                    );\n                    this.transmit(w.StatsTupleOut, a);\n                  },\n                },\n                {\n                  key: "sendDisruptions",\n                  value: function (a) {\n                    var b = this;\n                    a.forEach(function (a) {\n                      b.sendEventMsg(\n                        t.internalFabricEvent.oneWayMedia,\n                        a.getContent()\n                      );\n                    });\n                  },\n                },\n                {\n                  key: "sendCPULimitationObservations",\n                  value: function (a) {},\n                },\n                {\n                  key: "sendQPSumDistortions",\n                  value: function (a) {},\n                },\n                {\n                  key: "sendThroughputObservations",\n                  value: function (a) {\n                    this.sendEventMsg(\n                      t.internalFabricEvent.sendingThroughputObservations,\n                      a\n                    );\n                  },\n                },\n                {\n                  key: "sendEventMsg",\n                  value: function (a, b) {\n                    if (this.lastPcHash) {\n                      var c = m.Registry.getConferenceManager().getConferenceForPcHash(\n                        this.lastPcHash\n                      );\n                      if (c) {\n                        var d = c\n                            .getPeerConnectionManager()\n                            .getPcHandlerByHash(this.lastPcHash),\n                          e = d.getPeerConnection(),\n                          f = d.getConferenceId();\n                        m.Registry.getEventMessageBuilder().make(a, f, e, b);\n                      }\n                    }\n                  },\n                },\n              ]),\n              b\n            );\n          })(i.Component);\n        c.StatsMonitor = x;\n      },\n      {\n        "../collections/component": 26,\n        "../config/constants": 33,\n        "../utility/csiologger": 88,\n        "../utility/registry": 95,\n        "./monitorhooks/cpulimitationobserver": 61,\n        "./monitorhooks/onewaymediaobserver": 62,\n        "./monitorhooks/qpsumobserver": 63,\n        "./monitorhooks/sendingtrigger": 64,\n        "./monitorhooks/throughputobserver": 65,\n        "./statstuple": 75,\n        "./tracksmonitor": 81,\n        "./transportsmonitor": 82,\n      },\n    ],\n    73: [\n      function (a, b, c) {\n        "use strict";\n        function d(a) {\n          if (a && a.__esModule) return a;\n          var b = {};\n          if (null != a)\n            for (var c in a)\n              Object.prototype.hasOwnProperty.call(a, c) && (b[c] = a[c]);\n          return (b.default = a), b;\n        }\n        function e(a, b) {\n          if (!(a instanceof b))\n            throw new TypeError("Cannot call a class as a function");\n        }\n        function f(a, b) {\n          if (!a)\n            throw new ReferenceError(\n              "this hasn\'t been initialised - super() hasn\'t been called"\n            );\n          return !b || ("object" != typeof b && "function" != typeof b) ? a : b;\n        }\n        function g(a, b) {\n          if ("function" != typeof b && null !== b)\n            throw new TypeError(\n              "Super expression must either be null or a function, not " +\n                typeof b\n            );\n          (a.prototype = Object.create(b && b.prototype, {\n            constructor: {\n              value: a,\n              enumerable: !1,\n              writable: !0,\n              configurable: !0,\n            },\n          })),\n            b &&\n              (Object.setPrototypeOf\n                ? Object.setPrototypeOf(a, b)\n                : (a.__proto__ = b));\n        }\n        Object.defineProperty(c, "__esModule", {\n          value: !0,\n        }),\n          (c.StatsParser = c.StatsParserIO = void 0);\n        var h = (function () {\n            function a(a, b) {\n              for (var c = 0; c < b.length; c++) {\n                var d = b[c];\n                (d.enumerable = d.enumerable || !1),\n                  (d.configurable = !0),\n                  "value" in d && (d.writable = !0),\n                  Object.defineProperty(a, d.key, d);\n              }\n            }\n            return function (b, c, d) {\n              return c && a(b.prototype, c), d && a(b, d), b;\n            };\n          })(),\n          i = a("../collections/component"),\n          j = a("./measurement"),\n          k = a("./pcstats"),\n          l = a("../utility/rttregistry"),\n          m = a("./validator"),\n          n = d(m),\n          o = a("../config/constants"),\n          p = d(o),\n          q = a("../utility/csiologger"),\n          r = d(q),\n          s = (c.StatsParserIO = {\n            RawStatsIn: "RawStatsIn",\n            PcStatsTupleOut: "PcStatsTupleOut",\n          }),\n          t = (function (a) {\n            function b() {\n              e(this, b);\n              var a = f(\n                this,\n                (b.__proto__ || Object.getPrototypeOf(b)).call(\n                  this,\n                  "StatsParser"\n                )\n              );\n              return (\n                a.bindPort(s.RawStatsIn, a.receive, a),\n                a.declarePort(s.PcStatsTupleOut),\n                a\n              );\n            }\n            return (\n              g(b, a),\n              h(b, [\n                {\n                  key: "receive",\n                  value: function (a) {\n                    if (null === a)\n                      return void r.warn("Stats object can not be null");\n                    for (var b = a.tracks, c = [], d = 0; d < b.length; ++d) {\n                      var e = b[d];\n                      if (e && e.data) {\n                        var f = j.Measurement.make(\n                          a.pcHash,\n                          this.getSSRC(e),\n                          this.getStreamType(e),\n                          this.getMediaType(e),\n                          this.getFrameRateReceived(e),\n                          this.getFrameHeight(e),\n                          this.getFrameWidth(e),\n                          this.getDroppedFramesNum(e),\n                          this.getFramesReceived(e),\n                          this.getRTT(e),\n                          this.getJitter(e),\n                          this.getLostPackets(e),\n                          this.getReceivedPackets(e),\n                          this.getSentPackets(e),\n                          this.getDiscardedPackets(e),\n                          this.getSentBytes(e),\n                          this.getReceivedBytes(e),\n                          e\n                        );\n                        c.push(f);\n                      } else r.log("No track or track.data.");\n                    }\n                    var g = new k.PcStats(\n                      a.candidatePair,\n                      a.codec,\n                      a.pcHash,\n                      a.trackStats,\n                      a.transportStats,\n                      c\n                    );\n                    this.transmit(s.PcStatsTupleOut, g);\n                  },\n                },\n                {\n                  key: "getSSRC",\n                  value: function (a) {\n                    return a.ssrc;\n                  },\n                },\n                {\n                  key: "getStreamType",\n                  value: function (a) {\n                    return a.streamType === p.streamType.inbound\n                      ? p.streamType.inbound\n                      : a.streamType === p.streamType.outbound\n                      ? p.streamType.outbound\n                      : void 0;\n                  },\n                },\n                {\n                  key: "getSentBytes",\n                  value: function (a) {\n                    if (void 0 === a.data.bytesSent) return -1;\n                    var b = n.checkForNan(parseInt(a.data.bytesSent, 10));\n                    return null !== b ? b : -1;\n                  },\n                },\n                {\n                  key: "getReceivedBytes",\n                  value: function (a) {\n                    if (void 0 === a.data.bytesReceived) return -1;\n                    var b = n.checkForNan(parseInt(a.data.bytesReceived, 10));\n                    return null !== b ? b : -1;\n                  },\n                },\n                {\n                  key: "getReceivedPackets",\n                  value: function (a) {\n                    if (void 0 === a.data.packetsReceived) return -1;\n                    var b = n.checkForNegativeValue(\n                      parseInt(a.data.packetsReceived, 10)\n                    );\n                    return null !== b ? b : -1;\n                  },\n                },\n                {\n                  key: "getSentPackets",\n                  value: function (a) {\n                    if (void 0 === a.data.packetsSent) return -1;\n                    var b = n.checkForNegativeValue(\n                      parseInt(a.data.packetsSent, 10)\n                    );\n                    return null !== b ? b : -1;\n                  },\n                },\n                {\n                  key: "getDiscardedPackets",\n                  value: function (a) {\n                    if (void 0 === a.data.discardedPackets) return -1;\n                    var b = n.checkForNan(\n                      parseInt(a.data.discardedPackets, 10)\n                    );\n                    return null !== b ? b : -1;\n                  },\n                },\n                {\n                  key: "getLostPackets",\n                  value: function (a) {\n                    if (void 0 === a.data.packetsLost) return -1;\n                    var b = n.checkForNegativeValue(\n                      parseInt(a.data.packetsLost, 10)\n                    );\n                    return null !== b ? b : -1;\n                  },\n                },\n                {\n                  key: "getDroppedFramesNum",\n                  value: function (a) {\n                    if (void 0 === a.data.droppedFrames) return -1;\n                    var b = n.checkForNegativeValue(\n                      parseInt(a.data.droppedFrames, 10)\n                    );\n                    return null !== b ? b : -1;\n                  },\n                },\n                {\n                  key: "getFramesReceived",\n                  value: function (a) {\n                    if (void 0 === a.data.framesReceived) return -1;\n                    var b = n.checkForNegativeValue(\n                      parseInt(a.data.framesReceived, 10)\n                    );\n                    return null !== b ? b : -1;\n                  },\n                },\n                {\n                  key: "getFrameRateReceived",\n                  value: function (a) {\n                    var b = null;\n                    return (\n                      void 0 !== a.data.googFrameRateOutput\n                        ? (b = parseInt(a.data.googFrameRateOutput, 10))\n                        : void 0 !== a.data.googFrameRateDecoded\n                        ? (b = parseInt(a.data.googFrameRateDecoded, 10))\n                        : void 0 !== a.data.googFrameRateReceived\n                        ? (b = parseInt(a.data.googFrameRateReceived, 10))\n                        : void 0 !== a.data.googFrameRateSent\n                        ? (b = parseInt(a.data.googFrameRateSent, 10))\n                        : void 0 !== a.data.framerateMean\n                        ? (b = parseInt(a.data.framerateMean, 10))\n                        : void 0 !== a.data.framesPerSecond &&\n                          (b = parseInt(a.data.framesPerSecond, 10)),\n                      void 0 !== b && (b = n.checkForNegativeValue(b)),\n                      b\n                    );\n                  },\n                },\n                {\n                  key: "getFrameHeight",\n                  value: function (a) {\n                    var b = void 0;\n                    return (\n                      void 0 !== a.data.googFrameHeightReceived\n                        ? (b = a.data.googFrameHeightReceived)\n                        : void 0 !== a.data.googFrameHeightSent\n                        ? (b = a.data.googFrameHeightSent)\n                        : void 0 !== a.data.frameHeight &&\n                          (b = a.data.frameHeight),\n                      b\n                    );\n                  },\n                },\n                {\n                  key: "getJitter",\n                  value: function (a) {\n                    return void 0 !== a.data.googJitterReceived\n                      ? n.checkForNan(parseFloat(a.data.googJitterReceived, 10))\n                      : void 0 !== a.data.jitter\n                      ? n.checkForNan(parseFloat(a.data.jitter, 10))\n                      : void 0;\n                  },\n                },\n                {\n                  key: "getFrameWidth",\n                  value: function (a) {\n                    return void 0 !== a.data.googFrameWidthReceived\n                      ? a.data.googFrameWidthReceived\n                      : void 0 !== a.data.googFrameWidthSent\n                      ? a.data.googFrameWidthSent\n                      : void 0 !== a.data.frameWidth\n                      ? a.data.frameWidth\n                      : void 0;\n                  },\n                },\n                {\n                  key: "getRTT",\n                  value: function (a) {\n                    var b = function (a) {\n                      return isNaN(a) || a < 0 ? null : a;\n                    };\n                    if (void 0 !== a.data.googRtt)\n                      return b(parseFloat(a.data.googRtt, 10));\n                    if (void 0 !== a.data.mozRtt)\n                      return b(parseFloat(a.data.mozRtt, 10));\n                    if (a.data.roundTripTime)\n                      return b(parseFloat(a.data.roundTripTime, 10));\n                    var c = this.getSSRC(a),\n                      d = (0, l.getRTTRegistry)().getRTT(c);\n                    return d && (a.data.roundTripTime = d), d;\n                  },\n                },\n                {\n                  key: "getMediaType",\n                  value: function (a) {\n                    var b = p.mediaType.unknown;\n                    return a.data && void 0 !== a.data.mediaType\n                      ? a.data.mediaType\n                      : (void 0 !== a.data.googFrameRateReceived ||\n                        void 0 !== a.data.googFrameRateSent\n                          ? (b = p.mediaType.video)\n                          : void 0 !== a.data.audioInputLevel ||\n                            void 0 !== a.data.audioOutputLevel\n                          ? (b = p.mediaType.audio)\n                          : a.data.mediaType\n                          ? (b = a.data.mediaType)\n                          : void 0 !== a.data.framerateMean &&\n                            (b = p.mediaType.video),\n                        b);\n                  },\n                },\n              ]),\n              b\n            );\n          })(i.Component);\n        c.StatsParser = t;\n      },\n      {\n        "../collections/component": 26,\n        "../config/constants": 33,\n        "../utility/csiologger": 88,\n        "../utility/rttregistry": 96,\n        "./measurement": 60,\n        "./pcstats": 67,\n        "./validator": 83,\n      },\n    ],\n    74: [\n      function (a, b, c) {\n        "use strict";\n        function d(a) {\n          if (a && a.__esModule) return a;\n          var b = {};\n          if (null != a)\n            for (var c in a)\n              Object.prototype.hasOwnProperty.call(a, c) && (b[c] = a[c]);\n          return (b.default = a), b;\n        }\n        function e(a, b) {\n          if (!(a instanceof b))\n            throw new TypeError("Cannot call a class as a function");\n        }\n        function f(a, b) {\n          if (!a)\n            throw new ReferenceError(\n              "this hasn\'t been initialised - super() hasn\'t been called"\n            );\n          return !b || ("object" != typeof b && "function" != typeof b) ? a : b;\n        }\n        function g(a, b) {\n          if ("function" != typeof b && null !== b)\n            throw new TypeError(\n              "Super expression must either be null or a function, not " +\n                typeof b\n            );\n          (a.prototype = Object.create(b && b.prototype, {\n            constructor: {\n              value: a,\n              enumerable: !1,\n              writable: !0,\n              configurable: !0,\n            },\n          })),\n            b &&\n              (Object.setPrototypeOf\n                ? Object.setPrototypeOf(a, b)\n                : (a.__proto__ = b));\n        }\n        Object.defineProperty(c, "__esModule", {\n          value: !0,\n        }),\n          (c.StatsTransmitter = c.StatsTransmitterIO = void 0);\n        var h = (function () {\n            function a(a, b) {\n              for (var c = 0; c < b.length; c++) {\n                var d = b[c];\n                (d.enumerable = d.enumerable || !1),\n                  (d.configurable = !0),\n                  "value" in d && (d.writable = !0),\n                  Object.defineProperty(a, d.key, d);\n              }\n            }\n            return function (b, c, d) {\n              return c && a(b.prototype, c), d && a(b, d), b;\n            };\n          })(),\n          i = a("../collections/component"),\n          j = a("../utility/registry"),\n          k = a("../config/constants"),\n          l = d(k),\n          m = a("../utility/csiologger"),\n          n = d(m),\n          o = (c.StatsTransmitterIO = {\n            CallstatsIn: "CallstatsIn",\n            UnprocessedIn: "UnprocessedIn",\n          }),\n          p = (function (a) {\n            function b() {\n              e(this, b);\n              var a = f(\n                this,\n                (b.__proto__ || Object.getPrototypeOf(b)).call(\n                  this,\n                  "StatsTransmitter"\n                )\n              );\n              return (\n                (a.battery = j.Registry.getBattery()),\n                (a.lastUnprocessedStats = {}),\n                a.bindPort(o.CallstatsIn, a.receiveCallstats, a),\n                a.bindPort(o.UnprocessedIn, a.receiveUnprocessed, a),\n                a\n              );\n            }\n            return (\n              g(b, a),\n              h(b, [\n                {\n                  key: "receiveUnprocessed",\n                  value: function (a, b) {\n                    this.lastUnprocessedStats[b] = a;\n                  },\n                },\n                {\n                  key: "receiveCallstats",\n                  value: function (a, b) {\n                    var c = null;\n                    if (!(c = this.getUnifiedFormat(b, a)))\n                      return void n.warn("Content can not be sent");\n                    this.send(a, c);\n                  },\n                },\n                {\n                  key: "send",\n                  value: function (a, b) {\n                    var c = j.Registry.getConferenceManager().getConferenceForPcHash(\n                      a\n                    );\n                    if (c) {\n                      var d = c\n                        .getPeerConnectionManager()\n                        .getPcHandlerByHash(a);\n                      if (d) {\n                        var e = d.getPcState();\n                        if (\n                          e !== l.fabricState.terminated &&\n                          e !== l.fabricState.hold\n                        ) {\n                          j.Registry.getEventMessageBuilder().make(\n                            l.callstatsChannels.processedStats,\n                            d.getConferenceId(),\n                            d.getPeerConnection(),\n                            b\n                          ),\n                            this.sendToStatsCallback(b.stats, d);\n                        }\n                      }\n                    }\n                  },\n                },\n                {\n                  key: "sendToStatsCallback",\n                  value: function (a, b) {\n                    var c = j.Registry.getStatsCallbackBuilder();\n                    c && c.buildStats(a, b);\n                  },\n                },\n                {\n                  key: "getUnifiedFormat",\n                  value: function (a, b) {\n                    for (\n                      var c = this.lastUnprocessedStats[b], d = [], e = 0;\n                      e < c.length;\n                      e++\n                    ) {\n                      var f = c[e],\n                        g = {};\n                      if (\n                        (f.id && (g.id = f.id),\n                        f.timestamp && (g.timestamp = f.timestamp),\n                        f.type && (g.type = f.type),\n                        f.names)\n                      )\n                        for (var h = f.names(), i = 0; i < h.length; ++i)\n                          g[h[i]] = f.stat(h[i]);\n                      else Object.assign(g, f);\n                      if (g.values) {\n                        for (var k = 0; k < g.values.length; ++k)\n                          Object.assign(g, g.values[k]);\n                        delete g.values;\n                      }\n                      var l = (function (b) {\n                        for (var c = 0; c < a.tracks.length; c++) {\n                          var d = a.tracks[c];\n                          if (d.data.id === b.id && d.data.type === b.type)\n                            return d.data;\n                        }\n                        return b.id === a.Transport.id &&\n                          b.type === a.Transport.type\n                          ? a.Transport\n                          : null;\n                      })(f);\n                      if (l) {\n                        for (var m in l)\n                          if (l.hasOwnProperty(m)) {\n                            if ("id" === m || "type" === m || "timestamp" === m)\n                              continue;\n                            g[m] = l[m];\n                          }\n                        d.push(g);\n                      } else d.push(g);\n                    }\n                    var n = {\n                      stats: d,\n                    };\n                    return (\n                      (n.wifiStats = j.Registry.getWifiStatsExecutor().getWifiStats()),\n                      (n.batteryStatus = {}),\n                      (n.batteryStatus.batteryLevel = this.battery.getLevel()),\n                      (n.batteryStatus.isBatteryCharging = this.battery.getCharging()),\n                      n\n                    );\n                  },\n                },\n              ]),\n              b\n            );\n          })(i.Component);\n        c.StatsTransmitter = p;\n      },\n      {\n        "../collections/component": 26,\n        "../config/constants": 33,\n        "../utility/csiologger": 88,\n        "../utility/registry": 95,\n      },\n    ],\n    75: [\n      function (a, b, c) {\n        "use strict";\n        function d(a, b) {\n          if (!(a instanceof b))\n            throw new TypeError("Cannot call a class as a function");\n        }\n        Object.defineProperty(c, "__esModule", {\n          value: !0,\n        });\n        var e = (function () {\n            function a(a, b) {\n              for (var c = 0; c < b.length; c++) {\n                var d = b[c];\n                (d.enumerable = d.enumerable || !1),\n                  (d.configurable = !0),\n                  "value" in d && (d.writable = !0),\n                  Object.defineProperty(a, d.key, d);\n              }\n            }\n            return function (b, c, d) {\n              return c && a(b.prototype, c), d && a(b, d), b;\n            };\n          })(),\n          f = (function () {\n            function a(b, c, e, f, g) {\n              d(this, a),\n                (this.candidatePairs = b),\n                (this.codec = c),\n                (this.trackStats = e),\n                (this.transportStats = f),\n                (this.tracks = g);\n            }\n            return (\n              e(a, [\n                {\n                  key: "getCandidatePairs",\n                  value: function () {\n                    return this.candidatePairs;\n                  },\n                },\n                {\n                  key: "getCodec",\n                  value: function () {\n                    return this.codec;\n                  },\n                },\n                {\n                  key: "getTrackStats",\n                  value: function () {\n                    return this.trackStats;\n                  },\n                },\n                {\n                  key: "getTransportStats",\n                  value: function () {\n                    return this.transportStats;\n                  },\n                },\n                {\n                  key: "getTracks",\n                  value: function () {\n                    return this.tracks;\n                  },\n                },\n              ]),\n              a\n            );\n          })();\n        c.StatsTuple = f;\n      },\n      {},\n    ],\n    76: [\n      function (a, b, c) {\n        "use strict";\n        function d(a, b) {\n          if (!(a instanceof b))\n            throw new TypeError("Cannot call a class as a function");\n        }\n        function e(a, b) {\n          if (!a)\n            throw new ReferenceError(\n              "this hasn\'t been initialised - super() hasn\'t been called"\n            );\n          return !b || ("object" != typeof b && "function" != typeof b) ? a : b;\n        }\n        function f(a, b) {\n          if ("function" != typeof b && null !== b)\n            throw new TypeError(\n              "Super expression must either be null or a function, not " +\n                typeof b\n            );\n          (a.prototype = Object.create(b && b.prototype, {\n            constructor: {\n              value: a,\n              enumerable: !1,\n              writable: !0,\n              configurable: !0,\n            },\n          })),\n            b &&\n              (Object.setPrototypeOf\n                ? Object.setPrototypeOf(a, b)\n                : (a.__proto__ = b));\n        }\n        Object.defineProperty(c, "__esModule", {\n          value: !0,\n        }),\n          (c.SWAvg = void 0);\n        var g = (function () {\n            function a(a, b) {\n              for (var c = 0; c < b.length; c++) {\n                var d = b[c];\n                (d.enumerable = d.enumerable || !1),\n                  (d.configurable = !0),\n                  "value" in d && (d.writable = !0),\n                  Object.defineProperty(a, d.key, d);\n              }\n            }\n            return function (b, c, d) {\n              return c && a(b.prototype, c), d && a(b, d), b;\n            };\n          })(),\n          h = a("./swplugin"),\n          i = (function (a) {\n            function b(a, c) {\n              var f =\n                arguments.length > 2 && void 0 !== arguments[2]\n                  ? arguments[2]\n                  : null;\n              d(this, b);\n              var g = e(\n                this,\n                (b.__proto__ || Object.getPrototypeOf(b)).call(this, a, c, f)\n              );\n              return (g.sum = 0), (g.counter = 0), g;\n            }\n            return (\n              f(b, a),\n              g(b, [\n                {\n                  key: "add",\n                  value: function (a) {\n                    this.filter(a) &&\n                      ((this.sum += this.extract(a)),\n                      ++this.counter,\n                      this.calculate());\n                  },\n                },\n                {\n                  key: "remove",\n                  value: function (a) {\n                    this.filter(a) &&\n                      ((this.sum -= this.extract(a)),\n                      --this.counter,\n                      this.calculate());\n                  },\n                },\n                {\n                  key: "calculate",\n                  value: function () {\n                    var a = 0;\n                    if (this.counter < 1) return void this.notify(a);\n                    (a = this.sum / this.counter), this.notify(a);\n                  },\n                },\n              ]),\n              b\n            );\n          })(h.SWPlugin);\n        c.SWAvg = i;\n      },\n      {\n        "./swplugin": 79,\n      },\n    ],\n    77: [\n      function (a, b, c) {\n        "use strict";\n        function d(a, b) {\n          if (!(a instanceof b))\n            throw new TypeError("Cannot call a class as a function");\n        }\n        function e(a, b) {\n          if (!a)\n            throw new ReferenceError(\n              "this hasn\'t been initialised - super() hasn\'t been called"\n            );\n          return !b || ("object" != typeof b && "function" != typeof b) ? a : b;\n        }\n        function f(a, b) {\n          if ("function" != typeof b && null !== b)\n            throw new TypeError(\n              "Super expression must either be null or a function, not " +\n                typeof b\n            );\n          (a.prototype = Object.create(b && b.prototype, {\n            constructor: {\n              value: a,\n              enumerable: !1,\n              writable: !0,\n              configurable: !0,\n            },\n          })),\n            b &&\n              (Object.setPrototypeOf\n                ? Object.setPrototypeOf(a, b)\n                : (a.__proto__ = b));\n        }\n        Object.defineProperty(c, "__esModule", {\n          value: !0,\n        }),\n          (c.SWBTreePercentile = void 0);\n        var g = (function () {\n            function a(a, b) {\n              var c = [],\n                d = !0,\n                e = !1,\n                f = void 0;\n              try {\n                for (\n                  var g, h = a[Symbol.iterator]();\n                  !(d = (g = h.next()).done) &&\n                  (c.push(g.value), !b || c.length !== b);\n                  d = !0\n                );\n              } catch (a) {\n                (e = !0), (f = a);\n              } finally {\n                try {\n                  !d && h.return && h.return();\n                } finally {\n                  if (e) throw f;\n                }\n              }\n              return c;\n            }\n            return function (b, c) {\n              if (Array.isArray(b)) return b;\n              if (Symbol.iterator in Object(b)) return a(b, c);\n              throw new TypeError(\n                "Invalid attempt to destructure non-iterable instance"\n              );\n            };\n          })(),\n          h = (function () {\n            function a(a, b) {\n              for (var c = 0; c < b.length; c++) {\n                var d = b[c];\n                (d.enumerable = d.enumerable || !1),\n                  (d.configurable = !0),\n                  "value" in d && (d.writable = !0),\n                  Object.defineProperty(a, d.key, d);\n              }\n            }\n            return function (b, c, d) {\n              return c && a(b.prototype, c), d && a(b, d), b;\n            };\n          })(),\n          i = a("./swplugin"),\n          j = a("../../collections/binarytree"),\n          k = (function (a) {\n            function b(a, c, f, g) {\n              var h =\n                  arguments.length > 4 && void 0 !== arguments[4]\n                    ? arguments[4]\n                    : null,\n                i =\n                  arguments.length > 5 && void 0 !== arguments[5]\n                    ? arguments[5]\n                    : null,\n                k =\n                  arguments.length > 6 && void 0 !== arguments[6]\n                    ? arguments[6]\n                    : null;\n              d(this, b);\n              var l = e(\n                this,\n                (b.__proto__ || Object.getPrototypeOf(b)).call(this, f, g, i)\n              );\n              if (99 < a || a < 1)\n                throw new RangeError(\n                  "Percentile parameter must be between 1 and 99"\n                );\n              return (\n                (l.comparator = c),\n                (l.percentile = a),\n                (l.meanCalcer = k),\n                (l.estimator = h),\n                (l.ratio = a / (100 - a)),\n                (l.maxtree = new j.BinaryTree(c)),\n                (l.mintree = new j.BinaryTree(c)),\n                l.ratio < 1\n                  ? (l.required = 1 / l.ratio + 1)\n                  : 1 < l.ratio\n                  ? (l.required = l.ratio + 1)\n                  : (l.required = 2),\n                (l.result = null),\n                l\n              );\n            }\n            return (\n              f(b, a),\n              h(b, [\n                {\n                  key: "add",\n                  value: function (a) {\n                    if (this.filter(a)) {\n                      if (this.maxtree.getNodeCounter() < 1)\n                        return this.maxtree.insert(a), void this.calculate();\n                      this.comparator(a, this.maxtree.getTopValue()) <= 0\n                        ? this.maxtree.insert(a)\n                        : this.mintree.insert(a),\n                        this.balancing(),\n                        this.calculate();\n                    }\n                  },\n                },\n                {\n                  key: "remove",\n                  value: function (a) {\n                    if (this.filter(a)) {\n                      var b = this.mintree.getNodeCounter();\n                      this.maxtree.getNodeCounter() < 1\n                        ? this.mintree.delete(a)\n                        : b < 1\n                        ? this.maxtree.delete(a)\n                        : this.comparator(a, this.maxtree.getTopValue()) <= 0\n                        ? this.maxtree.delete(a)\n                        : this.mintree.delete(a),\n                        this.calculate();\n                    }\n                  },\n                },\n                {\n                  key: "getThresholds",\n                  value: function () {\n                    var a = this.mintree.getSize(),\n                      b = this.maxtree.getSize(),\n                      c = a + 1,\n                      d = b + 1;\n                    return (\n                      1 < this.ratio\n                        ? ((c = Math.ceil(a * this.ratio)),\n                          (d = Math.floor(b / this.ratio) + 1))\n                        : this.ratio < 1 &&\n                          ((c = Math.floor(a * this.ratio) + 1),\n                          (d = Math.ceil(b / this.ratio))),\n                      [c, d]\n                    );\n                  },\n                },\n                {\n                  key: "balancing",\n                  value: function () {\n                    var a = this.mintree,\n                      b = this.maxtree,\n                      c = a.getSize(),\n                      d = b.getSize();\n                    if (!(d + c < this.required)) {\n                      if (c < 1)\n                        return void a.insertNodeAtBottom(b.popTopNode());\n                      for (d < 1 && b.insertNodeAtTop(a.popBottomNode()); ; ) {\n                        var e = 1 < a.getNodeCounter(),\n                          f = 1 < b.getNodeCounter(),\n                          h = a.getBottomNode().getLength(),\n                          i = b.getTopNode().getLength();\n                        if (a.getNodeCounter() < 1 || b.getNodeCounter() < 1)\n                          break;\n                        var j = this.getThresholds(),\n                          k = g(j, 2),\n                          l = k[0],\n                          m = k[1];\n                        if (\n                          ((f &= c + i <= m),\n                          (e &= d + h <= l),\n                          (c = a.getSize()),\n                          (d = b.getSize()),\n                          l < d && f)\n                        )\n                          a.insertNodeAtBottom(b.popTopNode());\n                        else {\n                          if (!(m < c && e)) break;\n                          b.insertNodeAtTop(a.popBottomNode());\n                        }\n                      }\n                    }\n                  },\n                },\n                {\n                  key: "getMean",\n                  value: function (a, b) {\n                    return this.meanCalcer ? this.meanCalcer(a, b) : a;\n                  },\n                },\n                {\n                  key: "estimate",\n                  value: function (a, b) {\n                    return this.estimator ? this.estimator(a, b) : null;\n                  },\n                },\n                {\n                  key: "calculate",\n                  value: function () {\n                    var a = null,\n                      b = this.mintree,\n                      c = this.maxtree,\n                      d = b.getSize(),\n                      e = c.getSize(),\n                      f = e + d;\n                    if (!(f < 1)) {\n                      if (f < this.required || d < 1 || e < 1) {\n                        if (0 == f) return;\n                        var g = void 0,\n                          h = void 0;\n                        d < 1\n                          ? ((g = this.maxtree.getBottomValue()),\n                            (h = this.maxtree.getTopValue()))\n                          : e < 1\n                          ? ((g = this.mintree.getBottomValue()),\n                            (h = this.mintree.getTopValue()))\n                          : ((h = this.mintree.getTopValue()),\n                            (g = this.maxtree.getBottomValue()));\n                        var i = this.estimate(g, h);\n                        return void this.notify(i);\n                      }\n                      var j = c.getTopNode(),\n                        k = b.getBottomNode();\n                      if (j || k) {\n                        if (!j) {\n                          var l = this.extract(k);\n                          return void this.notify(l);\n                        }\n                        if (!k) {\n                          var m = this.extract(j);\n                          return void this.notify(m);\n                        }\n                        var n = f * (this.percentile / 100);\n                        if (!Number.isInteger(n)) {\n                          var o = e / d;\n                          a =\n                            this.ratio < o\n                              ? j.peek()\n                              : o < this.ratio\n                              ? k.peek()\n                              : this.ratio < 1\n                              ? k.peek()\n                              : j.peek();\n                        } else {\n                          var p = Math.floor(n);\n                          a =\n                            Math.ceil(n + 1) <= e\n                              ? j.peek()\n                              : p <= e\n                              ? this.getMean(j.peek(), k.peek())\n                              : k.peek();\n                        }\n                        var q = this.extract(a);\n                        this.notify(q);\n                      }\n                    }\n                  },\n                },\n              ]),\n              b\n            );\n          })(i.SWPlugin);\n        c.SWBTreePercentile = k;\n      },\n      {\n        "../../collections/binarytree": 23,\n        "./swplugin": 79,\n      },\n    ],\n    78: [\n      function (a, b, c) {\n        "use strict";\n        function d(a, b) {\n          if (!(a instanceof b))\n            throw new TypeError("Cannot call a class as a function");\n        }\n        function e(a, b) {\n          if (!a)\n            throw new ReferenceError(\n              "this hasn\'t been initialised - super() hasn\'t been called"\n            );\n          return !b || ("object" != typeof b && "function" != typeof b) ? a : b;\n        }\n        function f(a, b) {\n          if ("function" != typeof b && null !== b)\n            throw new TypeError(\n              "Super expression must either be null or a function, not " +\n                typeof b\n            );\n          (a.prototype = Object.create(b && b.prototype, {\n            constructor: {\n              value: a,\n              enumerable: !1,\n              writable: !0,\n              configurable: !0,\n            },\n          })),\n            b &&\n              (Object.setPrototypeOf\n                ? Object.setPrototypeOf(a, b)\n                : (a.__proto__ = b));\n        }\n        Object.defineProperty(c, "__esModule", {\n          value: !0,\n        }),\n          (c.SWFunctor = void 0);\n        var g = (function () {\n            function a(a, b) {\n              for (var c = 0; c < b.length; c++) {\n                var d = b[c];\n                (d.enumerable = d.enumerable || !1),\n                  (d.configurable = !0),\n                  "value" in d && (d.writable = !0),\n                  Object.defineProperty(a, d.key, d);\n              }\n            }\n            return function (b, c, d) {\n              return c && a(b.prototype, c), d && a(b, d), b;\n            };\n          })(),\n          h = a("./swplugin"),\n          i = (function (a) {\n            function b(a, c) {\n              var f =\n                arguments.length > 2 && void 0 !== arguments[2]\n                  ? arguments[2]\n                  : null;\n              d(this, b);\n              var g = e(\n                this,\n                (b.__proto__ || Object.getPrototypeOf(b)).call(\n                  this,\n                  null,\n                  null,\n                  f\n                )\n              );\n              return (g.addFunc = a), (g.remFunc = c), g;\n            }\n            return (\n              f(b, a),\n              g(b, [\n                {\n                  key: "add",\n                  value: function (a) {\n                    this.filter(a) && this.addFunc && this.addFunc(a);\n                  },\n                },\n                {\n                  key: "remove",\n                  value: function (a) {\n                    this.filter(a) && this.remFunc && this.remFunc(a);\n                  },\n                },\n                {\n                  key: "toString",\n                  value: function () {\n                    return "SWFuncPlugin";\n                  },\n                },\n              ]),\n              b\n            );\n          })(h.SWPlugin);\n        c.SWFunctor = i;\n      },\n      {\n        "./swplugin": 79,\n      },\n    ],\n    79: [\n      function (a, b, c) {\n        "use strict";\n        function d(a, b) {\n          if (!(a instanceof b))\n            throw new TypeError("Cannot call a class as a function");\n        }\n        Object.defineProperty(c, "__esModule", {\n          value: !0,\n        }),\n          (c.SWPlugin = void 0);\n        var e = (function () {\n            function a(a, b) {\n              for (var c = 0; c < b.length; c++) {\n                var d = b[c];\n                (d.enumerable = d.enumerable || !1),\n                  (d.configurable = !0),\n                  "value" in d && (d.writable = !0),\n                  Object.defineProperty(a, d.key, d);\n              }\n            }\n            return function (b, c, d) {\n              return c && a(b.prototype, c), d && a(b, d), b;\n            };\n          })(),\n          f = a("../../utility/csiologger"),\n          g = (function (a) {\n            if (a && a.__esModule) return a;\n            var b = {};\n            if (null != a)\n              for (var c in a)\n                Object.prototype.hasOwnProperty.call(a, c) && (b[c] = a[c]);\n            return (b.default = a), b;\n          })(f),\n          h = (function () {\n            function a(b, c) {\n              var e =\n                arguments.length > 2 && void 0 !== arguments[2]\n                  ? arguments[2]\n                  : null;\n              d(this, a),\n                (this.extractorFnc = b),\n                (this.notifierFnc = c),\n                (this.filterFunc = e);\n            }\n            return (\n              e(a, [\n                {\n                  key: "notify",\n                  value: function (a) {\n                    if (!this.notifierFnc)\n                      return void g.warn(\n                        "Failed notification for " + this.toString()\n                      );\n                    this.notifierFnc(a);\n                  },\n                },\n                {\n                  key: "extract",\n                  value: function (a) {\n                    return this.extractorFnc\n                      ? this.extractorFnc(a)\n                      : (g.warn(\n                          this.toString() +\n                            " tried to extract without extractorFnc"\n                        ),\n                        null);\n                  },\n                },\n                {\n                  key: "filter",\n                  value: function (a) {\n                    return !this.filterFunc || this.filterFunc(a);\n                  },\n                },\n                {\n                  key: "add",\n                  value: function (a) {\n                    g.log("Abstract method is called width value: " + a);\n                  },\n                },\n                {\n                  key: "remove",\n                  value: function (a) {\n                    g.log("Abstract method is called with value: " + a);\n                  },\n                },\n                {\n                  key: "toString",\n                  value: function () {\n                    return "SWPlugin";\n                  },\n                },\n              ]),\n              a\n            );\n          })();\n        c.SWPlugin = h;\n      },\n      {\n        "../../utility/csiologger": 88,\n      },\n    ],\n    80: [\n      function (a, b, c) {\n        "use strict";\n        function d(a) {\n          if (a && a.__esModule) return a;\n          var b = {};\n          if (null != a)\n            for (var c in a)\n              Object.prototype.hasOwnProperty.call(a, c) && (b[c] = a[c]);\n          return (b.default = a), b;\n        }\n        function e(a, b) {\n          if (!a)\n            throw new ReferenceError(\n              "this hasn\'t been initialised - super() hasn\'t been called"\n            );\n          return !b || ("object" != typeof b && "function" != typeof b) ? a : b;\n        }\n        function f(a, b) {\n          if ("function" != typeof b && null !== b)\n            throw new TypeError(\n              "Super expression must either be null or a function, not " +\n                typeof b\n            );\n          (a.prototype = Object.create(b && b.prototype, {\n            constructor: {\n              value: a,\n              enumerable: !1,\n              writable: !0,\n              configurable: !0,\n            },\n          })),\n            b &&\n              (Object.setPrototypeOf\n                ? Object.setPrototypeOf(a, b)\n                : (a.__proto__ = b));\n        }\n        function g(a, b) {\n          if (!(a instanceof b))\n            throw new TypeError("Cannot call a class as a function");\n        }\n        function h(a, b) {\n          return b.green <= a\n            ? t.avQualityRatings.excellent\n            : b.red < a\n            ? t.avQualityRatings.fair\n            : t.avQualityRatings.bad;\n        }\n        function i(a, b) {\n          return b.red < a\n            ? t.avQualityRatings.bad\n            : b.green <= a\n            ? t.avQualityRatings.fair\n            : t.avQualityRatings.excellent;\n        }\n        Object.defineProperty(c, "__esModule", {\n          value: !0,\n        }),\n          (c.TrackMonitor = void 0);\n        var j = function a(b, c, d) {\n            null === b && (b = Function.prototype);\n            var e = Object.getOwnPropertyDescriptor(b, c);\n            if (void 0 === e) {\n              var f = Object.getPrototypeOf(b);\n              return null === f ? void 0 : a(f, c, d);\n            }\n            if ("value" in e) return e.value;\n            var g = e.get;\n            if (void 0 !== g) return g.call(d);\n          },\n          k = (function () {\n            function a(a, b) {\n              for (var c = 0; c < b.length; c++) {\n                var d = b[c];\n                (d.enumerable = d.enumerable || !1),\n                  (d.configurable = !0),\n                  "value" in d && (d.writable = !0),\n                  Object.defineProperty(a, d.key, d);\n              }\n            }\n            return function (b, c, d) {\n              return c && a(b.prototype, c), d && a(b, d), b;\n            };\n          })(),\n          l = a("../utility/registry"),\n          m = a("../collections/slidingwindow"),\n          n = a("../statspipeline/swplugins/swavg"),\n          o = a("../statspipeline/swplugins/swbtreepercentile"),\n          p = a("../statspipeline/swplugins/swfunctor"),\n          q = a("../utility/timestamps"),\n          r = d(q),\n          s = a("../config/constants"),\n          t = d(s),\n          u = a("../utility/csiologger"),\n          v = d(u),\n          w = a("../utility/rttregistry"),\n          x = (function () {\n            function a() {\n              g(this, a), (this.evaluators = []);\n            }\n            return (\n              k(a, [\n                {\n                  key: "addEvaluator",\n                  value: function (a) {\n                    var b =\n                        arguments.length > 1 && void 0 !== arguments[1]\n                          ? arguments[1]\n                          : 1,\n                      c = {\n                        processFnc: a,\n                        weight: b,\n                      };\n                    this.evaluators.push(c);\n                  },\n                },\n                {\n                  key: "getQuality",\n                  value: function (a) {\n                    for (\n                      var b = 0, c = [], d = 0, e = 0;\n                      e < this.evaluators.length;\n                      e++\n                    ) {\n                      var f = this.evaluators[e],\n                        g = 0,\n                        h = f.processFnc ? f.processFnc(a) : 0;\n                      if (h) {\n                        if (h === t.avQualityRatings.bad)\n                          g = t.qualityRating.bad;\n                        else if (h === t.avQualityRatings.fair)\n                          g = t.qualityRating.fair;\n                        else if (h === t.avQualityRatings.excellent)\n                          g = t.qualityRating.excellent;\n                        else if (h === t.avQualityRatings.unknown) continue;\n                        (b += f.weight),\n                          c.push({\n                            result: g,\n                            weight: f.weight,\n                          });\n                      }\n                    }\n                    for (var i = 0; i < c.length; i++) {\n                      var j = c[i];\n                      d += j.result * (j.weight / b);\n                    }\n                    return (\n                      (d = Math.floor(d)),\n                      d === t.qualityRating.excellent\n                        ? t.avQualityRatings.excellent\n                        : d === t.qualityRating.good\n                        ? t.avQualityRatings.fair\n                        : d === t.qualityRating.fair\n                        ? t.avQualityRatings.fair\n                        : d === t.qualityRating.poor\n                        ? t.avQualityRatings.fair\n                        : d === t.qualityRating.bad\n                        ? t.avQualityRatings.bad\n                        : void 0\n                    );\n                  },\n                },\n              ]),\n              a\n            );\n          })(),\n          y = (function (a) {\n            function b(a, c, d, f) {\n              g(this, b);\n              var h = e(\n                this,\n                (b.__proto__ || Object.getPrototypeOf(b)).call(this, a, c)\n              );\n              return (\n                (h.thresholds = []),\n                (h.enableThresholds = !1),\n                (h.requestTime = 0),\n                (h.started = 0),\n                (h.created = r.getCurrent()),\n                (h.mediaType = f),\n                (h.streamType = d),\n                (h.qualityHelper = new x()),\n                (h.metrics = h.makeTrack()),\n                (h.lastTrack = {}),\n                (h.prevFrameRateMean = null),\n                (h.ssrc = null),\n                (h.scsHelper = {\n                  total: 0,\n                  above: 0,\n                  ccDriven: 0,\n                  sumMaxBitrateDiff: 0,\n                  sumThroughputDiff: 0,\n                  prevCsioAvgBRKbps: 0,\n                }),\n                h\n              );\n            }\n            return (\n              f(b, a),\n              k(b, null, [\n                {\n                  key: "make",\n                  value: function (a, c, d, e) {\n                    var f = new b(a, c, d, e),\n                      g = f.metrics;\n                    return (\n                      f.attach(\n                        new n.SWAvg(\n                          function (a) {\n                            return a.getJitter();\n                          },\n                          function (a) {\n                            g.csioAvgJitter = a;\n                          },\n                          function (a) {\n                            var b = a.getJitter();\n                            return null !== b && void 0 !== b;\n                          }\n                        )\n                      ),\n                      f.attach(\n                        new n.SWAvg(\n                          function (a) {\n                            return a.getRTT();\n                          },\n                          function (a) {\n                            g.csioAvgRtt = a;\n                          },\n                          function (a) {\n                            var b = a.getRTT();\n                            return null !== b && void 0 !== b;\n                          }\n                        )\n                      ),\n                      f.attach(\n                        new o.SWBTreePercentile(\n                          95,\n                          function (a, b) {\n                            var c = a.getJitter(),\n                              d = b.getJitter();\n                            return c == d ? 0 : c < d ? -1 : 1;\n                          },\n                          function (a) {\n                            return a.getJitter();\n                          },\n                          function (a) {\n                            g.csioPercentileJitter = a;\n                          },\n                          function (a, b) {\n                            return b\n                              ? b.getJitter()\n                              : a\n                              ? a.getJitter()\n                              : void 0;\n                          },\n                          function (a) {\n                            var b = a.getJitter();\n                            return null !== b && void 0 !== b;\n                          },\n                          function (a, b) {\n                            return a;\n                          }\n                        )\n                      ),\n                      f.attach(\n                        new o.SWBTreePercentile(\n                          95,\n                          function (a, b) {\n                            var c = a.getRTT(),\n                              d = b.getRTT();\n                            return c == d ? 0 : c < d ? -1 : 1;\n                          },\n                          function (a) {\n                            return a.getRTT();\n                          },\n                          function (a) {\n                            (g.csioSig2Latency = a), (g.csioeM = a + 40);\n                          },\n                          function (a, b) {\n                            return b ? b.getRTT() : a ? a.getRTT() : void 0;\n                          },\n                          function (a) {\n                            var b = a.getRTT();\n                            return null !== b && void 0 !== b;\n                          },\n                          function (a, b) {\n                            return a;\n                          }\n                        )\n                      ),\n                      d === t.streamType.inbound\n                        ? b.setupInboundMonitor(f)\n                        : d === t.streamType.outbound\n                        ? b.setupOutboundMonitor(f)\n                        : v.warn(\n                            "Unrecognized streamType (" +\n                              d +\n                              ") at TrackMonitor"\n                          ),\n                      e === t.mediaType.audio\n                        ? b.setupAudioMonitor(f)\n                        : e === t.mediaType.video\n                        ? b.setupVideoMonitor(f)\n                        : v.warn(\n                            "Unrecognized mediaType (" + e + ") at TrackMonitor"\n                          ),\n                      d === t.streamType.inbound && e === t.mediaType.audio\n                        ? b.setupInbAudioQualityEvaluator(f)\n                        : d === t.streamType.inbound && e === t.mediaType.video\n                        ? b.setupInbVideoQualityEvaluator(f)\n                        : d === t.streamType.outbound && e === t.mediaType.audio\n                        ? b.setupOutbAudioQualityEvaluator(f)\n                        : d === t.streamType.outbound &&\n                          e === t.mediaType.video &&\n                          (b.setupOutbVideoQualityEvaluator(f),\n                          b.setupSCSValidator(f)),\n                      f.addPostProcess(function (a) {\n                        g.csioMark = f.getQuality(a);\n                      }),\n                      f\n                    );\n                  },\n                },\n                {\n                  key: "setupInbAudioQualityEvaluator",\n                  value: function (a) {\n                    var b = a.metrics;\n                    a.addQualityEvaluator(function (a) {\n                      return void 0 === b.csioIntBRKbps ||\n                        null === b.csioIntBRKbps ||\n                        b.csioIntBRKbps < 0\n                        ? t.avQualityRatings.unknown\n                        : h(b.csioIntBRKbps, t.throughputThreshold.audio);\n                    }),\n                      a.addQualityEvaluator(function (a) {\n                        return void 0 === b.csioIntFL ||\n                          null === b.csioIntFL ||\n                          b.csioIntFL < 0\n                          ? t.avQualityRatings.unknown\n                          : i(b.csioIntFL, t.fractionalLossThreshold.audio);\n                      }),\n                      a.addQualityEvaluator(function (a) {\n                        return void 0 === b.csioeM || null === b.csioeM\n                          ? t.avQualityRatings.unknown\n                          : i(b.csioeM, t.eModelThreshold.audio);\n                      });\n                  },\n                },\n                {\n                  key: "setupOutbAudioQualityEvaluator",\n                  value: function (a) {\n                    var b = a.metrics;\n                    a.addQualityEvaluator(function (a) {\n                      return void 0 === b.csioIntBRKbps ||\n                        null === b.csioIntBRKbps ||\n                        b.csioIntBRKbps < 0\n                        ? t.avQualityRatings.unknown\n                        : h(b.csioIntBRKbps, t.throughputThreshold.audio);\n                    }),\n                      a.addQualityEvaluator(function (a) {\n                        return void 0 === b.csioeM || null === b.csioeM\n                          ? t.avQualityRatings.unknown\n                          : i(b.csioeM, t.eModelThreshold.audio);\n                      });\n                  },\n                },\n                {\n                  key: "setupInbVideoQualityEvaluator",\n                  value: function (a) {\n                    var b = a.metrics;\n                    a.addQualityEvaluator(function (a) {\n                      return void 0 === b.csioIntBRKbps ||\n                        null === b.csioIntBRKbps ||\n                        b.csioIntBRKbps < 0\n                        ? t.avQualityRatings.unknown\n                        : h(b.csioIntBRKbps, t.throughputThreshold.video);\n                    }),\n                      a.addQualityEvaluator(function (c) {\n                        return void 0 === b.csioFrameRateMean ||\n                          null === b.csioFrameRateMean\n                          ? t.avQualityRatings.unknown\n                          : b.csioFrameRateMean && a.prevFrameRateMean\n                          ? h(\n                              b.csioFrameRateMean / a.prevFrameRateMean,\n                              t.currOverPrevFrameRateThreshold.video\n                            )\n                          : t.avQualityRatings.bad;\n                      }),\n                      a.addQualityEvaluator(function (a) {\n                        return void 0 === b.csioSig2Latency ||\n                          null === b.csioSig2Latency\n                          ? t.avQualityRatings.unknown\n                          : i(b.csioSig2Latency, t.rttThreshold.video);\n                      });\n                  },\n                },\n                {\n                  key: "setupOutbVideoQualityEvaluator",\n                  value: function (a) {\n                    var b = a.metrics;\n                    a.addQualityEvaluator(function (a) {\n                      return void 0 == b.csioIntBRKbps ||\n                        null == b.csioIntBRKbps\n                        ? t.avQualityRatings.unknown\n                        : h(b.csioIntBRKbps, t.throughputThreshold.video);\n                    }),\n                      a.addQualityEvaluator(function (c) {\n                        return void 0 === b.csioFrameRateMean ||\n                          null === b.csioFrameRateMean\n                          ? t.avQualityRatings.unknown\n                          : b.csioFrameRateMean && a.prevFrameRateMean\n                          ? h(\n                              b.csioFrameRateMean / a.prevFrameRateMean,\n                              t.currOverPrevFrameRateThreshold.video\n                            )\n                          : t.avQualityRatings.bad;\n                      }),\n                      a.addQualityEvaluator(function (a) {\n                        return void 0 === b.csioSig2Latency ||\n                          null === b.csioSig2Latency\n                          ? t.avQualityRatings.unknown\n                          : i(b.csioSig2Latency, t.rttThreshold.video);\n                      });\n                  },\n                },\n                {\n                  key: "setupInboundMonitor",\n                  value: function (a) {\n                    var b = a.metrics;\n                    a.addPreProcess(function (c) {\n                      var d = c.getLostPackets(),\n                        e = c.getReceivedPackets(),\n                        f = a.getRequestedMeasurement(),\n                        g = 0,\n                        h = 0;\n                      f\n                        ? ((g = d - f.getLostPackets()),\n                          (h = e - f.getReceivedPackets()))\n                        : ((g = d), (h = e));\n                      var i = 0;\n                      if (\n                        ((0 < g || 0 < h) && (i = g / (h + g)),\n                        (b.csioIntPktLoss = g),\n                        (b.csioIntFL = i),\n                        c.setFractionLost(i),\n                        !c.getFrameRateReceived() &&\n                          c.getFramesReceived() &&\n                          0 < a.started)\n                      ) {\n                        var j = c.getFramesReceived(),\n                          k = r.getCurrent() - a.started;\n                        b.csioEstFrameRatePerSecond = (1e3 * j) / k;\n                        var l = c.getSSRC(),\n                          m = (0, w.getRTTRegistry)().getFrameRate(l);\n                        m && (b.legacyFrameRatePerSecond = m);\n                      }\n                    }),\n                      a.attach(\n                        new p.SWFunctor(\n                          function (c) {\n                            var d = r.getCurrent(),\n                              e = c.getResolution(),\n                              f = a.getRequestedMeasurement(),\n                              g = a.getRequestTime(),\n                              h = c.getLostPackets(),\n                              i = 8 * c.getReceivedBytes(),\n                              j = c.getReceivedPackets(),\n                              k = d - a.getStartTime(),\n                              m = 0,\n                              n = 0,\n                              o = 0,\n                              p = 0,\n                              q = 1e3,\n                              s = Math.max(d - a.getStartTime(), q);\n                            f\n                              ? ((p = j - f.getReceivedPackets()),\n                                (m = i - 8 * f.getReceivedBytes()),\n                                (n = h - f.getLostPackets()),\n                                (o = Math.max(d - g, q)))\n                              : ((q =\n                                  (l.Registry.getCredentials().getAdaptiveInterval(),\n                                  l.Registry.getCredentials().getStatsSubmissionInterval())),\n                                (s = Math.max(d - a.getStartTime(), q)),\n                                (p = j),\n                                (m = i),\n                                (n = h),\n                                (o = Math.max(s, q))),\n                              (b.csioIntPktRcv = p),\n                              (b.csioIntPR = p / (o / 1e3)),\n                              (b.csioAvgBRKbps = i / s),\n                              (b.csioIntBRKbps = m / o),\n                              (b.csioAvgPacketSize = c.getReceivedBytes() / j),\n                              (b.csioIntMs = k),\n                              (b.csioTimeElapseMs = o),\n                              (b.csiores = e),\n                              (b.csioPktLostPercentage = (n / m) * 100);\n                          },\n                          null,\n                          null\n                        )\n                      ),\n                      a.attach(\n                        new o.SWBTreePercentile(\n                          95,\n                          function (a, b) {\n                            var c = a.getFractionLost(),\n                              d = b.getFractionLost();\n                            return c == d ? 0 : c < d ? -1 : 1;\n                          },\n                          function (a) {\n                            return a.getFractionLost();\n                          },\n                          function (a) {\n                            b.csioPercentileFl = a;\n                          },\n                          function (a, b) {\n                            return b\n                              ? b.getFractionLost()\n                              : a\n                              ? a.getFractionLost()\n                              : void 0;\n                          },\n                          function (a) {\n                            var b = a.getFractionLost();\n                            return null !== b && void 0 !== b;\n                          },\n                          function (a, b) {\n                            return a;\n                          }\n                        )\n                      );\n                  },\n                },\n                {\n                  key: "setupOutboundMonitor",\n                  value: function (a) {\n                    var b = a.metrics;\n                    a.addPreProcess(function (c) {\n                      var d = c.getLostPackets(),\n                        e = c.getSentPackets(),\n                        f = a.getRequestedMeasurement(),\n                        g = 0,\n                        h = 0;\n                      f\n                        ? ((g = d - f.getLostPackets()),\n                          (h = e - f.getSentPackets()))\n                        : ((g = d), (h = e));\n                      var i = 0;\n                      (0 < g || 0 < h) && (i = g / (h + g)),\n                        (b.csioIntPktLoss = g),\n                        (b.csioIntFL = i),\n                        c.setFractionLost(i);\n                    }),\n                      a.attach(\n                        new p.SWFunctor(\n                          function (c) {\n                            var d = r.getCurrent(),\n                              e = c.getResolution(),\n                              f = a.getRequestedMeasurement(),\n                              g = a.getRequestTime(),\n                              h = c.getLostPackets(),\n                              i = 8 * c.getSentBytes(),\n                              j = c.getSentPackets(),\n                              k = d - a.getStartTime(),\n                              m = 0,\n                              n = 0,\n                              o = 0,\n                              p = 0,\n                              q = 1e3,\n                              s = Math.max(d - a.getStartTime(), q);\n                            f\n                              ? ((p = j - f.getSentPackets()),\n                                (m = i - 8 * f.getSentBytes()),\n                                (n = h - f.getLostPackets()),\n                                (o = Math.max(d - g, q)))\n                              : ((q =\n                                  (l.Registry.getCredentials().getAdaptiveInterval(),\n                                  l.Registry.getCredentials().getStatsSubmissionInterval())),\n                                (s = Math.max(d - a.getStartTime(), q)),\n                                (p = j),\n                                (m = i),\n                                (n = h),\n                                (o = Math.max(s, q))),\n                              (b.csioIntPktRcv = p),\n                              (b.csioAvgBRKbps = i / s),\n                              (b.csioIntBRKbps = m / o),\n                              (b.csioIntPR = p / (o / 1e3)),\n                              (b.csioAvgPacketSize = c.getSentBytes() / j),\n                              (b.csioIntMs = k),\n                              (b.csioTimeElapseMs = o),\n                              (b.csiores = e),\n                              (b.csioPktLostPercentage = (n / m) * 100);\n                          },\n                          null,\n                          null\n                        )\n                      ),\n                      a.attach(\n                        new o.SWBTreePercentile(\n                          95,\n                          function (a, b) {\n                            var c = a.getFractionLost(),\n                              d = b.getFractionLost();\n                            return c == d ? 0 : c < d ? -1 : 1;\n                          },\n                          function (a) {\n                            return a.getFractionLost();\n                          },\n                          function (a) {\n                            b.csioPercentileFl = a;\n                          },\n                          function (a, b) {\n                            return b\n                              ? b.getFractionLost()\n                              : a\n                              ? a.getFractionLost()\n                              : void 0;\n                          },\n                          function (a) {\n                            var b = a.getFractionLost();\n                            return null !== b && void 0 !== b;\n                          },\n                          function (a, b) {\n                            return a;\n                          }\n                        )\n                      );\n                  },\n                },\n                {\n                  key: "setupAudioMonitor",\n                  value: function (a) {\n                    var b = a.metrics;\n                    a.attach(\n                      new p.SWFunctor(\n                        function (a) {\n                          b.csioMediaType = t.mediaType.audio;\n                        },\n                        null,\n                        null\n                      )\n                    );\n                  },\n                },\n                {\n                  key: "setupVideoMonitor",\n                  value: function (a) {\n                    var b = a.metrics;\n                    a.attach(\n                      new n.SWAvg(\n                        function (a) {\n                          return a.getFrameRateReceived();\n                        },\n                        function (c) {\n                          (a.prevFrameRateMean = b.csioFrameRateMean),\n                            (b.csioFrameRateMean = c);\n                        },\n                        function (a) {\n                          var b = a.getFrameRateReceived();\n                          return null !== b && void 0 !== b;\n                        }\n                      )\n                    ),\n                      a.attach(\n                        new n.SWAvg(\n                          function (a) {\n                            return a.getFrameHeight();\n                          },\n                          function (a) {\n                            b.csioFrameHeightMean = a;\n                          },\n                          function (a) {\n                            var b = a.getFrameHeight();\n                            return null !== b && void 0 !== b;\n                          }\n                        )\n                      ),\n                      a.attach(\n                        new n.SWAvg(\n                          function (a) {\n                            return a.getFrameWidth();\n                          },\n                          function (a) {\n                            b.csioFrameWidthMean = a;\n                          },\n                          function (a) {\n                            var b = a.getFrameWidth();\n                            return null !== b && void 0 !== b;\n                          }\n                        )\n                      ),\n                      a.attach(\n                        new o.SWBTreePercentile(\n                          95,\n                          function (a, b) {\n                            var c = a.getFrameRateReceived(),\n                              d = b.getFrameRateReceived();\n                            return c == d ? 0 : c < d ? -1 : 1;\n                          },\n                          function (a) {\n                            return a.getFrameRateReceived();\n                          },\n                          function (a) {\n                            b.csioFrameRate95Percentile = a;\n                          },\n                          function (a, b) {\n                            return b\n                              ? b.getFrameRateReceived()\n                              : a\n                              ? a.getFrameRateReceived()\n                              : void 0;\n                          },\n                          function (a) {\n                            var b = a.getFrameRateReceived();\n                            return null !== b && void 0 !== b;\n                          },\n                          function (a, b) {\n                            return a;\n                          }\n                        )\n                      ),\n                      a.attach(\n                        new o.SWBTreePercentile(\n                          50,\n                          function (a, b) {\n                            var c = a.getFrameRateReceived(),\n                              d = b.getFrameRateReceived();\n                            return c == d ? 0 : c < d ? -1 : 1;\n                          },\n                          function (a) {\n                            return a.getFrameRateReceived();\n                          },\n                          function (a) {\n                            b.csioFrameRate50Percentile = a;\n                          },\n                          function (a, b) {\n                            return b\n                              ? b.getFrameRateReceived()\n                              : a\n                              ? a.getFrameRateReceived()\n                              : void 0;\n                          },\n                          function (a) {\n                            var b = a.getFrameRateReceived();\n                            return null !== b && void 0 !== b;\n                          },\n                          function (a, b) {\n                            return a;\n                          }\n                        )\n                      ),\n                      a.attach(\n                        new o.SWBTreePercentile(\n                          95,\n                          function (a, b) {\n                            var c = a.getFrameHeight(),\n                              d = b.getFrameHeight();\n                            return c == d ? 0 : c < d ? -1 : 1;\n                          },\n                          function (a) {\n                            return a.getFrameHeight();\n                          },\n                          function (a) {\n                            b.csioFrameHeight95Percentile = a;\n                          },\n                          function (a, b) {\n                            return b\n                              ? b.getFrameHeight()\n                              : a\n                              ? a.getFrameHeight()\n                              : void 0;\n                          },\n                          function (a) {\n                            var b = a.getFrameHeight();\n                            return null !== b && void 0 !== b;\n                          },\n                          function (a, b) {\n                            return a;\n                          }\n                        )\n                      ),\n                      a.attach(\n                        new o.SWBTreePercentile(\n                          50,\n                          function (a, b) {\n                            var c = a.getFrameHeight(),\n                              d = b.getFrameHeight();\n                            return c == d ? 0 : c < d ? -1 : 1;\n                          },\n                          function (a) {\n                            return a.getFrameHeight();\n                          },\n                          function (a) {\n                            b.csioFrameHeight50Percentile = a;\n                          },\n                          function (a, b) {\n                            return b\n                              ? b.getFrameHeight()\n                              : a\n                              ? a.getFrameHeight()\n                              : void 0;\n                          },\n                          function (a) {\n                            var b = a.getFrameHeight();\n                            return null !== b && void 0 !== b;\n                          },\n                          function (a, b) {\n                            return a;\n                          }\n                        )\n                      ),\n                      a.attach(\n                        new o.SWBTreePercentile(\n                          95,\n                          function (a, b) {\n                            var c = a.getFrameWidth(),\n                              d = b.getFrameWidth();\n                            return c == d ? 0 : c < d ? -1 : 1;\n                          },\n                          function (a) {\n                            return a.getFrameWidth();\n                          },\n                          function (a) {\n                            b.csioFrameWidth95Percentile = a;\n                          },\n                          function (a, b) {\n                            return b\n                              ? b.getFrameWidth()\n                              : a\n                              ? a.getFrameWidth()\n                              : void 0;\n                          },\n                          function (a) {\n                            var b = a.getFrameWidth();\n                            return null !== b && void 0 !== b;\n                          },\n                          function (a, b) {\n                            return a;\n                          }\n                        )\n                      ),\n                      a.attach(\n                        new o.SWBTreePercentile(\n                          50,\n                          function (a, b) {\n                            var c = a.getFrameWidth(),\n                              d = b.getFrameWidth();\n                            return c == d ? 0 : c < d ? -1 : 1;\n                          },\n                          function (a) {\n                            return a.getFrameWidth();\n                          },\n                          function (a) {\n                            b.csioFrameWidth50Percentile = a;\n                          },\n                          function (a, b) {\n                            return b\n                              ? b.getFrameWidth()\n                              : a\n                              ? a.getFrameWidth()\n                              : void 0;\n                          },\n                          function (a) {\n                            var b = a.getFrameWidth();\n                            return null !== b && void 0 !== b;\n                          },\n                          function (a, b) {\n                            return a;\n                          }\n                        )\n                      ),\n                      a.attach(\n                        new p.SWFunctor(\n                          function (a) {\n                            b.csioMediaType = t.mediaType.video;\n                          },\n                          null,\n                          null\n                        )\n                      );\n                  },\n                },\n                {\n                  key: "setupSCSValidator",\n                  value: function (a) {\n                    var b = a.metrics;\n                    a.attach(\n                      new p.SWFunctor(\n                        function (c) {\n                          var d = l.Registry.getConfigServiceWrapper().getSenderConfig();\n                          if (\n                            !d ||\n                            !d.rtc_rtp_parameters ||\n                            !d.rtc_rtp_parameters.encodings\n                          )\n                            return (\n                              (b.csioSCSValidationSampleCount = null),\n                              (b.csioAvgMaxBitrateDiff = null),\n                              (b.csioAvgDeltaThroughput = null),\n                              (b.csioMaxBitrateAboveRatio = null),\n                              void (b.csioCCDrivenRatio = null)\n                            );\n                          var e = 0;\n                          d.rtc_rtp_parameters.encodings.forEach(function (a) {\n                            a && (e = Math.max(e, a.maxBitrate));\n                          });\n                          var f = 0,\n                            g = l.Registry.getConfigServiceWrapper().getDefaultSenderConfig();\n                          if (g && g.encodings) {\n                            g.encodings.forEach(function (a) {\n                              f = Math.max(f, a.maxBitrate);\n                            });\n                            var h = 0,\n                              i = 0,\n                              j = null,\n                              k = null,\n                              m = a.getSCSHelper();\n                            0 < f && 0.9 * f < 1e3 * b.csioAvgBRKbps\n                              ? ((h = e - f), (k = !1))\n                              : ((h = e - 1e3 * b.csioAvgBRKbps), (k = !0)),\n                              (j = 0 < h),\n                              (i = b.csioAvgBRKbps - b.prevCsioAvgBRKbps),\n                              (m.prevCsioAvgBRKbps = b.csioAvgBRKbps),\n                              (b.csioSCSValidationSampleCount = ++m.total),\n                              (m.sumMaxBitrateDiff += h),\n                              (b.csioAvgMaxBitrateDiff =\n                                m.sumMaxBitrateDiff / m.total),\n                              (m.sumThroughputDiff += i),\n                              (b.csioAvgDeltaThroughput =\n                                m.sumThroughputDiff / m.total),\n                              j && (m.above += 1),\n                              (b.csioMaxBitrateAboveRatio = m.above / m.total),\n                              k && (m.ccDriven += 1),\n                              (b.csioCCDrivenRatio = m.ccDriven / m.total);\n                          }\n                        },\n                        null,\n                        null\n                      )\n                    );\n                  },\n                },\n              ]),\n              k(b, [\n                {\n                  key: "makeTrack",\n                  value: function () {\n                    var a = {};\n                    return (\n                      (a.csioMediaType = void 0),\n                      (a.csioMark = void 0),\n                      (a.csioIntBRKbps = void 0),\n                      (a.csioAvgBRKbps = void 0),\n                      (a.csioIntFL = void 0),\n                      (a.csioIntMs = void 0),\n                      (a.csioIntPR = void 0),\n                      (a.csioPercentileFl = void 0),\n                      (a.csioAvgJitter = void 0),\n                      (a.csioAvgRtt = void 0),\n                      (a.csioPercentileJitter = void 0),\n                      (a.csioSig2Latency = void 0),\n                      (a.csioTimeElapseMs = void 0),\n                      (a.csioeM = void 0),\n                      (a.csiores = void 0),\n                      (a.csioFrameWidth95Percentile = void 0),\n                      (a.csioFrameWidth50Percentile = void 0),\n                      (a.csioFrameHeight95Percentile = void 0),\n                      (a.csioFrameHeight50Percentile = void 0),\n                      (a.csioFrameRate95Percentile = void 0),\n                      (a.csioFrameRate50Percentile = void 0),\n                      (a.csioFrameWidthMean = void 0),\n                      (a.csioFrameHeightMean = void 0),\n                      (a.csioFrameRateMean = void 0),\n                      (a.csioIntPktRcv = void 0),\n                      (a.csioSCSValidationSampleCount = null),\n                      (a.csioAvgMaxBitrateDiff = null),\n                      (a.csioAvgDeltaThroughput = null),\n                      (a.csioMaxBitrateAboveRatio = null),\n                      (a.csioCCDrivenRatio = null),\n                      a\n                    );\n                  },\n                },\n                {\n                  key: "getSSRC",\n                  value: function () {\n                    return this.ssrc;\n                  },\n                },\n                {\n                  key: "add",\n                  value: function (a) {\n                    (this.ssrc = a.getSSRC()),\n                      (this.lastTrack = a.extractTrack()),\n                      (this.lastTrack.pcHash = a.getPcHash()),\n                      0 === this.started && (this.started = r.getCurrent()),\n                      j(\n                        b.prototype.__proto__ ||\n                          Object.getPrototypeOf(b.prototype),\n                        "add",\n                        this\n                      ).call(this, a);\n                  },\n                },\n                {\n                  key: "hasTraffic",\n                  value: function () {\n                    return 0 < this.metrics.csioIntBRKbps;\n                  },\n                },\n                {\n                  key: "getTrack",\n                  value: function () {\n                    var a = this.lastTrack;\n                    return Object.assign(a.data, this.metrics), a;\n                  },\n                },\n                {\n                  key: "extractTrack",\n                  value: function () {\n                    var a = this.lastTrack;\n                    return (\n                      Object.assign(a.data, this.metrics),\n                      (this.requestTime = r.getCurrent()),\n                      (this.requestedMeasurement = this.peek()),\n                      a\n                    );\n                  },\n                },\n                {\n                  key: "getMediaType",\n                  value: function () {\n                    return this.mediaType;\n                  },\n                },\n                {\n                  key: "getStreamType",\n                  value: function () {\n                    return this.streamType;\n                  },\n                },\n                {\n                  key: "getStartTime",\n                  value: function () {\n                    return this.started;\n                  },\n                },\n                {\n                  key: "getCreationTime",\n                  value: function () {\n                    return this.created;\n                  },\n                },\n                {\n                  key: "getRequestTime",\n                  value: function () {\n                    return Math.max(this.started, this.requestTime);\n                  },\n                },\n                {\n                  key: "getRequestedMeasurement",\n                  value: function () {\n                    return this.requestedMeasurement;\n                  },\n                },\n                {\n                  key: "getSCSHelper",\n                  value: function () {\n                    return this.scsHelper;\n                  },\n                },\n                {\n                  key: "addQualityEvaluator",\n                  value: function (a) {\n                    var b =\n                      arguments.length > 1 && void 0 !== arguments[1]\n                        ? arguments[1]\n                        : 1;\n                    this.qualityHelper.addEvaluator(a, b);\n                  },\n                },\n                {\n                  key: "getQuality",\n                  value: function (a) {\n                    return this.qualityHelper.getQuality(a);\n                  },\n                },\n                {\n                  key: "addPreProcess",\n                  value: function (a) {\n                    j(\n                      b.prototype.__proto__ ||\n                        Object.getPrototypeOf(b.prototype),\n                      "addPreProcess",\n                      this\n                    ).call(this, a);\n                  },\n                },\n                {\n                  key: "addPostProcess",\n                  value: function (a) {\n                    j(\n                      b.prototype.__proto__ ||\n                        Object.getPrototypeOf(b.prototype),\n                      "addPostProcess",\n                      this\n                    ).call(this, a);\n                  },\n                },\n              ]),\n              b\n            );\n          })(m.SlidingWindow);\n        c.TrackMonitor = y;\n      },\n      {\n        "../collections/slidingwindow": 28,\n        "../config/constants": 33,\n        "../statspipeline/swplugins/swavg": 76,\n        "../statspipeline/swplugins/swbtreepercentile": 77,\n        "../statspipeline/swplugins/swfunctor": 78,\n        "../utility/csiologger": 88,\n        "../utility/registry": 95,\n        "../utility/rttregistry": 96,\n        "../utility/timestamps": 99,\n      },\n    ],\n    81: [\n      function (a, b, c) {\n        "use strict";\n        function d(a, b) {\n          if (!(a instanceof b))\n            throw new TypeError("Cannot call a class as a function");\n        }\n        Object.defineProperty(c, "__esModule", {\n          value: !0,\n        }),\n          (c.TracksMonitor = void 0);\n        var e = (function () {\n            function a(a, b) {\n              for (var c = 0; c < b.length; c++) {\n                var d = b[c];\n                (d.enumerable = d.enumerable || !1),\n                  (d.configurable = !0),\n                  "value" in d && (d.writable = !0),\n                  Object.defineProperty(a, d.key, d);\n              }\n            }\n            return function (b, c, d) {\n              return c && a(b.prototype, c), d && a(b, d), b;\n            };\n          })(),\n          f = a("./trackmonitor"),\n          g = a("../config/constants"),\n          h = (function (a) {\n            if (a && a.__esModule) return a;\n            var b = {};\n            if (null != a)\n              for (var c in a)\n                Object.prototype.hasOwnProperty.call(a, c) && (b[c] = a[c]);\n            return (b.default = a), b;\n          })(g),\n          i = (function () {\n            function a() {\n              d(this, a),\n                (this.inbMonitors = new Map()),\n                (this.outbMonitors = new Map());\n            }\n            return (\n              e(a, [\n                {\n                  key: "getMonitor",\n                  value: function (a) {\n                    var b = a.getStreamType(),\n                      c = a.getMediaType(),\n                      d = a.getSSRC(),\n                      e = null;\n                    return (\n                      b === h.streamType.inbound\n                        ? c === h.mediaType.audio\n                          ? (e = this.getInbAudioMonitor(d))\n                          : c === h.mediaType.video &&\n                            (e = this.getInbVideoMonitor(d))\n                        : b === h.streamType.outbound &&\n                          (c === h.mediaType.audio\n                            ? (e = this.getOutbAudioMonitor(d))\n                            : c === h.mediaType.video &&\n                              (e = this.getOutbVideoMonitor(d))),\n                      e\n                    );\n                  },\n                },\n                {\n                  key: "extractTracks",\n                  value: function () {\n                    var a = [];\n                    return (\n                      this.outbMonitors.forEach(function (b, c) {\n                        a.push(b.extractTrack());\n                      }),\n                      this.inbMonitors.forEach(function (b, c) {\n                        a.push(b.extractTrack());\n                      }),\n                      a\n                    );\n                  },\n                },\n                {\n                  key: "getTracks",\n                  value: function () {\n                    var a = [];\n                    return (\n                      this.outbMonitors.forEach(function (b, c) {\n                        a.push(b.getTrack());\n                      }),\n                      this.inbMonitors.forEach(function (b, c) {\n                        a.push(b.getTrack());\n                      }),\n                      a\n                    );\n                  },\n                },\n                {\n                  key: "getMonitors",\n                  value: function () {\n                    var a = [];\n                    return (\n                      this.outbMonitors.forEach(function (b, c) {\n                        a.push(b);\n                      }),\n                      this.inbMonitors.forEach(function (b, c) {\n                        a.push(b);\n                      }),\n                      a\n                    );\n                  },\n                },\n                {\n                  key: "getInbAudioMonitor",\n                  value: function (a) {\n                    var b = this.inbMonitors.get(a);\n                    return (\n                      b ||\n                        ((b = f.TrackMonitor.make(\n                          1e3,\n                          3e4,\n                          h.streamType.inbound,\n                          h.mediaType.audio\n                        )),\n                        this.inbMonitors.set(a, b)),\n                      b\n                    );\n                  },\n                },\n                {\n                  key: "getInbVideoMonitor",\n                  value: function (a) {\n                    var b = this.inbMonitors.get(a);\n                    return (\n                      b ||\n                        ((b = f.TrackMonitor.make(\n                          1e3,\n                          3e4,\n                          h.streamType.inbound,\n                          h.mediaType.video\n                        )),\n                        this.inbMonitors.set(a, b)),\n                      b\n                    );\n                  },\n                },\n                {\n                  key: "getOutbAudioMonitor",\n                  value: function (a) {\n                    var b = this.outbMonitors.get(a);\n                    return (\n                      b ||\n                        ((b = f.TrackMonitor.make(\n                          1e3,\n                          3e4,\n                          h.streamType.outbound,\n                          h.mediaType.audio\n                        )),\n                        this.outbMonitors.set(a, b)),\n                      b\n                    );\n                  },\n                },\n                {\n                  key: "getOutbVideoMonitor",\n                  value: function (a) {\n                    var b = this.outbMonitors.get(a);\n                    return (\n                      b ||\n                        ((b = f.TrackMonitor.make(\n                          1e3,\n                          3e4,\n                          h.streamType.outbound,\n                          h.mediaType.video\n                        )),\n                        this.outbMonitors.set(a, b)),\n                      b\n                    );\n                  },\n                },\n              ]),\n              a\n            );\n          })();\n        c.TracksMonitor = i;\n      },\n      {\n        "../config/constants": 33,\n        "./trackmonitor": 80,\n      },\n    ],\n    82: [\n      function (a, b, c) {\n        "use strict";\n        function d(a) {\n          if (a && a.__esModule) return a;\n          var b = {};\n          if (null != a)\n            for (var c in a)\n              Object.prototype.hasOwnProperty.call(a, c) && (b[c] = a[c]);\n          return (b.default = a), b;\n        }\n        function e(a, b) {\n          if (!(a instanceof b))\n            throw new TypeError("Cannot call a class as a function");\n        }\n        Object.defineProperty(c, "__esModule", {\n          value: !0,\n        }),\n          (c.TransportsMonitor = void 0);\n        var f = (function () {\n            function a(a, b) {\n              for (var c = 0; c < b.length; c++) {\n                var d = b[c];\n                (d.enumerable = d.enumerable || !1),\n                  (d.configurable = !0),\n                  "value" in d && (d.writable = !0),\n                  Object.defineProperty(a, d.key, d);\n              }\n            }\n            return function (b, c, d) {\n              return c && a(b.prototype, c), d && a(b, d), b;\n            };\n          })(),\n          g = a("../config/constants"),\n          h = d(g),\n          i = a("../utility/timestamps"),\n          j = d(i),\n          k = a("../utility/rttregistry"),\n          l = (function () {\n            function a(b) {\n              e(this, a),\n                (this.previous = b),\n                (this.actual = b),\n                (this.outdated = j.getCurrent());\n            }\n            return (\n              f(a, [\n                {\n                  key: "setActual",\n                  value: function (a) {\n                    this.actual = a;\n                  },\n                },\n                {\n                  key: "outdate",\n                  value: function () {\n                    (this.previous = this.actual),\n                      (this.outdated = j.getCurrent());\n                  },\n                },\n                {\n                  key: "getActual",\n                  value: function () {\n                    return this.actual;\n                  },\n                },\n                {\n                  key: "getPrevious",\n                  value: function () {\n                    return this.previous;\n                  },\n                },\n                {\n                  key: "getElapsedTime",\n                  value: function () {\n                    return j.getCurrent() - this.outdated;\n                  },\n                },\n              ]),\n              a\n            );\n          })(),\n          m = (function () {\n            function a(b) {\n              e(this, a), (this.stats = new Map()), (this.codeBase = b);\n            }\n            return (\n              f(a, [\n                {\n                  key: "set",\n                  value: function (a, b) {\n                    var c = this.stats.get(a);\n                    if (!c) return void this.stats.set(a, new l(b));\n                    c.setActual(b);\n                  },\n                },\n                {\n                  key: "getIntervalStats",\n                  value: function () {\n                    var a = this,\n                      b = new Map();\n                    return (\n                      this.stats.forEach(function (c, d) {\n                        b.set(d, a.getIntervalStat(c)), c.outdate();\n                      }),\n                      b\n                    );\n                  },\n                },\n                {\n                  key: "getIntervalStat",\n                  value: function (a) {\n                    var b = null;\n                    switch (this.codeBase) {\n                      case h.codeBaseType.chrome:\n                        b = this.getIntervalStatForChrome(a);\n                        break;\n\n                      default:\n                        b = a.getActual();\n                    }\n                    return b;\n                  },\n                },\n                {\n                  key: "getIntervalStatForChrome",\n                  value: function (a) {\n                    var b = a.getActual(),\n                      c = a.getPrevious(),\n                      d = a.getElapsedTime();\n                    if (!c) return actual;\n                    for (var e = 0; e < b.length; ++e) {\n                      var f = b[e],\n                        g = c[e];\n                      if (!g || !f) return b;\n                      var i = parseInt(g.bytesReceived, 10),\n                        j = parseInt(g.bytesSent, 10);\n                      (f.csioReceivedBwKbps =\n                        (8 * (parseInt(f.bytesReceived, 10) - i)) / d),\n                        (f.csioSentBwKbps =\n                          (8 * (parseInt(f.bytesSent, 10) - j)) / d),\n                        (f.csioIntBytesReceived =\n                          parseInt(f.bytesReceived, 10) - i),\n                        (f.csioIntBytesSent = parseInt(f.bytesSent, 10) - j),\n                        void 0 !== g.packetsSent &&\n                          void 0 !== f.packetsSent &&\n                          ((f.csioSentPacketRate =\n                            (parseInt(f.packetsSent, 10) -\n                              parseInt(g.packetsSent, 10)) /\n                            (d / 1e3)),\n                          (f.csioIntPacketsSent =\n                            parseInt(f.packetsSent, 10) -\n                            parseInt(g.packetsSent, 10))),\n                        void 0 !== g.packetsReceived &&\n                          void 0 !== f.packetsReceived &&\n                          ((f.csioReceivedPacketRate =\n                            (parseInt(f.packetsReceived, 10) -\n                              parseInt(g.packetsReceived, 10)) /\n                            (d / 1e3)),\n                          (f.csioIntPacketsReceived =\n                            parseInt(f.packetsReceived, 10) -\n                            parseInt(g.packetsReceived, 10))),\n                        this.codeBase == h.codeBaseType.chrome &&\n                          (f.currentRoundTripTime = (0,\n                          k.getRTTRegistry)().getTransportRTT());\n                    }\n                    return b;\n                  },\n                },\n              ]),\n              a\n            );\n          })();\n        c.TransportsMonitor = m;\n      },\n      {\n        "../config/constants": 33,\n        "../utility/rttregistry": 96,\n        "../utility/timestamps": 99,\n      },\n    ],\n    83: [\n      function (a, b, c) {\n        "use strict";\n        function d(a) {\n          return isNaN(a) ? null : a;\n        }\n        function e(a) {\n          return null !== d(a) && 0 < a ? a : null;\n        }\n        Object.defineProperty(c, "__esModule", {\n          value: !0,\n        }),\n          (c.checkForNan = d),\n          (c.checkForNegativeValue = e);\n      },\n      {},\n    ],\n    84: [\n      function (a, b, c) {\n        "use strict";\n        function d(a, b) {\n          if (!(a instanceof b))\n            throw new TypeError("Cannot call a class as a function");\n        }\n        Object.defineProperty(c, "__esModule", {\n          value: !0,\n        });\n        var e = (function () {\n            function a(a, b) {\n              for (var c = 0; c < b.length; c++) {\n                var d = b[c];\n                (d.enumerable = d.enumerable || !1),\n                  (d.configurable = !0),\n                  "value" in d && (d.writable = !0),\n                  Object.defineProperty(a, d.key, d);\n              }\n            }\n            return function (b, c, d) {\n              return c && a(b.prototype, c), d && a(b, d), b;\n            };\n          })(),\n          f = (function () {\n            function a() {\n              d(this, a),\n                (this.getWifiStatsMethod = null),\n                (this.wifiStats = null),\n                (this.interval = 1e4);\n            }\n            return (\n              e(a, [\n                {\n                  key: "setGetWifiStatsMethod",\n                  value: function (a) {\n                    (this.getWifiStatsMethod = a), this.wifiStatsHandler();\n                  },\n                },\n                {\n                  key: "getWifiStats",\n                  value: function () {\n                    return this.wifiStats;\n                  },\n                },\n                {\n                  key: "wifiStatsHandler",\n                  value: function () {\n                    var a = this;\n                    a.getWifiStatsMethod &&\n                      a\n                        .getWifiStatsMethod()\n                        .then(function (b) {\n                          (a.wifiStats = JSON.parse(b)),\n                            setTimeout(function () {\n                              a.wifiStatsHandler();\n                            }, a.interval);\n                        })\n                        .catch(function () {\n                          setTimeout(function () {\n                            a.wifiStatsHandler();\n                          }, a.interval);\n                        });\n                  },\n                },\n              ]),\n              a\n            );\n          })();\n        c.WifiStatsExecutor = f;\n      },\n      {},\n    ],\n    85: [\n      function (a, b, c) {\n        "use strict";\n        function d(a) {\n          return window.btoa(a);\n        }\n        function e(a) {\n          return window.atob(a);\n        }\n        function f(a) {\n          return d(\n            encodeURIComponent(a).replace(/%([0-9A-F]{2})/g, function (a, b) {\n              return String.fromCharCode("0x" + b);\n            })\n          );\n        }\n        function g(a) {\n          return d(a)\n            .replace(/\\+/g, "-")\n            .replace(/\\//g, "_")\n            .replace(/\\=+$/, "");\n        }\n        function h(a) {\n          return f(a)\n            .replace(/\\+/g, "-")\n            .replace(/\\//g, "_")\n            .replace(/\\=+$/, "");\n        }\n        function i(a) {\n          for (\n            var b = e(a.replace(/[ \\r\\n]+$/, "")), c = [], d = 0;\n            d < b.length;\n            ++d\n          ) {\n            var f = b.charCodeAt(d).toString(16);\n            1 === f.length && (f = "0" + f), c.push(f);\n          }\n          return c.join("");\n        }\n        Object.defineProperty(c, "__esModule", {\n          value: !0,\n        }),\n          (c.encode = d),\n          (c.decode = e),\n          (c.urlencode = g),\n          (c.urlencodeUnicode = h),\n          (c.strtohex = i);\n      },\n      {},\n    ],\n    86: [\n      function (a, b, c) {\n        "use strict";\n        function d(a) {\n          if (a && a.__esModule) return a;\n          var b = {};\n          if (null != a)\n            for (var c in a)\n              Object.prototype.hasOwnProperty.call(a, c) && (b[c] = a[c]);\n          return (b.default = a), b;\n        }\n        function e(a, b) {\n          if (!(a instanceof b))\n            throw new TypeError("Cannot call a class as a function");\n        }\n        Object.defineProperty(c, "__esModule", {\n          value: !0,\n        }),\n          (c.Callbacks = void 0);\n        var f = (function () {\n            function a(a, b) {\n              for (var c = 0; c < b.length; c++) {\n                var d = b[c];\n                (d.enumerable = d.enumerable || !1),\n                  (d.configurable = !0),\n                  "value" in d && (d.writable = !0),\n                  Object.defineProperty(a, d.key, d);\n              }\n            }\n            return function (b, c, d) {\n              return c && a(b.prototype, c), d && a(b, d), b;\n            };\n          })(),\n          g = a("../config/constants"),\n          h = d(g),\n          i = a("./registry"),\n          j = a("./csiologger"),\n          k = d(j),\n          l = (function () {\n            function a() {\n              e(this, a), (this.callbacks = {});\n            }\n            return (\n              f(a, [\n                {\n                  key: "set",\n                  value: function (a, b) {\n                    if ("function" == typeof b)\n                      return h.callbackFunctions.hasOwnProperty(a)\n                        ? ((this.callbacks[a] = b),\n                          void (\n                            a === h.callbackFunctions.stats &&\n                            i.Registry.getStatsCallbackBuilder().setCallback(b)\n                          ))\n                        : void k.error("Couldn\'t set callback: " + a);\n                  },\n                },\n                {\n                  key: "get",\n                  value: function (a) {\n                    return this.callbacks.hasOwnProperty(a)\n                      ? this.callbacks[a]\n                      : null;\n                  },\n                },\n              ]),\n              a\n            );\n          })();\n        c.Callbacks = l;\n      },\n      {\n        "../config/constants": 33,\n        "./csiologger": 88,\n        "./registry": 95,\n      },\n    ],\n    87: [\n      function (a, b, c) {\n        "use strict";\n        function d(a) {\n          if (a && a.__esModule) return a;\n          var b = {};\n          if (null != a)\n            for (var c in a)\n              Object.prototype.hasOwnProperty.call(a, c) && (b[c] = a[c]);\n          return (b.default = a), b;\n        }\n        function e(a, b) {\n          if (!(a instanceof b))\n            throw new TypeError("Cannot call a class as a function");\n        }\n        Object.defineProperty(c, "__esModule", {\n          value: !0,\n        }),\n          (c.Credentials = void 0);\n        var f =\n            "function" == typeof Symbol && "symbol" == typeof Symbol.iterator\n              ? function (a) {\n                  return typeof a;\n                }\n              : function (a) {\n                  return a &&\n                    "function" == typeof Symbol &&\n                    a.constructor === Symbol &&\n                    a !== Symbol.prototype\n                    ? "symbol"\n                    : typeof a;\n                },\n          g = (function () {\n            function a(a, b) {\n              for (var c = 0; c < b.length; c++) {\n                var d = b[c];\n                (d.enumerable = d.enumerable || !1),\n                  (d.configurable = !0),\n                  "value" in d && (d.writable = !0),\n                  Object.defineProperty(a, d.key, d);\n              }\n            }\n            return function (b, c, d) {\n              return c && a(b.prototype, c), d && a(b, d), b;\n            };\n          })(),\n          h = a("../config/constants"),\n          i = d(h),\n          j = a("./csiologger"),\n          k = d(j),\n          l = (function () {\n            function a() {\n              e(this, a),\n                (this.appId = null),\n                (this.userId = null),\n                (this.userIdObject = null),\n                (this.deviceId = null),\n                (this.statsSubmissionInterval = 15e3),\n                (this.collectSDP = !1),\n                (this.transportType = i.transportType.rest),\n                (this.adaptiveInterval = !1);\n            }\n            return (\n              g(a, [\n                {\n                  key: "getAppId",\n                  value: function () {\n                    return this.appId;\n                  },\n                },\n                {\n                  key: "setAppId",\n                  value: function (a) {\n                    this.appId = "string" == typeof a ? parseInt(a, 10) : a;\n                  },\n                },\n                {\n                  key: "getUserId",\n                  value: function () {\n                    return this.userId;\n                  },\n                },\n                {\n                  key: "setUserId",\n                  value: function (a) {\n                    "object" === (void 0 === a ? "undefined" : f(a))\n                      ? ((this.userId = a.aliasName), this.setUserIdObject(a))\n                      : (this.userId = a);\n                  },\n                },\n                {\n                  key: "getUserIdObject",\n                  value: function () {\n                    return this.userIdObject;\n                  },\n                },\n                {\n                  key: "setUserIdObject",\n                  value: function (a) {\n                    this.userIdObject = a;\n                  },\n                },\n                {\n                  key: "getStatsSubmissionInterval",\n                  value: function () {\n                    return this.statsSubmissionInterval;\n                  },\n                },\n                {\n                  key: "setStatsSubmissionInterval",\n                  value: function (a) {\n                    k.log("setStatsSubmissionInterval is ", a),\n                      (this.statsSubmissionInterval = a);\n                  },\n                },\n                {\n                  key: "getCollectSDP",\n                  value: function () {\n                    return this.collectSDP;\n                  },\n                },\n                {\n                  key: "setCollectSDP",\n                  value: function (a) {\n                    this.collectSDP = a;\n                  },\n                },\n                {\n                  key: "getTransportType",\n                  value: function () {\n                    return this.transportType;\n                  },\n                },\n                {\n                  key: "setTransportType",\n                  value: function (a) {\n                    this.transportType = a;\n                  },\n                },\n                {\n                  key: "getAdaptiveInterval",\n                  value: function () {\n                    return this.adaptiveInterval;\n                  },\n                },\n                {\n                  key: "setAdaptiveInterval",\n                  value: function (a) {\n                    this.adaptiveInterval = a;\n                  },\n                },\n              ]),\n              a\n            );\n          })();\n        c.Credentials = l;\n      },\n      {\n        "../config/constants": 33,\n        "./csiologger": 88,\n      },\n    ],\n    88: [\n      function (a, b, c) {\n        "use strict";\n        function d() {\n          if ("true" === i.csioDebug) {\n            var a;\n            (a = console).info.apply(a, arguments);\n          }\n        }\n        function e() {\n          if ("true" === i.csioDebug) {\n            var a;\n            (a = console).log.apply(a, arguments);\n          }\n        }\n        function f() {\n          if ("true" === i.csioDebug) {\n            var a;\n            (a = console).warn.apply(a, arguments);\n          }\n        }\n        function g() {\n          var a;\n          (a = console).warn.apply(a, arguments);\n        }\n        Object.defineProperty(c, "__esModule", {\n          value: !0,\n        }),\n          (c.info = d),\n          (c.log = e),\n          (c.warn = f),\n          (c.error = g);\n        var h = a("../config/settings"),\n          i = (function (a) {\n            if (a && a.__esModule) return a;\n            var b = {};\n            if (null != a)\n              for (var c in a)\n                Object.prototype.hasOwnProperty.call(a, c) && (b[c] = a[c]);\n            return (b.default = a), b;\n          })(h);\n      },\n      {\n        "../config/settings": 34,\n      },\n    ],\n    89: [\n      function (a, b, c) {\n        "use strict";\n        function d(a) {\n          if (a && a.__esModule) return a;\n          var b = {};\n          if (null != a)\n            for (var c in a)\n              Object.prototype.hasOwnProperty.call(a, c) && (b[c] = a[c]);\n          return (b.default = a), b;\n        }\n        function e(a, b) {\n          if (!(a instanceof b))\n            throw new TypeError("Cannot call a class as a function");\n        }\n        Object.defineProperty(c, "__esModule", {\n          value: !0,\n        }),\n          (c.Endpoint = void 0);\n        var f = (function () {\n            function a(a, b) {\n              for (var c = 0; c < b.length; c++) {\n                var d = b[c];\n                (d.enumerable = d.enumerable || !1),\n                  (d.configurable = !0),\n                  "value" in d && (d.writable = !0),\n                  Object.defineProperty(a, d.key, d);\n              }\n            }\n            return function (b, c, d) {\n              return c && a(b.prototype, c), d && a(b, d), b;\n            };\n          })(),\n          g = a("../browserapi/localstorage"),\n          h = d(g),\n          i = a("../browserapi/detectbrowser"),\n          j = d(i),\n          k = a("../utility/timestamps"),\n          l = d(k),\n          m = a("../utility/hash"),\n          n = d(m),\n          o = (function () {\n            function a() {\n              e(this, a),\n                (this.id = null),\n                (this.appversion = null),\n                (this.magicKey = Math.floor(4294967296 * Math.random())),\n                (this.browserName = null),\n                (this.browserVersion = null),\n                (this.osName = null),\n                (this.osVersion = null),\n                (this.codeBase = null),\n                (this.userAgent = null),\n                this.retrieveId();\n            }\n            return (\n              f(a, [\n                {\n                  key: "setup",\n                  value: function () {\n                    var a = j.detect();\n                    (this.browserName = a.browserName),\n                      (this.browserVersion = a.browserVersion),\n                      (this.osName = a.os),\n                      (this.osVersion = a.osVersion),\n                      (this.codeBase = a.codeBase),\n                      (this.userAgent = a.userAgent);\n                  },\n                },\n                {\n                  key: "retrieveId",\n                  value: function () {\n                    var a = this,\n                      b = h.get("endpointID");\n                    if (null === b) {\n                      var c = l.getCurrent(),\n                        d = Math.random() * c;\n                      n.generateSHA256(d.toString(), function (b) {\n                        (a.id = b), h.store("endpointID", b);\n                      });\n                    } else this.id = b;\n                  },\n                },\n                {\n                  key: "getId",\n                  value: function () {\n                    return this.id;\n                  },\n                },\n                {\n                  key: "getAppVersion",\n                  value: function () {\n                    return this.appversion;\n                  },\n                },\n                {\n                  key: "setAppVersion",\n                  value: function (a) {\n                    this.appversion = a;\n                  },\n                },\n                {\n                  key: "getMagicKey",\n                  value: function () {\n                    return this.magicKey;\n                  },\n                },\n                {\n                  key: "getBrowserName",\n                  value: function () {\n                    return this.browserName;\n                  },\n                },\n                {\n                  key: "getBrowserVersion",\n                  value: function () {\n                    return this.browserVersion;\n                  },\n                },\n                {\n                  key: "getOsName",\n                  value: function () {\n                    return this.osName;\n                  },\n                },\n                {\n                  key: "getOsVersion",\n                  value: function () {\n                    return this.osVersion;\n                  },\n                },\n                {\n                  key: "getCodeBase",\n                  value: function () {\n                    return this.codeBase;\n                  },\n                },\n                {\n                  key: "getUserAgent",\n                  value: function () {\n                    return this.userAgent;\n                  },\n                },\n                {\n                  key: "serialize",\n                  value: function () {\n                    return {\n                      type: "browser",\n                      buildName: this.browserName,\n                      buildVersion: this.browserVersion,\n                      appVersion: this.appversion,\n                      os: this.osName,\n                      osVersion: this.osVersion,\n                      userAgent: this.userAgent,\n                    };\n                  },\n                },\n              ]),\n              a\n            );\n          })();\n        c.Endpoint = o;\n      },\n      {\n        "../browserapi/detectbrowser": 18,\n        "../browserapi/localstorage": 20,\n        "../utility/hash": 92,\n        "../utility/timestamps": 99,\n      },\n    ],\n    90: [\n      function (a, b, c) {\n        "use strict";\n        function d(a) {\n          if (a && a.__esModule) return a;\n          var b = {};\n          if (null != a)\n            for (var c in a)\n              Object.prototype.hasOwnProperty.call(a, c) && (b[c] = a[c]);\n          return (b.default = a), b;\n        }\n        function e(a, b) {\n          if (!(a instanceof b))\n            throw new TypeError("Cannot call a class as a function");\n        }\n        Object.defineProperty(c, "__esModule", {\n          value: !0,\n        }),\n          (c.EventMessage = void 0);\n        var f =\n            "function" == typeof Symbol && "symbol" == typeof Symbol.iterator\n              ? function (a) {\n                  return typeof a;\n                }\n              : function (a) {\n                  return a &&\n                    "function" == typeof Symbol &&\n                    a.constructor === Symbol &&\n                    a !== Symbol.prototype\n                    ? "symbol"\n                    : typeof a;\n                },\n          g = (function () {\n            function a(a, b) {\n              for (var c = 0; c < b.length; c++) {\n                var d = b[c];\n                (d.enumerable = d.enumerable || !1),\n                  (d.configurable = !0),\n                  "value" in d && (d.writable = !0),\n                  Object.defineProperty(a, d.key, d);\n              }\n            }\n            return function (b, c, d) {\n              return c && a(b.prototype, c), d && a(b, d), b;\n            };\n          })(),\n          h = a("../config/constants"),\n          i = d(h),\n          j = a("../config/settings"),\n          k = d(j),\n          l = a("./registry"),\n          m = a("./csiologger"),\n          n = d(m),\n          o = (function () {\n            function a(b, c, d, f) {\n              e(this, a),\n                (this.eventType = b),\n                (this.customEntries = d),\n                (this.pcHandler = f),\n                (this.auth = l.Registry.getAuthenticator()),\n                (this.clocksync = l.Registry.getClockSync()),\n                (this.timestamp = this.clocksync.getSynchronizedTimestamp()),\n                (this.conferenceId = c),\n                (this.clockUnSynced = !this.clocksync.isCompleted());\n            }\n            return (\n              g(\n                a,\n                [\n                  {\n                    key: "updateConferenceId",\n                    value: function (a) {\n                      n.log(\n                        "updating conferenceId to ",\n                        this.eventType,\n                        this.conferenceId,\n                        a\n                      ),\n                        (this.conferenceId = a);\n                    },\n                  },\n                  {\n                    key: "toJson",\n                    value: function () {\n                      if (!this.canBeSent()) return null;\n                      var a = this.getCommonHeader();\n                      return (\n                        Object.assign(a, this.customEntries),\n                        this.eventType === i.internalFabricEvent.userJoined &&\n                          delete a.connectionID,\n                        a\n                      );\n                    },\n                  },\n                  {\n                    key: "getCallback",\n                    value: function () {\n                      return this.pcHandler\n                        ? this.pcHandler.getCallback()\n                        : null;\n                    },\n                  },\n                  {\n                    key: "canBeSent",\n                    value: function () {\n                      var a = void 0,\n                        b = i.tmpConferenceId;\n                      if (this.conferenceId === b) return !1;\n                      if (this.pcHandler && !this.pcHandler.getRemoteId())\n                        return !1;\n                      if (this.eventType !== i.precalltestEvents.results) {\n                        var c = l.Registry.getConferenceManager().get(\n                          this.conferenceId\n                        );\n                        if (!c) return !1;\n                        a = c.getUcId();\n                      }\n                      return (\n                        !!this.auth.getToken() &&\n                        (this.auth.isTokenValid()\n                          ? !!(\n                              this.isPriority() ||\n                              (this.clocksync.isCompleted() && a)\n                            ) &&\n                            !(\n                              this.eventType ===\n                                i.internalFabricEvent.userAlive && !a\n                            )\n                          : (this.auth.reAuthenticate(), !1))\n                      );\n                    },\n                  },\n                  {\n                    key: "isCachable",\n                    value: function () {\n                      return (\n                        -1 ===\n                        [i.internalFabricEvent.userAlive].indexOf(\n                          this.eventType\n                        )\n                      );\n                    },\n                  },\n                  {\n                    key: "isPriority",\n                    value: function () {\n                      var a = !1;\n                      return (\n                        (this.eventType !== i.internalFabricEvent.userJoined &&\n                          this.eventType !== i.precalltestEvents.results &&\n                          this.eventType !== i.internalFabricEvent.userAlive) ||\n                          (a = !0),\n                        a\n                      );\n                    },\n                  },\n                  {\n                    key: "getConferenceId",\n                    value: function () {\n                      return this.conferenceId;\n                    },\n                  },\n                  {\n                    key: "getCommonHeader",\n                    value: function () {\n                      var a = {\n                        version: k.version,\n                        callstatsVersion: k.version,\n                        channel: this.decideChannel(),\n                        timestamp: this.timestamp,\n                        action: this.eventType,\n                        eventType: this.eventType,\n                        localID: encodeURIComponent(\n                          l.Registry.getCredentials().getUserId()\n                        ),\n                        timeShift: 0,\n                        appID: l.Registry.getCredentials().getAppId(),\n                        deviceID: l.Registry.getEndpoint().getId(),\n                        token: this.auth.getToken(),\n                        confID: encodeURIComponent(this.conferenceId),\n                      };\n                      this.clockUnSynced &&\n                        (a.timestamp += this.clocksync.getOffset());\n                      var b = l.Registry.getConferenceManager().get(\n                        this.conferenceId\n                      );\n                      return (\n                        (a.ucID = b ? b.getUcId() : null),\n                        this.pcHandler\n                          ? ((a.remoteID = encodeURIComponent(\n                              this.pcHandler.getRemoteId()\n                            )),\n                            (a.connectionID = this.pcHandler.getPcHash()))\n                          : ((a.remoteID = encodeURIComponent(\n                              l.Registry.getCredentials().getUserId()\n                            )),\n                            (a.connectionID = encodeURIComponent(\n                              l.Registry.getCredentials().getUserId()\n                            ))),\n                        a.remoteID ||\n                          (a.remoteID = encodeURIComponent(\n                            l.Registry.getCredentials().getUserId()\n                          )),\n                        a\n                      );\n                    },\n                  },\n                  {\n                    key: "decideChannel",\n                    value: function () {\n                      if (this.eventType == i.callstatsChannels.sdpSubmission)\n                        return i.callstatsChannels.sdpSubmission;\n                      if (this.eventType == i.callstatsChannels.userFeedback)\n                        return i.callstatsChannels.userFeedback;\n                      if (this.eventType == i.callstatsChannels.processedStats)\n                        return i.callstatsChannels.processedStats;\n                      for (var a in i.precalltestEvents)\n                        if (this.eventType == i.precalltestEvents[a])\n                          return i.callstatsChannels.preCallTest;\n                      return i.callstatsChannels.callstatsEvent;\n                    },\n                  },\n                ],\n                [\n                  {\n                    key: "checkCustomEntries",\n                    value: function (a, b) {\n                      if (!p[a])\n                        return n.error("eventType not recognized:", a), !1;\n                      var c = p[a];\n                      for (var d in c)\n                        if (!b.hasOwnProperty(d) || f(b[d]) !== c[d])\n                          return (\n                            n.error(\n                              "customEntries for",\n                              a,\n                              "should have",\n                              d,\n                              "of type",\n                              c[d]\n                            ),\n                            !1\n                          );\n                      return !0;\n                    },\n                  },\n                ]\n              ),\n              a\n            );\n          })(),\n          p = {};\n        (p[i.internalFabricEvent.userJoined] = {\n          endpointInfo: "object",\n        }),\n          (p[i.internalFabricEvent.userLeft] = {}),\n          (p[i.internalFabricEvent.userAlive] = {}),\n          (p[i.internalFabricEvent.userDetails] = {\n            userName: "string",\n          }),\n          (p[i.internalFabricEvent.connectedDeviceList] = {\n            mediaDeviceList: "object",\n          }),\n          (p[i.fabricEvent.activeDeviceList] = {\n            mediaDeviceList: "object",\n          }),\n          (p[i.fabricEvent.audioMute] = {}),\n          (p[i.fabricEvent.audioUnmute] = {}),\n          (p[i.fabricEvent.videoPause] = {}),\n          (p[i.fabricEvent.videoResume] = {}),\n          (p[i.fabricEvent.screenShareStart] = {}),\n          (p[i.fabricEvent.screenShareStop] = {}),\n          (p[i.internalFabricEvent.mediaPlaybackStart] = {\n            ssrc: "string",\n          }),\n          (p[i.internalFabricEvent.mediaPlaybackSuspended] = {\n            ssrc: "string",\n          }),\n          (p[i.internalFabricEvent.mediaPlaybackStalled] = {\n            ssrc: "string",\n          }),\n          (p[i.internalFabricEvent.oneWayMedia] = {\n            mediaType: "string",\n            ssrc: "string",\n          }),\n          (p[i.internalFabricEvent.fabricSetup] = {\n            localIceCandidates: "object",\n            remoteIceCandidates: "object",\n            iceCandidatePairs: "object",\n          }),\n          (p[i.fabricEvent.fabricSetupFailed] = {\n            failureDelay: "number",\n            reason: "string",\n            function: "string",\n            endpoint: "object",\n          }),\n          (p[i.internalFabricEvent.fabricStateChange] = {\n            changedState: "string",\n            prevState: "string",\n            newState: "string",\n          }),\n          (p[i.internalFabricEvent.fabricDropped] = {\n            prevIceConnectionState: "string",\n            currIceConnectionState: "string",\n            currIceCandidatePair: "object",\n            failureDelay: "number",\n          }),\n          (p[i.internalFabricEvent.iceConnectionDisruptionStart] = {\n            prevIceConnectionState: "string",\n            currIceConnectionState: "string",\n            prevIceConnectionStateTs: "number",\n            currIceCandidatePair: "object",\n          }),\n          (p[i.internalFabricEvent.iceConnectionDisruptionEnd] = {\n            prevIceConnectionState: "string",\n            currIceConnectionState: "string",\n            delay: "number",\n          }),\n          (p[i.internalFabricEvent.iceDisruptionStart] = {\n            prevIceConnectionState: "string",\n            currIceConnectionState: "string",\n            prevIceConnectionStateTs: "number",\n            currIceCandidatePair: "object",\n          }),\n          (p[i.internalFabricEvent.iceDisruptionEnd] = {\n            prevIceConnectionState: "string",\n            currIceConnectionState: "string",\n            prevIceCandidatePair: "object",\n          }),\n          (p[i.internalFabricEvent.iceFailed] = {\n            localIceCandidates: "object",\n            prevIceConnectionState: "string",\n            currIceConnectionState: "string",\n            currIceCandidatePair: "object",\n            failureDelay: "number",\n          }),\n          (p[i.internalFabricEvent.iceAborted] = {\n            prevIceConnectionState: "string",\n            currIceConnectionState: "string",\n          }),\n          (p[i.internalFabricEvent.iceRestarted] = {\n            prevIceConnectionState: "string",\n            currIceConnectionState: "string",\n            prevIceCandidatePair: "object",\n          }),\n          (p[i.internalFabricEvent.fabricTransportSwitch] = {\n            prevIceCandidatePair: "object",\n            currIceCandidatePair: "object",\n          }),\n          (p[i.internalFabricEvent.iceTerminated] = {\n            prevIceConnectionState: "string",\n            currIceConnectionState: "string",\n          }),\n          (p[i.fabricEvent.fabricTerminated] = {}),\n          (p[i.fabricEvent.fabricHold] = {}),\n          (p[i.fabricEvent.fabricResume] = {}),\n          (p[i.callstatsChannels.sdpSubmission] = {\n            localSDP: "string",\n            remoteSDP: "string",\n          }),\n          (p[i.internalFabricEvent.ssrcMap] = {\n            ssrcData: "object",\n          }),\n          (p[i.callstatsChannels.userFeedback] = {\n            feedback: "object",\n          }),\n          (p[i.internalFabricEvent.sendingThroughputObservations] = {\n            ssrc: "string",\n            maxsendingKBitrate: "number",\n            timeToMaxSendingKBitrate: "number",\n            stablesendingKBitrate: "number",\n            timeToStableSendingKBitrate: "number",\n          }),\n          (p[i.fabricEvent.dominantSpeaker] = {}),\n          (p[i.fabricEvent.applicationErrorLog] = {\n            message: "string",\n            messageType: "string",\n          }),\n          (p[i.callstatsChannels.processedStats] = {\n            stats: "object",\n          }),\n          (p[i.callstatsChannels.senderConfiguration] = {\n            rtc_rtp_parameters: "object",\n          }),\n          (p[i.internalFabricEvent.limitationObservations] = {\n            reason: "string",\n          }),\n          (p[i.qualityDisruptionTypes.qpchange] = {\n            reason: "string",\n          }),\n          (p[i.precalltestEvents.results] = {\n            results: "object",\n          }),\n          (p[i.precalltestEvents.associate] = {\n            ids: "object",\n          }),\n          (c.EventMessage = o);\n      },\n      {\n        "../config/constants": 33,\n        "../config/settings": 34,\n        "./csiologger": 88,\n        "./registry": 95,\n      },\n    ],\n    91: [\n      function (a, b, c) {\n        "use strict";\n        function d(a) {\n          if (a && a.__esModule) return a;\n          var b = {};\n          if (null != a)\n            for (var c in a)\n              Object.prototype.hasOwnProperty.call(a, c) && (b[c] = a[c]);\n          return (b.default = a), b;\n        }\n        function e(a, b) {\n          if (!(a instanceof b))\n            throw new TypeError("Cannot call a class as a function");\n        }\n        Object.defineProperty(c, "__esModule", {\n          value: !0,\n        }),\n          (c.EventMessageBuilder = void 0);\n        var f =\n            "function" == typeof Symbol && "symbol" == typeof Symbol.iterator\n              ? function (a) {\n                  return typeof a;\n                }\n              : function (a) {\n                  return a &&\n                    "function" == typeof Symbol &&\n                    a.constructor === Symbol &&\n                    a !== Symbol.prototype\n                    ? "symbol"\n                    : typeof a;\n                },\n          g = (function () {\n            function a(a, b) {\n              for (var c = 0; c < b.length; c++) {\n                var d = b[c];\n                (d.enumerable = d.enumerable || !1),\n                  (d.configurable = !0),\n                  "value" in d && (d.writable = !0),\n                  Object.defineProperty(a, d.key, d);\n              }\n            }\n            return function (b, c, d) {\n              return c && a(b.prototype, c), d && a(b, d), b;\n            };\n          })(),\n          h = a("./eventmessage"),\n          i = a("../config/constants"),\n          j = d(i),\n          k = a("./registry"),\n          l = a("./csiologger"),\n          m = d(l),\n          n = (function () {\n            function a() {\n              e(this, a),\n                (this.transmissionmanager = k.Registry.getTransmissionManager());\n            }\n            return (\n              g(a, [\n                {\n                  key: "make",\n                  value: function (a, b, c) {\n                    var d =\n                      arguments.length > 3 && void 0 !== arguments[3]\n                        ? arguments[3]\n                        : {};\n                    if (\n                      "string" != typeof a ||\n                      null === d ||\n                      "object" !== (void 0 === d ? "undefined" : f(d))\n                    )\n                      return (\n                        m.error(\n                          "failed typeof checks:",\n                          a,\n                          void 0 === a ? "undefined" : f(a),\n                          void 0 === d ? "undefined" : f(d),\n                          d\n                        ),\n                        k.Registry.getGenericEventHandler().sendEvent(\n                          j.logEvents.error,\n                          {\n                            msg:\n                              "failed typeof checks:" +\n                              a +\n                              ":" +\n                              (void 0 === d ? "undefined" : f(d)) +\n                              ":" +\n                              (void 0 === a ? "undefined" : f(a)),\n                          }\n                        ),\n                        !1\n                      );\n                    if (null === b && a !== j.precalltestEvents.results)\n                      return (\n                        m.error("failed conferenceId checks:", a, b),\n                        k.Registry.getGenericEventHandler().sendEvent(\n                          j.logEvents.error,\n                          {\n                            msg: "failed conferenceId checks:" + a,\n                          }\n                        ),\n                        !1\n                      );\n                    if (\n                      !c &&\n                      a !== j.callstatsChannels.userFeedback &&\n                      a !== j.fabricEvent.applicationErrorLog &&\n                      a !== j.fabricEvent.fabricSetupFailed &&\n                      a !== j.internalFabricEvent.userJoined &&\n                      a !== j.precalltestEvents.results\n                    )\n                      return (\n                        m.error("peerconnection cannot be null", a),\n                        k.Registry.getGenericEventHandler().sendEvent(\n                          j.logEvents.error,\n                          {\n                            msg: "peerconnection cannot be null" + a,\n                          }\n                        ),\n                        !1\n                      );\n                    if (!h.EventMessage.checkCustomEntries(a, d))\n                      return (\n                        m.error("failed checks:", a, d),\n                        k.Registry.getGenericEventHandler().sendEvent(\n                          j.logEvents.error,\n                          {\n                            msg: "failed customEntries checks:" + a,\n                          }\n                        ),\n                        !1\n                      );\n                    var e = void 0;\n                    if (b) {\n                      var g = k.Registry.getConferenceManager().get(b);\n                      g &&\n                        c &&\n                        (e = g.getPeerConnectionManager().getPcHandler(c));\n                    }\n                    var i = new h.EventMessage(a, b, d, e);\n                    return this.transmissionmanager.send(i), !0;\n                  },\n                },\n              ]),\n              a\n            );\n          })();\n        c.EventMessageBuilder = n;\n      },\n      {\n        "../config/constants": 33,\n        "./csiologger": 88,\n        "./eventmessage": 90,\n        "./registry": 95,\n      },\n    ],\n    92: [\n      function (a, b, c) {\n        "use strict";\n        function d(a, b) {\n          var c = {\n            name: "SHA-256",\n          };\n          if (window.crypto) {\n            var d = window.crypto.subtle || window.crypto.webkitSubtle;\n            if (!d) return void e(a, b);\n            d.digest(c, f(a))\n              .then(function (a) {\n                b(g(a));\n              })\n              .catch(function () {\n                e(a, b);\n              });\n          } else if (window.msCrypto) {\n            if (!window.msCrypto.subtle) return void e(a, b);\n            var h = window.msCrypto.subtle.digest(c, f(a));\n            (h.oncomplete = function (a) {\n              a.target && b(g(a.target.result));\n            }),\n              (h.onerror = function () {\n                e(a, b);\n              });\n          } else e(a, b);\n        }\n        function e(a) {\n          var b =\n              arguments.length > 1 && void 0 !== arguments[1]\n                ? arguments[1]\n                : null,\n            c = 0;\n          if (!a) return c;\n          for (var d = 0, e = a.length; d < e; d++) {\n            (c = (c << 5) - c + a.charCodeAt(d)), (c |= 0);\n          }\n          return b && b(c + ""), c + "";\n        }\n        function f(a) {\n          for (var b = [], c = 0; c < a.length; ++c) {\n            var d = a.charCodeAt(c);\n            d < 128\n              ? (b[b.length] = d)\n              : d > 127 && d < 2048\n              ? ((b[b.length] = (d >> 6) | 192), (b[b.length] = (63 & d) | 128))\n              : ((b[b.length] = (d >> 12) | 224),\n                (b[b.length] = ((d >> 6) & 63) | 128),\n                (b[b.length] = (63 & d) | 128));\n          }\n          return new Uint8Array(b).buffer;\n        }\n        function g(a) {\n          for (\n            var b = new DataView(a), c = "", d = void 0, e = 0;\n            e < b.byteLength;\n            e++\n          )\n            (d = b.getUint8(e).toString(16)),\n              d.length < 2 && (d = "0" + d),\n              (c += d);\n          return c;\n        }\n        Object.defineProperty(c, "__esModule", {\n          value: !0,\n        }),\n          (c.generateSHA256 = d),\n          (c.generateHash = e);\n      },\n      {},\n    ],\n    93: [\n      function (a, b, c) {\n        "use strict";\n        function d(a) {\n          return !!/^[\\],:{}\\s]*$/.test(\n            a\n              .replace(/\\\\["\\\\\\/bfnrtu]/g, "@")\n              .replace(\n                /"[^"\\\\\\n\\r]*"|true|false|null|-?\\d+(?:\\.\\d*)?(?:[eE][+\\-]?\\d+)?/g,\n                "]"\n              )\n              .replace(/(?:^|:|,)(?:\\s*\\[)+/g, "")\n          );\n        }\n        function e(a) {\n          var b = null;\n          return null === a ? b : (d(a) && (b = JSON.parse(a)), b);\n        }\n        Object.defineProperty(c, "__esModule", {\n          value: !0,\n        }),\n          (c.isValid = d),\n          (c.parse = e);\n      },\n      {},\n    ],\n    94: [\n      function (a, b, c) {\n        "use strict";\n        function d(a) {\n          if (a && a.__esModule) return a;\n          var b = {};\n          if (null != a)\n            for (var c in a)\n              Object.prototype.hasOwnProperty.call(a, c) && (b[c] = a[c]);\n          return (b.default = a), b;\n        }\n        function e() {\n          window &&\n            window.addEventListener &&\n            window.addEventListener("error", function (a) {\n              var b = f.Registry.getGenericEventHandler();\n              if (a && a.filename && a.filename.indexOf("callstats") > -1) {\n                for (\n                  var c = !1,\n                    d = {\n                      fileName: a.filename,\n                      line: a.lineno,\n                      col: a.colno,\n                      jsVersion: h.version,\n                      eventType: "error",\n                      message: a.message,\n                      pageURL: window.location.href,\n                    },\n                    e = f.Registry.getConferenceManager().getConferenceIds(),\n                    g = 0;\n                  g < e.length;\n                  g++\n                )\n                  (d.conferenceID = e[g]),\n                    b.sendEvent(j.logEvents.error, d),\n                    (c = !0);\n                c || b.sendEvent(j.logEvents.error, d);\n              }\n            });\n        }\n        Object.defineProperty(c, "__esModule", {\n          value: !0,\n        }),\n          (c.setErrorEventListener = e);\n        var f = a("./registry"),\n          g = a("../config/settings"),\n          h = d(g),\n          i = a("../config/constants"),\n          j = d(i);\n      },\n      {\n        "../config/constants": 33,\n        "../config/settings": 34,\n        "./registry": 95,\n      },\n    ],\n    95: [\n      function (a, b, c) {\n        "use strict";\n        function d(a, b) {\n          if (!(a instanceof b))\n            throw new TypeError("Cannot call a class as a function");\n        }\n        Object.defineProperty(c, "__esModule", {\n          value: !0,\n        }),\n          (c.Registry = void 0);\n        var e = (function () {\n            function a(a, b) {\n              for (var c = 0; c < b.length; c++) {\n                var d = b[c];\n                (d.enumerable = d.enumerable || !1),\n                  (d.configurable = !0),\n                  "value" in d && (d.writable = !0),\n                  Object.defineProperty(a, d.key, d);\n              }\n            }\n            return function (b, c, d) {\n              return c && a(b.prototype, c), d && a(b, d), b;\n            };\n          })(),\n          f = a("../services/clocksync"),\n          g = a("../services/configservice/configservicewrapper"),\n          h = a("../services/authenticator"),\n          i = a("../services/backendlog"),\n          j = a("../services/transmissionmanager"),\n          k = a("./eventmessagebuilder"),\n          l = a("../conference/conferencemanager"),\n          m = a("../utility/credentials"),\n          n = a("../statspipeline/statsadapter"),\n          o = a("../statspipeline/statsparser"),\n          p = a("../statspipeline/statsmonitor"),\n          q = a("../statspipeline/statstransmitter"),\n          r = a("../statspipeline/statsassembler"),\n          s = a("../utility/endpoint"),\n          t = a("../browserapi/battery"),\n          u = a("precalltest"),\n          v = a("../statspipeline/wifistatsexecutor"),\n          w = a("./callbacks"),\n          x = a("../statspipeline/statscallbackbuilder"),\n          y = a("../services/connectionmanager"),\n          z = null,\n          A = null,\n          B = null,\n          C = null,\n          D = null,\n          E = null,\n          F = null,\n          G = null,\n          H = null,\n          I = null,\n          J = null,\n          K = null,\n          L = null,\n          M = null,\n          N = null,\n          O = null,\n          P = null,\n          Q = null,\n          R = null,\n          S = null,\n          T = (function () {\n            function a() {\n              d(this, a);\n            }\n            return (\n              e(a, null, [\n                {\n                  key: "getConferenceManager",\n                  value: function () {\n                    return O || (O = new l.ConferenceManager()), O;\n                  },\n                },\n                {\n                  key: "getStatsCallbackBuilder",\n                  value: function () {\n                    return R || (R = new x.StatsCallbackBuilder()), R;\n                  },\n                },\n                {\n                  key: "getClockSync",\n                  value: function () {\n                    return A || (A = new f.ClockSync()), A;\n                  },\n                },\n                {\n                  key: "getWifiStatsExecutor",\n                  value: function () {\n                    return P || (P = new v.WifiStatsExecutor()), P;\n                  },\n                },\n                {\n                  key: "getAuthenticator",\n                  value: function () {\n                    return B || (B = new h.Authenticator()), B;\n                  },\n                },\n                {\n                  key: "getConfigServiceWrapper",\n                  value: function () {\n                    return C || (C = new g.ConfigServiceWrapper()), C;\n                  },\n                },\n                {\n                  key: "getGenericEventHandler",\n                  value: function () {\n                    return (\n                      D || ((D = new i.GenericEventHandler()), D.enable()), D\n                    );\n                  },\n                },\n                {\n                  key: "getConnectionManager",\n                  value: function () {\n                    return S || (S = new y.ConnectionManager()), S;\n                  },\n                },\n                {\n                  key: "getTransmissionManager",\n                  value: function () {\n                    return E || (E = new j.TransmissionManager()), E;\n                  },\n                },\n                {\n                  key: "getEventMessageBuilder",\n                  value: function () {\n                    return F || (F = new k.EventMessageBuilder()), F;\n                  },\n                },\n                {\n                  key: "getCredentials",\n                  value: function () {\n                    return G || (G = new m.Credentials()), G;\n                  },\n                },\n                {\n                  key: "getEndpoint",\n                  value: function () {\n                    return H || (H = new s.Endpoint()), H;\n                  },\n                },\n                {\n                  key: "getStatsAdapter",\n                  value: function () {\n                    if (!I) {\n                      var b = a.getEndpoint().getCodeBase(),\n                        c = a.getEndpoint().getBrowserName();\n                      I = new n.StatsAdapter(b, c);\n                    }\n                    return I;\n                  },\n                },\n                {\n                  key: "getPreCallTest",\n                  value: function () {\n                    return z || (z = new u.PreCallTest()), z;\n                  },\n                },\n                {\n                  key: "getStatsParser",\n                  value: function () {\n                    return J || (J = new o.StatsParser()), J;\n                  },\n                },\n                {\n                  key: "getStatsMonitor",\n                  value: function () {\n                    if (!K) {\n                      var b = a.getEndpoint().getCodeBase();\n                      K = new p.StatsMonitor(b);\n                    }\n                    return K;\n                  },\n                },\n                {\n                  key: "getStatsTransmitter",\n                  value: function () {\n                    return L || (L = new q.StatsTransmitter()), L;\n                  },\n                },\n                {\n                  key: "getStatsAssembler",\n                  value: function () {\n                    return M || (M = new r.StatsAssembler()), M;\n                  },\n                },\n                {\n                  key: "getBattery",\n                  value: function () {\n                    return N || (N = new t.Battery()), N;\n                  },\n                },\n                {\n                  key: "getCallbacks",\n                  value: function () {\n                    return Q || (Q = new w.Callbacks()), Q;\n                  },\n                },\n              ]),\n              a\n            );\n          })();\n        c.Registry = T;\n      },\n      {\n        "../browserapi/battery": 17,\n        "../conference/conferencemanager": 31,\n        "../services/authenticator": 44,\n        "../services/backendlog": 45,\n        "../services/clocksync": 46,\n        "../services/configservice/configservicewrapper": 50,\n        "../services/connectionmanager": 51,\n        "../services/transmissionmanager": 56,\n        "../statspipeline/statsadapter": 69,\n        "../statspipeline/statsassembler": 70,\n        "../statspipeline/statscallbackbuilder": 71,\n        "../statspipeline/statsmonitor": 72,\n        "../statspipeline/statsparser": 73,\n        "../statspipeline/statstransmitter": 74,\n        "../statspipeline/wifistatsexecutor": 84,\n        "../utility/credentials": 87,\n        "../utility/endpoint": 89,\n        "./callbacks": 86,\n        "./eventmessagebuilder": 91,\n        precalltest: 2,\n      },\n    ],\n    96: [\n      function (a, b, c) {\n        "use strict";\n        function d(a, b) {\n          if (!(a instanceof b))\n            throw new TypeError("Cannot call a class as a function");\n        }\n        function e() {\n          return null === i && (i = new j()), i;\n        }\n        Object.defineProperty(c, "__esModule", {\n          value: !0,\n        });\n        var f = (function () {\n          function a(a, b) {\n            for (var c = 0; c < b.length; c++) {\n              var d = b[c];\n              (d.enumerable = d.enumerable || !1),\n                (d.configurable = !0),\n                "value" in d && (d.writable = !0),\n                Object.defineProperty(a, d.key, d);\n            }\n          }\n          return function (b, c, d) {\n            return c && a(b.prototype, c), d && a(b, d), b;\n          };\n        })();\n        c.getRTTRegistry = e;\n        var g = a("../statspipeline/validator"),\n          h = (function (a) {\n            if (a && a.__esModule) return a;\n            var b = {};\n            if (null != a)\n              for (var c in a)\n                Object.prototype.hasOwnProperty.call(a, c) && (b[c] = a[c]);\n            return (b.default = a), b;\n          })(g),\n          i = null,\n          j = (function () {\n            function a() {\n              d(this, a),\n                (this.rtts = new Map()),\n                (this.frameRates = new Map()),\n                (this.transportRTT = null);\n            }\n            return (\n              f(a, [\n                {\n                  key: "getFrameRateReceived",\n                  value: function (a) {\n                    for (\n                      var b = null,\n                        c = [\n                          "googFrameRateOutput",\n                          "googFrameRateDecoded",\n                          "googFrameRateReceived",\n                          "googFrameRateSent",\n                          "framerateMean",\n                          "framesPerSecond",\n                        ],\n                        d = 0,\n                        e = c.length;\n                      d < e;\n                      d++\n                    ) {\n                      var f = c[d];\n                      if (void 0 !== (b = a.stat(f))) break;\n                    }\n                    return b;\n                  },\n                },\n                {\n                  key: "update",\n                  value: function (a) {\n                    var b = this;\n                    a.getStats(function (a) {\n                      for (\n                        var c = [], d = a.result(), e = 0;\n                        e < d.length;\n                        ++e\n                      ) {\n                        var f = d[e];\n                        if ("googCandidatePair" !== f.type) {\n                          if ("ssrc" === f.type) {\n                            var g = b.getFrameRateReceived(f),\n                              i = f.stat("googRtt"),\n                              j = f.stat("ssrc");\n                            i &&\n                              b.rtts.set(\n                                h.checkForNan(parseInt(j, 10)),\n                                h.checkForNan(parseInt(i, 10))\n                              ),\n                              g &&\n                                b.frameRates.set(\n                                  h.checkForNan(parseInt(j, 10)),\n                                  h.checkForNan(parseInt(g, 10))\n                                );\n                          }\n                        } else {\n                          var k = f.stat("googRtt");\n                          c.push(k);\n                        }\n                      }\n                      b.transportRTT = Math.max.apply(Math, c);\n                    });\n                  },\n                },\n                {\n                  key: "getTransportRTT",\n                  value: function () {\n                    return this.transportRTT;\n                  },\n                },\n                {\n                  key: "getRTT",\n                  value: function (a) {\n                    var b = h.checkForNan(parseInt(a, 10));\n                    return this.rtts.has(b) ? this.rtts.get(b) : null;\n                  },\n                },\n                {\n                  key: "getFrameRate",\n                  value: function (a) {\n                    var b = h.checkForNan(parseInt(a, 10));\n                    return this.frameRates.has(b)\n                      ? this.frameRates.get(b)\n                      : null;\n                  },\n                },\n              ]),\n              a\n            );\n          })();\n      },\n      {\n        "../statspipeline/validator": 83,\n      },\n    ],\n    97: [\n      function (a, b, c) {\n        "use strict";\n        function d(a, b) {\n          if (!(a instanceof b))\n            throw new TypeError("Cannot call a class as a function");\n        }\n        Object.defineProperty(c, "__esModule", {\n          value: !0,\n        });\n        var e = (function () {\n            function a(a, b) {\n              for (var c = 0; c < b.length; c++) {\n                var d = b[c];\n                (d.enumerable = d.enumerable || !1),\n                  (d.configurable = !0),\n                  "value" in d && (d.writable = !0),\n                  Object.defineProperty(a, d.key, d);\n              }\n            }\n            return function (b, c, d) {\n              return c && a(b.prototype, c), d && a(b, d), b;\n            };\n          })(),\n          f = (function () {\n            function a(b, c, e) {\n              d(this, a),\n                (this.max = b),\n                (this.midpoint = c),\n                (this.stepness = e),\n                (this.actualStep = 0),\n                this.reset();\n            }\n            return (\n              e(a, [\n                {\n                  key: "reset",\n                  value: function () {\n                    this.actualStep = 0;\n                  },\n                },\n                {\n                  key: "setMidpoint",\n                  value: function (a) {\n                    this.midpoint = a;\n                  },\n                },\n                {\n                  key: "setMax",\n                  value: function (a) {\n                    this.max = a;\n                  },\n                },\n                {\n                  key: "setStepness",\n                  value: function (a) {\n                    this.stepness = a;\n                  },\n                },\n                {\n                  key: "increaseActualStep",\n                  value: function (a) {\n                    this.actualStep += a;\n                  },\n                },\n                {\n                  key: "getActual",\n                  value: function () {\n                    var a =\n                      arguments.length > 0 && void 0 !== arguments[0]\n                        ? arguments[0]\n                        : 1;\n                    return (\n                      (this.actualStep += a),\n                      this.max /\n                        (1 +\n                          Math.exp(\n                            -1 *\n                              this.stepness *\n                              (this.actualStep - this.midpoint)\n                          ))\n                    );\n                  },\n                },\n              ]),\n              a\n            );\n          })();\n        c.Sigmoid = f;\n      },\n      {},\n    ],\n    98: [\n      function (a, b, c) {\n        "use strict";\n        function d(a, b) {\n          if (!(a instanceof b))\n            throw new TypeError("Cannot call a class as a function");\n        }\n        Object.defineProperty(c, "__esModule", {\n          value: !0,\n        }),\n          (c.TimeoutProcess = void 0);\n        var e = (function () {\n            function a(a, b) {\n              for (var c = 0; c < b.length; c++) {\n                var d = b[c];\n                (d.enumerable = d.enumerable || !1),\n                  (d.configurable = !0),\n                  "value" in d && (d.writable = !0),\n                  Object.defineProperty(a, d.key, d);\n              }\n            }\n            return function (b, c, d) {\n              return c && a(b.prototype, c), d && a(b, d), b;\n            };\n          })(),\n          f = a("./csiologger"),\n          g = (function (a) {\n            if (a && a.__esModule) return a;\n            var b = {};\n            if (null != a)\n              for (var c in a)\n                Object.prototype.hasOwnProperty.call(a, c) && (b[c] = a[c]);\n            return (b.default = a), b;\n          })(f),\n          h = (function () {\n            function a(b) {\n              d(this, a),\n                (this.interval = b),\n                (this.timerId = null),\n                (this.callback = function () {\n                  g.warn("no callback function set", this);\n                });\n            }\n            return (\n              e(a, [\n                {\n                  key: "setCallback",\n                  value: function (a) {\n                    this.callback = a;\n                  },\n                },\n                {\n                  key: "start",\n                  value: function () {\n                    var a = this;\n                    this.timerId = setInterval(function () {\n                      a.callback();\n                    }, this.interval);\n                  },\n                },\n                {\n                  key: "stop",\n                  value: function () {\n                    clearInterval(this.timerId), (this.timerId = null);\n                  },\n                },\n                {\n                  key: "isStarted",\n                  value: function () {\n                    return null !== this.timerId;\n                  },\n                },\n              ]),\n              a\n            );\n          })();\n        c.TimeoutProcess = h;\n      },\n      {\n        "./csiologger": 88,\n      },\n    ],\n    99: [\n      function (a, b, c) {\n        "use strict";\n        function d() {\n          return window &&\n            window.performance &&\n            window.performance.now &&\n            window.performance.timing &&\n            window.performance.timing.navigationStart\n            ? window.performance.now() +\n                window.performance.timing.navigationStart\n            : Date.now();\n        }\n        function e() {\n          return window && window.performance && window.performance.now\n            ? window.performance.now()\n            : null;\n        }\n        Object.defineProperty(c, "__esModule", {\n          value: !0,\n        }),\n          (c.getCurrent = d),\n          (c.getSinceOrigin = e);\n      },\n      {},\n    ],\n    100: [\n      function (a, b, c) {\n        "use strict";\n        function d(a, b) {\n          if (!(a instanceof b))\n            throw new TypeError("Cannot call a class as a function");\n        }\n        Object.defineProperty(c, "__esModule", {\n          value: !0,\n        });\n        var e =\n            "function" == typeof Symbol && "symbol" == typeof Symbol.iterator\n              ? function (a) {\n                  return typeof a;\n                }\n              : function (a) {\n                  return a &&\n                    "function" == typeof Symbol &&\n                    a.constructor === Symbol &&\n                    a !== Symbol.prototype\n                    ? "symbol"\n                    : typeof a;\n                },\n          f = (function () {\n            function a(a, b) {\n              for (var c = 0; c < b.length; c++) {\n                var d = b[c];\n                (d.enumerable = d.enumerable || !1),\n                  (d.configurable = !0),\n                  "value" in d && (d.writable = !0),\n                  Object.defineProperty(a, d.key, d);\n              }\n            }\n            return function (b, c, d) {\n              return c && a(b.prototype, c), d && a(b, d), b;\n            };\n          })(),\n          g = (function () {\n            function a(b) {\n              d(this, a), (this.base = b);\n              for (\n                var c = arguments.length, e = Array(c > 1 ? c - 1 : 0), f = 1;\n                f < c;\n                f++\n              )\n                e[f - 1] = arguments[f];\n              this.appendixes = e;\n            }\n            return (\n              f(a, null, [\n                {\n                  key: "concat",\n                  value: function (a, b) {\n                    if (!b) return a;\n                    if (!a) return b;\n                    var c = "/" === a.substr(a.length - 1),\n                      d = "/" === b.substring(0, 1);\n                    return c || d\n                      ? c && d\n                        ? a + b.substring(1)\n                        : a + b\n                      : a + "/" + b;\n                  },\n                },\n              ]),\n              f(a, [\n                {\n                  key: "append",\n                  value: function (a) {\n                    this.appendixes.push(a);\n                  },\n                },\n                {\n                  key: "toString",\n                  value: function () {\n                    var b = this.getString(this.base),\n                      c = this;\n                    return (\n                      this.appendixes.forEach(function (d) {\n                        if (null !== d && void 0 !== d) {\n                          var e = c.getString(d);\n                          b = a.concat(b, e);\n                        }\n                      }),\n                      b\n                    );\n                  },\n                },\n                {\n                  key: "getString",\n                  value: function (a) {\n                    switch (void 0 === a ? "undefined" : e(a)) {\n                      case "function":\n                        return this.getString(a());\n\n                      case "number":\n                        return a + "";\n\n                      case "string":\n                      default:\n                        return a;\n                    }\n                  },\n                },\n              ]),\n              a\n            );\n          })();\n        c.Url = g;\n      },\n      {},\n    ],\n    101: [\n      function (a, b, c) {\n        "use strict";\n        function d(a) {\n          var b = [];\n          if (!a) return b;\n          for (var c = 0; c < a.length; c++) {\n            var d = {};\n            (d.mediaDeviceID = a[c].deviceId),\n              (d.groupID = a[c].groupId),\n              (d.kind = a[c].kind),\n              (d.label = a[c].label),\n              b.push(d);\n          }\n          return b;\n        }\n        function e() {\n          Number.isInteger ||\n            (Number.isInteger =\n              Number.isInteger ||\n              function (a) {\n                return (\n                  "number" == typeof a && isFinite(a) && Math.floor(a) === a\n                );\n              });\n        }\n        function f() {\n          "function" != typeof Object.assign &&\n            Object.defineProperty(Object, "assign", {\n              value: function (a, b) {\n                if (null == a)\n                  throw new TypeError(\n                    "Cannot convert undefined or null to object"\n                  );\n                for (var c = Object(a), d = 1; d < arguments.length; d++) {\n                  var e = arguments[d];\n                  if (null != e)\n                    for (var f in e)\n                      Object.prototype.hasOwnProperty.call(e, f) &&\n                        (c[f] = e[f]);\n                }\n                return c;\n              },\n              writable: !0,\n              configurable: !0,\n            });\n        }\n        Object.defineProperty(c, "__esModule", {\n          value: !0,\n        }),\n          (c.normalizeMediaDeviceList = d),\n          (c.isIntegerPollyfill = e),\n          (c.assignPollyfill = f);\n      },\n      {},\n    ],\n  },\n  {},\n  [22]\n);\n'},function(n,e,t){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=t(29),i=t(0);class a{constructor(n){"object"===typeof window._PlivoInstance?(i.Logger.info("window.Plivo object and its instance already exist"),this.client=window._PlivoInstance):this.client=new r.Client(n)}}Object.defineProperty(a,"client",{enumerable:!0}),e.default=a,n.exports=a},function(n,e,t){"use strict";var r=this&&this.__createBinding||(Object.create?function(n,e,t,r){void 0===r&&(r=t),Object.defineProperty(n,r,{enumerable:!0,get:function(){return e[t]}})}:function(n,e,t,r){void 0===r&&(r=t),n[r]=e[t]}),i=this&&this.__setModuleDefault||(Object.create?function(n,e){Object.defineProperty(n,"default",{enumerable:!0,value:e})}:function(n,e){n.default=e}),a=this&&this.__importStar||function(n){if(n&&n.__esModule)return n;var e={};if(null!=n)for(var t in n)"default"!==t&&Object.prototype.hasOwnProperty.call(n,t)&&r(e,n,t);return i(e,n),e},s=this&&this.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(e,"__esModule",{value:!0}),e.Client=void 0;const o=t(30),c=a(t(1)),l=t(0),u=a(t(6)),d=a(t(7)),h=s(t(36)),p=a(t(3)),f=a(t(9)),g=s(t(37)),m=a(t(19)),b=a(t(23)),v=t(14),y=t(42),_=t(17),C=s(t(2)),S=s(t(43)),T=s(t(44)),E=t(8),w=t(12),k=t(1),R=t(45),I={log:l.Logger,sendEvents:p.sendEvents,AppError:p.AppError};class A extends o.EventEmitter{constructor(n){super(),this.login=(n,e)=>this._login(n,e),this.loginWithAccessToken=n=>this._loginWithAccessToken(n),this.loginWithAccessTokenGenerator=n=>this._loginWithAccessTokenGenerator(n),this.getErrorStringByErrorCodes=n=>this._getErrorStringByErrorCodes(n),this.logout=()=>this._logout(),this.call=(n,e)=>this._call(n,e),this.answer=(n,e)=>this._answer(n,e),this.hangup=()=>this._hangup(),this.reject=n=>this._reject(n),this.ignore=n=>this._ignore(n),this.sendDtmf=n=>this._sendDtmf(n),this.mute=()=>this._mute(),this.unmute=()=>this._unmute(),this.setRingTone=n=>this._setRingTone(n),this.setRingToneBack=n=>this._setRingToneBack(n),this.setConnectTone=n=>this._setConnectTone(n),this.startNoiseReduction=()=>this._startNoiseReduction(),this.stopNoiseReduction=()=>this._stopNoiseReduction(),this.setDtmfTone=(n,e)=>this._setDtmfTone(n,e),this.getCallUUID=()=>this._getCallUUID(),this.isRegistered=()=>this._isRegistered(),this.isConnecting=()=>this._isConnecting(),this.isConnected=()=>this._isConnected(),this.getLastCallUUID=()=>this._getLastCallUUID(),this.getIncomingCalls=()=>this._getIncomingCalls(),this.setDebug=n=>this._setDebug(n),this.getPeerConnection=()=>this._getPeerConnection(),this.webRTC=()=>!!window.RTCPeerConnection,this.supportedBrowsers=()=>"Chrome, Firefox, Safari, Edge",this.submitCallQualityFeedback=(n,e,t,r,i)=>this._submitCallQualityFeedback(n,e,t,r,i),this.getUsernameFromToken=n=>{if(n.sub)return`${n.sub}_${n.iss}`;return`puser${(new Date).valueOf().toString()}jt_${n.iss}`},this.validateToken=n=>{if(null==n)return!1;const{app:e,iss:t,sub:r,nbf:i,exp:a,per:s}=n;return!!(t&&i&&a)&&!(e&&"string"!==typeof e||t&&"string"!==typeof t||r&&"string"!==typeof r||i&&"number"!==typeof i||a&&"number"!==typeof a||s&&s.voice&&s.voice.incoming_allow&&"boolean"!==typeof s.voice.incoming_allow||s&&s.voice&&s.voice.outgoing_allow&&"boolean"!==typeof s.voice.outgoing_allow)},this.parseJwtToken=n=>{try{const e=n.split(".")[1].replace(/-/g,"+").replace(/_/g,"/"),t=decodeURIComponent(atob(e).split("").map((n=>"%"+("00"+n.charCodeAt(0).toString(16)).slice(-2))).join(""));return JSON.parse(t)}catch(n){return I.log.error(`${c.LOGCAT.LOGIN}| parsing of jwt failed ${n.message}`),null}},this.tokenLogin=(n,e)=>{var t;if(this.phone&&this.phone.isRegistered()&&this.phone.isConnected()&&this.userName===n&&!this.isAccessToken)return I.log.warn(`${c.LOGCAT.LOGIN} | Already registered with the endpoint provided - ${this.userName}`),!0;this.isLoginCalled=!0;const r=new g.default(this,n," ",e,null!==(t=this.options.registrationRefreshTimer)&&void 0!==t?t:c.REGISTER_EXPIRES_SECONDS),i=()=>{r.setupUserAccount()},a=r.validate((()=>{i()}));if("boolean"===typeof a){if(!a)return!1;i()}return!0},this.setExpiryTimeInEpoch=n=>{this.accessTokenExpiryInEpoch=n},this.getTokenExpiryTimeInEpoch=()=>this.accessTokenExpiryInEpoch,this._loginWithAccessTokenGenerator=n=>null==n?(I.log.error(`${c.LOGCAT.LOGIN} | Login failed. Access token object can not be null`),this.emit("onLoginFailed","INVALID_ACCESS_TOKEN"),!1):(this.isAccessTokenGenerator=!0,this.accessTokenObject=n,I.log.info(`${c.LOGCAT.LOGIN} | Login initiated with Access Token Generator`),n.getAccessToken().then((e=>{if(null==e)return this.emit("onLoginFailed","INVALID_ACCESS_TOKEN"),I.log.error(`${c.LOGCAT.LOGIN} | Login failed. Access Token found null. Try to re-login with valid accessToken`),!1;const t=this.parseJwtToken(e);if(null!=t){const e=Math.floor((new Date).getTime()),r=Math.floor((new Date).getTime()+864e5),i=(null!=t.exp?1e3*t.exp:r)-e-6e4;this.accessTokenGeneratorTimer=setTimeout((()=>{this.loginWithAccessTokenGenerator(n)}),Number(i))}return this.isAccessToken?(null!=this.phone&&this._initJWTParams(e)&&(I.log.debug("New token added : ",e),this.phone.registrator().setExtraHeaders([`X-Plivo-Jwt: ${e}`])),!0):this.loginWithAccessToken(e)})).catch((n=>(I.log.error(`${c.LOGCAT.LOGIN} | Failed to fetch the accessToken. Try to re-login with valid accessToken`,n),this.emit("onLoginFailed","INVALID_ACCESS_TOKEN"),!1))),!0),this._initJWTParams=n=>{try{const e=this.parseJwtToken(n);e&&e.per&&e.per.voice&&(this.isOutgoingGrant=e.per.voice.outgoing_allow,this.isIncomingGrant=e.per.voice.incoming_allow);return this.validateToken(e)?(I.log.info(`${c.LOGCAT.LOGIN} | Parsed JWT with params:- `,JSON.stringify(e)),this.userName=this.getUsernameFromToken(e),this.accessToken=n,this.isAccessToken=!0,!0):(this.emit("onLoginFailed","INVALID_ACCESS_TOKEN"),I.log.error(`${c.LOGCAT.LOGIN} | Login failed. Access Token found null. Try to re-login with valid accessToken`),!1)}catch(n){return!1}},this._loginWithAccessToken=n=>{try{return this.phone&&(this.isConnecting()||this.phone.isRegistering())?(I.log.warn(`${c.LOGCAT.LOGIN} | Already ${this.isConnecting()?"connecting":"registering"}`),!0):this._initJWTParams(n)&&this.userName?(I.log.info(c.LOGCAT.LOGIN," | Login initiated with AccessToken : ",n),this.loggerUtil.setUserName(this.userName),this.tokenLogin(this.userName,n)):(I.log.info(c.LOGCAT.LOGIN,"Login failed : Invalid AccessToken"),!1)}catch(n){return!1}},this._getErrorStringByErrorCodes=n=>{switch(n){case 10001:return"INVALID_ACCESS_TOKEN";case 10002:return"INVALID_ACCESS_TOKEN_HEADER";case 10003:return"INVALID_ACCESS_TOKEN_ISSUER";case 10004:return"INVALID_ACCESS_TOKEN_SUBJECT";case 10005:return"ACCESS_TOKEN_NOT_VALID_YET";case 10006:return"ACCESS_TOKEN_EXPIRED";case 10007:return"INVALID_ACCESS_TOKEN_SIGNATURE";case 10008:return"INVALID_ACCESS_TOKEN_GRANTS";case 10009:return"EXPIRATION_EXCEEDS_MAX_ALLOWED_TIME";case 10010:return"MAX_ALLOWED_LOGIN_REACHED";default:return"Unauthorised"}},this._login=(n,e)=>{var t;if(this.loggerUtil.setUserName(n),I.log.info(`${c.LOGCAT.LOGIN} | Login initiated with Endpoint - ${n}`),this.phone&&(this.isConnecting()||this.phone.isRegistering()))return I.log.warn(`${c.LOGCAT.LOGIN} | Already ${this.isConnecting()?"connecting":"registering"}`),!0;if(this.phone&&this.phone.isRegistered()&&this.phone.isConnected()&&this.userName===n&&!this.isAccessToken)return I.log.warn(`${c.LOGCAT.LOGIN} | Already registered with the endpoint provided - ${this.userName}`),!0;this.isLoginCalled=!0;const r=new g.default(this,n,e,null,null!==(t=this.options.registrationRefreshTimer)&&void 0!==t?t:c.REGISTER_EXPIRES_SECONDS),i=()=>{r.setupUserAccount(),"safari"===this.browserDetails.browser&&d.playAudio(c.SILENT_TONE_ELEMENT_ID)},a=r.validate((()=>{i()}));if("boolean"===typeof a){if(!a)return!1;i()}return!0},this._logout=()=>this.isLoggedIn?(I.log.debug(c.LOGCAT.LOGOUT," | Logout initiated!",this.userName),this.clearOnLogout(),!0):(I.log.debug(c.LOGCAT.LOGOUT," | Cannot execute logout: no active login session.",this.userName),!1),this._call=(n,e)=>{if(this.timeTakenForStats.pdd={init:(new Date).getTime()},!this.isLoggedIn&&(null===this.phone||this.phone&&!this.phone.isConnected()&&!this.phone.isRegistered()))return I.log.warn(`${c.LOGCAT.LOGIN} | Must be logged in before to make a call`),!1;if(this.isAccessToken&&(null==this.accessToken||void 0===this.accessToken||!1===(null===this||void 0===this?void 0:this.isOutgoingGrant)))return this.emit("onPermissionDenied","INVALID_ACCESS_TOKEN_GRANTS"),I.log.warn(`${c.LOGCAT.LOGIN} | Outgoing call permission not granted`),!1;return(()=>{this.isAccessToken&&(e["X-Plivo-Jwt"]=`${this.accessToken}`),this.owaLastDetect.isOneWay=!1,b.makeCall(this,e,n)})(),!0},this._answer=(n,e)=>{const t=m.getCurrentIncomingCall(n,this),r=m.checkIncomingCallAction(e);return t&&r?(I.log.debug(`answer - ${t.callUUID}`),t.addConnectionStage(`answer()@${(new Date).getTime()}`),m.answerIncomingCall(t,e),!0):(I.log.error(`${c.LOGCAT.LOGIN} | Incoming call answer() failed : no incoming call`),!1)},this._hangup=()=>{var n;if(!this._currentSession)return I.log.warn(`${k.LOGCAT.CALL} | No call session exists to hangup`),!1;this.loggerUtil.setSipCallID(null!==(n=this._currentSession.sipCallID)&&void 0!==n?n:""),I.log.debug(`hangup - ${this._currentSession.callUUID}`),this._currentSession.session&&"outgoing"!==this._currentSession.session.direction&&!this._currentSession.session.isEstablished()&&I.log.warn("use of hangup() on unanswered call is deprecated. use reject() instead");try{I.log.debug(`${k.LOGCAT.CALL} | hangup initialized`),u.updateAudioDeviceFlags(),I.AppError&&I.AppError.call(this,{name:"hangup",message:"hangup initialized",method:"hangup()"}),this._currentSession.session&&!this._currentSession.session.isEnded()&&this._currentSession.session.terminate(),this.ringBackToneView&&!this.ringBackToneView.paused&&d.stopAudio(c.RINGBACK_ELEMENT_ID)}catch(n){I.log.error(`${k.LOGCAT.CALL} | Could not hangup, Reason: `,n),I.AppError&&I.sendEvents&&(I.AppError.call(this,{name:n.name,message:n.message,method:"hangup()"}),I.sendEvents.call(this,{msg:"ERROR_EVENT",name:n.name,info:n.message,method:"hangup()"},this._currentSession))}return!0},this._reject=n=>{var e;const t=m.getCurrentIncomingCall(n,this);if(!t)return I.log.warn(`${k.LOGCAT.CALL} | No call session exists to reject()`),!1;if(this.loggerUtil.setSipCallID(null!==(e=t.sipCallID)&&void 0!==e?e:""),I.log.debug(`${k.LOGCAT.CALL} | reject - ${t.callUUID}`),t.session&&t.session.isEstablished())return I.log.warn(`${k.LOGCAT.CALL} |call already answerd, please use hangup() method`),!1;if(t){const n={status_code:486,reason_phrase:"Busy Here"};I.log.info("rejecting call"),I.AppError&&I.AppError.call(this,{name:"reject",message:"reject initialized",method:"reject()"});try{t.session.terminate(n),this.incomingInvites.delete(t.callUUID)}catch(n){I.log.error("error in rejecting call : ",n),I.AppError&&I.sendEvents&&(I.AppError.call(this,{name:n.name,message:n.message,method:"reject()"}),I.sendEvents.call(this,{msg:"ERROR_EVENT",name:n.name,info:n.message,method:"reject()"},t))}this.incomingInvites.size||this.ringToneView&&!this.ringToneView.paused&&d.stopAudio(c.RINGTONE_ELEMENT_ID)}return!0},this._ignore=n=>{var e;const t=m.getCurrentIncomingCall(n,this);return t?(this.loggerUtil.setSipCallID(null!==(e=t.sipCallID)&&void 0!==e?e:""),I.log.debug(`ignore - ${t.callUUID}`),t.session.removeAllListeners(),this.incomingInvites.delete(t.callUUID),this.incomingInvites.size||this.ringToneView&&!this.ringToneView.paused&&d.stopAudio(c.RINGTONE_ELEMENT_ID),m.handleIgnoreState(t),I.log.debug(`${c.LOGCAT.CALL} | On incoming call ignored`,t.getCallInfo("local","none","Ignored",k.LOCAL_ERROR_CODES.Ignored)),this.emit("onIncomingCallIgnored",t.getCallInfo("local","none","Ignored",k.LOCAL_ERROR_CODES.Ignored)),!0):(I.log.warn("No incoming calls to ignore"),this.shouldMuteCall=!1,!1)},this._sendDtmf=n=>{var e;if(!navigator.onLine)return I.log.warn(`${c.LOGCAT.CALL} | Unable to send DTMF: No internet connection`);const t=c.DTMF_TONE_FLAG;if("undefined"===typeof n||null==n)return I.log.warn(`${c.LOGCAT.CALL} | DTMF digit can not be null`);if("undefined"===typeof t[n])return I.log.warn(`${n} is not a valid DTMF digit`);if(!this._currentSession)return I.log.warn("No call session exists to send DTMF");I.log.debug(`sendDtmf - ${this._currentSession.callUUID}`);try{I.log.debug(`${c.LOGCAT.CALL} | DTMF send ${n}`);return"INBAND"!==d.getDTMFOption(this.options.dtmfOptions)&&(this._currentSession.session.sendDTMF(n),I.log.info("sent outband dtmf")),"*"===n?d.playAudio("dtmfstar",this):"#"===n?d.playAudio("dtmfpound",this):d.playAudio(`dtmf${n}`,this)}catch(n){return I.log.error(`${c.LOGCAT.CALL} | Call has not been confirmed cannot send DTMF`),I.AppError&&I.AppError.call(this,{name:n.name,message:n.message,method:"sendDtmf()"}),null===(e=I.sendEvents)||void 0===e?void 0:e.call(this,{msg:"ERROR_EVENT",name:n.name,info:n.message,method:"sendDtmf()"},this._currentSession)}},this._mute=()=>{var n,e;if(!this._currentSession)return I.log.warn(`${c.LOGCAT.CALL} | No call session exists to mute`),this.shouldMuteCall=!0,!1;I.log.debug(`${c.LOGCAT.CALL} | mute method is called`);try{this.isMuteCalled=!0,u.mute.call(this),this.isCallMuted=!0,this.callStats&&this.callStats.sendFabricEvent(this._currentSession.session.connection,this.callStats.fabricEvent.audioMute,this._currentSession.callUUID),p.onToggleMute.call(this,this._currentSession,"mute")}catch(t){I.log.error(`${c.LOGCAT.CALL} | error in mute :`,t.message),null===(n=I.AppError)||void 0===n||n.call(this,{name:t.name,message:t.message,method:"mute()"}),null===(e=I.sendEvents)||void 0===e||e.call(this,{msg:"ERROR_EVENT",name:t.name,info:t.message,method:"mute()"},this._currentSession)}return!0},this._unmute=()=>{var n,e;if(!this._currentSession)return I.log.warn(`${c.LOGCAT.CALL} | No call session exists to unmute`),!1;I.log.debug(`${c.LOGCAT.CALL} | unmute method is called`),this.shouldMuteCall=!1;try{this.isMuteCalled=!1,u.unmute.call(this),this.isCallMuted=!1,this.callStats&&this.callStats.sendFabricEvent(this._currentSession.session.connection,this.callStats.fabricEvent.audioUnmute,this._currentSession.callUUID),p.onToggleMute.call(this,this._currentSession,"unmute")}catch(t){I.log.error(`${c.LOGCAT.CALL} | error in unmute : `,t.message),null===(n=I.AppError)||void 0===n||n.call(this,{name:t.name,message:t.message,method:"unmute()"}),null===(e=I.sendEvents)||void 0===e||e.call(this,{msg:"ERROR_EVENT",name:t.name,info:t.message,method:"unmute()"},this._currentSession)}return!0},this._setRingTone=n=>(I.log.debug(`${c.LOGCAT.INIT}| setting ringtone`),!1===n||null===n?this.ringToneFlag=!1:"string"===typeof n?(this.ringToneFlag=!0,I.log.debug(`setRingTone() url : ${n}`),this.ringToneView&&(this.ringToneView.src=n)):this.ringToneFlag=!0,!0),this._setRingToneBack=n=>(I.log.debug(`${c.LOGCAT.INIT}| setting ringtoneback`),!1===n||null===n?this.ringToneBackFlag=!1:"string"===typeof n?(this.ringToneBackFlag=!0,I.log.debug(`setRingToneBack() url : ${n}`),this.ringBackToneView&&(this.ringBackToneView.src=n)):this.ringToneBackFlag=!0,!0),this._setConnectTone=n=>(I.log.debug(`${c.LOGCAT.INIT}| setting connect tone`),this.connectToneFlag=!!n,!0),this._setDtmfTone=(n,e)=>{I.log.debug(`${c.LOGCAT.CALL}| setting dtmf tone`);const t=c.DTMF_TONE_FLAG;if(!1===e||null===e)t[n]=!1;else if("string"===typeof e){I.log.debug("set dtmf tone"),t[n]="user";const r=`dtmf${n}`;document.getElementById(r).src=e}else t[n]=!0;return!0},this._getCallUUID=()=>this._currentSession?this._currentSession.callUUID:null,this._isRegistered=()=>this.isLoggedIn&&this.phone&&this.phone.isRegistered(),this._isConnecting=()=>this.phone&&this.phone._transport.isConnecting(),this._isConnected=()=>this.phone&&this.phone.isConnected(),this._startNoiseReduction=()=>new Promise((n=>{this.enableNoiseReduction?this.noiseSuppresion?"safari"===this.browserDetails.browser?(I.log.warn(`${c.LOGCAT.CALL_QUALITY} | Noise reduction feature is not supported in safari browser`),n(!1)):this.noiseSuppresion.startNoiseSuppresionManual().then((()=>{I.log.info(`${c.LOGCAT.CALL_QUALITY} | Noise Reduction started`),n(!0)})).catch((e=>{I.log.info(`${c.LOGCAT.CALL_QUALITY} | Noise Reduction start failed with error:- ${e.message}`),n(!1)})):(I.log.warn(`${c.LOGCAT.CALL_QUALITY} | Noise reduction cannot be started since noise reduction is not instantiated`),n(!1)):(I.log.warn(`${c.LOGCAT.CALL_QUALITY} | Noise reduction cannot be started since "enableNoiseReduction" is set to false`),n(!1))})),this._stopNoiseReduction=()=>new Promise((n=>{this.enableNoiseReduction?this.noiseSuppresion?"safari"===this.browserDetails.browser?(I.log.warn(`${c.LOGCAT.CALL_QUALITY} | Noise reduction feature is not supported in safari browser`),n(!1)):this.noiseSuppresion.stopNoiseSuppressionManual().then((()=>{I.log.info(`${c.LOGCAT.CALL_QUALITY} | Noise Reduction stopped`),n(!0)})).catch((e=>{I.log.info(`${c.LOGCAT.CALL_QUALITY} | Noise Reduction stop failed with error:- ${e.message}`),n(!1)})):(I.log.warn(`${c.LOGCAT.CALL_QUALITY} | Noise reduction cannot be stopped since noise reduction is not instantiated`),n(!1)):(I.log.warn(`${c.LOGCAT.CALL_QUALITY} | Noise reduction cannot be stopped since "enableNoiseReduction" is set to false`),n(!1))})),this._getLastCallUUID=()=>this._lastCallSession?this._lastCallSession.callUUID:null,this._getIncomingCalls=()=>{const n=[];return this.incomingInvites.forEach((e=>{n.push(e.getCallInfo())})),n},this._setDebug=n=>{n&&-1!==["INFO","DEBUG","WARN","ERROR","ALL","OFF"].indexOf(n)&&I.log.setLevel(n)},this._getPeerConnection=()=>this._currentSession&&this._currentSession.session&&this._currentSession.session.connection?{status:"success",pc:this._currentSession.session.connection}:{status:"called in wrong state",pc:null},this._submitCallQualityFeedback=(n,e,t,r,i)=>new Promise(((a,s)=>{y.validateFeedback(n,e,r,t,this.userName,this.isLoggedIn).then((e=>{let t;if(this.callStats&&this.callStats.sendUserFeedback(n,e,(n=>{I.log.debug(`Feedback stats sent status: ${n}`)})),this._currentSession&&this._currentSession.callUUID===n?t=this._currentSession:this._lastCallSession&&this._lastCallSession.callUUID===n&&(t=this._lastCallSession),t&&(I.log.send(this),this.statsSocket||(this.statsSocket=new v.StatsSocket,this.statsSocket.connect()),p.sendFeedbackEvent.call(this,t,e)),!0===i){let t;t=this.isAccessToken?{username:this.userName,accessToken:this.accessToken,calluuid:n}:{username:this.userName,password:this.password,domain:c.DOMAIN,calluuid:n},_.getPreSignedS3URL(t,this.isAccessToken).then((n=>{_.uploadConsoleLogsToBucket(n,e).then((()=>{a("Feedback is sent with console logs")})).catch((n=>{s(n)}))})).catch((n=>{I.log.error("Feedback was not able to send console logs"),s(n)}))}else a("Feedback is sent")})).catch((n=>{I.log.error(`${c.LOGCAT.CALL_QUALITY} | SubmitCallQualityFeedback failed:- ${n}`),s(n)}))})),E.setErrorCollector(),f.checkMediaDevices(),this.version="2.2.21";const e=h.default(n);I.log.enableSipLogs(e.debug);const t={codecs:e.codecs,enableTracking:e.enableTracking,enableQualityTracking:e.enableQualityTracking,debug:e.debug,enableIPV6:e.enableIPV6,dscp:e.dscp,appId:e.appId,appSecret:e.appSecret,registrationDomainSocket:e.registrationDomainSocket,clientRegion:e.clientRegion,disableRtpTimeOut:e.disableRtpTimeOut,allowMultipleIncomingCalls:e.allowMultipleIncomingCalls,closeProtection:e.closeProtection,maxAverageBitrate:e.maxAverageBitrate,useDefaultAudioDevice:e.useDefaultAudioDevice,enableNoiseReduction:e.enableNoiseReduction,usePlivoStunServer:e.usePlivoStunServer,dtmfOptions:e.dtmfOptions};I.log.info(`${c.LOGCAT.INIT} | Plivo SDK initialized successfully with options:- `,JSON.stringify(t),`in ${I.log.level()} mode`),o.EventEmitter.call(this),this.accessTokenInterface=T.default,this.deferFeedback=null,this.isUnregisterPending=null,this.browserDetails=C.default(),this.connectionInfo={state:"",reason:""},this.permOnClick=!1,this.ringToneFlag=!0,this.ringToneBackFlag=!0,this.connectToneFlag=!0,this.isLoggedIn=!1,this.reconnectInterval=null,this.noiseReductionFilePath=n.noiseReductionFilePath,this.reconnectTryCount=0,this.phone=null,this._currentSession=null,this.callSession=null,this.callUUID=null,this.callDirection=null,this.lastCallUUID=null,this._lastCallSession=null,this.incomingInvites=new Map,this.incomingCallsInitiationTime=new Map,this.lastIncomingCall=null,this.callStats=null,this.userName=null,this.password=null,this.options=e,this.callstatskey=null,this.rtp_enabled=!1,this.statsioused=!1,this.isCallMuted=!1,this.isLoginCalled=!1,this.isLogoutCalled=!1,this.networkChangeInterval=null,this.connectionRetryInterval=null,this.shouldMuteCall=!1,this.isOutgoingGrant=!1,this.isIncomingGrant=!1,this.useDefaultAudioDevice=!1,"firefox"!==C.default().browser&&(this.speechRecognition=new webkitSpeechRecognition),this.loggerUtil=new R.LoggerUtil(this),I.log.setLoggerUtil(this.loggerUtil),!0===this.options.usePlivoStunServer&&-1===c.STUN_SERVERS.indexOf(c.FALLBACK_STUN_SERVER)&&c.STUN_SERVERS.push(c.FALLBACK_STUN_SERVER),!1===this.options.usePlivoStunServer&&-1===c.STUN_SERVERS.indexOf(c.GOOG_STUN_SERVER)&&c.STUN_SERVERS.push(c.GOOG_STUN_SERVER),this.audio={availableDevices:u.availableDevices,ringtoneDevices:u.ringtoneDevices,microphoneDevices:u.inputDevices,speakerDevices:u.outputDevices,revealAudioDevices:u.revealAudioDevices},this.audioConstraints=this.options.audioConstraints,this.owaLastDetect={time:0,isOneWay:!0},this.owaDetectTime=36e5,this.statsSocket=null,this.timeTakenForStats={},this.networkDisconnectedTimestamp=null,this.networkReconnectionTimestamp=null,this.deviceToggledInCurrentSession=!1,this.networkChangeInCurrentSession=!1,this.didFetchInitialNetworkInfo=!1,this.enableNoiseReduction=this.options.enableNoiseReduction,u.setAudioContraints(this),d.setup(this,this.options),u.detectDeviceChange.call(this),this.audioDevDic=null,u.audioDevDicSetter((n=>{this.audioDevDic=n})),u.audioDevDictionary(!0),window._PlivoInstance=this,I.log.info(`${c.LOGCAT.INIT} | PlivoWebSdk initialized in ${I.log.level()} mode, version: 2.2.21 , browser: ${this.browserDetails.browser}-${this.browserDetails.version}`),this.jsFramework=S.default()}clearOnLogout(){this.isAccessToken&&(this.isAccessToken=!1,this.isOutgoingGrant=!1,this.isIncomingGrant=!1,this.accessToken=null),this.isAccessTokenGenerator&&null!=this.accessTokenGeneratorTimer&&(clearTimeout(this.accessTokenGeneratorTimer),this.accessTokenGeneratorTimer=null),this._currentSession&&!this._currentSession.session.isEnded()&&(this._currentSession.addConnectionStage(`logout()@${(new Date).getTime()}`),I.log.debug(`${c.LOGCAT.LOGOUT} | Terminating an active call, before logging out`),this._currentSession.session.terminate()),this.isLogoutCalled=!0,this.noiseSuppresion.clearNoiseSupression(),this.connectionInfo={state:w.ConnectionState.DISCONNECTED,reason:"Logout"},this.phone&&this.phone.isRegistered()&&(this.phone.stop(),this.phone=null),this.statsSocket&&(this.statsSocket.disconnect(),this.statsSocket=null),I.log.send(this)}}e.Client=A},function(n,e,t){"use strict";var r,i="object"===typeof Reflect?Reflect:null,a=i&&"function"===typeof i.apply?i.apply:function(n,e,t){return Function.prototype.apply.call(n,e,t)};r=i&&"function"===typeof i.ownKeys?i.ownKeys:Object.getOwnPropertySymbols?function(n){return Object.getOwnPropertyNames(n).concat(Object.getOwnPropertySymbols(n))}:function(n){return Object.getOwnPropertyNames(n)};var s=Number.isNaN||function(n){return n!==n};function o(){o.init.call(this)}n.exports=o,n.exports.once=function(n,e){return new Promise((function(t,r){function i(){void 0!==a&&n.removeListener("error",a),t([].slice.call(arguments))}var a;"error"!==e&&(a=function(t){n.removeListener(e,i),r(t)},n.once("error",a)),n.once(e,i)}))},o.EventEmitter=o,o.prototype._events=void 0,o.prototype._eventsCount=0,o.prototype._maxListeners=void 0;var c=10;function l(n){if("function"!==typeof n)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof n)}function u(n){return void 0===n._maxListeners?o.defaultMaxListeners:n._maxListeners}function d(n,e,t,r){var i,a,s,o;if(l(t),void 0===(a=n._events)?(a=n._events=Object.create(null),n._eventsCount=0):(void 0!==a.newListener&&(n.emit("newListener",e,t.listener?t.listener:t),a=n._events),s=a[e]),void 0===s)s=a[e]=t,++n._eventsCount;else if("function"===typeof s?s=a[e]=r?[t,s]:[s,t]:r?s.unshift(t):s.push(t),(i=u(n))>0&&s.length>i&&!s.warned){s.warned=!0;var c=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");c.name="MaxListenersExceededWarning",c.emitter=n,c.type=e,c.count=s.length,o=c,console&&console.warn&&console.warn(o)}return n}function h(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function p(n,e,t){var r={fired:!1,wrapFn:void 0,target:n,type:e,listener:t},i=h.bind(r);return i.listener=t,r.wrapFn=i,i}function f(n,e,t){var r=n._events;if(void 0===r)return[];var i=r[e];return void 0===i?[]:"function"===typeof i?t?[i.listener||i]:[i]:t?function(n){for(var e=new Array(n.length),t=0;t<e.length;++t)e[t]=n[t].listener||n[t];return e}(i):m(i,i.length)}function g(n){var e=this._events;if(void 0!==e){var t=e[n];if("function"===typeof t)return 1;if(void 0!==t)return t.length}return 0}function m(n,e){for(var t=new Array(e),r=0;r<e;++r)t[r]=n[r];return t}Object.defineProperty(o,"defaultMaxListeners",{enumerable:!0,get:function(){return c},set:function(n){if("number"!==typeof n||n<0||s(n))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+n+".");c=n}}),o.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},o.prototype.setMaxListeners=function(n){if("number"!==typeof n||n<0||s(n))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+n+".");return this._maxListeners=n,this},o.prototype.getMaxListeners=function(){return u(this)},o.prototype.emit=function(n){for(var e=[],t=1;t<arguments.length;t++)e.push(arguments[t]);var r="error"===n,i=this._events;if(void 0!==i)r=r&&void 0===i.error;else if(!r)return!1;if(r){var s;if(e.length>0&&(s=e[0]),s instanceof Error)throw s;var o=new Error("Unhandled error."+(s?" ("+s.message+")":""));throw o.context=s,o}var c=i[n];if(void 0===c)return!1;if("function"===typeof c)a(c,this,e);else{var l=c.length,u=m(c,l);for(t=0;t<l;++t)a(u[t],this,e)}return!0},o.prototype.addListener=function(n,e){return d(this,n,e,!1)},o.prototype.on=o.prototype.addListener,o.prototype.prependListener=function(n,e){return d(this,n,e,!0)},o.prototype.once=function(n,e){return l(e),this.on(n,p(this,n,e)),this},o.prototype.prependOnceListener=function(n,e){return l(e),this.prependListener(n,p(this,n,e)),this},o.prototype.removeListener=function(n,e){var t,r,i,a,s;if(l(e),void 0===(r=this._events))return this;if(void 0===(t=r[n]))return this;if(t===e||t.listener===e)0===--this._eventsCount?this._events=Object.create(null):(delete r[n],r.removeListener&&this.emit("removeListener",n,t.listener||e));else if("function"!==typeof t){for(i=-1,a=t.length-1;a>=0;a--)if(t[a]===e||t[a].listener===e){s=t[a].listener,i=a;break}if(i<0)return this;0===i?t.shift():function(n,e){for(;e+1<n.length;e++)n[e]=n[e+1];n.pop()}(t,i),1===t.length&&(r[n]=t[0]),void 0!==r.removeListener&&this.emit("removeListener",n,s||e)}return this},o.prototype.off=o.prototype.removeListener,o.prototype.removeAllListeners=function(n){var e,t,r;if(void 0===(t=this._events))return this;if(void 0===t.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==t[n]&&(0===--this._eventsCount?this._events=Object.create(null):delete t[n]),this;if(0===arguments.length){var i,a=Object.keys(t);for(r=0;r<a.length;++r)"removeListener"!==(i=a[r])&&this.removeAllListeners(i);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"===typeof(e=t[n]))this.removeListener(n,e);else if(void 0!==e)for(r=e.length-1;r>=0;r--)this.removeListener(n,e[r]);return this},o.prototype.listeners=function(n){return f(this,n,!0)},o.prototype.rawListeners=function(n){return f(this,n,!1)},o.listenerCount=function(n,e){return"function"===typeof n.listenerCount?n.listenerCount(e):g.call(n,e)},o.prototype.listenerCount=g,o.prototype.eventNames=function(){return this._eventsCount>0?r(this._events):[]}},function(n,e,t){"use strict";Object.defineProperty(e,"__esModule",{value:!0});class r{constructor(){this.TAG="PlivoLogStorage",this.getData=()=>{var n;return null!==(n=window.localStorage.getItem(this.TAG))&&void 0!==n?n:""},this.clear=()=>window.localStorage.removeItem(this.TAG)}static getInstance(){return this.instance||(this.instance=new r),this.instance}setData(n,e,t){const r=this.getData(),i=n+e+t,a=r?`${JSON.parse(r)}\n${i}`:i,s=JSON.stringify(a);window.localStorage.setItem(this.TAG,s)}}e.default=r,r.instance=null},function(n,e,t){"use strict";const{compareSemVer:r,isValidSemVer:i,parseSemVer:a,promises:s}=t(33);n.exports={compareSemVer:r,isValidSemVer:i,parseSemVer:a,promises:s}},function(n,e,t){"use strict";const{getType:r,isString:i}=t(34),a="(?:0|[1-9]\\d*)",s="\\d*[A-z-][A-z\\d-]*",o=`(?:${s}|${a})`,c=`(?:${s}|\\d+)`,l=`(${a}(?:\\.${a}){2})(?:-(${`${o}(?:\\.${o})*`}))?(?:\\+(${`${c}(?:\\.${c})*`}))?`,u=new RegExp(`^${a}$`),d=new RegExp(`^v?${l}$`),h=new RegExp(`^${l}$`),p=(n,e=!1)=>{if(!i(n))throw new TypeError(`Expected String but got ${r(n)}.`);return(e?h:d).test(n)},f=(n,e=!1)=>{if(!i(n))throw new TypeError(`Expected String but got ${r(n)}.`);if(!e&&!u.test(n))throw new Error(`${n} is not a stringified positive integer.`);if(u.test(n)&&(n=parseInt(n,10),!Number.isSafeInteger(n)))throw new RangeError(`${n} exceeds ${Number.MAX_SAFE_INTEGER}.`);return n},g=(n,e,t=!1)=>{if(!i(n))throw new TypeError(`Expected String but got ${r(n)}.`);if(!i(e))throw new TypeError(`Expected String but got ${r(e)}.`);if(!p(n,!!t))throw new Error(`${n} is not valid version string.`);if(!p(e,!!t))throw new Error(`${e} is not valid version string.`);let a;if(n===e)a=0;else{const r=t?h:d,[,s,o]=n.match(r),[,c,l]=e.match(r),[u,p,g]=s.split(".").map(f),[m,b,v]=c.split(".").map(f);if(u>m)a=1;else if(u<m)a=-1;else if(p>b)a=1;else if(p<b)a=-1;else if(g>v)a=1;else if(g<v)a=-1;else if(o===l)a=0;else if(!o&&l)a=1;else if(o&&!l)a=-1;else{const n=o.split(".").map((n=>f(n,!0))),e=l.split(".").map((n=>f(n,!0))),t=Math.max(n.length,e.length);let r=0;for(;r<t;){const t=n[r],s=e[r];if(t&&!s||i(t)&&Number.isInteger(s)?a=1:!t&&s||Number.isInteger(t)&&i(s)?a=-1:t!==s&&i(t)&&i(s)?a=t.localeCompare(s):Number.isInteger(t)&&Number.isInteger(s)&&(t>s?a=1:t<s&&(a=-1)),Number.isInteger(a))break;r++}}}return a},m=(n,e=!1)=>{if(!i(n))throw new TypeError(`Expected String but got ${r(n)}.`);const t=p(n,!!e);let a,s,o,c,l;if(t){const t=e?h:d,[,r,i,u]=n.match(t);[a,s,o]=r.split(".").map(f),i&&(c=i.split(".").map((n=>f(n,!0)))),u&&(l=u.split(".").map((n=>f(n,!0))))}return{version:n,matches:t,major:a,minor:s,patch:o,pre:c,build:l}};n.exports={compareSemVer:g,isValidSemVer:p,parseSemVer:m,parseVersionPart:f,promises:{compareSemVer:async(n,e,t=!1)=>await g(n,e,t),isValidSemVer:async(n,e=!1)=>await p(n,e),parseSemVer:async(n,e=!1)=>await m(n,e)}}},function(n,e,t){"use strict";const r=n=>Object.prototype.toString.call(n).slice(8,-1),i=n=>"string"===typeof n||n instanceof String;n.exports={escapeChar:(n,e)=>i(n)&&e&&e.global?n.replace(e,((n,e)=>`\\${e}`)):null,getType:r,isString:i,logErr:n=>(console.error(n),!1),logMsg:n=>(n&&console.log(n),n),logWarn:n=>(n&&console.warn(n),!1),parseStringifiedInt:(n,e=!1)=>{if(!i(n))throw new TypeError(`Expexted String but got ${r(n)}`);if(!e&&!/^-?(?:0|[1-9]\d*)$/.test(n))throw new Error(`${n} is not a stringified integer.`);return parseInt(n)},stringifyPositiveInt:(n,e=!1)=>Number.isSafeInteger(n)&&(e&&n>=0||n>0)?`${n}`:null,stripHtmlTags:n=>{for(;/^\n*<(?:[^>]+:)?[^>]+?>|<\/(?:[^>]+:)?[^>]+>\n*$/.test(n);)n=n.replace(/^\n*<(?:[^>]+:)?[^>]+?>/,"").replace(/<\/(?:[^>]+:)?[^>]+>\n*$/,"\n");return n.replace(/<\/(?:[^>]+:)?[^>]+>\n*<!--.*-->\n*<(?:[^>]+:)?[^>]+>/g,"\n\n").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').replace(/&amp;/g,"&")},throwErr:n=>{throw n}}},function(n,e,t){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=t(0);let i,a,s,o,c,l,u;const d=function(){o=window.requestAnimationFrame(d);const n=new Uint8Array(l.frequencyBinCount),e=new Uint8Array(u.frequencyBinCount);l.getByteFrequencyData(n),u.getByteFrequencyData(e);let t=0,r=0;for(let i=0;i<n.length;i+=1)t+=n[i],r+=e[i];const a={inputVolume:(t/n.length/255).toFixed(3),outputVolume:(r/e.length/255).toFixed(3)};i.emit("volume",a)},h=function(n,e,t){if(i=n,!e||!t)return;a?a.resume():a=new c,s?s.resume():s=new c;const r=a.createGain(),o=s.createGain();a.createMediaStreamSource(e).connect(r);s.createMediaStreamSource(t).connect(o),l=a.createAnalyser(),u=s.createAnalyser(),l.fftSize=128,u.fftSize=128,r.connect(l),o.connect(u),d()};e.default=()=>(c=window.AudioContext||window.webkitAudioContext||window.mozAudioContext,{start:h,stop(){r.Logger.info("stopping the requesting frame"),a&&a.suspend(),s&&s.suspend(),o&&window.cancelAnimationFrame(o)}})},function(n,e,t){"use strict";var r=this&&this.__createBinding||(Object.create?function(n,e,t,r){void 0===r&&(r=t),Object.defineProperty(n,r,{enumerable:!0,get:function(){return e[t]}})}:function(n,e,t,r){void 0===r&&(r=t),n[r]=e[t]}),i=this&&this.__setModuleDefault||(Object.create?function(n,e){Object.defineProperty(n,"default",{enumerable:!0,value:e})}:function(n,e){n.default=e}),a=this&&this.__importStar||function(n){if(n&&n.__esModule)return n;var e={};if(null!=n)for(var t in n)"default"!==t&&Object.prototype.hasOwnProperty.call(n,t)&&r(e,n,t);return i(e,n),e};Object.defineProperty(e,"__esModule",{value:!0});const s=a(t(1)),o={log:t(0).Logger},c={codecs:s.DEFAULT_CODECS,enableTracking:!0,enableQualityTracking:s.DEFAULT_ENABLE_QUALITY_TRACKING,debug:s.DEFAULT_LOG_LEVEL,permOnClick:!1,enableIPV6:!1,audioConstraints:s.AUDIO_CONSTRAINTS,dscp:!0,appId:null,appSecret:null,registrationDomainSocket:null,clientRegion:null,preDetectOwa:!1,disableRtpTimeOut:!1,allowMultipleIncomingCalls:!1,closeProtection:!1,useDefaultAudioDevice:!1,maxAverageBitrate:s.MAX_AVERAGE_BITRATE,dtmfOptions:s.DEFAULT_DTMFOPTIONS,enableNoiseReduction:!1,usePlivoStunServer:!1,registrationRefreshTimer:s.REGISTER_EXPIRES_SECONDS,noiseReductionFilePath:""},l=function(n,e){return"boolean"===typeof e||(o.log.error(`${n} has to be boolean. ${e} is not accepted`),!1)},u=function(n,e){return"number"===typeof e||(o.log.error(`${n} has to be number. ${e} is not accepted`),!1)};e.default=function(n){if("undefined"!==typeof n){Object.keys(n).forEach((e=>{switch(e){case"enableTracking":l(e,n[e])?c.enableTracking=n[e]:c.enableTracking=!0;break;case"enableQualityTracking":if(void 0!==n[e]){const t=n[e].toString().toUpperCase();-1!==s.ENABLE_QUALITY_TRACKING_ALLOWED_VALUES.indexOf(t)?c.enableQualityTracking=t:o.log.error(`The value set for ${e} is ${n[e]} which is not valid. Please choose one from following string values : [ ${s.ENABLE_QUALITY_TRACKING_ALLOWED_VALUES} ]`)}break;case"debug":n[e]=n[e].toUpperCase(),!function(n){const e=s.DEBUG_MODES;return-1!==e.indexOf(n)||(o.log.error(`debug method ${n} is not allowed`),o.log.debug("Allowed list for debug: ",e),!1)}(n[e])?o.log.setLevel("INFO"):(c.debug=n[e],"ALL-PLAIN"===n[e]&&(c[e]="ALL"),o.log.setLevel(n[e]));break;case"permOnClick":l(e,n[e])&&(this.permOnClick=n[e],c.permOnClick=n[e]);break;case"audioConstraints":n[e]&&"object"===typeof n[e]?c.audioConstraints=n[e]:c.audioConstraints=s.AUDIO_CONSTRAINTS;break;case"dscp":l(e,n[e])&&(c.dscp=n[e]);break;case"enableNoiseReduction":l(e,n[e])&&(c.enableNoiseReduction=n[e]);break;case"codecs":(function(n){const e=s.DEFAULT_CODECS;if(Array.isArray(n)){let t=!0;return n.forEach((n=>{-1===e.indexOf(n)&&(t=!1,o.log.warn("Ignoring invalid codec - ",n),o.log.debug("Allowed list: ",e))})),t}return o.log.error("Please send codecs in array format. Eg:",e),!1})(n[e])&&(c.codecs=n[e]);break;case"useDefaultAudioDevice":l(e,n[e])&&(c.useDefaultAudioDevice=n[e]);break;case"usePlivoStunServer":l(e,n[e])&&(c.usePlivoStunServer=n[e]);break;case"appSecret":c.appSecret=n[e];break;case"appId":c.appId=n[e];break;case"registrationRefreshTimer":u(e,n[e])&&(n[e]>=s.MIN_REGISTRATION_REFRESH_TIMER&&n[e]<=s.MAX_REGISTRATION_REFRESH_TIMER?c.registrationRefreshTimer=n[e]:o.log.error(`registrationRefreshTimer should be an integer in between ${s.MIN_REGISTRATION_REFRESH_TIMER} and ${s.MAX_REGISTRATION_REFRESH_TIMER}`));break;case"registrationDomainSocket":c.registrationDomainSocket=n[e];break;case"enableIPV6":break;case"clientRegion":(function(n){const e=s.REGION;return-1!==e.indexOf(n)||(o.log.error(`region name ${n} is not allowed`),o.log.debug("Allowed list for regions: ",e),!1)})(n[e])&&(c.clientRegion=n[e]);break;case"preDetectOwa":l(e,n[e])&&(c.preDetectOwa=!1);break;case"disableRtpTimeOut":l(e,n[e])&&(c.disableRtpTimeOut=n[e]);break;case"noiseReductionFilePath":"string"===typeof n[e]&&(c.noiseReductionFilePath=n[e]);break;case"allowMultipleIncomingCalls":l(e,n[e])&&(c.allowMultipleIncomingCalls=n[e]);break;case"closeProtection":l(e,n[e])&&(c.closeProtection=n[e]);break;case"maxAverageBitrate":u(e,n[e])&&(n[e]>=s.MIN_AVERAGE_BITRATE&&n[e]<=s.MAX_AVERAGE_BITRATE&&(t=n[e])===Math.round(t)?c.maxAverageBitrate=Math.floor(n[e]):o.log.error(`maxAverageBitrate should be an integer in between ${s.MIN_AVERAGE_BITRATE} and ${s.MAX_AVERAGE_BITRATE}`));break;case"dtmfOptions":n[e]&&"object"===typeof n[e]?c.dtmfOptions=function(n){let e;const t=[];if(!n||!("sendDtmfType"in n))return s.DEFAULT_DTMFOPTIONS;e=n.sendDtmfType;const r=s.DTMF_OPTIONS;return Array.isArray(e)?(e.forEach((n=>{-1===r.indexOf(n.toUpperCase())?(o.log.warn("Ignoring invalid dtmf option - ",n),o.log.debug("Allowed list of dtmf options : ",r)):t.push(n.toUpperCase())})),0===t.length?s.DEFAULT_DTMFOPTIONS:{sendDtmfType:t}):(o.log.error("Please send dtmfoption in following format. Eg: ",s.DEFAULT_DTMFOPTIONS),s.DEFAULT_DTMFOPTIONS)}(n[e]):c.dtmfOptions=s.DEFAULT_DTMFOPTIONS;break;default:o.log.warn(`Ignoring invalid option key ${e}`)}var t}))}return c}},function(n,e,t){"use strict";var r=this&&this.__createBinding||(Object.create?function(n,e,t,r){void 0===r&&(r=t),Object.defineProperty(n,r,{enumerable:!0,get:function(){return e[t]}})}:function(n,e,t,r){void 0===r&&(r=t),n[r]=e[t]}),i=this&&this.__setModuleDefault||(Object.create?function(n,e){Object.defineProperty(n,"default",{enumerable:!0,value:e})}:function(n,e){n.default=e}),a=this&&this.__importStar||function(n){if(n&&n.__esModule)return n;var e={};if(null!=n)for(var t in n)"default"!==t&&Object.prototype.hasOwnProperty.call(n,t)&&r(e,n,t);return i(e,n),e};Object.defineProperty(e,"__esModule",{value:!0});const s=a(t(11)),o=a(t(1)),c=t(0),l=a(t(10)),u=t(17),d=t(18),h=t(19),p=t(23),f=t(8),g=t(7),m=t(12),b=t(14),v=t(40),y={log:c.Logger};let _=0;e.default=class{constructor(n,e,t,r,i){this.validate=n=>this._validate(n),this.setupUserAccount=()=>this._setupUserAccount(),this.create=()=>this._create(),this.createListeners=()=>this._createListeners(),this._validate=n=>"undefined"===typeof this.credentials.userName||"undefined"===typeof this.credentials.password||null===this.credentials.userName||null===this.credentials.password&&(this.credentials.userName.length<=0||this.credentials.password.length<=0)?(y.log.error(`${o.LOGCAT.LOGIN} | username and password cannot be null.`),this.cs.emit("onLoginFailed","Username and password must be filled out"),!1):this.cs._currentSession?(y.log.warn(`${o.LOGCAT.LOGIN} | Cannot login when there is an ongoing call ${this.cs._currentSession.callUUID}`),this.cs.emit("onLoginFailed","Cannot login when there is an ongoing call"),!1):navigator.onLine?!this.cs.phone||(this.cs.loginCallback=n,y.log.debug(`${o.LOGCAT.LOGIN} | deleting the existing phone instance`),this.cs.phone.stop(),this.cs.connectionInfo={state:m.ConnectionState.DISCONNECTED,reason:"Relogin"},this.cs.loginCallback):(y.log.warn(`${o.LOGCAT.LOGIN} | Cannot login when there is no internet`),this.cs.emit("onLoginFailed","Cannot login when there is no internet"),!1),this.sendReInvite=()=>{y.log.debug(`${o.LOGCAT.LOGIN} | reInvite initiated`),this.cs._currentSession&&this.cs.phone&&(this.cs._currentSession.session.replaceUA(this.cs.phone),setTimeout((()=>{this.reinviteCounter+=1,this.cs._currentSession.session._sendReinvite({eventHandlers:{succeeded:()=>{},failed:()=>{}},rtcOfferConstraints:{iceRestart:!0}})}),0))},this.setupUAConfig=()=>{this.cs.plivoSocket=null;let n=o.WS_SERVERS;this.cs.options.registrationDomainSocket&&(n=this.cs.options.registrationDomainSocket,n="string"===typeof this.cs.options.registrationDomainSocket?this.cs.options.registrationDomainSocket.split(","):this.cs.options.registrationDomainSocket),_>=n.length&&(_=0),y.log.debug(`${o.LOGCAT.LOGIN} | Connecting WS with domain ${n[_]}`),this.cs.plivoSocket=new s.WebSocketInterface(n[_]);return{sockets:[this.cs.plivoSocket],register_expires:this.registerRefreshTimer,uri:`${this.credentials.userName}@${o.DOMAIN}`,password:this.credentials.password,token:this.accessTokenCredentials.accessToken,googIPv6:!1,connection_recovery_max_interval:o.WS_RECOVERY_MAX_INTERVAL,connection_recovery_min_interval:o.WS_RECOVERY_MIN_INTERVAL,session_timers:!1,user_agent:`${l.name} ${l.version}`}},this._setupUserAccount=()=>{this._create()&&(y.log.info("Ready to login"),y.log.debug(`${o.LOGCAT.CALL} | Establishing user accounts and configuring the callback listener`),this._createListeners(),this.cs.phone&&(null!=this.accessTokenCredentials.accessToken&&this.cs.phone.registrator().setExtraHeaders([`X-Plivo-Jwt: ${this.accessTokenCredentials.accessToken}`]),m.socketReconnectionRetry(this.cs),this.cs.phone.start()))},this._create=()=>{const n=this.setupUAConfig();try{return this.cs.phone=new s.UA(n),!0}catch(n){return y.log.debug(`${o.LOGCAT.LOGIN} | Failed to create user agent ${n.message}`),this.cs.emit("onLoginFailed","Failed to create user agent"),!1}},this.tiggerNetworkChangeEvent=()=>{this.fetchIpCount+=1,u.fetchIPAddress(this.cs).then((n=>{"string"===typeof n?m.sendNetworkChangeEvent(this.cs,n):this.fetchIpCount!==o.IP_ADDRESS_FETCH_RETRY_COUNT?setTimeout((()=>{this.tiggerNetworkChangeEvent()}),200*this.fetchIpCount):(y.log.warn(`${o.LOGCAT.NETWORK_CHANGE} | Could not retreive ipaddress`),this.fetchIpCount=0)}))},this._createListeners=()=>{this.cs.phone&&(this.cs.phone.on("connected",this._onConnected),this.cs.phone.on("disconnected",this._onDisconnected),this.cs.phone.on("registered",this._onRegistered),this.cs.phone.on("unregistered",this._onUnRegistered),this.cs.phone.on("registrationFailed",this._onRegistrationFailed),this.cs.phone.on("newTransaction",this._onNewTransaction),this.cs.phone.on("newRTCSession",this._onNewRTCSession))},this._onConnected=n=>{y.log.debug("websocket connection established",n),y.log.info(`${o.LOGCAT.WS} | websocket connection established`),this.cs.connectionRetryInterval&&(y.log.info(`${o.LOGCAT.LOGIN} | websocket connected. Clearing the connection check interval`),clearInterval(this.cs.connectionRetryInterval),this.cs.connectionRetryInterval=null),this.isPlivoSocketConnected||(this.isPlivoSocketConnected=!0,this.cs.didFetchInitialNetworkInfo||(u.fetchIPAddress(this.cs).then((n=>{this.cs.currentNetworkInfo={networkType:navigator.connection?navigator.connection.effectiveType:"unknown",ip:"string"===typeof n?n:""}})).catch((()=>{this.cs.currentNetworkInfo={networkType:navigator.connection?navigator.connection.effectiveType:"unknown",ip:""}})),this.cs.didFetchInitialNetworkInfo=!0))},this._onDisconnected=n=>{var e,t;if(y.log.info(`${o.LOGCAT.LOGOUT} | WebSocket Connection Closed - Code: ${null!==(e=n.code)&&void 0!==e?e:"Unknown code"}, Reason: ${null!==(t=n.reason)&&void 0!==t?t:"No reason provided"}, Socket URL: ${n.socket.url}`),n.code&&(this.cs.connectionInfo={state:m.ConnectionState.DISCONNECTED,reason:n.code.toString()}),this.isPlivoSocketConnected&&(this.isPlivoSocketConnected=!1),this.cs.loginCallback&&(y.log.debug(`${o.LOGCAT.LOGOUT} |  Previous connection disconnected successfully, starting a new one.`),this.cs.loginCallback(),this.cs.loginCallback=null),!n.ignoreReconnection){y.log.debug(`${o.LOGCAT.LOGIN} | starting new transport`),_+=1,m.socketReconnectionRetry(this.cs);const n=this.setupUAConfig();this.cs.phone.createNewUATransport(n),this.cs.phone.start(),this.sendReInvite()}},this._onRegistered=n=>{if(this.cs._currentSession&&this.cs.isCallMuted&&(y.log.info(`${o.LOGCAT.CALL} | Speech Recognition restarted after network disruption`),this.cs._currentSession.startSpeechRecognition(this.cs)),this.cs.loginCallback&&(this.cs.loginCallback=null),this.cs.connectionInfo={state:m.ConnectionState.CONNECTED,reason:"registered"},y.log.debug(`${o.LOGCAT.WS} |  websocket connected: ${this.cs.connectionInfo.reason}`),this.cs.emit("onConnectionChange",Object.assign({},this.cs.connectionInfo)),this.cs.isAccessToken&&n.response.headers["X-Plivo-Jwt"]){const e=n.response.headers["X-Plivo-Jwt"][0].raw.split(";")[0].split("=")[1];this.cs.setExpiryTimeInEpoch(1e3*e)}if(!this.cs.isLoggedIn&&!this.cs.isLoginCalled){if(y.log.info(`${o.LOGCAT.NETWORK_CHANGE} | Network changed happened. re-starting the OPTIONS interval`),clearInterval(this.cs.networkChangeInterval),this.cs.networkChangeInterval=null,m.startPingPong({client:this.cs,networkChangeInterval:this.cs._currentSession?o.NETWORK_CHANGE_INTERVAL_ON_CALL_STATE:o.NETWORK_CHANGE_INTERVAL_IDLE_STATE,messageCheckTimeout:o.MESSAGE_CHECK_TIMEOUT_ON_CALL_STATE}),!this.cs._currentSession)return u.fetchIPAddress(this.cs).then((n=>{const e=m.getNetworkData(this.cs,n);y.log.info(`${o.LOGCAT.NETWORK_CHANGE} | Network changed from ${JSON.stringify(e.previousNetworkInfo).slice(1,-1)}\n          to ${JSON.stringify(e.newNetworkInfo).slice(1,-1)} in idle state`),this.cs.currentNetworkInfo={networkType:e.newNetworkInfo.networkType,ip:"string"===typeof n?n:""}})),void(this.cs.isLoggedIn=!0);this.cs.statsSocket&&(this.cs.statsSocket.disconnect(),this.cs.statsSocket=null),this.cs.statsSocket=new b.StatsSocket,this.cs.statsSocket.connect(),this.cs.networkReconnectionTimestamp=(new Date).getTime(),this.tiggerNetworkChangeEvent()}if(this.cs.isLoginCalled||(this.cs.isLoggedIn=!0),this.cs.userName=this.credentials.userName,this.cs.password=this.credentials.password,!1===this.cs.isLoggedIn&&!0===this.cs.isLoginCalled){let n;this.cs.isLoggedIn=!0,this.cs.isLoginCalled=!1,this.cs.noiseSuppresion=new v.NoiseSuppression(this.cs),this.cs.emit("onLogin"),y.log.info(`${o.LOGCAT.LOGIN} | User logged in successfully`),m.startPingPong({client:this.cs,networkChangeInterval:o.NETWORK_CHANGE_INTERVAL_IDLE_STATE,messageCheckTimeout:o.MESSAGE_CHECK_TIMEOUT_ON_CALL_STATE}),this.cs.isAccessToken?n=this.cs.accessToken:(this.cs.isAccessToken=!1,n=this.cs.password),u.validateCallStats(this.cs.userName,n,this.cs.isAccessToken).then((n=>{this.cs.callstatskey=n.data,this.cs.rtp_enabled=n.is_rtp_enabled})).catch((()=>{this.cs.callstatskey=null})),d.initCallStatsIO.call(this.cs),y.log.send(this.cs)}},this._onUnRegistered=()=>{this.cs.isLoggedIn=!1,""!==this.cs.connectionInfo.state&&this.cs.connectionInfo.state!==m.ConnectionState.CONNECTED||(this.cs.connectionInfo={state:m.ConnectionState.DISCONNECTED,reason:"unregistered"}),y.log.debug(`${o.LOGCAT.WS} |  websocket disconnected with reason : ${this.cs.connectionInfo.reason}`),this.cs.emit("onConnectionChange",Object.assign({},this.cs.connectionInfo)),this.cs.isLogoutCalled&&(y.log.debug(`${o.LOGCAT.LOGOUT} |  Plivo client unregistered`),this.cs.ringToneView&&!this.cs.ringToneView.paused&&g.stopAudio(o.RINGTONE_ELEMENT_ID),this.cs.ringBackToneView&&!this.cs.ringBackToneView.paused&&g.stopAudio(o.RINGBACK_ELEMENT_ID),this.cs.networkDisconnectedTimestamp=(new Date).getTime(),this.cs.userName=null,this.cs.password=null,this.cs.emit("onLogout"),y.log.info(o.LOGCAT.LOGOUT," | Logout successful!"),this.cs.networkChangeInterval&&(clearInterval(this.cs.networkChangeInterval),this.cs.networkChangeInterval=null),this.cs.clearOnLogout(),this.message=null,this.cs.isLogoutCalled=!1,y.log.send(this.cs))},this._onRegistrationFailed=n=>{var e,t,r;if(this.cs.connectionInfo.state===m.ConnectionState.DISCONNECTED&&this.cs.isLoggedIn)return void y.log.debug(`${o.LOGCAT.LOGIN} | Registration failed when state: ${this.cs.connectionInfo.state} and login: ${this.cs.isLoggedIn} with error: `,n.cause,n.response);this.cs.isLoggedIn=!1,this.cs.userName=null,this.cs.password=null;const i=(null===(e=null===n||void 0===n?void 0:n.response)||void 0===e?void 0:e.headers["X-Plivo-Jwt-Error-Code"])?parseInt(null===(r=null===(t=null===n||void 0===n?void 0:n.response)||void 0===t?void 0:t.headers["X-Plivo-Jwt-Error-Code"][0])||void 0===r?void 0:r.raw,10):401;if(n.cause&&401===i)y.log.info(`${o.LOGCAT.LOGIN} | Login failed with error: `,n.cause,n.response),this.cs.emit("onLoginFailed",n.cause);else{clearInterval(this.cs.networkChangeInterval),this.cs.networkChangeInterval=null;const n=this.cs.isAccessTokenGenerator?"RELOGIN_FAILED_INVALID_TOKEN":this.cs.getErrorStringByErrorCodes(i);y.log.info(`${o.LOGCAT.LOGIN} | Login failed with error: ${n}`),this.cs.emit("onLoginFailed",n)}},this._onNewTransaction=n=>{var e;if("ist"===n.transaction.type){const t=null!==(e=n.transaction.request.getHeader("Call-ID"))&&void 0!==e?e:"";y.log.info(`${o.LOGCAT.LOGIN} | new Transaction created, incoming call received callUUID: ${t}`),this.cs.loggerUtil.setSipCallID(t),y.log.info("<----- INCOMING -----\x3e");const r=n.transaction.request.getHeader("X-Calluuid")||null;this.cs.incomingCallsInitiationTime.set(r,f.getCurrentTime()),y.log.debug("call initiation time, invite received from server")}},this._onNewRTCSession=n=>{if("local"===n.originator){const e=n.request.call_id;this.cs.loggerUtil.setSipCallID(e)}y.log.debug(`${o.LOGCAT.CALL} | new rtc session created, originator:${n.originator}`),d.createStatsSocket.call(this.cs),this._validateRTCSession(n)&&("remote"===n.originator?(f.addMidAttribute.call(this.cs,n),h.createIncomingSession(this.cs,n)):p.createOutgoingSession(n),this.cs.timeTakenForStats.mediaSetup={},this.cs.timeTakenForStats.mediaSetup.init=(new Date).getTime())},this._validateRTCSession=n=>{var e,t;if(this.cs._currentSession&&this.cs._currentSession.session.connection&&"closed"===this.cs._currentSession.session.connection.signalingState&&(y.log.warn(`${o.LOGCAT.CALL} | Previous call did not end properly`),this.cs._currentSession=null,this.cs.callSession=null,this.cs.callUUID=null,this.cs.callDirection=null),this.cs.incomingInvites.size&&(y.log.debug(`${o.LOGCAT.CALL} | Remove the incoming call from map if it is failed but not removed properly, invite-size: ${null!==(t=null===(e=this.cs.incomingInvites)||void 0===e?void 0:e.size)&&void 0!==t?t:"none"}`),this.cs.incomingInvites.forEach((n=>{n.session.isEnded()&&this.cs.incomingInvites.delete(n.callUUID)}))),(this.cs._currentSession||this.cs.incomingInvites.size)&&!this.cs.options.allowMultipleIncomingCalls||this.cs.incomingInvites.size>=o.NUMBER_OF_SIMULTANEOUS_INCOMING_CALLS_ALLOWED){y.log.debug(`${o.LOGCAT.CALL} | Already on call, Sending busy call due to existing call, invite-size: ${this.cs.incomingInvites.size} }`),this.cs.loggerUtil.setSipCallID("");const e={status_code:486,reason_phrase:"Busy Here"};return n.session.terminate(e),!1}return!0},this.cs=n,this.credentials={userName:e,password:t},this.accessTokenCredentials={accessToken:r},this.message=null,this.registerRefreshTimer=i,this.reinviteCounter=0,this.isPlivoSocketConnected=!1,this.fetchIpCount=0}}},function(n,e,t){"use strict";var r=this&&this.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(e,"__esModule",{value:!0}),e.owaNotification=e.owaCallback=e.detectOWA=e.getWebRTCStats=void 0;const i=t(4),a=t(0),s=t(1),o=r(t(2)),c={log:a.Logger};let l,u,d,h;const p=function(n){h&&h(null,n)},f=function(n,e){c.log.debug(`${s.LOGCAT.CALL} creating remote offer`),n.setRemoteDescription(e).then((()=>{"offer"===e.type&&n.createAnswer().then((e=>{c.log.info(`${s.LOGCAT.CALL} | SDP Answer created: ${e}`),n.setLocalDescription(e).then((()=>{})).catch(p),f(u,e)})).catch(p)})).catch(p)},g=function(n,e){e.candidate&&n.addIceCandidate(e.candidate).then().catch(p)},m=function(){c.log.debug(`${s.LOGCAT.CALL} stopping local stream after detecting one way audio`),l&&l.getTracks().forEach((n=>{n.stop(),l&&l.removeTrack(n),l=null})),"stable"===u.signalingState&&u.close(),"stable"===d.signalingState&&d.close()};e.getWebRTCStats=function(n){return new Promise(((e,t)=>{const r=n.getSenders(),i={bytesSent:null,audioInputLevel:null};r?r[0].getStats(n.getLocalStreams()[0].getAudioTracks()[0]).then((n=>{Array.from(n.values()).forEach((n=>{"outbound-rtp"===n.type&&(i.bytesSent=n.bytesSent),"media-source"===n.type&&(i.audioInputLevel=n.audioLevel),i.bytesSent&&i.audioInputLevel&&e(i)})),null===i.bytesSent&&null===i.audioInputLevel&&h(null,"stats not collectd")})).catch((n=>{t(n)})):t(i)}))};const b=function(){c.log.debug(`Precheck ice state : ${u.iceConnectionState}`);let n=0;!function t(){u.getLocalStreams()[0]&&e.getWebRTCStats(u).then((e=>{e.bytesSent&&e.audioInputLevel?Number(e.audioInputLevel)<=0&&2!==n?(n+=1,setTimeout(t,1e3),c.log.debug(`Precheck re-attempt: ${n}`)):(h&&h(e,null),setTimeout(m,3e3)):h(null,"error gathering stats")})).catch((n=>{p(n)}))}()};e.detectOWA=n=>{h=n,u=new RTCPeerConnection(null),d=new RTCPeerConnection(null),navigator.mediaDevices.getUserMedia({audio:!0,video:!1}).then((n=>{var e;l=n,e=u,c.log.debug(`${s.LOGCAT.CALL} creating local offer`),e.addStream(l),e.createOffer().then((n=>{c.log.info(`${s.LOGCAT.CALL} | SDP Offer created:- ${n}`),e.setLocalDescription(n).then((()=>{f(d,n)})).catch(p)})).catch(p)})).catch(p),u.onicecandidate=n=>{g(d,n)},d.onicecandidate=n=>{g(u,n)},setTimeout(b,500)};e.owaCallback=function(n,e,t,r){const a=this;return a&&a.owaLastDetect&&(a.owaLastDetect.time=new Date),e?(c.log.error(`${s.LOGCAT.CALL} | Error in detecting microphone status `,e.message),a&&a.emit&&a.emit("onMediaPermission",{status:"failure",error:e.name}),t(`media - ${e.name}`),!1):(c.log.debug(`${s.LOGCAT.LOGIN} getUserMedia precheck `,n),0===Number(n.bytesSent)&&0===Number(n.audioInputLevel)?(c.log.error(`${s.LOGCAT.CALL} | chrome lost access to microphone - restart browser`,e.message),i.emitMetrics.call(this,"audio","warning","no_microphone_access",0,!0,"chrome lost access to microphone - restart browser","None"),a&&a.owaLastDetect&&(a.owaLastDetect.isOneWay=!0),t("no_microphone_access"),!1):(0===Number(n.audioInputLevel)&&(c.log.error(`${s.LOGCAT.CALL} | microphone is muted`,e.message),i.emitMetrics.call(this,"audio","warning","no_microphone_access",0,!0,"microphone is muted","None")),r(),!0))};e.owaNotification=n=>{n&&"closed"!==n.signalingState&&"chrome"===o.default().browser&&e.getWebRTCStats(n).then((n=>{n.bytesSent&&c.log.debug(`${s.LOGCAT.CALL} | Bytes sent by WebSDK client: ${n.bytesSent} audioInputLevel: ${n.audioInputLevel}`),0===n.bytesSent&&0===n.audioInputLevel&&(c.log.debug(`${s.LOGCAT.CALL} | One way audio detected`),i.emitMetrics.call(this,"audio","warning","no_microphone_access",0,!0,"no access to your microphone","None"))})).catch((n=>{c.log.debug(`${s.LOGCAT.CALL} | Error while gathering webrtc stats ${n}`)}))}},function(n,e,t){"use strict";var r=this&&this.__createBinding||(Object.create?function(n,e,t,r){void 0===r&&(r=t),Object.defineProperty(n,r,{enumerable:!0,get:function(){return e[t]}})}:function(n,e,t,r){void 0===r&&(r=t),n[r]=e[t]}),i=this&&this.__setModuleDefault||(Object.create?function(n,e){Object.defineProperty(n,"default",{enumerable:!0,value:e})}:function(n,e){n.default=e}),a=this&&this.__importStar||function(n){if(n&&n.__esModule)return n;var e={};if(null!=n)for(var t in n)"default"!==t&&Object.prototype.hasOwnProperty.call(n,t)&&r(e,n,t);return i(e,n),e},s=this&&this.__awaiter||function(n,e,t,r){return new(t||(t=Promise))((function(i,a){function s(n){try{c(r.next(n))}catch(n){a(n)}}function o(n){try{c(r.throw(n))}catch(n){a(n)}}function c(n){var e;n.done?i(n.value):(e=n.value,e instanceof t?e:new t((function(n){n(e)}))).then(s,o)}c((r=r.apply(n,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.GetRTPStats=e.handleWebRTCStats=void 0;const o=a(t(1)),c=t(16),l=t(4),u={log:t(0).Logger},d=function(n,e){return null!=n&&!isNaN(n)||null!=e&&!isNaN(e)?null==n||isNaN(n)?e:null==e||isNaN(e)?n:n+e:null},h=function(){const n=this;n.audioTimer=setInterval((()=>{n.senderMediaStream&&!1===n.senderMediaStream.active&&(n.senderMediaStream.getTracks().forEach((n=>n.stop())),n.senderMediaStream=null,navigator.mediaDevices.getUserMedia&&navigator.mediaDevices.getUserMedia({audio:!0,video:!1}).then((n=>n)).then((e=>{n.senderMediaStream=e,n.localAudioLevelHelper=new c.AudioLevel(n.senderMediaStream)})).catch((n=>{this.clientScope.emit("onMediaPermission",{status:"failure",error:n.message})}))),n.clientScope.isCallMuted||(n.audioInputLevel=d(n.audioInputLevel,n.localAudioLevelHelper.getAudioLevel()),n.audioInputCount+=1),n.audioOutputLevel=d(n.audioOutputLevel,n.remoteAudioLevelHelper.getAudioLevel()),n.audioOutputCount+=1}),o.AUDIO_INTERVAL)},p=function(){const n=this;n.audioInputLevel=null,n.audioOutputLevel=null,n.audioInputCount=0,n.audioOutputCount=0},f=function(n,e="int",t=n,r=!1){let i;return null==n||isNaN(n)?(i=r?t:n,i):(i=Number("int"===e?n:Number(n).toFixed(3)),i)},g=function(n){return null==n||isNaN(n)?null:n};function m(n){this.packets.prePacketsReceived=f(g(n.remote.packetsReceived)),this.packets.prePacketsSent=f(g(n.local.packetsSent)),this.packets.preRemotePacketsLoss=f(g(n.remote.packetsLost)),this.packets.preLocalPacketsLoss=f(g(n.local.packetsLost))}const b=function(n,e,t,r,i){const a=this;let s=0,o=0;const c="opus"===a.storage.audioCodec?95:93.2;let l;s=t+2*r+10,o=s<160?c-s/40:c-(s-120)/10,o-=100*i*2.5,o<=0?l=1:o<100?(l=1+.035*o+7e-6*o*(o-60)*(100-o),l=parseFloat(l.toFixed(3))):l=4.5,n.push(l),u.log.debug(`mos ${e}`,l),"mosLocalMeasures"===e&&(a.collected.local.mos=Number(l)||0),"mosRemoteMeasures"===e&&(a.collected.local.mos=Math.min(Number(l)||0,a.collected.local.mos))},v=function(n,e,t,r){const i=this,a=i.storage[n];if(null!=g(t)&&null!=g(r)&&0!==Number(e||0)){if("firefox"===i.clientScope.browserDetails.browser&&(e=1e3*Number(e),t=1e3*Number(t)),2===a.length){b.call(i,a,n,e,t,r);a.filter((n=>n<3)).length>=2?i.storage.warning[n]=!0:i.storage.warning[n]&&(i.storage.warning[n]=!1)}else b.call(i,a,n,e,t,r);3===a.length&&a.splice(0,2)}else i.collected.local.mos=null},y=function(n){const e=this;if(!e.baseStatsCollected){const t=f(n.local.packetsLost),r=f(n.remote.packetsLost),i=f(n.local.packetsSent),a=f(n.remote.packetsReceived)+r;return e.collected.local.fractionLoss=0===t&&0===i?0:0===i?1:f(t/i,"float"),e.collected.remote.fractionLoss=0===r&&0===a?0:0===a?1:f(r/a,"float"),m.call(e,n),void(e.baseStatsCollected=!0)}const t=f(n.local.packetsLost)-e.packets.preLocalPacketsLoss,r=f(n.local.packetsSent)-e.packets.prePacketsSent;e.collected.local.fractionLoss=0===t&&0===r?0:0===r?1:f(t/r,"float");const i=f(n.remote.packetsLost)-e.packets.preRemotePacketsLoss,a=f(n.remote.packetsReceived)-e.packets.prePacketsReceived+i;e.collected.remote.fractionLoss=0===i&&0===a?0:0===a?1:f(i/a,"float"),v.call(e,"mosLocalMeasures",e.collected.local.rtt,e.collected.local.jitter,e.collected.local.fractionLoss),v.call(e,"mosRemoteMeasures",e.collected.local.rtt,e.collected.remote.jitter,e.collected.remote.fractionLoss),m.call(e,n)},_=function(n){const e=this;e.statsSocket&&e.callstatskey&&e._currentSession&&e.rtp_enabled&&(this.options.enableQualityTracking===o.DEFAULT_ENABLE_QUALITY_TRACKING&&this.options.enableTracking||this.options.enableQualityTracking===o.REMOTEONLY)&&(e.statsSocket.send(n,e),window._PlivoDevLogging&&u.log.info(n)),e._currentSession&&e._currentSession.session&&"chrome"===e.browserDetails.browser&&(this.options.enableQualityTracking===o.DEFAULT_ENABLE_QUALITY_TRACKING&&this.options.enableTracking||this.options.enableQualityTracking===o.LOCALONLY)&&l.processStreams.call(e,n,e._currentSession.session.isMuted().audio)},C=function(n){const e=this;e.statsSocket&&e.callstatskey&&e.rtp_enabled&&(u.log.debug(`${o.LOGCAT.CALL} | Sending CALL_STATS_DUMP Event`),e.statsSocket.send(n,e))},S=function(n){const e=this;var t;e.collected={msg:"CALL_STATS",callstats_key:e.callstatskey,local:{},remote:{},codec:n.codec,xcallUUID:e.xcallUUID,callUUID:e.callUUID,corelationId:e.corelationId,userName:e.userName,timeStamp:Date.now(),domain:o.DOMAIN,source:o.STATS_SOURCE,version:o.STATS_VERSION,networkType:n.networkType||"unknown",networkEffectiveType:navigator.connection?navigator.connection.effectiveType:"unknown",networkDownlinkSpeed:navigator.connection?navigator.connection.downlink:-1,statsIOUsed:e.statsioused,pdd:e.clientScope.timeTakenForStats.pdd?e.clientScope.timeTakenForStats.pdd.end-e.clientScope.timeTakenForStats.pdd.init:0,mediaSetupTime:(t=e.clientScope,t.timeTakenForStats.mediaSetup?t.timeTakenForStats.mediaSetup.end-t.timeTakenForStats.mediaSetup.init:0)},e.collected.local.audioLevel=f(n.local.audioInputLevel,"int",Number(-100),!0),e.collected.remote.audioLevel=f(n.remote.audioOutputLevel,"int",Number(-100),!0),e.collected.remote.jitterBufferDelay=f(n.remote.jitterBufferDelay,"int",null,!0),e.collected.local.googEchoCancellationReturnLoss=f(n.local.googEchoCancellationReturnLoss,"int",null,!0),e.collected.local.googEchoCancellationReturnLossEnhancement=f(n.local.googEchoCancellationReturnLossEnhancement,"int",null,!0),e.collected.remote.googJitterBufferMs=f(n.remote.googJitterBufferMs,"int",null,!0),e.collected.remote.packetsDiscarded=f(n.remote.packetsDiscarded,"int",null,!0),"chrome"===e.clientScope.browserDetails.browser||"edge"===this.clientScope.browserDetails.browser?(e.collected.local.rtt=f(n.local.googRtt,"float"),e.collected.local.jitter=f(n.local.jitter,"float"),e.collected.remote.jitter=f(n.remote.jitter,"float")):"firefox"!==e.clientScope.browserDetails.browser&&"safari"!==e.clientScope.browserDetails.browser||(e.collected.local.rtt=f(n.local.rtt,"float"),e.collected.local.jitter=f(n.local.jitter,"float"),e.collected.remote.jitter=f(n.remote.jitter,"float")),e.collected.remote.packetsReceived=f(n.remote.packetsReceived),e.collected.local.packetsSent=f(n.local.packetsSent),e.collected.remote.bytesReceived=f(n.remote.bytesReceived),e.collected.local.bytesSent=f(n.local.bytesSent),e.collected.remote.packetsLost=f(n.remote.packetsLost),e.collected.local.packetsLost=f(n.local.packetsLost),e.collected.remote.ssrc=f(n.remote.ssrc),e.collected.local.ssrc=f(n.local.ssrc),y.call(e,n),_.call(e.clientScope,e.collected)},T=function(){try{return this.pc.remoteDescription.sdp.match(/rtpmap:.*/)[0].split(" ")[1].split("/")[0]}catch(n){return u.log.debug("Error fetching codec from remote description message",n),""}};e.handleWebRTCStats=function(n){n.codec=T.call(this);const e=this.pc.getSenders();e&&(this.rtpsender=e[0].getStats(),this.rtpsender.then((e=>{Array.from(e.values()).forEach((e=>{if("outbound-rtp"===e.type&&(n.local.rtt=null==e.rtt||isNaN(e.rtt)?n.local.rtt:e.rtt,n.local.jitter=null==e.jitter||isNaN(e.jitter)?n.local.jitter:e.jitter,n.local.packetsSent=null==e.packetsSent||isNaN(e.packetsSent)?n.local.packetsSent:e.packetsSent,n.local.packetsLost=null==e.packetsLost||isNaN(e.packetsLost)?n.local.packetsLost:e.packetsLost,n.local.bytesSent=null==e.bytesSent||isNaN(e.bytesSent)?n.local.bytesSent:e.bytesSent,n.local.ssrc=null==e.ssrc||isNaN(e.ssrc)?n.local.ssrc:e.ssrc),"remote-inbound-rtp"===e.type){const t=e;n.local.googRtt=null==t.roundTripTime||isNaN(t.roundTripTime)?n.local.googRtt:Math.round(1e3*t.roundTripTime),n.local.rtt=null==t.roundTripTime||isNaN(t.roundTripTime)?n.local.rtt:t.roundTripTime,n.local.jitter=null==t.jitter||isNaN(t.jitter)?n.local.jitter:t.jitter,n.local.packetsLost=null==t.packetsLost||isNaN(t.packetsLost)?n.local.packetsLost:t.packetsLost}if("candidate-pair"!==e.type||null!=n.local.rtt&&!isNaN(n.local.rtt)||(n.local.rtt=e.currentRoundTripTime),"local-candidate"===e.type){n.networkType=e.networkType;const i={id:e.id,address:e.address,port:e.port,relatedAddress:e.relatedAddress,relatedPort:e.relatedPort};if(this.localCandidateInfo){if(0===Object.keys(this.localCandidateInfo).length)this.localCandidateInfo[e.timestamp]=i;else try{(t=this.localCandidateInfo,r=e.id,new Promise((n=>{let e=!1;Object.keys(t).forEach((n=>{t[n].id===r&&(e=!0)})),n(e)}))).then((n=>{!1===n&&(u.log.debug(`${o.LOGCAT.CALL} | Local Candidate Info Change`),this.localCandidateInfo[e.timestamp]=i)}))}catch(n){u.log.debug(`${o.LOGCAT.CALL} | Error in getStats LocalStreams API during Local Candidate Info Check `,n.message)}}}var t,r;"media-source"===e.type&&"chrome"===this.clientScope.browserDetails.browser&&(n.local.googEchoCancellationReturnLoss=Math.floor(e.echoReturnLoss),n.local.googEchoCancellationReturnLossEnhancement=Math.floor(e.echoReturnLossEnhancement))})),this.rtpreceiver=this.pc.getReceivers()[0].getStats();let t=0;this.pc.getReceivers()[0].getStats().then((e=>{Array.from(e.values()).forEach((e=>{"media-playout"===e.type&&(t=e.totalPlayoutDelay),"inbound-rtp"===e.type&&(n.remote=e,n.local.audioInputLevel=this.audioInputLevel/this.audioInputCount,n.remote.audioOutputLevel=this.audioOutputLevel/this.audioOutputCount,n.remote.jitterBufferDelay=Math.floor((e.jitterBufferDelay+t)/1e4),n.remote.googJitterBufferMs=Math.floor(e.jitterBufferDelay/e.jitterBufferEmittedCount*1e3),p.call(this),"safari"===this.clientScope.browserDetails.browser&&(n=function(n){return n.local.rtt=null==n.local.rtt?null:1e3*Number(n.local.rtt),n.local.jitter=null==n.local.jitter?null:1e3*Number(n.local.jitter),n.remote.jitter=null==n.remote.jitter?null:1e3*Number(n.remote.jitter),n}(n)),"chrome"!==this.clientScope.browserDetails.browser&&"edge"!==this.clientScope.browserDetails.browser||(n.remote.jitter=null==e.jitter?null:Math.floor(1e3*e.jitter),n.local.jitter=null==n.local.jitter?null:Math.floor(1e3*n.local.jitter)),S.call(this,n))}))})).catch((n=>{u.log.debug(`${o.LOGCAT.CALL} | Error in getStats RemoteStreams API `,n.message)}))})).catch((n=>{u.log.debug(`${o.LOGCAT.CALL} | Error in getStats LocalStreams API `,n.message)})))};const E=function(){const n=this;n.statsTimer=setInterval((()=>{const t={codec:"",local:{},remote:{},networkType:""};"chrome"===n.clientScope.browserDetails.browser||"edge"===n.clientScope.browserDetails.browser||"firefox"===n.clientScope.browserDetails.browser||"safari"===n.clientScope.browserDetails.browser?e.handleWebRTCStats.call(n,t):u.log.error(`${o.LOGCAT.LOGIN} | Plivo Browser SDK is not supported in ${n.clientScope.browserDetails.browser}`)}),o.GETSTATS_INTERVAL)};e.GetRTPStats=class{constructor(n){if(this.localCandidateInfo={},this.sendCallStatsDump=function(n){return new Promise(((e,t)=>{const r=this.rtpsender;r&&r.then((e=>{Array.from(e.values()).forEach((e=>{"local-candidate"===e.type&&(n.localCandidate.id=e.id,n.localCandidate.address=e.address,n.localCandidate.port=e.port,n.localCandidate.relatedAddress=e.relatedAddress,n.localCandidate.relatedPort=e.relatedPort,n.localCandidate.candidateType=e.candidateType,n.localCandidate.usernameFragment=e.usernameFragment),"remote-candidate"===e.type&&(n.remoteCandidate.id=e.id,n.remoteCandidate.address=e.address,n.remoteCandidate.port=e.port,n.remoteCandidate.candidateType=e.candidateType,n.remoteCandidate.usernameFragment=e.usernameFragment),"transport"===e.type&&(n.transport.id=e.id,n.transport.dtlsRole=e.dtlsRole,n.transport.dtlsState=e.dtlsState,n.transport.iceRole=e.iceRole,n.transport.iceState=e.iceState,n.transport.packetsReceived=e.packetsReceived,n.transport.packetsSent=e.packetsSent,n.transport.selectedCandidatePairChanges=e.selectedCandidatePairChanges,n.transport.selectedCandidatePairId=e.selectedCandidatePairId),"candidate-pair"===e.type&&(n.candidatePair.id=e.id,n.candidatePair.availableOutgoingBitrate=e.availableOutgoingBitrate,n.candidatePair.consentRequestsSent=e.consentRequestsSent,n.candidatePair.lastPacketReceivedTimestamp=e.lastPacketReceivedTimestamp,n.candidatePair.lastPacketSentTimestamp=e.lastPacketSentTimestamp,n.candidatePair.localCandidateId=e.localCandidateId,n.candidatePair.remoteCandidateId=e.remoteCandidateId,n.candidatePair.nominated=e.nominated,n.candidatePair.packetsDiscardedOnSend=e.packetsDiscardedOnSend,n.candidatePair.packetsReceived=e.packetsReceived,n.candidatePair.packetsSent=e.packetsSent,n.candidatePair.requestsReceived=e.requestsReceived,n.candidatePair.requestsSent=e.requestsSent,n.candidatePair.responsesReceived=e.responsesReceived,n.candidatePair.responsesSent=e.responsesSent,n.candidatePair.state=e.state,n.candidatePair.transportId=e.transportId,n.candidatePair.writable=e.writable),"outbound-rtp"===e.type&&(n.outboundRTP.bytesSent=e.bytesSent,n.outboundRTP.packetsSent=e.packetsSent,n.outboundRTP.retransmittedBytesSent=e.retransmittedBytesSent,n.outboundRTP.retransmittedPacketsSent=e.retransmittedBytesSent,n.outboundRTP.transportId=e.transportId),"remote-inbound-rtp"===e.type&&(n.remoteInboundRTP.fractionLost=e.fractionLost,n.remoteInboundRTP.packetsLost=e.packetsLost,n.remoteInboundRTP.roundTripTime=e.roundTripTime,n.remoteInboundRTP.roundTripTimeMeasurements=e.roundTripTimeMeasurements,n.remoteInboundRTP.totalRoundTripTime=e.totalRoundTripTime,n.remoteInboundRTP.transportId=e.transportId)})),n.changedCandidatedInfo=this.localCandidateInfo})).catch((n=>{u.log.debug(`${o.LOGCAT.CALL} | Error during CALL_STATS_DUMP event creation `,n.message)}));const i=this.rtpreceiver;i&&i.then((e=>{Array.from(e.values()).forEach((e=>{"inbound-rtp"===e.type&&(n.inboundRTP.bytesReceived=e.bytesReceived,n.inboundRTP.jitterBufferDelay=e.jitterBufferDelay,n.inboundRTP.jitterBufferEmittedCount=e.jitterBufferEmittedCount,n.inboundRTP.jitterBufferMinimumDelay=e.jitterBufferMinimumDelay,n.inboundRTP.jitterBufferTargetDelay=e.jitterBufferTargetDelay,n.inboundRTP.packetsDiscarded=e.packetsDiscarded,n.inboundRTP.packetsLost=e.packetsLost,n.inboundRTP.packetsReceived=e.packetsReceived,n.inboundRTP.totalSamplesDuration=e.totalSamplesDuration,n.inboundRTP.totalSamplesReceived=e.totalSamplesDuration,n.inboundRTP.transportId=e.transportId),"remote-outbound-rtp"===e.type&&(n.remoteOutboundRTP.bytesSent=e.bytesSent,n.remoteOutboundRTP.packetsSent=e.packetsSent,n.remoteOutboundRTP.reportsSent=e.reportsSent,n.remoteOutboundRTP.totalRoundTripTime=e.totalRoundTripTime,n.remoteOutboundRTP.transportId=e.transportId)})),u.log.debug(`${o.LOGCAT.CALL} | Created CALL_STATS_DUMP Event`),C.call(this.clientScope,n)})).catch((n=>{u.log.debug(`${o.LOGCAT.CALL} | Error during CALL_STATS_DUMP event creation `,n.message),t(new Error("Error in getStats LocalStreams API"))})),e()}))},this.stop=()=>s(this,void 0,void 0,(function*(){const n={msg:"CALL_STATS_DUMP",callUUID:this.callUUID,xcallUUID:this.xcallUUID,source:o.STATS_SOURCE,timeStamp:Date.now(),version:o.STATS_VERSION,changedCandidatedInfo:{},localCandidate:{},remoteCandidate:{},transport:{},candidatePair:{},outboundRTP:{},remoteInboundRTP:{},inboundRTP:{},remoteOutboundRTP:{}};this.sendCallStatsDump(n),this.localAudioLevelHelper.stop(),this.remoteAudioLevelHelper.stop()})),this.clientScope=n,this.pc=n._currentSession.session.connection,this.xcallUUID=n._currentSession.callUUID,this.callUUID=n._currentSession.sipCallID,this.corelationId=n._currentSession.sipCallID,this.userName=n.userName,this.storage=n.storage,this.callstatskey=n.callstatskey,this.statsioused=n.statsioused,!this.pc||!this.callUUID)return this.pc||u.log.error("pc obj is null, webrtc stats error"),void(this.callUUID||u.log.error("CallUUID is null, webrtc stats error"));this.baseStatsCollected=!1,this.packets={},this.senderMediaStream=new MediaStream,this.senderMediaStream.addTrack(this.pc.getSenders()[0].track),this.receiverMediaStream=new MediaStream,this.receiverMediaStream.addTrack(this.pc.getReceivers()[0].track),this.localAudioLevelHelper=new c.AudioLevel(this.senderMediaStream),this.remoteAudioLevelHelper=new c.AudioLevel(this.receiverMediaStream),this.audioInputLevel=null,this.audioOutputLevel=null,this.audioInputCount=0,this.audioOutputCount=0,h.call(this),E.call(this)}}},function(n,e,t){"use strict";var r=this&&this.__createBinding||(Object.create?function(n,e,t,r){void 0===r&&(r=t),Object.defineProperty(n,r,{enumerable:!0,get:function(){return e[t]}})}:function(n,e,t,r){void 0===r&&(r=t),n[r]=e[t]}),i=this&&this.__setModuleDefault||(Object.create?function(n,e){Object.defineProperty(n,"default",{enumerable:!0,value:e})}:function(n,e){n.default=e}),a=this&&this.__importStar||function(n){if(n&&n.__esModule)return n;var e={};if(null!=n)for(var t in n)"default"!==t&&Object.prototype.hasOwnProperty.call(n,t)&&r(e,n,t);return i(e,n),e},s=this&&this.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(e,"__esModule",{value:!0}),e.NoiseSuppression=void 0;const o=t(0),c=a(t(1)),l=t(41),u=t(6),d=s(t(2)),h={log:o.Logger};e.NoiseSuppression=class{constructor(n){this.noiseSupressionRunning=!1,this.started=!1,this.initNoiseSuppresionEffect=function(){return new Promise((n=>{this.noiseSuppresionEffect=new l.NoiseSuppressionEffect,this.noiseSuppresionEffect.prepareAudioWorklet(this.client.noiseReductionFilePath).then((()=>{this.client.emit("onNoiseReductionReady"),n()}))}))},this.startNoiseSuppression=function(n){return new Promise((e=>{this.noiseSupressionRunning?(h.log.info(`${c.LOGCAT.CALL_QUALITY} | Noise Suppression is already running. Cannot start again`),e(window.localStream)):n?this.noiseSuppresionEffect&&this.noiseSuppresionEffect.noiseSuppressorNode&&this.started?(h.log.debug(`${c.LOGCAT.CALL_QUALITY} | Noise Suppression started. Starting effect on current stream`),this.noiseSupressionRunning=!0,this.noiseSuppresionEffect.startEffect(n).then((n=>{window.localStream=n,e(n)}))):(h.log.debug(`${c.LOGCAT.CALL_QUALITY} | Noise Suppression is not running, returning mediastream`),window.localStream=n,e(n)):this.setLocalMediaStream().then((n=>{h.log.info(`${c.LOGCAT.CALL_QUALITY} | Fetching new stream to process`),n?this.noiseSuppresionEffect&&this.noiseSuppresionEffect.noiseSuppressorNode&&this.started?(h.log.info(`${c.LOGCAT.CALL_QUALITY} | Noise Suppression started. Starting effect on new stream`),this.noiseSupressionRunning=!0,this.noiseSuppresionEffect.startEffect(n).then((n=>{window.localStream=n,e(n)}))):(h.log.info(`${c.LOGCAT.CALL_QUALITY} | Noise Suppression is not running, returning new stream without processing`),e(n)):(h.log.error(`${c.LOGCAT.CALL_QUALITY} | Could not fetch new stream. Returning current localStream`),e(window.localStream))})).catch((n=>{h.log.error(`${c.LOGCAT.CALL_QUALITY} | Error while fetching the new stream ${n}`),e(window.localStream)}))}))},this.stopNoiseSuppresion=()=>{if(this.noiseSuppresionEffect&&this.noiseSuppresionEffect.noiseSuppressorNode){if(!this.noiseSupressionRunning)return void h.log.debug(`${c.LOGCAT.CALL_QUALITY} | Noise Suppression is already stopped. Cannot stop again`);h.log.debug(`${c.LOGCAT.CALL_QUALITY} | Stopping noise suppression`),this.noiseSupressionRunning=!1,this.noiseSuppresionEffect.stopEffect()}},this.setLocalMediaStream=function(){return new Promise(((n,e)=>{window.localStream?(h.log.debug(`${c.LOGCAT.CALL_QUALITY} | Returning current localstream`),n(window.localStream)):navigator.mediaDevices&&navigator.mediaDevices.getUserMedia?navigator.mediaDevices.getUserMedia({audio:this.client.options.audioConstraints,video:!1}).then((e=>{h.log.debug(`${c.LOGCAT.CALL_QUALITY} | Got the new stream from getUserMedia`),window.localStream=e,n(e)})).catch((n=>{h.log.debug(`${c.LOGCAT.CALL_QUALITY} | Error in navigator.getUserMedia ${n}`),e(n)})):(h.log.error(`${c.LOGCAT.CALL_QUALITY} | Usermedia:Not available, Noise suppression will not work`),e(new Error("getUserMedia not available")))}))},this.updateProcessingStream=function(n){return new Promise((e=>{this.noiseSuppresionEffect&&(this.noiseSupressionRunning||this.started)?(this.stopNoiseSuppresion(),this.startNoiseSuppression(n).then((n=>{h.log.debug(`${c.LOGCAT.CALL_QUALITY} | Updated stream with a new stream`),window.localStream=n,e(n)}))):(h.log.debug(`${c.LOGCAT.CALL_QUALITY} | Noise suppresion not started. Returning current stream`),e(n))}))},this.clearNoiseSupression=()=>{this.noiseSuppresionEffect&&(h.log.debug(`${c.LOGCAT.CALL_QUALITY} | Noise suppression cleared`),this.noiseSupressionRunning=!1,this.started=!1,this.noiseSuppresionEffect.clearEffect())},this.muteStream=()=>{this.noiseSuppresionEffect&&this.noiseSupressionRunning&&(h.log.debug(`${c.LOGCAT.CALL_QUALITY} | processed stream muted`),this.noiseSuppresionEffect.muteEffect())},this.unmuteStream=()=>{this.noiseSuppresionEffect&&this.noiseSupressionRunning&&(h.log.debug(`${c.LOGCAT.CALL_QUALITY} | processed stream unmuted`),this.noiseSuppresionEffect.unmuteEffect())},this.startNoiseSuppresionManual=function(){return new Promise(((n,e)=>{this.noiseSuppresionEffect&&this.noiseSuppresionEffect.noiseSuppressorNode&&this.client?(h.log.debug(`${c.LOGCAT.CALL_QUALITY} | starting noise suppresion`),this.started?(h.log.info(`${c.LOGCAT.CALL_QUALITY} | noise suppresion already started. Cannot start again`),e(new Error("Noise suprresion is already started"))):(this.started=!0,u.replaceStream(this.client,{audio:this.client.options.audioConstraints,video:!1}).then((()=>{n()})).catch((n=>{e(n)})))):e(new Error('Noise reduction is not instantiated. Please check if "enableNoiseReduction" is passed as true while initializing the SDK'))}))},this.stopNoiseSuppressionManual=function(){return new Promise(((n,e)=>{this.noiseSuppresionEffect&&this.noiseSuppresionEffect.noiseSuppressorNode&&this.client?(h.log.debug(`${c.LOGCAT.CALL_QUALITY} | stopping noise suppresion`),this.started?(this.started=!1,u.replaceStream(this.client,{audio:this.client.options.audioConstraints,video:!1}).then((()=>{n()})).catch((n=>{e(n)}))):(h.log.debug(`${c.LOGCAT.CALL_QUALITY} | noise suppresion already stopped. Cannot stop again`),e(new Error("Noise suprresion is already stopped")))):e(new Error('Noise reduction is not instantiated. Please check if "enableNoiseReduction" is passed as true while initializing the SDK'))}))},this.client=n,n.enableNoiseReduction&&!this.noiseSuppresionEffect&&"safari"!==d.default().browser&&(h.log.info(`${c.LOGCAT.CALL_QUALITY} | Noise Suppression instance created`),this.initNoiseSuppresionEffect())}}},function(n,e,t){"use strict";var r=this&&this.__createBinding||(Object.create?function(n,e,t,r){void 0===r&&(r=t),Object.defineProperty(n,r,{enumerable:!0,get:function(){return e[t]}})}:function(n,e,t,r){void 0===r&&(r=t),n[r]=e[t]}),i=this&&this.__setModuleDefault||(Object.create?function(n,e){Object.defineProperty(n,"default",{enumerable:!0,value:e})}:function(n,e){n.default=e}),a=this&&this.__importStar||function(n){if(n&&n.__esModule)return n;var e={};if(null!=n)for(var t in n)"default"!==t&&Object.prototype.hasOwnProperty.call(n,t)&&r(e,n,t);return i(e,n),e};Object.defineProperty(e,"__esModule",{value:!0}),e.getBaseUrl=e.NoiseSuppressionEffect=void 0;const s=t(0),o=a(t(1)),c={log:s.Logger};function l(n,e,t){return new Promise((r=>{try{c.log.debug(`${o.LOGCAT.LOGIN} | Noise suppresion file path is: ${e}`),n.audioWorklet.addModule(e||"https://cdn.plivo.com/sdk/browser/processor.js").then((()=>{c.log.debug(`${o.LOGCAT.CALL_QUALITY} | audioWorklet setup is completed`),r(new AudioWorkletNode(n,"NoiseSuppressorWorklet-ts"))})).catch((i=>{c.log.debug(`${o.LOGCAT.LOGIN} | Error while loading audio worklet: ${i} `),e&&0===t&&(c.log.debug(`${o.LOGCAT.LOGIN} | Could not add file from path: ${e}. Fetching the file from plivo cdn`),r(l(n,"https://cdn.plivo.com/sdk/browser/processor.js",1)))}))}catch(n){c.log.error(`${o.LOGCAT.CALL_QUALITY} | Error while initializing noise suppression effect ${n}`),r(void 0)}}))}e.NoiseSuppressionEffect=class{constructor(){this.prepareAudioWorklet=function(n){return new Promise((e=>{const t=()=>{l(this.audioContext,n,0).then((n=>{n?(this.noiseSuppressorNode=n,e(this.noiseSuppressorNode)):e(void 0)}))};this.audioContext?(c.log.debug(`${o.LOGCAT.CALL_QUALITY} | AudioContext instance already created. Resuming it.`),this.audioContext.resume().then((()=>{t()}))):(c.log.debug(`${o.LOGCAT.CALL_QUALITY} | Creating new instance of AudioContext`),this.audioContext=new AudioContext,t())}))}}startEffect(n){return new Promise((e=>{try{this.audioContext.resume().then((()=>{this.originalMediaTrack=n.getAudioTracks()[0],this.audioSource=this.audioContext.createMediaStreamSource(n),this.audioDestination=this.audioContext.createMediaStreamDestination(),this.outputMediaTrack=this.audioDestination.stream.getAudioTracks()[0],this.noiseSuppressorNode&&this.audioSource&&this.audioDestination&&(this.audioSource.connect(this.noiseSuppressorNode),this.noiseSuppressorNode.connect(this.audioDestination)),this.outputMediaTrack.enabled=this.originalMediaTrack.enabled,this.originalMediaTrack.enabled=!0,e(this.audioDestination.stream)}))}catch(t){c.log.error(`${o.LOGCAT.CALL_QUALITY} | Error while starting noise suppression effect ${t}`),e(n)}}))}stopEffect(){var n,e;try{this.originalMediaTrack&&this.outputMediaTrack&&(this.originalMediaTrack.enabled=this.outputMediaTrack.enabled),null===(n=this.audioDestination)||void 0===n||n.disconnect(),null===(e=this.audioSource)||void 0===e||e.disconnect()}catch(n){c.log.error(`${o.LOGCAT.CALL_QUALITY} | Error while stopping noise suppression effect ${n}`)}}muteEffect(){try{this.noiseSuppressorNode&&this.audioSource&&this.audioDestination&&(this.audioSource.disconnect(this.noiseSuppressorNode),this.noiseSuppressorNode.disconnect(this.audioDestination))}catch(n){c.log.error(`${o.LOGCAT.CALL_QUALITY} | Error while mute in noise suppression effect ${n}`)}}unmuteEffect(){try{this.noiseSuppressorNode&&this.audioSource&&this.audioDestination&&(this.audioSource.connect(this.noiseSuppressorNode),this.noiseSuppressorNode.connect(this.audioDestination))}catch(n){c.log.error(`${o.LOGCAT.CALL_QUALITY} | Error while unmute in noise suppression effect ${n}`)}}clearEffect(){var n,e,t,r,i;try{this.originalMediaTrack&&this.outputMediaTrack&&(this.originalMediaTrack.enabled=this.outputMediaTrack.enabled),null===(e=null===(n=this.noiseSuppressorNode)||void 0===n?void 0:n.port)||void 0===e||e.close(),null===(t=this.audioDestination)||void 0===t||t.disconnect(),null===(r=this.noiseSuppressorNode)||void 0===r||r.disconnect(),null===(i=this.audioSource)||void 0===i||i.disconnect(),this.audioContext.suspend()}catch(n){c.log.error(`${o.LOGCAT.CALL_QUALITY} | Error while clearing noise suppression effect ${n}`)}}},e.getBaseUrl=function(n=window){const e=n.document.querySelector("base");if(null===e||void 0===e?void 0:e.href)return e.href;const{protocol:t,host:r}=n.location;return`${t}//${r}`}},function(n,e,t){"use strict";var r=this&&this.__createBinding||(Object.create?function(n,e,t,r){void 0===r&&(r=t),Object.defineProperty(n,r,{enumerable:!0,get:function(){return e[t]}})}:function(n,e,t,r){void 0===r&&(r=t),n[r]=e[t]}),i=this&&this.__setModuleDefault||(Object.create?function(n,e){Object.defineProperty(n,"default",{enumerable:!0,value:e})}:function(n,e){n.default=e}),a=this&&this.__importStar||function(n){if(n&&n.__esModule)return n;var e={};if(null!=n)for(var t in n)"default"!==t&&Object.prototype.hasOwnProperty.call(n,t)&&r(e,n,t);return i(e,n),e};Object.defineProperty(e,"__esModule",{value:!0}),e.validateFeedback=void 0;const s=a(t(1)),o={log:t(0).Logger};e.validateFeedback=function(n,e,t,r,i,a){return new Promise(((c,l)=>{if(!i)return o.log.error(`submitCallQualityFeedback() username is null, isLoggedIn : ${a}`),void l("username not found");if(!n)return o.log.error("submitCallQualityFeedback() callUUID is mandatory"),void l("callUUID is mandatory");if(!e)return o.log.error("submitCallQualityFeedback() starRating is not given "),void l("Star rating is Mandatory");const u=Number(e);return u<=0||u>5?(o.log.error(`submitCallQualityFeedback() starRating: ${u} , starRating should be from 1-5 range`),void l("score should be from 1-5 range")):t&&t.toString().length>280?(o.log.error("submitCallQualityFeedback() max length for note is 280 characters"),void l("Maximum length for note is 280 charecters")):void function(n,e,t,r=[],i){const a=[];if(Array.isArray(r)){if(5!==i&&(!r||r.length<1))return o.log.error("submitCallQualityFeedback() Atleast one issue is mandatory for feedback"),void e("Atleast one issue is mandatory for feedback");if(r.length>=1&&(r.forEach((n=>{if("string"===typeof n){const e=n.trim().toUpperCase(),t=s.DEFAULT_COMMENTS[e];t&&a.push(t)}})),a.length<1)){const n=Object.keys(s.DEFAULT_COMMENTS);if(5!==i)return o.log.error(`submitCallQualityFeedback() Issues must be from the predefined list of issues for feedback -${n}`),void e(`Issues must be from the predefined list of issues - ${n}`);o.log.debug(`submitCallQualityFeedback() Feedback with full rating without any Issues or matches from predefined list of issues -${n}`)}n({overall:i,comment:`${a} ${t}`||""})}else e("Attribute issues should be an array")}(c,l,t,r,u)}))}},function(n,e,t){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.default=()=>{const n=[];return(window.React||document.querySelector("[data-reactroot], [data-reactid]")||(()=>{const n=document.querySelectorAll("*");for(let e=0;e<n.length;e+=1)if(/react/.test(n[e])||/React/.test(n[e]))return!0;return!1})())&&n.push("React"),(window.angular||document.querySelector(".ng-binding, [ng-app], [data-ng-app], [ng-controller], [data-ng-controller], [ng-repeat], [ng-version], [data-ng-repeat]")||document.querySelector('script[src*="angular.js"], script[src*="angular.min.js"]'))&&n.push("Angular.js"),window.Backbone&&n.push("Backbone.js"),window.Ember&&n.push("Ember.js"),window.Vue&&n.push("Vue.js"),window.Meteor&&n.push("Meteor.js"),window.jQuery&&n.push("jQuery.js"),n}},function(n,e){var t=function(){if(this.constructor===t)throw new Error("Can't instantiate abstract class!")};t.prototype.getAccessToken=function(){throw new Error("Abstract method!")},n.exports=t},function(n,e,t){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.LoggerUtil=void 0;class r{constructor(n){this.sipCallID="",this.userName="",this.client=n,r.instance=this}static getInstance(){return this.instance||null}getSipCallID(){var n;return this.sipCallID?this.sipCallID:this.client._currentSession?(this.sipCallID=null!==(n=this.client._currentSession.sipCallID)&&void 0!==n?n:"",this.sipCallID):""}setSipCallID(n){this.sipCallID=n}getUserName(){return this.userName}setUserName(n){this.userName=n}}e.LoggerUtil=r},,,,,,function(n,e,t){"use strict";t.r(e);var r={};t.r(r),t.d(r,"shimGetUserMedia",(function(){return S})),t.d(r,"shimGetDisplayMedia",(function(){return T})),t.d(r,"shimMediaStream",(function(){return E})),t.d(r,"shimOnTrack",(function(){return w})),t.d(r,"shimGetSendersWithDtmf",(function(){return k})),t.d(r,"shimGetStats",(function(){return R})),t.d(r,"shimSenderReceiverGetStats",(function(){return I})),t.d(r,"shimAddTrackRemoveTrackWithNative",(function(){return A})),t.d(r,"shimAddTrackRemoveTrack",(function(){return O})),t.d(r,"shimPeerConnection",(function(){return P})),t.d(r,"fixNegotiationNeeded",(function(){return L}));var i={};t.r(i),t.d(i,"shimGetUserMedia",(function(){return M})),t.d(i,"shimGetDisplayMedia",(function(){return j})),t.d(i,"shimPeerConnection",(function(){return x})),t.d(i,"shimReplaceTrack",(function(){return U}));var a={};t.r(a),t.d(a,"shimGetUserMedia",(function(){return F})),t.d(a,"shimGetDisplayMedia",(function(){return G})),t.d(a,"shimOnTrack",(function(){return $})),t.d(a,"shimPeerConnection",(function(){return H})),t.d(a,"shimSenderGetStats",(function(){return B})),t.d(a,"shimReceiverGetStats",(function(){return q})),t.d(a,"shimRemoveStream",(function(){return V})),t.d(a,"shimRTCDataChannel",(function(){return W})),t.d(a,"shimAddTransceiver",(function(){return z})),t.d(a,"shimGetParameters",(function(){return K})),t.d(a,"shimCreateOffer",(function(){return J})),t.d(a,"shimCreateAnswer",(function(){return Q}));var s={};t.r(s),t.d(s,"shimLocalStreamsAPI",(function(){return Y})),t.d(s,"shimRemoteStreamsAPI",(function(){return X})),t.d(s,"shimCallbacksAPI",(function(){return Z})),t.d(s,"shimGetUserMedia",(function(){return nn})),t.d(s,"shimConstraints",(function(){return en})),t.d(s,"shimRTCIceServerUrls",(function(){return tn})),t.d(s,"shimTrackEventTransceiver",(function(){return rn})),t.d(s,"shimCreateOfferLegacy",(function(){return an})),t.d(s,"shimAudioContext",(function(){return sn}));var o={};t.r(o),t.d(o,"shimRTCIceCandidate",(function(){return ln})),t.d(o,"shimMaxMessageSize",(function(){return un})),t.d(o,"shimSendThrowTypeError",(function(){return dn})),t.d(o,"shimConnectionState",(function(){return hn})),t.d(o,"removeAllowExtmapMixed",(function(){return pn}));let c=!0,l=!0;function u(n,e,t){const r=n.match(e);return r&&r.length>=t&&parseInt(r[t],10)}function d(n,e,t){if(!n.RTCPeerConnection)return;const r=n.RTCPeerConnection.prototype,i=r.addEventListener;r.addEventListener=function(n,r){if(n!==e)return i.apply(this,arguments);const a=n=>{const e=t(n);e&&(r.handleEvent?r.handleEvent(e):r(e))};return this._eventMap=this._eventMap||{},this._eventMap[e]||(this._eventMap[e]=new Map),this._eventMap[e].set(r,a),i.apply(this,[n,a])};const a=r.removeEventListener;r.removeEventListener=function(n,t){if(n!==e||!this._eventMap||!this._eventMap[e])return a.apply(this,arguments);if(!this._eventMap[e].has(t))return a.apply(this,arguments);const r=this._eventMap[e].get(t);return this._eventMap[e].delete(t),0===this._eventMap[e].size&&delete this._eventMap[e],0===Object.keys(this._eventMap).length&&delete this._eventMap,a.apply(this,[n,r])},Object.defineProperty(r,"on"+e,{get(){return this["_on"+e]},set(n){this["_on"+e]&&(this.removeEventListener(e,this["_on"+e]),delete this["_on"+e]),n&&this.addEventListener(e,this["_on"+e]=n)},enumerable:!0,configurable:!0})}function h(n){return"boolean"!==typeof n?new Error("Argument type: "+typeof n+". Please use a boolean."):(c=n,n?"adapter.js logging disabled":"adapter.js logging enabled")}function p(n){return"boolean"!==typeof n?new Error("Argument type: "+typeof n+". Please use a boolean."):(l=!n,"adapter.js deprecation warnings "+(n?"disabled":"enabled"))}function f(){if("object"===typeof window){if(c)return;"undefined"!==typeof console&&"function"===typeof console.log&&console.log.apply(console,arguments)}}function g(n,e){l&&console.warn(n+" is deprecated, please use "+e+" instead.")}function m(n){const e={browser:null,version:null};if("undefined"===typeof n||!n.navigator)return e.browser="Not a browser.",e;const{navigator:t}=n;if(t.mozGetUserMedia)e.browser="firefox",e.version=u(t.userAgent,/Firefox\/(\d+)\./,1);else if(t.webkitGetUserMedia||!1===n.isSecureContext&&n.webkitRTCPeerConnection&&!n.RTCIceGatherer)e.browser="chrome",e.version=u(t.userAgent,/Chrom(e|ium)\/(\d+)\./,2);else if(t.mediaDevices&&t.userAgent.match(/Edge\/(\d+).(\d+)$/))e.browser="edge",e.version=u(t.userAgent,/Edge\/(\d+).(\d+)$/,2);else{if(!n.RTCPeerConnection||!t.userAgent.match(/AppleWebKit\/(\d+)\./))return e.browser="Not a supported browser.",e;e.browser="safari",e.version=u(t.userAgent,/AppleWebKit\/(\d+)\./,1),e.supportsUnifiedPlan=n.RTCRtpTransceiver&&"currentDirection"in n.RTCRtpTransceiver.prototype}return e}function b(n){return"[object Object]"===Object.prototype.toString.call(n)}function v(n){return b(n)?Object.keys(n).reduce((function(e,t){const r=b(n[t]),i=r?v(n[t]):n[t],a=r&&!Object.keys(i).length;return void 0===i||a?e:Object.assign(e,{[t]:i})}),{}):n}function y(n,e,t){e&&!t.has(e.id)&&(t.set(e.id,e),Object.keys(e).forEach((r=>{r.endsWith("Id")?y(n,n.get(e[r]),t):r.endsWith("Ids")&&e[r].forEach((e=>{y(n,n.get(e),t)}))})))}function _(n,e,t){const r=t?"outbound-rtp":"inbound-rtp",i=new Map;if(null===e)return i;const a=[];return n.forEach((n=>{"track"===n.type&&n.trackIdentifier===e.id&&a.push(n)})),a.forEach((e=>{n.forEach((t=>{t.type===r&&t.trackId===e.id&&y(n,t,i)}))})),i}const C=f;function S(n){const e=n&&n.navigator;if(!e.mediaDevices)return;const t=m(n),r=function(n){if("object"!==typeof n||n.mandatory||n.optional)return n;const e={};return Object.keys(n).forEach((t=>{if("require"===t||"advanced"===t||"mediaSource"===t)return;const r="object"===typeof n[t]?n[t]:{ideal:n[t]};void 0!==r.exact&&"number"===typeof r.exact&&(r.min=r.max=r.exact);const i=function(n,e){return n?n+e.charAt(0).toUpperCase()+e.slice(1):"deviceId"===e?"sourceId":e};if(void 0!==r.ideal){e.optional=e.optional||[];let n={};"number"===typeof r.ideal?(n[i("min",t)]=r.ideal,e.optional.push(n),n={},n[i("max",t)]=r.ideal,e.optional.push(n)):(n[i("",t)]=r.ideal,e.optional.push(n))}void 0!==r.exact&&"number"!==typeof r.exact?(e.mandatory=e.mandatory||{},e.mandatory[i("",t)]=r.exact):["min","max"].forEach((n=>{void 0!==r[n]&&(e.mandatory=e.mandatory||{},e.mandatory[i(n,t)]=r[n])}))})),n.advanced&&(e.optional=(e.optional||[]).concat(n.advanced)),e},i=function(n,i){if(t.version>=61)return i(n);if((n=JSON.parse(JSON.stringify(n)))&&"object"===typeof n.audio){const e=function(n,e,t){e in n&&!(t in n)&&(n[t]=n[e],delete n[e])};e((n=JSON.parse(JSON.stringify(n))).audio,"autoGainControl","googAutoGainControl"),e(n.audio,"noiseSuppression","googNoiseSuppression"),n.audio=r(n.audio)}if(n&&"object"===typeof n.video){let a=n.video.facingMode;a=a&&("object"===typeof a?a:{ideal:a});const s=t.version<66;if(a&&("user"===a.exact||"environment"===a.exact||"user"===a.ideal||"environment"===a.ideal)&&(!e.mediaDevices.getSupportedConstraints||!e.mediaDevices.getSupportedConstraints().facingMode||s)){let t;if(delete n.video.facingMode,"environment"===a.exact||"environment"===a.ideal?t=["back","rear"]:"user"!==a.exact&&"user"!==a.ideal||(t=["front"]),t)return e.mediaDevices.enumerateDevices().then((e=>{let s=(e=e.filter((n=>"videoinput"===n.kind))).find((n=>t.some((e=>n.label.toLowerCase().includes(e)))));return!s&&e.length&&t.includes("back")&&(s=e[e.length-1]),s&&(n.video.deviceId=a.exact?{exact:s.deviceId}:{ideal:s.deviceId}),n.video=r(n.video),C("chrome: "+JSON.stringify(n)),i(n)}))}n.video=r(n.video)}return C("chrome: "+JSON.stringify(n)),i(n)},a=function(n){return t.version>=64?n:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[n.name]||n.name,message:n.message,constraint:n.constraint||n.constraintName,toString(){return this.name+(this.message&&": ")+this.message}}};if(e.getUserMedia=function(n,t,r){i(n,(n=>{e.webkitGetUserMedia(n,t,(n=>{r&&r(a(n))}))}))}.bind(e),e.mediaDevices.getUserMedia){const n=e.mediaDevices.getUserMedia.bind(e.mediaDevices);e.mediaDevices.getUserMedia=function(e){return i(e,(e=>n(e).then((n=>{if(e.audio&&!n.getAudioTracks().length||e.video&&!n.getVideoTracks().length)throw n.getTracks().forEach((n=>{n.stop()})),new DOMException("","NotFoundError");return n}),(n=>Promise.reject(a(n))))))}}}function T(n,e){n.navigator.mediaDevices&&"getDisplayMedia"in n.navigator.mediaDevices||n.navigator.mediaDevices&&("function"===typeof e?n.navigator.mediaDevices.getDisplayMedia=function(t){return e(t).then((e=>{const r=t.video&&t.video.width,i=t.video&&t.video.height,a=t.video&&t.video.frameRate;return t.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:e,maxFrameRate:a||3}},r&&(t.video.mandatory.maxWidth=r),i&&(t.video.mandatory.maxHeight=i),n.navigator.mediaDevices.getUserMedia(t)}))}:console.error("shimGetDisplayMedia: getSourceId argument is not a function"))}function E(n){n.MediaStream=n.MediaStream||n.webkitMediaStream}function w(n){if("object"===typeof n&&n.RTCPeerConnection&&!("ontrack"in n.RTCPeerConnection.prototype)){Object.defineProperty(n.RTCPeerConnection.prototype,"ontrack",{get(){return this._ontrack},set(n){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=n)},enumerable:!0,configurable:!0});const e=n.RTCPeerConnection.prototype.setRemoteDescription;n.RTCPeerConnection.prototype.setRemoteDescription=function(){return this._ontrackpoly||(this._ontrackpoly=e=>{e.stream.addEventListener("addtrack",(t=>{let r;r=n.RTCPeerConnection.prototype.getReceivers?this.getReceivers().find((n=>n.track&&n.track.id===t.track.id)):{track:t.track};const i=new Event("track");i.track=t.track,i.receiver=r,i.transceiver={receiver:r},i.streams=[e.stream],this.dispatchEvent(i)})),e.stream.getTracks().forEach((t=>{let r;r=n.RTCPeerConnection.prototype.getReceivers?this.getReceivers().find((n=>n.track&&n.track.id===t.id)):{track:t};const i=new Event("track");i.track=t,i.receiver=r,i.transceiver={receiver:r},i.streams=[e.stream],this.dispatchEvent(i)}))},this.addEventListener("addstream",this._ontrackpoly)),e.apply(this,arguments)}}else d(n,"track",(n=>(n.transceiver||Object.defineProperty(n,"transceiver",{value:{receiver:n.receiver}}),n)))}function k(n){if("object"===typeof n&&n.RTCPeerConnection&&!("getSenders"in n.RTCPeerConnection.prototype)&&"createDTMFSender"in n.RTCPeerConnection.prototype){const e=function(n,e){return{track:e,get dtmf(){return void 0===this._dtmf&&("audio"===e.kind?this._dtmf=n.createDTMFSender(e):this._dtmf=null),this._dtmf},_pc:n}};if(!n.RTCPeerConnection.prototype.getSenders){n.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};const t=n.RTCPeerConnection.prototype.addTrack;n.RTCPeerConnection.prototype.addTrack=function(n,r){let i=t.apply(this,arguments);return i||(i=e(this,n),this._senders.push(i)),i};const r=n.RTCPeerConnection.prototype.removeTrack;n.RTCPeerConnection.prototype.removeTrack=function(n){r.apply(this,arguments);const e=this._senders.indexOf(n);-1!==e&&this._senders.splice(e,1)}}const t=n.RTCPeerConnection.prototype.addStream;n.RTCPeerConnection.prototype.addStream=function(n){this._senders=this._senders||[],t.apply(this,[n]),n.getTracks().forEach((n=>{this._senders.push(e(this,n))}))};const r=n.RTCPeerConnection.prototype.removeStream;n.RTCPeerConnection.prototype.removeStream=function(n){this._senders=this._senders||[],r.apply(this,[n]),n.getTracks().forEach((n=>{const e=this._senders.find((e=>e.track===n));e&&this._senders.splice(this._senders.indexOf(e),1)}))}}else if("object"===typeof n&&n.RTCPeerConnection&&"getSenders"in n.RTCPeerConnection.prototype&&"createDTMFSender"in n.RTCPeerConnection.prototype&&n.RTCRtpSender&&!("dtmf"in n.RTCRtpSender.prototype)){const e=n.RTCPeerConnection.prototype.getSenders;n.RTCPeerConnection.prototype.getSenders=function(){const n=e.apply(this,[]);return n.forEach((n=>n._pc=this)),n},Object.defineProperty(n.RTCRtpSender.prototype,"dtmf",{get(){return void 0===this._dtmf&&("audio"===this.track.kind?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}}function R(n){if(!n.RTCPeerConnection)return;const e=n.RTCPeerConnection.prototype.getStats;n.RTCPeerConnection.prototype.getStats=function(){const[n,t,r]=arguments;if(arguments.length>0&&"function"===typeof n)return e.apply(this,arguments);if(0===e.length&&(0===arguments.length||"function"!==typeof n))return e.apply(this,[]);const i=function(n){const e={};return n.result().forEach((n=>{const t={id:n.id,timestamp:n.timestamp,type:{localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[n.type]||n.type};n.names().forEach((e=>{t[e]=n.stat(e)})),e[t.id]=t})),e},a=function(n){return new Map(Object.keys(n).map((e=>[e,n[e]])))};if(arguments.length>=2){const r=function(n){t(a(i(n)))};return e.apply(this,[r,n])}return new Promise(((n,t)=>{e.apply(this,[function(e){n(a(i(e)))},t])})).then(t,r)}}function I(n){if(!("object"===typeof n&&n.RTCPeerConnection&&n.RTCRtpSender&&n.RTCRtpReceiver))return;if(!("getStats"in n.RTCRtpSender.prototype)){const e=n.RTCPeerConnection.prototype.getSenders;e&&(n.RTCPeerConnection.prototype.getSenders=function(){const n=e.apply(this,[]);return n.forEach((n=>n._pc=this)),n});const t=n.RTCPeerConnection.prototype.addTrack;t&&(n.RTCPeerConnection.prototype.addTrack=function(){const n=t.apply(this,arguments);return n._pc=this,n}),n.RTCRtpSender.prototype.getStats=function(){const n=this;return this._pc.getStats().then((e=>_(e,n.track,!0)))}}if(!("getStats"in n.RTCRtpReceiver.prototype)){const e=n.RTCPeerConnection.prototype.getReceivers;e&&(n.RTCPeerConnection.prototype.getReceivers=function(){const n=e.apply(this,[]);return n.forEach((n=>n._pc=this)),n}),d(n,"track",(n=>(n.receiver._pc=n.srcElement,n))),n.RTCRtpReceiver.prototype.getStats=function(){const n=this;return this._pc.getStats().then((e=>_(e,n.track,!1)))}}if(!("getStats"in n.RTCRtpSender.prototype)||!("getStats"in n.RTCRtpReceiver.prototype))return;const e=n.RTCPeerConnection.prototype.getStats;n.RTCPeerConnection.prototype.getStats=function(){if(arguments.length>0&&arguments[0]instanceof n.MediaStreamTrack){const n=arguments[0];let e,t,r;return this.getSenders().forEach((t=>{t.track===n&&(e?r=!0:e=t)})),this.getReceivers().forEach((e=>(e.track===n&&(t?r=!0:t=e),e.track===n))),r||e&&t?Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):e?e.getStats():t?t.getStats():Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return e.apply(this,arguments)}}function A(n){n.RTCPeerConnection.prototype.getLocalStreams=function(){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map((n=>this._shimmedLocalStreams[n][0]))};const e=n.RTCPeerConnection.prototype.addTrack;n.RTCPeerConnection.prototype.addTrack=function(n,t){if(!t)return e.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};const r=e.apply(this,arguments);return this._shimmedLocalStreams[t.id]?-1===this._shimmedLocalStreams[t.id].indexOf(r)&&this._shimmedLocalStreams[t.id].push(r):this._shimmedLocalStreams[t.id]=[t,r],r};const t=n.RTCPeerConnection.prototype.addStream;n.RTCPeerConnection.prototype.addStream=function(n){this._shimmedLocalStreams=this._shimmedLocalStreams||{},n.getTracks().forEach((n=>{if(this.getSenders().find((e=>e.track===n)))throw new DOMException("Track already exists.","InvalidAccessError")}));const e=this.getSenders();t.apply(this,arguments);const r=this.getSenders().filter((n=>-1===e.indexOf(n)));this._shimmedLocalStreams[n.id]=[n].concat(r)};const r=n.RTCPeerConnection.prototype.removeStream;n.RTCPeerConnection.prototype.removeStream=function(n){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[n.id],r.apply(this,arguments)};const i=n.RTCPeerConnection.prototype.removeTrack;n.RTCPeerConnection.prototype.removeTrack=function(n){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},n&&Object.keys(this._shimmedLocalStreams).forEach((e=>{const t=this._shimmedLocalStreams[e].indexOf(n);-1!==t&&this._shimmedLocalStreams[e].splice(t,1),1===this._shimmedLocalStreams[e].length&&delete this._shimmedLocalStreams[e]})),i.apply(this,arguments)}}function O(n){if(!n.RTCPeerConnection)return;const e=m(n);if(n.RTCPeerConnection.prototype.addTrack&&e.version>=65)return A(n);const t=n.RTCPeerConnection.prototype.getLocalStreams;n.RTCPeerConnection.prototype.getLocalStreams=function(){const n=t.apply(this);return this._reverseStreams=this._reverseStreams||{},n.map((n=>this._reverseStreams[n.id]))};const r=n.RTCPeerConnection.prototype.addStream;n.RTCPeerConnection.prototype.addStream=function(e){if(this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},e.getTracks().forEach((n=>{if(this.getSenders().find((e=>e.track===n)))throw new DOMException("Track already exists.","InvalidAccessError")})),!this._reverseStreams[e.id]){const t=new n.MediaStream(e.getTracks());this._streams[e.id]=t,this._reverseStreams[t.id]=e,e=t}r.apply(this,[e])};const i=n.RTCPeerConnection.prototype.removeStream;function a(n,e){let t=e.sdp;return Object.keys(n._reverseStreams||[]).forEach((e=>{const r=n._reverseStreams[e],i=n._streams[r.id];t=t.replace(new RegExp(i.id,"g"),r.id)})),new RTCSessionDescription({type:e.type,sdp:t})}function s(n,e){let t=e.sdp;return Object.keys(n._reverseStreams||[]).forEach((e=>{const r=n._reverseStreams[e],i=n._streams[r.id];t=t.replace(new RegExp(r.id,"g"),i.id)})),new RTCSessionDescription({type:e.type,sdp:t})}n.RTCPeerConnection.prototype.removeStream=function(n){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},i.apply(this,[this._streams[n.id]||n]),delete this._reverseStreams[this._streams[n.id]?this._streams[n.id].id:n.id],delete this._streams[n.id]},n.RTCPeerConnection.prototype.addTrack=function(e,t){if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");const r=[].slice.call(arguments,1);if(1!==r.length||!r[0].getTracks().find((n=>n===e)))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");const i=this.getSenders().find((n=>n.track===e));if(i)throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};const a=this._streams[t.id];if(a)a.addTrack(e),Promise.resolve().then((()=>{this.dispatchEvent(new Event("negotiationneeded"))}));else{const r=new n.MediaStream([e]);this._streams[t.id]=r,this._reverseStreams[r.id]=t,this.addStream(r)}return this.getSenders().find((n=>n.track===e))},["createOffer","createAnswer"].forEach((function(e){const t=n.RTCPeerConnection.prototype[e],r={[e](){const n=arguments;return arguments.length&&"function"===typeof arguments[0]?t.apply(this,[e=>{const t=a(this,e);n[0].apply(null,[t])},e=>{n[1]&&n[1].apply(null,e)},arguments[2]]):t.apply(this,arguments).then((n=>a(this,n)))}};n.RTCPeerConnection.prototype[e]=r[e]}));const o=n.RTCPeerConnection.prototype.setLocalDescription;n.RTCPeerConnection.prototype.setLocalDescription=function(){return arguments.length&&arguments[0].type?(arguments[0]=s(this,arguments[0]),o.apply(this,arguments)):o.apply(this,arguments)};const c=Object.getOwnPropertyDescriptor(n.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(n.RTCPeerConnection.prototype,"localDescription",{get(){const n=c.get.apply(this);return""===n.type?n:a(this,n)}}),n.RTCPeerConnection.prototype.removeTrack=function(n){if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!n._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(!(n._pc===this))throw new DOMException("Sender was not created by this connection.","InvalidAccessError");let e;this._streams=this._streams||{},Object.keys(this._streams).forEach((t=>{this._streams[t].getTracks().find((e=>n.track===e))&&(e=this._streams[t])})),e&&(1===e.getTracks().length?this.removeStream(this._reverseStreams[e.id]):e.removeTrack(n.track),this.dispatchEvent(new Event("negotiationneeded")))}}function P(n){const e=m(n);if(!n.RTCPeerConnection&&n.webkitRTCPeerConnection&&(n.RTCPeerConnection=n.webkitRTCPeerConnection),!n.RTCPeerConnection)return;const t=0===n.RTCPeerConnection.prototype.addIceCandidate.length;e.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach((function(e){const t=n.RTCPeerConnection.prototype[e],r={[e](){return arguments[0]=new("addIceCandidate"===e?n.RTCIceCandidate:n.RTCSessionDescription)(arguments[0]),t.apply(this,arguments)}};n.RTCPeerConnection.prototype[e]=r[e]}));const r=n.RTCPeerConnection.prototype.addIceCandidate;n.RTCPeerConnection.prototype.addIceCandidate=function(){return t||arguments[0]?e.version<78&&arguments[0]&&""===arguments[0].candidate?Promise.resolve():r.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())}}function L(n){const e=m(n);d(n,"negotiationneeded",(n=>{const t=n.target;if(!(e.version<72||t.getConfiguration&&"plan-b"===t.getConfiguration().sdpSemantics)||"stable"===t.signalingState)return n}))}var D=t(24),N=t.n(D);function M(n){const e=n&&n.navigator,t=e.mediaDevices.getUserMedia.bind(e.mediaDevices);e.mediaDevices.getUserMedia=function(n){return t(n).catch((n=>Promise.reject(function(n){return{name:{PermissionDeniedError:"NotAllowedError"}[n.name]||n.name,message:n.message,constraint:n.constraint,toString(){return this.name}}}(n))))}}function j(n){"getDisplayMedia"in n.navigator&&n.navigator.mediaDevices&&(n.navigator.mediaDevices&&"getDisplayMedia"in n.navigator.mediaDevices||(n.navigator.mediaDevices.getDisplayMedia=n.navigator.getDisplayMedia.bind(n.navigator)))}function x(n){const e=m(n);if(n.RTCIceGatherer&&(n.RTCIceCandidate||(n.RTCIceCandidate=function(n){return n}),n.RTCSessionDescription||(n.RTCSessionDescription=function(n){return n}),e.version<15025)){const e=Object.getOwnPropertyDescriptor(n.MediaStreamTrack.prototype,"enabled");Object.defineProperty(n.MediaStreamTrack.prototype,"enabled",{set(n){e.set.call(this,n);const t=new Event("enabled");t.enabled=n,this.dispatchEvent(t)}})}n.RTCRtpSender&&!("dtmf"in n.RTCRtpSender.prototype)&&Object.defineProperty(n.RTCRtpSender.prototype,"dtmf",{get(){return void 0===this._dtmf&&("audio"===this.track.kind?this._dtmf=new n.RTCDtmfSender(this):"video"===this.track.kind&&(this._dtmf=null)),this._dtmf}}),n.RTCDtmfSender&&!n.RTCDTMFSender&&(n.RTCDTMFSender=n.RTCDtmfSender);const t=N()(n,e.version);n.RTCPeerConnection=function(n){return n&&n.iceServers&&(n.iceServers=function(n,e){let t=!1;return(n=JSON.parse(JSON.stringify(n))).filter((n=>{if(n&&(n.urls||n.url)){let e=n.urls||n.url;n.url&&!n.urls&&g("RTCIceServer.url","RTCIceServer.urls");const r="string"===typeof e;return r&&(e=[e]),e=e.filter((n=>{if(0===n.indexOf("stun:"))return!1;const e=n.startsWith("turn")&&!n.startsWith("turn:[")&&n.includes("transport=udp");return e&&!t?(t=!0,!0):e&&!t})),delete n.url,n.urls=r?e[0]:e,!!e.length}}))}(n.iceServers,e.version),f("ICE servers after filtering:",n.iceServers)),new t(n)},n.RTCPeerConnection.prototype=t.prototype}function U(n){n.RTCRtpSender&&!("replaceTrack"in n.RTCRtpSender.prototype)&&(n.RTCRtpSender.prototype.replaceTrack=n.RTCRtpSender.prototype.setTrack)}function F(n){const e=m(n),t=n&&n.navigator,r=n&&n.MediaStreamTrack;if(t.getUserMedia=function(n,e,r){g("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),t.mediaDevices.getUserMedia(n).then(e,r)},!(e.version>55&&"autoGainControl"in t.mediaDevices.getSupportedConstraints())){const n=function(n,e,t){e in n&&!(t in n)&&(n[t]=n[e],delete n[e])},e=t.mediaDevices.getUserMedia.bind(t.mediaDevices);if(t.mediaDevices.getUserMedia=function(t){return"object"===typeof t&&"object"===typeof t.audio&&(t=JSON.parse(JSON.stringify(t)),n(t.audio,"autoGainControl","mozAutoGainControl"),n(t.audio,"noiseSuppression","mozNoiseSuppression")),e(t)},r&&r.prototype.getSettings){const e=r.prototype.getSettings;r.prototype.getSettings=function(){const t=e.apply(this,arguments);return n(t,"mozAutoGainControl","autoGainControl"),n(t,"mozNoiseSuppression","noiseSuppression"),t}}if(r&&r.prototype.applyConstraints){const e=r.prototype.applyConstraints;r.prototype.applyConstraints=function(t){return"audio"===this.kind&&"object"===typeof t&&(t=JSON.parse(JSON.stringify(t)),n(t,"autoGainControl","mozAutoGainControl"),n(t,"noiseSuppression","mozNoiseSuppression")),e.apply(this,[t])}}}}function G(n,e){n.navigator.mediaDevices&&"getDisplayMedia"in n.navigator.mediaDevices||n.navigator.mediaDevices&&(n.navigator.mediaDevices.getDisplayMedia=function(t){if(!t||!t.video){const n=new DOMException("getDisplayMedia without video constraints is undefined");return n.name="NotFoundError",n.code=8,Promise.reject(n)}return!0===t.video?t.video={mediaSource:e}:t.video.mediaSource=e,n.navigator.mediaDevices.getUserMedia(t)})}function $(n){"object"===typeof n&&n.RTCTrackEvent&&"receiver"in n.RTCTrackEvent.prototype&&!("transceiver"in n.RTCTrackEvent.prototype)&&Object.defineProperty(n.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function H(n){const e=m(n);if("object"!==typeof n||!n.RTCPeerConnection&&!n.mozRTCPeerConnection)return;if(!n.RTCPeerConnection&&n.mozRTCPeerConnection&&(n.RTCPeerConnection=n.mozRTCPeerConnection),e.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach((function(e){const t=n.RTCPeerConnection.prototype[e],r={[e](){return arguments[0]=new("addIceCandidate"===e?n.RTCIceCandidate:n.RTCSessionDescription)(arguments[0]),t.apply(this,arguments)}};n.RTCPeerConnection.prototype[e]=r[e]})),e.version<68){const e=n.RTCPeerConnection.prototype.addIceCandidate;n.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?arguments[0]&&""===arguments[0].candidate?Promise.resolve():e.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())}}const t={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},r=n.RTCPeerConnection.prototype.getStats;n.RTCPeerConnection.prototype.getStats=function(){const[n,i,a]=arguments;return r.apply(this,[n||null]).then((n=>{if(e.version<53&&!i)try{n.forEach((n=>{n.type=t[n.type]||n.type}))}catch(e){if("TypeError"!==e.name)throw e;n.forEach(((e,r)=>{n.set(r,Object.assign({},e,{type:t[e.type]||e.type}))}))}return n})).then(i,a)}}function B(n){if("object"!==typeof n||!n.RTCPeerConnection||!n.RTCRtpSender)return;if(n.RTCRtpSender&&"getStats"in n.RTCRtpSender.prototype)return;const e=n.RTCPeerConnection.prototype.getSenders;e&&(n.RTCPeerConnection.prototype.getSenders=function(){const n=e.apply(this,[]);return n.forEach((n=>n._pc=this)),n});const t=n.RTCPeerConnection.prototype.addTrack;t&&(n.RTCPeerConnection.prototype.addTrack=function(){const n=t.apply(this,arguments);return n._pc=this,n}),n.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map)}}function q(n){if("object"!==typeof n||!n.RTCPeerConnection||!n.RTCRtpSender)return;if(n.RTCRtpSender&&"getStats"in n.RTCRtpReceiver.prototype)return;const e=n.RTCPeerConnection.prototype.getReceivers;e&&(n.RTCPeerConnection.prototype.getReceivers=function(){const n=e.apply(this,[]);return n.forEach((n=>n._pc=this)),n}),d(n,"track",(n=>(n.receiver._pc=n.srcElement,n))),n.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}function V(n){n.RTCPeerConnection&&!("removeStream"in n.RTCPeerConnection.prototype)&&(n.RTCPeerConnection.prototype.removeStream=function(n){g("removeStream","removeTrack"),this.getSenders().forEach((e=>{e.track&&n.getTracks().includes(e.track)&&this.removeTrack(e)}))})}function W(n){n.DataChannel&&!n.RTCDataChannel&&(n.RTCDataChannel=n.DataChannel)}function z(n){if("object"!==typeof n||!n.RTCPeerConnection)return;const e=n.RTCPeerConnection.prototype.addTransceiver;e&&(n.RTCPeerConnection.prototype.addTransceiver=function(){this.setParametersPromises=[];const n=arguments[1],t=n&&"sendEncodings"in n;t&&n.sendEncodings.forEach((n=>{if("rid"in n){if(!/^[a-z0-9]{0,16}$/i.test(n.rid))throw new TypeError("Invalid RID value provided.")}if("scaleResolutionDownBy"in n&&!(parseFloat(n.scaleResolutionDownBy)>=1))throw new RangeError("scale_resolution_down_by must be >= 1.0");if("maxFramerate"in n&&!(parseFloat(n.maxFramerate)>=0))throw new RangeError("max_framerate must be >= 0.0")}));const r=e.apply(this,arguments);if(t){const{sender:e}=r,t=e.getParameters();(!("encodings"in t)||1===t.encodings.length&&0===Object.keys(t.encodings[0]).length)&&(t.encodings=n.sendEncodings,e.sendEncodings=n.sendEncodings,this.setParametersPromises.push(e.setParameters(t).then((()=>{delete e.sendEncodings})).catch((()=>{delete e.sendEncodings}))))}return r})}function K(n){if("object"!==typeof n||!n.RTCRtpSender)return;const e=n.RTCRtpSender.prototype.getParameters;e&&(n.RTCRtpSender.prototype.getParameters=function(){const n=e.apply(this,arguments);return"encodings"in n||(n.encodings=[].concat(this.sendEncodings||[{}])),n})}function J(n){if("object"!==typeof n||!n.RTCPeerConnection)return;const e=n.RTCPeerConnection.prototype.createOffer;n.RTCPeerConnection.prototype.createOffer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then((()=>e.apply(this,arguments))).finally((()=>{this.setParametersPromises=[]})):e.apply(this,arguments)}}function Q(n){if("object"!==typeof n||!n.RTCPeerConnection)return;const e=n.RTCPeerConnection.prototype.createAnswer;n.RTCPeerConnection.prototype.createAnswer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then((()=>e.apply(this,arguments))).finally((()=>{this.setParametersPromises=[]})):e.apply(this,arguments)}}function Y(n){if("object"===typeof n&&n.RTCPeerConnection){if("getLocalStreams"in n.RTCPeerConnection.prototype||(n.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),!("addStream"in n.RTCPeerConnection.prototype)){const e=n.RTCPeerConnection.prototype.addTrack;n.RTCPeerConnection.prototype.addStream=function(n){this._localStreams||(this._localStreams=[]),this._localStreams.includes(n)||this._localStreams.push(n),n.getAudioTracks().forEach((t=>e.call(this,t,n))),n.getVideoTracks().forEach((t=>e.call(this,t,n)))},n.RTCPeerConnection.prototype.addTrack=function(n,...t){return t&&t.forEach((n=>{this._localStreams?this._localStreams.includes(n)||this._localStreams.push(n):this._localStreams=[n]})),e.apply(this,arguments)}}"removeStream"in n.RTCPeerConnection.prototype||(n.RTCPeerConnection.prototype.removeStream=function(n){this._localStreams||(this._localStreams=[]);const e=this._localStreams.indexOf(n);if(-1===e)return;this._localStreams.splice(e,1);const t=n.getTracks();this.getSenders().forEach((n=>{t.includes(n.track)&&this.removeTrack(n)}))})}}function X(n){if("object"===typeof n&&n.RTCPeerConnection&&("getRemoteStreams"in n.RTCPeerConnection.prototype||(n.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in n.RTCPeerConnection.prototype))){Object.defineProperty(n.RTCPeerConnection.prototype,"onaddstream",{get(){return this._onaddstream},set(n){this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=n),this.addEventListener("track",this._onaddstreampoly=n=>{n.streams.forEach((n=>{if(this._remoteStreams||(this._remoteStreams=[]),this._remoteStreams.includes(n))return;this._remoteStreams.push(n);const e=new Event("addstream");e.stream=n,this.dispatchEvent(e)}))})}});const e=n.RTCPeerConnection.prototype.setRemoteDescription;n.RTCPeerConnection.prototype.setRemoteDescription=function(){const n=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(e){e.streams.forEach((e=>{if(n._remoteStreams||(n._remoteStreams=[]),n._remoteStreams.indexOf(e)>=0)return;n._remoteStreams.push(e);const t=new Event("addstream");t.stream=e,n.dispatchEvent(t)}))}),e.apply(n,arguments)}}}function Z(n){if("object"!==typeof n||!n.RTCPeerConnection)return;const e=n.RTCPeerConnection.prototype,t=e.createOffer,r=e.createAnswer,i=e.setLocalDescription,a=e.setRemoteDescription,s=e.addIceCandidate;e.createOffer=function(n,e){const r=arguments.length>=2?arguments[2]:arguments[0],i=t.apply(this,[r]);return e?(i.then(n,e),Promise.resolve()):i},e.createAnswer=function(n,e){const t=arguments.length>=2?arguments[2]:arguments[0],i=r.apply(this,[t]);return e?(i.then(n,e),Promise.resolve()):i};let o=function(n,e,t){const r=i.apply(this,[n]);return t?(r.then(e,t),Promise.resolve()):r};e.setLocalDescription=o,o=function(n,e,t){const r=a.apply(this,[n]);return t?(r.then(e,t),Promise.resolve()):r},e.setRemoteDescription=o,o=function(n,e,t){const r=s.apply(this,[n]);return t?(r.then(e,t),Promise.resolve()):r},e.addIceCandidate=o}function nn(n){const e=n&&n.navigator;if(e.mediaDevices&&e.mediaDevices.getUserMedia){const n=e.mediaDevices,t=n.getUserMedia.bind(n);e.mediaDevices.getUserMedia=n=>t(en(n))}!e.getUserMedia&&e.mediaDevices&&e.mediaDevices.getUserMedia&&(e.getUserMedia=function(n,t,r){e.mediaDevices.getUserMedia(n).then(t,r)}.bind(e))}function en(n){return n&&void 0!==n.video?Object.assign({},n,{video:v(n.video)}):n}function tn(n){if(!n.RTCPeerConnection)return;const e=n.RTCPeerConnection;n.RTCPeerConnection=function(n,t){if(n&&n.iceServers){const e=[];for(let t=0;t<n.iceServers.length;t++){let r=n.iceServers[t];!r.hasOwnProperty("urls")&&r.hasOwnProperty("url")?(g("RTCIceServer.url","RTCIceServer.urls"),r=JSON.parse(JSON.stringify(r)),r.urls=r.url,delete r.url,e.push(r)):e.push(n.iceServers[t])}n.iceServers=e}return new e(n,t)},n.RTCPeerConnection.prototype=e.prototype,"generateCertificate"in e&&Object.defineProperty(n.RTCPeerConnection,"generateCertificate",{get:()=>e.generateCertificate})}function rn(n){"object"===typeof n&&n.RTCTrackEvent&&"receiver"in n.RTCTrackEvent.prototype&&!("transceiver"in n.RTCTrackEvent.prototype)&&Object.defineProperty(n.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function an(n){const e=n.RTCPeerConnection.prototype.createOffer;n.RTCPeerConnection.prototype.createOffer=function(n){if(n){"undefined"!==typeof n.offerToReceiveAudio&&(n.offerToReceiveAudio=!!n.offerToReceiveAudio);const e=this.getTransceivers().find((n=>"audio"===n.receiver.track.kind));!1===n.offerToReceiveAudio&&e?"sendrecv"===e.direction?e.setDirection?e.setDirection("sendonly"):e.direction="sendonly":"recvonly"===e.direction&&(e.setDirection?e.setDirection("inactive"):e.direction="inactive"):!0!==n.offerToReceiveAudio||e||this.addTransceiver("audio"),"undefined"!==typeof n.offerToReceiveVideo&&(n.offerToReceiveVideo=!!n.offerToReceiveVideo);const t=this.getTransceivers().find((n=>"video"===n.receiver.track.kind));!1===n.offerToReceiveVideo&&t?"sendrecv"===t.direction?t.setDirection?t.setDirection("sendonly"):t.direction="sendonly":"recvonly"===t.direction&&(t.setDirection?t.setDirection("inactive"):t.direction="inactive"):!0!==n.offerToReceiveVideo||t||this.addTransceiver("video")}return e.apply(this,arguments)}}function sn(n){"object"!==typeof n||n.AudioContext||(n.AudioContext=n.webkitAudioContext)}var on=t(5),cn=t.n(on);function ln(n){if(!n.RTCIceCandidate||n.RTCIceCandidate&&"foundation"in n.RTCIceCandidate.prototype)return;const e=n.RTCIceCandidate;n.RTCIceCandidate=function(n){if("object"===typeof n&&n.candidate&&0===n.candidate.indexOf("a=")&&((n=JSON.parse(JSON.stringify(n))).candidate=n.candidate.substr(2)),n.candidate&&n.candidate.length){const t=new e(n),r=cn.a.parseCandidate(n.candidate),i=Object.assign(t,r);return i.toJSON=function(){return{candidate:i.candidate,sdpMid:i.sdpMid,sdpMLineIndex:i.sdpMLineIndex,usernameFragment:i.usernameFragment}},i}return new e(n)},n.RTCIceCandidate.prototype=e.prototype,d(n,"icecandidate",(e=>(e.candidate&&Object.defineProperty(e,"candidate",{value:new n.RTCIceCandidate(e.candidate),writable:"false"}),e)))}function un(n){if(!n.RTCPeerConnection)return;const e=m(n);"sctp"in n.RTCPeerConnection.prototype||Object.defineProperty(n.RTCPeerConnection.prototype,"sctp",{get(){return"undefined"===typeof this._sctp?null:this._sctp}});const t=function(n){if(!n||!n.sdp)return!1;const e=cn.a.splitSections(n.sdp);return e.shift(),e.some((n=>{const e=cn.a.parseMLine(n);return e&&"application"===e.kind&&-1!==e.protocol.indexOf("SCTP")}))},r=function(n){const e=n.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(null===e||e.length<2)return-1;const t=parseInt(e[1],10);return t!==t?-1:t},i=function(n){let t=65536;return"firefox"===e.browser&&(t=e.version<57?-1===n?16384:2147483637:e.version<60?57===e.version?65535:65536:2147483637),t},a=function(n,t){let r=65536;"firefox"===e.browser&&57===e.version&&(r=65535);const i=cn.a.matchPrefix(n.sdp,"a=max-message-size:");return i.length>0?r=parseInt(i[0].substr(19),10):"firefox"===e.browser&&-1!==t&&(r=2147483637),r},s=n.RTCPeerConnection.prototype.setRemoteDescription;n.RTCPeerConnection.prototype.setRemoteDescription=function(){if(this._sctp=null,"chrome"===e.browser&&e.version>=76){const{sdpSemantics:n}=this.getConfiguration();"plan-b"===n&&Object.defineProperty(this,"sctp",{get(){return"undefined"===typeof this._sctp?null:this._sctp},enumerable:!0,configurable:!0})}if(t(arguments[0])){const n=r(arguments[0]),e=i(n),t=a(arguments[0],n);let s;s=0===e&&0===t?Number.POSITIVE_INFINITY:0===e||0===t?Math.max(e,t):Math.min(e,t);const o={};Object.defineProperty(o,"maxMessageSize",{get:()=>s}),this._sctp=o}return s.apply(this,arguments)}}function dn(n){if(!n.RTCPeerConnection||!("createDataChannel"in n.RTCPeerConnection.prototype))return;function e(n,e){const t=n.send;n.send=function(){const r=arguments[0],i=r.length||r.size||r.byteLength;if("open"===n.readyState&&e.sctp&&i>e.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+e.sctp.maxMessageSize+" bytes)");return t.apply(n,arguments)}}const t=n.RTCPeerConnection.prototype.createDataChannel;n.RTCPeerConnection.prototype.createDataChannel=function(){const n=t.apply(this,arguments);return e(n,this),n},d(n,"datachannel",(n=>(e(n.channel,n.target),n)))}function hn(n){if(!n.RTCPeerConnection||"connectionState"in n.RTCPeerConnection.prototype)return;const e=n.RTCPeerConnection.prototype;Object.defineProperty(e,"connectionState",{get(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(e,"onconnectionstatechange",{get(){return this._onconnectionstatechange||null},set(n){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),n&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=n)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach((n=>{const t=e[n];e[n]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=n=>{const e=n.target;if(e._lastConnectionState!==e.connectionState){e._lastConnectionState=e.connectionState;const t=new Event("connectionstatechange",n);e.dispatchEvent(t)}return n},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),t.apply(this,arguments)}}))}function pn(n){if(!n.RTCPeerConnection)return;const e=m(n);if("chrome"===e.browser&&e.version>=71)return;if("safari"===e.browser&&e.version>=605)return;const t=n.RTCPeerConnection.prototype.setRemoteDescription;n.RTCPeerConnection.prototype.setRemoteDescription=function(n){return n&&n.sdp&&-1!==n.sdp.indexOf("\na=extmap-allow-mixed")&&(n.sdp=n.sdp.split("\n").filter((n=>"a=extmap-allow-mixed"!==n.trim())).join("\n")),t.apply(this,arguments)}}const fn=function({window:n}={},e={shimChrome:!0,shimFirefox:!0,shimEdge:!0,shimSafari:!0}){const t=f,c=m(n),l={browserDetails:c,commonShim:o,extractVersion:u,disableLog:h,disableWarnings:p};switch(c.browser){case"chrome":if(!r||!P||!e.shimChrome)return t("Chrome shim is not included in this adapter release."),l;if(null===c.version)return t("Chrome shim can not determine version, not shimming."),l;t("adapter.js shimming chrome."),l.browserShim=r,S(n),E(n),P(n),w(n),O(n),k(n),R(n),I(n),L(n),ln(n),hn(n),un(n),dn(n),pn(n);break;case"firefox":if(!a||!H||!e.shimFirefox)return t("Firefox shim is not included in this adapter release."),l;t("adapter.js shimming firefox."),l.browserShim=a,F(n),H(n),$(n),V(n),B(n),q(n),W(n),z(n),K(n),J(n),Q(n),ln(n),hn(n),un(n),dn(n);break;case"edge":if(!i||!x||!e.shimEdge)return t("MS edge shim is not included in this adapter release."),l;t("adapter.js shimming edge."),l.browserShim=i,M(n),j(n),x(n),U(n),un(n),dn(n);break;case"safari":if(!s||!e.shimSafari)return t("Safari shim is not included in this adapter release."),l;t("adapter.js shimming safari."),l.browserShim=s,tn(n),an(n),Z(n),Y(n),X(n),rn(n),nn(n),sn(n),ln(n),un(n),dn(n),pn(n);break;default:t("Unsupported browser!")}return l}({window:"undefined"===typeof window?void 0:window});e.default=fn}]);